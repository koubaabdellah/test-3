// JavaScript Document
var viewWidth = jQuery(window).width();
var viewHeight = jQuery(window).height();
var isMobileCQ = 'false';
if (viewWidth <= '767') {
    isMobileCQ = 'true';
}

var site = 'http://www.att.com';
var pid = '';
thomson = location.href;
thomson = thomson.indexOf('phoenix');
if (thomson !== -1) {
    pid = 'thomson';
    site = 'http://www.att.com';
}
if (location.href.indexOf('historic_att_stock') == '27') {
    pid = 'historicattstock';
    site = 'http://www.att.com';
}
rss = location.href;
rss = rss.indexOf('rss');
if (rss !== -1) {
    pid = 'rss';
    site = 'http://www.att.com';
}

function renderGNTop() {
    document.write('<div id="wrapper"><div id="inner-wrapper"><div>' + '<ul id="universalNav" role="menu">' + '<li class="accessibility"><a role="menuitem" href="#content" title="Skip To Content">Skip To Content</a></li>' + '</ul>' + '</div>' + '<div id="container">' + '<div id="page">');
    renderTopLeftTabs();
    renderPrimaryNav();
    document.write('<div id="content-container">' + '<div id="content">');
}

function renderTopLeftTabs() {
    document.write('<div id="header">' + '<ul class="topLeftTabs" role="menu">' + '<li id="per" class="first"><a role="menuitem" href="http://www.att.com/gen/landing-pages?pid=3308" title="Personal">Personal</a></li>' + '<li id="biz"><a role="menuitem" href="http://www.att.com/gen/landing-pages?pid=9213" title="Business">Business</a>' + '<ul>' + '<li><a role="menuitem" href="http://www.att.com/gen/landing-pages?pid=9213" title="Small Business">Small Business</a></li>' + '<li><a role="menuitem" href="http://www.att.com/gen/landing-pages?pid=9214" title="Enterprise Business">Enterprise Business</a></li>' + '<li><a role="menuitem" href="http://www.att.com/gen/general?pid=11624" title="Wholesale">Wholesale</a></li>' + '<li><a role="menuitem" href="http://www.att.com/gen/general?pid=11625" title="Government">Government</a></li>' + '</ul>' + '</li>' + '<li id="abt" class="selected"><a role="menuitem" href="http://about.att.com" title="About AT&amp;T">About AT&amp;T</a></li>' + '<li id="last"><span> </span></li>' + '</ul>' + '</div>');
}


function renderPrimaryNav() {
    document.write('<div id="mainNavigation">');
    if (thomson !== -1) {
        pid = 'thomson';
        site = 'http://www.att.com';
        var thomsonID = location.href;
        checkURL = thomsonID.indexOf('p=');
        if (checkURL !== -1) {
            thomsonID = thomsonID.substr(checkURL + 2);
            checkAnd = thomsonID.indexOf('&');
            if (checkAnd !== -1) {
                thomsonID = thomsonID.split('&');
                thomsonID = thomsonID[0];
            }
            checkAnc = thomsonID.indexOf('#');
            if (checkAnc !== -1) {
                thomsonID = thomsonID.split('#');
                thomsonID = thomsonID[0];
            }
            pid = thomsonID;
        }
        pid = pid.toLowerCase();
    } else if (location.href.indexOf('historic_att_stock') !== -1) {
        pid = 'historicattstock';
        site = 'http://www.att.com';
    } else if (location.href.indexOf('/media-gallery-all.html') !== -1 || location.href.indexOf('/innovationblog') !== -1 || location.href.indexOf('/inside_connections_blog') !== -1 || location.href.indexOf('/mediakits') !== -1) {
      // NEWS LANDING PAGE
          pid = 'news';
          site = 'http://www.att.com';
    } else if (location.href.indexOf('/innovation') !== -1) {
      // COMPANY LANDING PAGE
        pid = 'company';
        site = 'http://www.att.com';
    } else if (location.href.indexOf('https://investors.att.com/') !== -1 )  {
      // INVESTORS LANDING PAGE
        pid = 'investors';
        site = 'http://www.att.com';
    } else if (location.href.indexOf('/sites/values') !== -1 || location.href.indexOf('/csr') !== -1 || location.href.indexOf('/sites/diversity') !== -1 || location.href.indexOf('/sites/it_can_wait') !== -1) {
      // VALUES LANDING PAGE
        pid = 'values';
        site = 'http://www.att.com';
    } else if (location.href.indexOf('/sites/careers') !== -1) {
      // CAREERS LANDING PAGE
        pid = 'careers';
        site = 'http://www.att.com';
    } else {
      // ANYTHING ELSE DEFAULTS TO...
        pid = 'company';
        site = 'http://www.att.com';
    }

    console.log("pid = " + pid);

    /*===============================
        WRITING OUT PRIMARY NAV:
    ===============================*/

    /* Begin Black Nav Header Bar */
    document.write('<div id="headerNav"><div id="menuButton"><button href="#PrimaryNav" title="Toggle Navigation"><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button></div>');

    /* Begin Primary Navigation List */
    document.write('<div id="PrimaryNav-container"><ul role="menubar" id="PrimaryNav">'
                 + '<li role="none" class="logo hidden-phone"><a role="menuitem" aria-label="AT&T" href="https://about.att.com/"><img src="/ui/corpcomm_internet_attus/1.0.0/images/att_logo.png" alt="AT&T logo" /> <div id="headerTitle"> <span> About AT&amp;T </span> </div></a></li>');


  /* COMPANY - PRIMARY */
  document.write('<li role="none" class="first-mobile');
  if (pid == 'company') {
    document.write(' selected');
  }
  document.write('"><a role="menuitem" aria-haspopup="true" href="http://about.att.com/category/all_news.html" aria-label="Company" id="company-home">COMPANY</a>');
  /* Company - Secondary */
  document.write('<ul role="menu" class="secondaryNav" id="company_nav">'
    + '<li role="none"><a role="menuitem" href="https://about.att.com/pages/company_profile" aria-label="AT&T Profile" id="company-profile">AT&amp;T Profile</a></li>'
    + '<li role="none"><a role="menuitem" href="https://investors.att.com/corporate-governance/leadership" aria-label="Leadership Team" id="company-leadership">Leadership Team</a>' );
    // Leadership Tertiary Nav
    + company_leadership_nav();
    document.write('</li>'
    + '<li role="none"><a role="menuitem" href="https://about.att.com/category/att_communications_news" aria-label="AT&T Communications" id="company-communications">AT&T Communications</a>' );
    // Communications Tertiary Nav
    + company_comms_nav();
    document.write('</li>'
    + '<li role="none"><a role="menuitem" href="https://about.att.com/category/warnermedia_news" aria-label="WarnerMedia" id="company-warnermedia">WarnerMedia</a>' );
    // WarnerMedia Tertiary Nav
    + company_warnermedia_nav();
    document.write('</li>'
    + '<li role="none"><a role="menuitem" href="https://about.att.com/category/att_latin_america_news" aria-label="AT&T Latin America" id="company-latin-america" target="_blank">AT&T Latin America</a>' );
    // Latin America Tertiary Nav
    + company_latin_nav();
    document.write('</li>'
    + '<li role="none"><a role="menuitem" href="https://about.att.com/category/xandr_news" aria-label="Xandr" id="company-advertising">Xandr</a>' );
    // Advertising Tertiary Nav
    + company_advertising_nav();
    document.write('</li>'
    + '</ul>');


  /* INVESTORS - PRIMARY */
  document.write('<li role="none"');
  if (pid == '5718' || pid == 'historicattstock' || pid == 'thomson' || thomson !== -1) {
    document.write(' class="selected"');
  }
  document.write('> <a role="menuitem" aria-haspopup="true" id="investors-home" aria-label="Investors" href="https://investors.att.com/">INVESTORS</a>');
  /* Investors - Secondary */
  document.write('<ul role="menu" class="secondaryNav" id="investor_relations_nav">'
    + '<li role="none"><a role="menuitem" href="https://investors.att.com/investor-profile" id="ir_investor_profile_link" aria-label="Investor Profile">Investor Profile</a></li>'
    + '<li role="none"><a role="menuitem" href="https://investors.att.com/news-and-events/events-and-presentations" id="ir_investor_news_link" aria-label="News & Events">News &amp; Events</a></li>'
    + '<li role="none"><a role="menuitem" href="https://investors.att.com/financial-reports/quarterly-earnings" id="ir_financial_reporting_link" aria-label="Financial Reports">Financial Reports</a></li>'
    + '<li role="none"><a role="menuitem" href="https://investors.att.com/stock-information/stock-quote-and-chart" id="ir_stock_info_link" aria-label="Stock Information">Stock Information</a></li>'
    + '<li role="none"><a role="menuitem" href="https://investors.att.com/stockholder-services/cost-basis-guide" id="ir_stockholder_services_link" aria-label="Stockholder Services">Stockholder Services</a></li>'
    + '<li role="none"><a role="menuitem" href="https://investors.att.com/corporate-governance/leadership" id="ir_corporate_governance_link" aria-label="Corporate Governance">Corporate Governance</a></li>'
    + '<li role="none"><a role="menuitem" href="https://investors.att.com/resources/contacts" id="ir_resources_link" aria-label="Resources">Resources</a></li>'
    + '</ul>'
    + '</li>');


  /* VALUES - PRIMARY */
  document.write('<li role="none"');
	if (pid == 'values') {
		document.write(' class="selected"');
	}
  document.write('><a role="menuitem" aria-haspopup="true" href="http://about.att.com/sites/values" aria-label="AT&T Values" id="values-home">VALUES</a>');
  /* Values - Secondary */
	document.write('<ul role="menu" class="secondaryNav" id="values_nav">'
    + '<li role="none"><a role="menuitem" id="values-responsibility" href="https://about.att.com/category/social_responsibility_news" aria-label="Social Responsibility">Social Responsibility</a>' );
    // Social Responsibility Tertiary Nav
    + values_responsibility_nav();
    document.write('</li>'
    + '<li role="none"><a role="menuitem" id="values-diversity" href="http://about.att.com/sites/diversity" aria-label="Diversity & Inclusion">Diversity & Inclusion</a></li>'
    + '</ul>'
    + '</li>');

  /* CAREERS - PRIMARY */
  document.write('<li role="none"');
    if (pid == 'careers') {
        document.write(' class="selected"');
    }
  document.write('><a role="menuitem" aria-haspopup="true" href="https://www.att.jobs/" aria-label="Careers" id="careers-home" target="_blank">CAREERS</a>');
  /* Careers - Secondary */
  document.write('<ul role="menu" class="secondaryNav"></ul>');
  document.write('</li>');


  /* NEWS - PRIMARY */
  document.write('<li role="none"');
	if (pid == 'warnermedia') {
		document.write(' class="selected"');
	}
  document.write('><a role="menuitem" aria-haspopup="true" href="https://about.att.com/allnews.html" aria-label="News" id="news-home">NEWS</a>');
  /* News - Secondary */
	document.write('<ul role="menu" class="secondaryNav" id="news_nav">'
    + '<li role="none"><a role="menuitem" id="news-all" href="https://about.att.com/allnews.html" aria-label="All News">All News</a></li>'
    + '<li role="none"><a role="menuitem" id="news-assets" href="http://about.att.com/media-gallery-all.html" aria-label="Brand Assets">Brand Assets</a></li>'
    + '<li role="none"><a role="menuitem" id="news-contacts" href="https://about.att.com/pages/media_contacts" aria-label="Contacts">Contacts</a></li>'
    + '<li role="none"><a role="menuitem" id="news-blogs" href="#" aria-label="Blogs">Blogs</a>');
    // Blogs Tertiary Nav
    + news_blogs_nav();
    document.write('</li>'
    +'</ul>'
    + '</li>');

   // Fusion Mobile Nav:
   document.write('<li role="none" class="visible-phone"><a role="menuitem" href="http://m.att.com/shopmobile/globalnav/morefromatt.html?referer=aboutUsWeb" id="sm_more_link" aria-label="More from AT&T">More from AT&amp;T</a></li>'
   + '<li id="menuCloseButton" class="visible-phone"><button href="javascript:void(0);" id="sm_close_link" aria-label="Close navigation">X</button></li>'
   + '</ul></div>'
   /* End Primary Navigation List */

   + '<h1 id="mobile-heading" class="visible-phone">About AT&amp;T</h1></div>'
   + '</div>');}

   /* End Black Nav Header Bar */


function renderGNBottom() {
    renderMobileFooter();
    document.write('</div>' + '</div>' + '</div>' + '</div>');// </#content></#content-container></#page></#container>
    renderFooter();
    document.write('</div></div>');// </#inner-wrapper></#wrapper>
}

function renderMobileFooter() {
    document.write('<section id="mobile-footer" class="clearfix">' + '<div class="connect-social clearfix">' + '<p><a href="//www.att.com/gen/press-room?pid=5000" title="AT&amp;T Social Media">Connect with us</a></p>' + '<ul>' + '<li><a href="https://twitter.com/ATT/" target="_blank" title="Twitter"><img src="/ui/corpcomm_internet_attus/1.0.0/images/icon_twitter.png" alt="" /></a></li>' + '<li><a href="http://www.facebook.com/ATT/" target="_blank" title="Facebook"><img src="/ui/corpcomm_internet_attus/1.0.0/images/icon_facebook.png" alt="" /></a></li>' + '<li><a href="http://www.linkedin.com/company/at&t/" target="_blank" title="LinkedIn"><img src="/ui/corpcomm_internet_attus/1.0.0/images/icon_linkedin.png" alt="" /></a></li>' + '<li><a href="https://plus.google.com/+ATT/" target="_blank" title="Google+"><img src="/ui/corpcomm_internet_attus/1.0.0/images/icon_googleplus.png" alt="" /></a></li>' + '</ul>' + '</div>' + '<ul>' + '<li><a href="http://about.att.com/sites/web_policy">Privacy Policy</a></li>' + '<li><a href="https://www.att.com/legal/terms.attWebsiteTermsOfUse.html">Terms of Use</a></li>' + '<li><a href="https://www.att.com/features/accessibility.html">Accessibility</a></li>' + '<li><a href="https://www.att.com/contactus/" class="end">Contact Us</a></li>' + '</ul>'+ '<p class="copyright"><a href="http://www.att.com/gen/privacy-policy?pid=2587">&#169; ' + new Date().getFullYear() +' AT&amp;T Intellectual Property.</a> All rights reserved.</p>' + '<div class="clear"></div></section>');
}

function renderFooter() {
    document.write('<div id="footer">' + '<div class="left">' + '<p class="separator"><a href="http://about.att.com/sites/web_policy">Privacy Policy</a> <a href="https://www.att.com/legal/terms.attWebsiteTermsOfUse.html">Terms of Use</a> <a href="https://www.att.com/features/accessibility.html">Accessibility</a> <a href="https://www.att.com/contactus/" class="end">Contact Us</a></p>' + '<p class="copyright"><a href="http://www.att.com/gen/privacy-policy?pid=2587">&#169; ' + new Date().getFullYear() +' AT&amp;T Intellectual Property.</a> All rights reserved.</p>' + '</div>' + '<div class="clear"></div></div>');
}

function renderThomsonTop() {
    renderGNTop();
}

function renderThomsonBottom() {
    renderGNBottom();
}

jQuery(document).ready(function($) {

    // OFF-CANVAS GLOBAL NAV
    $('html').addClass('js-ready');
    $('#menuButton button').click(function(e) {
        e.preventDefault();
        $('html').toggleClass('js-nav');
    });
    $('#menuCloseButton button').click(function(e) {
        e.preventDefault();
        $('#mobile-heading').focus();
        if($('html').hasClass('js-nav')){
          $('html').removeClass('js-nav');
        }
    });

    if (isMobileCQ == 'true') {
    // OFF-CANVAS MEDIA GALLERY NAV
    if ($('#media-gallery').length > 0) {
        $('html').addClass('js-ready2');
        $('#mobile-media-nav .menuButton button').click(function(e) {
            e.preventDefault();
            $('html').toggleClass('js-nav2');
                return false;
        });
        $('#tab-nav a').click(function(){
            $('html').removeClass('js-nav2');
        });
        }
    }

    $(window).resize(function() {
        var viewWidth = $(window).width();
        var viewHeight = $(window).height();
        var isMobileCQ = 'false';
        if (viewWidth <= '767') {
            var isMobileCQ = 'true';
        }
    });

    /*===============================
        GLOBAL NAV HIGHLIGHTING:
    ===============================*/
    // nav highlighting for CQ landing pages, media kits, microsites
    var $body = $('body');

    /* nav highlighting classes must be applied at the page level in
       the CQ page properties and will always begin with "nav-" */

    // if we find a nav class on the body...
    if($('body[class*="nav-"]').length > 0){
      // ...isolate it from any other classes on the body
      var bodyClasses = $body.attr('class').split(/\s+/);
      var navClass = bodyClasses.filter(function(className){
        return className.indexOf("nav-") !== -1;
      });
      console.log("The nav class is " + navClass);

      /* ...then pass the nav class into a function that will parse it
      and apply the appropriate dual-level nav highlighting */
      highlightNav(navClass);
    }

    function highlightNav(navClass){
      var navClass = navClass.toString();
      var primary = navClass.split('-')[1];
      var secondary = navClass.split('nav-')[1];
      console.log("primary nav item is " + primary);
      console.log("secondary nav item is " + secondary);

      if(!primary && !secondary) {
        return;
      } else {
        // highlight the appropriate primary nav item (override any existing nav highlight)
        if(primary && $('#' + primary + '-home').length > 0){
          $("#PrimaryNav > li.selected").removeClass("selected");
          $('#' + primary + '-home').parent().addClass('selected');
        }

        // highlight the appropriate secondary nav item
        if(secondary && secondary !== primary && $('#' + secondary + '').length > 0){
          $('#' + secondary + '').parent().addClass('selected');
        }
      }
    }

    // highlights for Innovation microsites
    if(pid === "company"){
      if(location.href.indexOf('/innovation') !== -1 || location.href.indexOf('/sites/entertainment') !== -1 || location.href.indexOf('/sites/sponsorships') !== -1){
        highlightNav('nav-company-communications');
      }
    }

    // highlights for Innovation Blog and Inside Connections Blog pages
    if (pid === 'news') {
      if(location.href.indexOf('/innovationblog') !== -1 || location.href.indexOf('/inside_connections_blog') !== -1){
        highlightNav('nav-news-blogs');
      } else if(location.href.indexOf('/media-gallery-all.html') !== -1 ){
        highlightNav('nav-news-assets');
      }
    }

    // highlights for CSR pages
    if (pid === 'values' && location.href.indexOf('/csr') !== -1 || location.href.indexOf('/sites/it_can_wait') !== -1){
      highlightNav('nav-values-responsibility');
    }
});
