/*! For license information please see 3384.dba7027d.min.js.LICENSE.txt */
(this["webpackChunkapplication"]=this["webpackChunkapplication"]||[]).push([[3384],{401727:function(e,t,r){e=r.nmd(e);(function(e,r){true?r(t):0})(this,(function(t){"use strict";function slice(e,t){t=t|0;var r=Math.max(e.length-t,0);var i=Array(r);for(var n=0;n<r;n++){i[n]=e[t+n]}return i}var apply=function(e){var t=slice(arguments,1);return function(){var r=slice(arguments);return e.apply(null,t.concat(r))}};var initialParams=function(e){return function(){var t=slice(arguments);var r=t.pop();e.call(this,t,r)}};function isObject(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var i=typeof setImmediate==="function"&&setImmediate;var n=typeof process==="object"&&typeof process.nextTick==="function";function fallback(e){setTimeout(e,0)}function wrap(e){return function(t){var r=slice(arguments,1);e((function(){t.apply(null,r)}))}}var a;if(i){a=setImmediate}else if(n){a=process.nextTick}else{a=fallback}var s=wrap(a);function asyncify(e){return initialParams((function(t,r){var i;try{i=e.apply(this,t)}catch(e){return r(e)}if(isObject(i)&&typeof i.then==="function"){i.then((function(e){invokeCallback(r,null,e)}),(function(e){invokeCallback(r,e.message?e:new Error(e))}))}else{r(null,i)}}))}function invokeCallback(e,t,r){try{e(t,r)}catch(e){s(rethrow,e)}}function rethrow(e){throw e}var o=typeof Symbol==="function";function isAsync(e){return o&&e[Symbol.toStringTag]==="AsyncFunction"}function wrapAsync(e){return isAsync(e)?asyncify(e):e}function applyEach$1(e){return function(t){var r=slice(arguments,1);var i=initialParams((function(r,i){var n=this;return e(t,(function(e,t){wrapAsync(e).apply(n,r.concat(t))}),i)}));if(r.length){return i.apply(this,r)}else{return i}}}var u=typeof r.g=="object"&&r.g&&r.g.Object===Object&&r.g;var c=typeof self=="object"&&self&&self.Object===Object&&self;var l=u||c||Function("return this")();var f=l.Symbol;var p=Object.prototype;var d=p.hasOwnProperty;var h=p.toString;var g=f?f.toStringTag:undefined;function getRawTag(e){var t=d.call(e,g),r=e[g];try{e[g]=undefined;var i=true}catch(e){}var n=h.call(e);if(i){if(t){e[g]=r}else{delete e[g]}}return n}var v=Object.prototype;var m=v.toString;function objectToString(e){return m.call(e)}var y="[object Null]";var S="[object Undefined]";var T=f?f.toStringTag:undefined;function baseGetTag(e){if(e==null){return e===undefined?S:y}return T&&T in Object(e)?getRawTag(e):objectToString(e)}var b="[object AsyncFunction]";var _="[object Function]";var C="[object GeneratorFunction]";var A="[object Proxy]";function isFunction(e){if(!isObject(e)){return false}var t=baseGetTag(e);return t==_||t==C||t==b||t==A}var E=9007199254740991;function isLength(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=E}function isArrayLike(e){return e!=null&&isLength(e.length)&&!isFunction(e)}var I={};function noop(){}function once(e){return function(){if(e===null)return;var t=e;e=null;t.apply(this,arguments)}}var R=typeof Symbol==="function"&&Symbol.iterator;var getIterator=function(e){return R&&e[R]&&e[R]()};function baseTimes(e,t){var r=-1,i=Array(e);while(++r<e){i[r]=t(r)}return i}function isObjectLike(e){return e!=null&&typeof e=="object"}var w="[object Arguments]";function baseIsArguments(e){return isObjectLike(e)&&baseGetTag(e)==w}var $=Object.prototype;var x=$.hasOwnProperty;var O=$.propertyIsEnumerable;var D=baseIsArguments(function(){return arguments}())?baseIsArguments:function(e){return isObjectLike(e)&&x.call(e,"callee")&&!O.call(e,"callee")};var k=Array.isArray;function stubFalse(){return false}var N=typeof t=="object"&&t&&!t.nodeType&&t;var U=N&&"object"=="object"&&e&&!e.nodeType&&e;var L=U&&U.exports===N;var P=L?l.Buffer:undefined;var M=P?P.isBuffer:undefined;var H=M||stubFalse;var q=9007199254740991;var j=/^(?:0|[1-9]\d*)$/;function isIndex(e,t){var r=typeof e;t=t==null?q:t;return!!t&&(r=="number"||r!="symbol"&&j.test(e))&&(e>-1&&e%1==0&&e<t)}var F="[object Arguments]";var B="[object Array]";var W="[object Boolean]";var G="[object Date]";var z="[object Error]";var K="[object Function]";var V="[object Map]";var Y="[object Number]";var Q="[object Object]";var J="[object RegExp]";var X="[object Set]";var Z="[object String]";var ee="[object WeakMap]";var te="[object ArrayBuffer]";var re="[object DataView]";var ie="[object Float32Array]";var ne="[object Float64Array]";var ae="[object Int8Array]";var se="[object Int16Array]";var oe="[object Int32Array]";var ue="[object Uint8Array]";var ce="[object Uint8ClampedArray]";var le="[object Uint16Array]";var fe="[object Uint32Array]";var pe={};pe[ie]=pe[ne]=pe[ae]=pe[se]=pe[oe]=pe[ue]=pe[ce]=pe[le]=pe[fe]=true;pe[F]=pe[B]=pe[te]=pe[W]=pe[re]=pe[G]=pe[z]=pe[K]=pe[V]=pe[Y]=pe[Q]=pe[J]=pe[X]=pe[Z]=pe[ee]=false;function baseIsTypedArray(e){return isObjectLike(e)&&isLength(e.length)&&!!pe[baseGetTag(e)]}function baseUnary(e){return function(t){return e(t)}}var de=typeof t=="object"&&t&&!t.nodeType&&t;var he=de&&"object"=="object"&&e&&!e.nodeType&&e;var ge=he&&he.exports===de;var ve=ge&&u.process;var me=function(){try{var e=he&&he.require&&he.require("util").types;if(e){return e}return ve&&ve.binding&&ve.binding("util")}catch(e){}}();var ye=me&&me.isTypedArray;var Se=ye?baseUnary(ye):baseIsTypedArray;var Te=Object.prototype;var be=Te.hasOwnProperty;function arrayLikeKeys(e,t){var r=k(e),i=!r&&D(e),n=!r&&!i&&H(e),a=!r&&!i&&!n&&Se(e),s=r||i||n||a,o=s?baseTimes(e.length,String):[],u=o.length;for(var c in e){if((t||be.call(e,c))&&!(s&&(c=="length"||n&&(c=="offset"||c=="parent")||a&&(c=="buffer"||c=="byteLength"||c=="byteOffset")||isIndex(c,u)))){o.push(c)}}return o}var _e=Object.prototype;function isPrototype(e){var t=e&&e.constructor,r=typeof t=="function"&&t.prototype||_e;return e===r}function overArg(e,t){return function(r){return e(t(r))}}var Ce=overArg(Object.keys,Object);var Ae=Object.prototype;var Ee=Ae.hasOwnProperty;function baseKeys(e){if(!isPrototype(e)){return Ce(e)}var t=[];for(var r in Object(e)){if(Ee.call(e,r)&&r!="constructor"){t.push(r)}}return t}function keys(e){return isArrayLike(e)?arrayLikeKeys(e):baseKeys(e)}function createArrayIterator(e){var t=-1;var r=e.length;return function next(){return++t<r?{value:e[t],key:t}:null}}function createES2015Iterator(e){var t=-1;return function next(){var r=e.next();if(r.done)return null;t++;return{value:r.value,key:t}}}function createObjectIterator(e){var t=keys(e);var r=-1;var i=t.length;return function next(){var n=t[++r];return r<i?{value:e[n],key:n}:null}}function iterator(e){if(isArrayLike(e)){return createArrayIterator(e)}var t=getIterator(e);return t?createES2015Iterator(t):createObjectIterator(e)}function onlyOnce(e){return function(){if(e===null)throw new Error("Callback was already called.");var t=e;e=null;t.apply(this,arguments)}}function _eachOfLimit(e){return function(t,r,i){i=once(i||noop);if(e<=0||!t){return i(null)}var n=iterator(t);var a=false;var s=0;var o=false;function iterateeCallback(e,t){s-=1;if(e){a=true;i(e)}else if(t===I||a&&s<=0){a=true;return i(null)}else if(!o){replenish()}}function replenish(){o=true;while(s<e&&!a){var t=n();if(t===null){a=true;if(s<=0){i(null)}return}s+=1;r(t.value,t.key,onlyOnce(iterateeCallback))}o=false}replenish()}}function eachOfLimit(e,t,r,i){_eachOfLimit(t)(e,wrapAsync(r),i)}function doLimit(e,t){return function(r,i,n){return e(r,t,i,n)}}function eachOfArrayLike(e,t,r){r=once(r||noop);var i=0,n=0,a=e.length;if(a===0){r(null)}function iteratorCallback(e,t){if(e){r(e)}else if(++n===a||t===I){r(null)}}for(;i<a;i++){t(e[i],i,onlyOnce(iteratorCallback))}}var Ie=doLimit(eachOfLimit,Infinity);var eachOf=function(e,t,r){var i=isArrayLike(e)?eachOfArrayLike:Ie;i(e,wrapAsync(t),r)};function doParallel(e){return function(t,r,i){return e(eachOf,t,wrapAsync(r),i)}}function _asyncMap(e,t,r,i){i=i||noop;t=t||[];var n=[];var a=0;var s=wrapAsync(r);e(t,(function(e,t,r){var i=a++;s(e,(function(e,t){n[i]=t;r(e)}))}),(function(e){i(e,n)}))}var Re=doParallel(_asyncMap);var we=applyEach$1(Re);function doParallelLimit(e){return function(t,r,i,n){return e(_eachOfLimit(r),t,wrapAsync(i),n)}}var $e=doParallelLimit(_asyncMap);var xe=doLimit($e,1);var Oe=applyEach$1(xe);function arrayEach(e,t){var r=-1,i=e==null?0:e.length;while(++r<i){if(t(e[r],r,e)===false){break}}return e}function createBaseFor(e){return function(t,r,i){var n=-1,a=Object(t),s=i(t),o=s.length;while(o--){var u=s[e?o:++n];if(r(a[u],u,a)===false){break}}return t}}var De=createBaseFor();function baseForOwn(e,t){return e&&De(e,t,keys)}function baseFindIndex(e,t,r,i){var n=e.length,a=r+(i?1:-1);while(i?a--:++a<n){if(t(e[a],a,e)){return a}}return-1}function baseIsNaN(e){return e!==e}function strictIndexOf(e,t,r){var i=r-1,n=e.length;while(++i<n){if(e[i]===t){return i}}return-1}function baseIndexOf(e,t,r){return t===t?strictIndexOf(e,t,r):baseFindIndex(e,baseIsNaN,r)}var auto=function(e,t,r){if(typeof t==="function"){r=t;t=null}r=once(r||noop);var i=keys(e);var n=i.length;if(!n){return r(null)}if(!t){t=n}var a={};var s=0;var o=false;var u=Object.create(null);var c=[];var l=[];var f={};baseForOwn(e,(function(t,r){if(!k(t)){enqueueTask(r,[t]);l.push(r);return}var i=t.slice(0,t.length-1);var n=i.length;if(n===0){enqueueTask(r,t);l.push(r);return}f[r]=n;arrayEach(i,(function(a){if(!e[a]){throw new Error("async.auto task `"+r+"` has a non-existent dependency `"+a+"` in "+i.join(", "))}addListener(a,(function(){n--;if(n===0){enqueueTask(r,t)}}))}))}));checkForDeadlocks();processQueue();function enqueueTask(e,t){c.push((function(){runTask(e,t)}))}function processQueue(){if(c.length===0&&s===0){return r(null,a)}while(c.length&&s<t){var e=c.shift();e()}}function addListener(e,t){var r=u[e];if(!r){r=u[e]=[]}r.push(t)}function taskComplete(e){var t=u[e]||[];arrayEach(t,(function(e){e()}));processQueue()}function runTask(e,t){if(o)return;var i=onlyOnce((function(t,i){s--;if(arguments.length>2){i=slice(arguments,1)}if(t){var n={};baseForOwn(a,(function(e,t){n[t]=e}));n[e]=i;o=true;u=Object.create(null);r(t,n)}else{a[e]=i;taskComplete(e)}}));s++;var n=wrapAsync(t[t.length-1]);if(t.length>1){n(a,i)}else{n(i)}}function checkForDeadlocks(){var e;var t=0;while(l.length){e=l.pop();t++;arrayEach(getDependents(e),(function(e){if(--f[e]===0){l.push(e)}}))}if(t!==n){throw new Error("async.auto cannot execute tasks due to a recursive dependency")}}function getDependents(t){var r=[];baseForOwn(e,(function(e,i){if(k(e)&&baseIndexOf(e,t,0)>=0){r.push(i)}}));return r}};function arrayMap(e,t){var r=-1,i=e==null?0:e.length,n=Array(i);while(++r<i){n[r]=t(e[r],r,e)}return n}var ke="[object Symbol]";function isSymbol(e){return typeof e=="symbol"||isObjectLike(e)&&baseGetTag(e)==ke}var Ne=1/0;var Ue=f?f.prototype:undefined;var Le=Ue?Ue.toString:undefined;function baseToString(e){if(typeof e=="string"){return e}if(k(e)){return arrayMap(e,baseToString)+""}if(isSymbol(e)){return Le?Le.call(e):""}var t=e+"";return t=="0"&&1/e==-Ne?"-0":t}function baseSlice(e,t,r){var i=-1,n=e.length;if(t<0){t=-t>n?0:n+t}r=r>n?n:r;if(r<0){r+=n}n=t>r?0:r-t>>>0;t>>>=0;var a=Array(n);while(++i<n){a[i]=e[i+t]}return a}function castSlice(e,t,r){var i=e.length;r=r===undefined?i:r;return!t&&r>=i?e:baseSlice(e,t,r)}function charsEndIndex(e,t){var r=e.length;while(r--&&baseIndexOf(t,e[r],0)>-1){}return r}function charsStartIndex(e,t){var r=-1,i=e.length;while(++r<i&&baseIndexOf(t,e[r],0)>-1){}return r}function asciiToArray(e){return e.split("")}var Pe="\\ud800-\\udfff";var Me="\\u0300-\\u036f";var He="\\ufe20-\\ufe2f";var qe="\\u20d0-\\u20ff";var je=Me+He+qe;var Fe="\\ufe0e\\ufe0f";var Be="\\u200d";var We=RegExp("["+Be+Pe+je+Fe+"]");function hasUnicode(e){return We.test(e)}var Ge="\\ud800-\\udfff";var ze="\\u0300-\\u036f";var Ke="\\ufe20-\\ufe2f";var Ve="\\u20d0-\\u20ff";var Ye=ze+Ke+Ve;var Qe="\\ufe0e\\ufe0f";var Je="["+Ge+"]";var Xe="["+Ye+"]";var Ze="\\ud83c[\\udffb-\\udfff]";var et="(?:"+Xe+"|"+Ze+")";var tt="[^"+Ge+"]";var rt="(?:\\ud83c[\\udde6-\\uddff]){2}";var it="[\\ud800-\\udbff][\\udc00-\\udfff]";var nt="\\u200d";var at=et+"?";var st="["+Qe+"]?";var ot="(?:"+nt+"(?:"+[tt,rt,it].join("|")+")"+st+at+")*";var ut=st+at+ot;var ct="(?:"+[tt+Xe+"?",Xe,rt,it,Je].join("|")+")";var lt=RegExp(Ze+"(?="+Ze+")|"+ct+ut,"g");function unicodeToArray(e){return e.match(lt)||[]}function stringToArray(e){return hasUnicode(e)?unicodeToArray(e):asciiToArray(e)}function toString(e){return e==null?"":baseToString(e)}var ft=/^\s+|\s+$/g;function trim(e,t,r){e=toString(e);if(e&&(r||t===undefined)){return e.replace(ft,"")}if(!e||!(t=baseToString(t))){return e}var i=stringToArray(e),n=stringToArray(t),a=charsStartIndex(i,n),s=charsEndIndex(i,n)+1;return castSlice(i,a,s).join("")}var pt=/^(?:async\s+)?(function)?\s*[^\(]*\(\s*([^\)]*)\)/m;var dt=/,/;var ht=/(=.+)?(\s*)$/;var gt=/((\/\/.*$)|(\/\*[\s\S]*?\*\/))/gm;function parseParams(e){e=e.toString().replace(gt,"");e=e.match(pt)[2].replace(" ","");e=e?e.split(dt):[];e=e.map((function(e){return trim(e.replace(ht,""))}));return e}function autoInject(e,t){var r={};baseForOwn(e,(function(e,t){var i;var n=isAsync(e);var a=!n&&e.length===1||n&&e.length===0;if(k(e)){i=e.slice(0,-1);e=e[e.length-1];r[t]=i.concat(i.length>0?newTask:e)}else if(a){r[t]=e}else{i=parseParams(e);if(e.length===0&&!n&&i.length===0){throw new Error("autoInject task functions require explicit parameters.")}if(!n)i.pop();r[t]=i.concat(newTask)}function newTask(t,r){var n=arrayMap(i,(function(e){return t[e]}));n.push(r);wrapAsync(e).apply(null,n)}}));auto(r,t)}function DLL(){this.head=this.tail=null;this.length=0}function setInitial(e,t){e.length=1;e.head=e.tail=t}DLL.prototype.removeLink=function(e){if(e.prev)e.prev.next=e.next;else this.head=e.next;if(e.next)e.next.prev=e.prev;else this.tail=e.prev;e.prev=e.next=null;this.length-=1;return e};DLL.prototype.empty=function(){while(this.head)this.shift();return this};DLL.prototype.insertAfter=function(e,t){t.prev=e;t.next=e.next;if(e.next)e.next.prev=t;else this.tail=t;e.next=t;this.length+=1};DLL.prototype.insertBefore=function(e,t){t.prev=e.prev;t.next=e;if(e.prev)e.prev.next=t;else this.head=t;e.prev=t;this.length+=1};DLL.prototype.unshift=function(e){if(this.head)this.insertBefore(this.head,e);else setInitial(this,e)};DLL.prototype.push=function(e){if(this.tail)this.insertAfter(this.tail,e);else setInitial(this,e)};DLL.prototype.shift=function(){return this.head&&this.removeLink(this.head)};DLL.prototype.pop=function(){return this.tail&&this.removeLink(this.tail)};DLL.prototype.toArray=function(){var e=Array(this.length);var t=this.head;for(var r=0;r<this.length;r++){e[r]=t.data;t=t.next}return e};DLL.prototype.remove=function(e){var t=this.head;while(!!t){var r=t.next;if(e(t)){this.removeLink(t)}t=r}return this};function queue(e,t,r){if(t==null){t=1}else if(t===0){throw new Error("Concurrency must not be zero")}var i=wrapAsync(e);var n=0;var a=[];var o=false;function _insert(e,t,r){if(r!=null&&typeof r!=="function"){throw new Error("task callback must be a function")}c.started=true;if(!k(e)){e=[e]}if(e.length===0&&c.idle()){return s((function(){c.drain()}))}for(var i=0,n=e.length;i<n;i++){var a={data:e[i],callback:r||noop};if(t){c._tasks.unshift(a)}else{c._tasks.push(a)}}if(!o){o=true;s((function(){o=false;c.process()}))}}function _next(e){return function(t){n-=1;for(var r=0,i=e.length;r<i;r++){var s=e[r];var o=baseIndexOf(a,s,0);if(o===0){a.shift()}else if(o>0){a.splice(o,1)}s.callback.apply(s,arguments);if(t!=null){c.error(t,s.data)}}if(n<=c.concurrency-c.buffer){c.unsaturated()}if(c.idle()){c.drain()}c.process()}}var u=false;var c={_tasks:new DLL,concurrency:t,payload:r,saturated:noop,unsaturated:noop,buffer:t/4,empty:noop,drain:noop,error:noop,started:false,paused:false,push:function(e,t){_insert(e,false,t)},kill:function(){c.drain=noop;c._tasks.empty()},unshift:function(e,t){_insert(e,true,t)},remove:function(e){c._tasks.remove(e)},process:function(){if(u){return}u=true;while(!c.paused&&n<c.concurrency&&c._tasks.length){var e=[],t=[];var r=c._tasks.length;if(c.payload)r=Math.min(r,c.payload);for(var s=0;s<r;s++){var o=c._tasks.shift();e.push(o);a.push(o);t.push(o.data)}n+=1;if(c._tasks.length===0){c.empty()}if(n===c.concurrency){c.saturated()}var l=onlyOnce(_next(e));i(t,l)}u=false},length:function(){return c._tasks.length},running:function(){return n},workersList:function(){return a},idle:function(){return c._tasks.length+n===0},pause:function(){c.paused=true},resume:function(){if(c.paused===false){return}c.paused=false;s(c.process)}};return c}function cargo(e,t){return queue(e,1,t)}var vt=doLimit(eachOfLimit,1);function reduce(e,t,r,i){i=once(i||noop);var n=wrapAsync(r);vt(e,(function(e,r,i){n(t,e,(function(e,r){t=r;i(e)}))}),(function(e){i(e,t)}))}function seq(){var e=arrayMap(arguments,wrapAsync);return function(){var t=slice(arguments);var r=this;var i=t[t.length-1];if(typeof i=="function"){t.pop()}else{i=noop}reduce(e,t,(function(e,t,i){t.apply(r,e.concat((function(e){var t=slice(arguments,1);i(e,t)})))}),(function(e,t){i.apply(r,[e].concat(t))}))}}var compose=function(){return seq.apply(null,slice(arguments).reverse())};var mt=Array.prototype.concat;var concatLimit=function(e,t,r,i){i=i||noop;var n=wrapAsync(r);$e(e,t,(function(e,t){n(e,(function(e){if(e)return t(e);return t(null,slice(arguments,1))}))}),(function(e,t){var r=[];for(var n=0;n<t.length;n++){if(t[n]){r=mt.apply(r,t[n])}}return i(e,r)}))};var yt=doLimit(concatLimit,Infinity);var St=doLimit(concatLimit,1);var constant=function(){var e=slice(arguments);var t=[null].concat(e);return function(){var e=arguments[arguments.length-1];return e.apply(this,t)}};function identity(e){return e}function _createTester(e,t){return function(r,i,n,a){a=a||noop;var s=false;var o;r(i,(function(r,i,a){n(r,(function(i,n){if(i){a(i)}else if(e(n)&&!o){s=true;o=t(true,r);a(null,I)}else{a()}}))}),(function(e){if(e){a(e)}else{a(null,s?o:t(false))}}))}}function _findGetResult(e,t){return t}var Tt=doParallel(_createTester(identity,_findGetResult));var bt=doParallelLimit(_createTester(identity,_findGetResult));var _t=doLimit(bt,1);function consoleFunc(e){return function(t){var r=slice(arguments,1);r.push((function(t){var r=slice(arguments,1);if(typeof console==="object"){if(t){if(console.error){console.error(t)}}else if(console[e]){arrayEach(r,(function(t){console[e](t)}))}}}));wrapAsync(t).apply(null,r)}}var Ct=consoleFunc("dir");function doDuring(e,t,r){r=onlyOnce(r||noop);var i=wrapAsync(e);var n=wrapAsync(t);function next(e){if(e)return r(e);var t=slice(arguments,1);t.push(check);n.apply(this,t)}function check(e,t){if(e)return r(e);if(!t)return r(null);i(next)}check(null,true)}function doWhilst(e,t,r){r=onlyOnce(r||noop);var i=wrapAsync(e);var next=function(e){if(e)return r(e);var n=slice(arguments,1);if(t.apply(this,n))return i(next);r.apply(null,[null].concat(n))};i(next)}function doUntil(e,t,r){doWhilst(e,(function(){return!t.apply(this,arguments)}),r)}function during(e,t,r){r=onlyOnce(r||noop);var i=wrapAsync(t);var n=wrapAsync(e);function next(e){if(e)return r(e);n(check)}function check(e,t){if(e)return r(e);if(!t)return r(null);i(next)}n(check)}function _withoutIndex(e){return function(t,r,i){return e(t,i)}}function eachLimit(e,t,r){eachOf(e,_withoutIndex(wrapAsync(t)),r)}function eachLimit$1(e,t,r,i){_eachOfLimit(t)(e,_withoutIndex(wrapAsync(r)),i)}var At=doLimit(eachLimit$1,1);function ensureAsync(e){if(isAsync(e))return e;return initialParams((function(t,r){var i=true;t.push((function(){var e=arguments;if(i){s((function(){r.apply(null,e)}))}else{r.apply(null,e)}}));e.apply(this,t);i=false}))}function notId(e){return!e}var Et=doParallel(_createTester(notId,notId));var It=doParallelLimit(_createTester(notId,notId));var Rt=doLimit(It,1);function baseProperty(e){return function(t){return t==null?undefined:t[e]}}function filterArray(e,t,r,i){var n=new Array(t.length);e(t,(function(e,t,i){r(e,(function(e,r){n[t]=!!r;i(e)}))}),(function(e){if(e)return i(e);var r=[];for(var a=0;a<t.length;a++){if(n[a])r.push(t[a])}i(null,r)}))}function filterGeneric(e,t,r,i){var n=[];e(t,(function(e,t,i){r(e,(function(r,a){if(r){i(r)}else{if(a){n.push({index:t,value:e})}i()}}))}),(function(e){if(e){i(e)}else{i(null,arrayMap(n.sort((function(e,t){return e.index-t.index})),baseProperty("value")))}}))}function _filter(e,t,r,i){var n=isArrayLike(t)?filterArray:filterGeneric;n(e,t,wrapAsync(r),i||noop)}var wt=doParallel(_filter);var $t=doParallelLimit(_filter);var xt=doLimit($t,1);function forever(e,t){var r=onlyOnce(t||noop);var i=wrapAsync(ensureAsync(e));function next(e){if(e)return r(e);i(next)}next()}var groupByLimit=function(e,t,r,i){i=i||noop;var n=wrapAsync(r);$e(e,t,(function(e,t){n(e,(function(r,i){if(r)return t(r);return t(null,{key:i,val:e})}))}),(function(e,t){var r={};var n=Object.prototype.hasOwnProperty;for(var a=0;a<t.length;a++){if(t[a]){var s=t[a].key;var o=t[a].val;if(n.call(r,s)){r[s].push(o)}else{r[s]=[o]}}}return i(e,r)}))};var Ot=doLimit(groupByLimit,Infinity);var Dt=doLimit(groupByLimit,1);var kt=consoleFunc("log");function mapValuesLimit(e,t,r,i){i=once(i||noop);var n={};var a=wrapAsync(r);eachOfLimit(e,t,(function(e,t,r){a(e,t,(function(e,i){if(e)return r(e);n[t]=i;r()}))}),(function(e){i(e,n)}))}var Nt=doLimit(mapValuesLimit,Infinity);var Ut=doLimit(mapValuesLimit,1);function has(e,t){return t in e}function memoize(e,t){var r=Object.create(null);var i=Object.create(null);t=t||identity;var n=wrapAsync(e);var a=initialParams((function memoized(e,a){var o=t.apply(null,e);if(has(r,o)){s((function(){a.apply(null,r[o])}))}else if(has(i,o)){i[o].push(a)}else{i[o]=[a];n.apply(null,e.concat((function(){var e=slice(arguments);r[o]=e;var t=i[o];delete i[o];for(var n=0,a=t.length;n<a;n++){t[n].apply(null,e)}})))}}));a.memo=r;a.unmemoized=e;return a}var Lt;if(n){Lt=process.nextTick}else if(i){Lt=setImmediate}else{Lt=fallback}var Pt=wrap(Lt);function _parallel(e,t,r){r=r||noop;var i=isArrayLike(t)?[]:{};e(t,(function(e,t,r){wrapAsync(e)((function(e,n){if(arguments.length>2){n=slice(arguments,1)}i[t]=n;r(e)}))}),(function(e){r(e,i)}))}function parallelLimit(e,t){_parallel(eachOf,e,t)}function parallelLimit$1(e,t,r){_parallel(_eachOfLimit(t),e,r)}var queue$1=function(e,t){var r=wrapAsync(e);return queue((function(e,t){r(e[0],t)}),t,1)};var priorityQueue=function(e,t){var r=queue$1(e,t);r.push=function(e,t,i){if(i==null)i=noop;if(typeof i!=="function"){throw new Error("task callback must be a function")}r.started=true;if(!k(e)){e=[e]}if(e.length===0){return s((function(){r.drain()}))}t=t||0;var n=r._tasks.head;while(n&&t>=n.priority){n=n.next}for(var a=0,o=e.length;a<o;a++){var u={data:e[a],priority:t,callback:i};if(n){r._tasks.insertBefore(n,u)}else{r._tasks.push(u)}}s(r.process)};delete r.unshift;return r};function race(e,t){t=once(t||noop);if(!k(e))return t(new TypeError("First argument to race must be an array of functions"));if(!e.length)return t();for(var r=0,i=e.length;r<i;r++){wrapAsync(e[r])(t)}}function reduceRight(e,t,r,i){var n=slice(e).reverse();reduce(n,t,r,i)}function reflect(e){var t=wrapAsync(e);return initialParams((function reflectOn(e,r){e.push((function callback(e,t){if(e){r(null,{error:e})}else{var i;if(arguments.length<=2){i=t}else{i=slice(arguments,1)}r(null,{value:i})}}));return t.apply(this,e)}))}function reflectAll(e){var t;if(k(e)){t=arrayMap(e,reflect)}else{t={};baseForOwn(e,(function(e,r){t[r]=reflect.call(this,e)}))}return t}function reject$1(e,t,r,i){_filter(e,t,(function(e,t){r(e,(function(e,r){t(e,!r)}))}),i)}var Mt=doParallel(reject$1);var Ht=doParallelLimit(reject$1);var qt=doLimit(Ht,1);function constant$1(e){return function(){return e}}function retry(e,t,r){var i=5;var n=0;var a={times:i,intervalFunc:constant$1(n)};function parseTimes(e,t){if(typeof t==="object"){e.times=+t.times||i;e.intervalFunc=typeof t.interval==="function"?t.interval:constant$1(+t.interval||n);e.errorFilter=t.errorFilter}else if(typeof t==="number"||typeof t==="string"){e.times=+t||i}else{throw new Error("Invalid arguments for async.retry")}}if(arguments.length<3&&typeof e==="function"){r=t||noop;t=e}else{parseTimes(a,e);r=r||noop}if(typeof t!=="function"){throw new Error("Invalid arguments for async.retry")}var s=wrapAsync(t);var o=1;function retryAttempt(){s((function(e){if(e&&o++<a.times&&(typeof a.errorFilter!="function"||a.errorFilter(e))){setTimeout(retryAttempt,a.intervalFunc(o))}else{r.apply(null,arguments)}}))}retryAttempt()}var retryable=function(e,t){if(!t){t=e;e=null}var r=wrapAsync(t);return initialParams((function(t,i){function taskFn(e){r.apply(null,t.concat(e))}if(e)retry(e,taskFn,i);else retry(taskFn,i)}))};function series(e,t){_parallel(vt,e,t)}var jt=doParallel(_createTester(Boolean,identity));var Ft=doParallelLimit(_createTester(Boolean,identity));var Bt=doLimit(Ft,1);function sortBy(e,t,r){var i=wrapAsync(t);Re(e,(function(e,t){i(e,(function(r,i){if(r)return t(r);t(null,{value:e,criteria:i})}))}),(function(e,t){if(e)return r(e);r(null,arrayMap(t.sort(comparator),baseProperty("value")))}));function comparator(e,t){var r=e.criteria,i=t.criteria;return r<i?-1:r>i?1:0}}function timeout(e,t,r){var i=wrapAsync(e);return initialParams((function(n,a){var s=false;var o;function timeoutCallback(){var t=e.name||"anonymous";var i=new Error('Callback function "'+t+'" timed out.');i.code="ETIMEDOUT";if(r){i.info=r}s=true;a(i)}n.push((function(){if(!s){a.apply(null,arguments);clearTimeout(o)}}));o=setTimeout(timeoutCallback,t);i.apply(null,n)}))}var Wt=Math.ceil;var Gt=Math.max;function baseRange(e,t,r,i){var n=-1,a=Gt(Wt((t-e)/(r||1)),0),s=Array(a);while(a--){s[i?a:++n]=e;e+=r}return s}function timeLimit(e,t,r,i){var n=wrapAsync(r);$e(baseRange(0,e,1),t,n,i)}var zt=doLimit(timeLimit,Infinity);var Kt=doLimit(timeLimit,1);function transform(e,t,r,i){if(arguments.length<=3){i=r;r=t;t=k(e)?[]:{}}i=once(i||noop);var n=wrapAsync(r);eachOf(e,(function(e,r,i){n(t,e,r,i)}),(function(e){i(e,t)}))}function tryEach(e,t){var r=null;var i;t=t||noop;At(e,(function(e,t){wrapAsync(e)((function(e,n){if(arguments.length>2){i=slice(arguments,1)}else{i=n}r=e;t(!e)}))}),(function(){t(r,i)}))}function unmemoize(e){return function(){return(e.unmemoized||e).apply(null,arguments)}}function whilst(e,t,r){r=onlyOnce(r||noop);var i=wrapAsync(t);if(!e())return r(null);var next=function(t){if(t)return r(t);if(e())return i(next);var n=slice(arguments,1);r.apply(null,[null].concat(n))};i(next)}function until(e,t,r){whilst((function(){return!e.apply(this,arguments)}),t,r)}var waterfall=function(e,t){t=once(t||noop);if(!k(e))return t(new Error("First argument to waterfall must be an array of functions"));if(!e.length)return t();var r=0;function nextTask(t){var i=wrapAsync(e[r++]);t.push(onlyOnce(next));i.apply(null,t)}function next(i){if(i||r===e.length){return t.apply(null,arguments)}nextTask(slice(arguments,1))}nextTask([])};var Vt={apply,applyEach:we,applyEachSeries:Oe,asyncify,auto,autoInject,cargo,compose,concat:yt,concatLimit,concatSeries:St,constant,detect:Tt,detectLimit:bt,detectSeries:_t,dir:Ct,doDuring,doUntil,doWhilst,during,each:eachLimit,eachLimit:eachLimit$1,eachOf,eachOfLimit,eachOfSeries:vt,eachSeries:At,ensureAsync,every:Et,everyLimit:It,everySeries:Rt,filter:wt,filterLimit:$t,filterSeries:xt,forever,groupBy:Ot,groupByLimit,groupBySeries:Dt,log:kt,map:Re,mapLimit:$e,mapSeries:xe,mapValues:Nt,mapValuesLimit,mapValuesSeries:Ut,memoize,nextTick:Pt,parallel:parallelLimit,parallelLimit:parallelLimit$1,priorityQueue,queue:queue$1,race,reduce,reduceRight,reflect,reflectAll,reject:Mt,rejectLimit:Ht,rejectSeries:qt,retry,retryable,seq,series,setImmediate:s,some:jt,someLimit:Ft,someSeries:Bt,sortBy,timeout,times:zt,timesLimit:timeLimit,timesSeries:Kt,transform,tryEach,unmemoize,until,waterfall,whilst,all:Et,allLimit:It,allSeries:Rt,any:jt,anyLimit:Ft,anySeries:Bt,find:Tt,findLimit:bt,findSeries:_t,forEach:eachLimit,forEachSeries:At,forEachLimit:eachLimit$1,forEachOf:eachOf,forEachOfSeries:vt,forEachOfLimit:eachOfLimit,inject:reduce,foldl:reduce,foldr:reduceRight,select:wt,selectLimit:$t,selectSeries:xt,wrapSync:asyncify};t["default"]=Vt;t.apply=apply;t.applyEach=we;t.applyEachSeries=Oe;t.asyncify=asyncify;t.auto=auto;t.autoInject=autoInject;t.cargo=cargo;t.compose=compose;t.concat=yt;t.concatLimit=concatLimit;t.concatSeries=St;t.constant=constant;t.detect=Tt;t.detectLimit=bt;t.detectSeries=_t;t.dir=Ct;t.doDuring=doDuring;t.doUntil=doUntil;t.doWhilst=doWhilst;t.during=during;t.each=eachLimit;t.eachLimit=eachLimit$1;t.eachOf=eachOf;t.eachOfLimit=eachOfLimit;t.eachOfSeries=vt;t.eachSeries=At;t.ensureAsync=ensureAsync;t.every=Et;t.everyLimit=It;t.everySeries=Rt;t.filter=wt;t.filterLimit=$t;t.filterSeries=xt;t.forever=forever;t.groupBy=Ot;t.groupByLimit=groupByLimit;t.groupBySeries=Dt;t.log=kt;t.map=Re;t.mapLimit=$e;t.mapSeries=xe;t.mapValues=Nt;t.mapValuesLimit=mapValuesLimit;t.mapValuesSeries=Ut;t.memoize=memoize;t.nextTick=Pt;t.parallel=parallelLimit;t.parallelLimit=parallelLimit$1;t.priorityQueue=priorityQueue;t.queue=queue$1;t.race=race;t.reduce=reduce;t.reduceRight=reduceRight;t.reflect=reflect;t.reflectAll=reflectAll;t.reject=Mt;t.rejectLimit=Ht;t.rejectSeries=qt;t.retry=retry;t.retryable=retryable;t.seq=seq;t.series=series;t.setImmediate=s;t.some=jt;t.someLimit=Ft;t.someSeries=Bt;t.sortBy=sortBy;t.timeout=timeout;t.times=zt;t.timesLimit=timeLimit;t.timesSeries=Kt;t.transform=transform;t.tryEach=tryEach;t.unmemoize=unmemoize;t.until=until;t.waterfall=waterfall;t.whilst=whilst;t.all=Et;t.allLimit=It;t.allSeries=Rt;t.any=jt;t.anyLimit=Ft;t.anySeries=Bt;t.find=Tt;t.findLimit=bt;t.findSeries=_t;t.forEach=eachLimit;t.forEachSeries=At;t.forEachLimit=eachLimit$1;t.forEachOf=eachOf;t.forEachOfSeries=vt;t.forEachOfLimit=eachOfLimit;t.inject=reduce;t.foldl=reduce;t.foldr=reduceRight;t.select=wt;t.selectLimit=$t;t.selectSeries=xt;t.wrapSync=asyncify;Object.defineProperty(t,"__esModule",{value:true})}))},970943:e=>{var t={utf8:{stringToBytes:function(e){return t.bin.stringToBytes(unescape(encodeURIComponent(e)))},bytesToString:function(e){return decodeURIComponent(escape(t.bin.bytesToString(e)))}},bin:{stringToBytes:function(e){for(var t=[],r=0;r<e.length;r++)t.push(e.charCodeAt(r)&255);return t},bytesToString:function(e){for(var t=[],r=0;r<e.length;r++)t.push(String.fromCharCode(e[r]));return t.join("")}}};e.exports=t},829677:e=>{(function(){var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r={rotl:function(e,t){return e<<t|e>>>32-t},rotr:function(e,t){return e<<32-t|e>>>t},endian:function(e){if(e.constructor==Number){return r.rotl(e,8)&16711935|r.rotl(e,24)&4278255360}for(var t=0;t<e.length;t++)e[t]=r.endian(e[t]);return e},randomBytes:function(e){for(var t=[];e>0;e--)t.push(Math.floor(Math.random()*256));return t},bytesToWords:function(e){for(var t=[],r=0,i=0;r<e.length;r++,i+=8)t[i>>>5]|=e[r]<<24-i%32;return t},wordsToBytes:function(e){for(var t=[],r=0;r<e.length*32;r+=8)t.push(e[r>>>5]>>>24-r%32&255);return t},bytesToHex:function(e){for(var t=[],r=0;r<e.length;r++){t.push((e[r]>>>4).toString(16));t.push((e[r]&15).toString(16))}return t.join("")},hexToBytes:function(e){for(var t=[],r=0;r<e.length;r+=2)t.push(parseInt(e.substr(r,2),16));return t},bytesToBase64:function(e){for(var r=[],i=0;i<e.length;i+=3){var n=e[i]<<16|e[i+1]<<8|e[i+2];for(var a=0;a<4;a++)if(i*8+a*6<=e.length*8)r.push(t.charAt(n>>>6*(3-a)&63));else r.push("=")}return r.join("")},base64ToBytes:function(e){e=e.replace(/[^A-Z0-9+\/]/gi,"");for(var r=[],i=0,n=0;i<e.length;n=++i%4){if(n==0)continue;r.push((t.indexOf(e.charAt(i-1))&Math.pow(2,-2*n+8)-1)<<n*2|t.indexOf(e.charAt(i))>>>6-n*2)}return r}};e.exports=r})()},789924:(e,t,r)=>{"use strict";var i,n;var getStats=function(e,t,i){var n="Fake/5.0 (FakeOS) AppleWebKit/123 (KHTML, like Gecko) Fake/12.3.4567.89 Fake/123.45";(function(e){if(!e){return}if(typeof window!=="undefined"){return}if(typeof r.g==="undefined"){return}r.g.navigator={userAgent:n,getUserMedia:function(){}};if(!r.g.console){r.g.console={}}if(typeof r.g.console.log==="undefined"||typeof r.g.console.error==="undefined"){r.g.console.error=r.g.console.log=r.g.console.log||function(){console.log(arguments)}}if(typeof document==="undefined"){e.document={documentElement:{appendChild:function(){return""}}};document.createElement=document.captureStream=document.mozCaptureStream=function(){var e={getContext:function(){return e},play:function(){},pause:function(){},drawImage:function(){},toDataURL:function(){return""}};return e};e.HTMLVideoElement=function(){}}if(typeof location==="undefined"){e.location={protocol:"file:",href:"",hash:""}}if(typeof screen==="undefined"){e.screen={width:0,height:0}}if(typeof URL==="undefined"){e.URL={createObjectURL:function(){return""},revokeObjectURL:function(){return""}}}if(typeof MediaStreamTrack==="undefined"){e.MediaStreamTrack=function(){}}if(typeof a==="undefined"){e.RTCPeerConnection=function(){}}e.window=r.g})(typeof r.g!=="undefined"?r.g:null);var a=window.RTCPeerConnection||window.mozRTCPeerConnection||window.webkitRTCPeerConnection;if(typeof MediaStreamTrack==="undefined"){MediaStreamTrack={}}var s=((navigator.connection||{}).type||"unknown").toString().toLowerCase();var o={encryption:"sha-256",audio:{send:{tracks:[],codecs:[],availableBandwidth:0,streams:0,framerateMean:0,bitrateMean:0},recv:{tracks:[],codecs:[],availableBandwidth:0,streams:0,framerateMean:0,bitrateMean:0},bytesSent:0,bytesReceived:0,latency:0,packetsLost:0},video:{send:{tracks:[],codecs:[],availableBandwidth:0,streams:0,framerateMean:0,bitrateMean:0},recv:{tracks:[],codecs:[],availableBandwidth:0,streams:0,framerateMean:0,bitrateMean:0},bytesSent:0,bytesReceived:0,latency:0,packetsLost:0},bandwidth:{systemBandwidth:0,sentPerSecond:0,encodedPerSecond:0,helper:{audioBytesSent:0,videoBytestSent:0},speed:0},results:{},connectionType:{systemNetworkType:s,systemIpAddress:"192.168.1.2",local:{candidateType:[],transport:[],ipAddress:[],networkType:[]},remote:{candidateType:[],transport:[],ipAddress:[],networkType:[]}},resolutions:{send:{width:0,height:0},recv:{width:0,height:0}},internal:{audio:{send:{},recv:{}},video:{send:{},recv:{}},candidates:{}},nomore:function(){f=true}};var u={checkIfOfferer:function(e){if(e.type==="googLibjingleSession"){o.isOfferer=e.googInitiator}}};var c=/^((?!chrome|android).)*safari/i.test(navigator.userAgent);var l=this;if(!(arguments[0]instanceof a)){throw"1st argument is not instance of RTCPeerConnection."}l=arguments[0];if(arguments[1]instanceof MediaStreamTrack){e=arguments[1];t=arguments[2];i=arguments[3]}var f=false;function getStatsLooper(){getStatsWrapper((function(e){if(!e||!e.forEach)return;e.forEach((function(e){Object.keys(u).forEach((function(t){if(typeof u[t]==="function"){try{u[t](e)}catch(e){console.error(e.message,e.stack,e)}}}))}));try{if(l.iceConnectionState.search(/failed|closed|disconnected/gi)!==-1){f=true}}catch(e){f=true}if(f===true){if(o.datachannel){o.datachannel.state="close"}o.ended=true}o.results=e;if(o.audio&&o.video){o.bandwidth.speed=o.audio.bytesSent-o.bandwidth.helper.audioBytesSent+(o.video.bytesSent-o.bandwidth.helper.videoBytesSent);o.bandwidth.helper.audioBytesSent=o.audio.bytesSent;o.bandwidth.helper.videoBytesSent=o.video.bytesSent}t(o);if(!f){typeof i!=undefined&&i&&setTimeout(getStatsLooper,i||1e3)}}))}function getStatsWrapper(e){if(typeof window.InstallTrigger!=="undefined"||c){l.getStats(window.mediaStreamTrack||null).then((function(t){var r=[];t.forEach((function(e){r.push(e)}));e(r)})).catch(e)}else{l.getStats((function(t){var r=[];t.result().forEach((function(e){var t={};e.names().forEach((function(r){t[r]=e.stat(r)}));t.id=e.id;t.type=e.type;t.timestamp=e.timestamp;r.push(t)}));e(r)}))}}u.datachannel=function(e){if(e.type!=="datachannel")return;o.datachannel={state:e.state}};u.googCertificate=function(e){if(e.type=="googCertificate"){o.encryption=e.googFingerprintAlgorithm}if(e.type=="certificate"){o.encryption=e.fingerprintAlgorithm}};u.checkAudioTracks=function(e){if(e.mediaType!=="audio")return;var t=e.id.split("_").pop();if(e.isRemote===true){t="recv"}if(e.isRemote===false){t="send"}if(!t)return;if(o.audio[t].codecs.indexOf(e.googCodecName||"opus")===-1){o.audio[t].codecs.push(e.googCodecName||"opus")}if(!!e.bytesSent){var r=0;if(!o.internal.audio[t].prevBytesSent){o.internal.audio[t].prevBytesSent=e.bytesSent}var i=e.bytesSent-o.internal.audio[t].prevBytesSent;o.internal.audio[t].prevBytesSent=e.bytesSent;r=i/1024;o.audio[t].availableBandwidth=r.toFixed(1);o.audio.bytesSent=r.toFixed(1)}if(!!e.bytesReceived){var r=0;if(!o.internal.audio[t].prevBytesReceived){o.internal.audio[t].prevBytesReceived=e.bytesReceived}var i=e.bytesReceived-o.internal.audio[t].prevBytesReceived;o.internal.audio[t].prevBytesReceived=e.bytesReceived;r=i/1024;o.audio.bytesReceived=r.toFixed(1)}if(e.googTrackId&&o.audio[t].tracks.indexOf(e.googTrackId)===-1){o.audio[t].tracks.push(e.googTrackId)}if(!!e.googCurrentDelayMs){var r=0;if(!o.internal.audio.prevGoogCurrentDelayMs){o.internal.audio.prevGoogCurrentDelayMs=e.googCurrentDelayMs}var i=e.googCurrentDelayMs-o.internal.audio.prevGoogCurrentDelayMs;o.internal.audio.prevGoogCurrentDelayMs=e.googCurrentDelayMs;o.audio.latency=i.toFixed(1);if(o.audio.latency<0){o.audio.latency=0}}if(!!e.packetsLost){var r=0;if(!o.internal.audio.prevPacketsLost){o.internal.audio.prevPacketsLost=e.packetsLost}var i=e.packetsLost-o.internal.audio.prevPacketsLost;o.internal.audio.prevPacketsLost=e.packetsLost;o.audio.packetsLost=i.toFixed(1);if(o.audio.packetsLost<0){o.audio.packetsLost=0}}};u.checkVideoTracks=function(e){if(e.mediaType!=="video")return;var t=e.id.split("_").pop();if(e.isRemote===true){t="recv"}if(e.isRemote===false){t="send"}if(!t)return;if(o.video[t].codecs.indexOf(e.googCodecName||"VP8")===-1){o.video[t].codecs.push(e.googCodecName||"VP8")}if(!!e.bytesSent){var r=0;if(!o.internal.video[t].prevBytesSent){o.internal.video[t].prevBytesSent=e.bytesSent}var i=e.bytesSent-o.internal.video[t].prevBytesSent;o.internal.video[t].prevBytesSent=e.bytesSent;r=i/1024;o.video[t].availableBandwidth=r.toFixed(1);o.video.bytesSent=r.toFixed(1)}if(!!e.bytesReceived){var r=0;if(!o.internal.video[t].prevBytesReceived){o.internal.video[t].prevBytesReceived=e.bytesReceived}var i=e.bytesReceived-o.internal.video[t].prevBytesReceived;o.internal.video[t].prevBytesReceived=e.bytesReceived;r=i/1024;o.video.bytesReceived=r.toFixed(1)}if(e.googFrameHeightReceived&&e.googFrameWidthReceived){o.resolutions[t].width=e.googFrameWidthReceived;o.resolutions[t].height=e.googFrameHeightReceived}if(e.googFrameHeightSent&&e.googFrameWidthSent){o.resolutions[t].width=e.googFrameWidthSent;o.resolutions[t].height=e.googFrameHeightSent}if(e.googTrackId&&o.video[t].tracks.indexOf(e.googTrackId)===-1){o.video[t].tracks.push(e.googTrackId)}if(e.framerateMean){o.bandwidth.framerateMean=e.framerateMean;var r=0;if(!o.internal.video[t].prevFramerateMean){o.internal.video[t].prevFramerateMean=e.bitrateMean}var i=e.bytesSent-o.internal.video[t].prevFramerateMean;o.internal.video[t].prevFramerateMean=e.framerateMean;r=i/1024;o.video[t].framerateMean=i.toFixed(1)}if(e.bitrateMean){o.bandwidth.bitrateMean=e.bitrateMean;var r=0;if(!o.internal.video[t].prevBitrateMean){o.internal.video[t].prevBitrateMean=e.bitrateMean}var i=e.bytesSent-o.internal.video[t].prevBitrateMean;o.internal.video[t].prevBitrateMean=e.bitrateMean;r=i/1024;o.video[t].bitrateMean=i.toFixed(1)}if(!!e.googCurrentDelayMs){var r=0;if(!o.internal.video.prevGoogCurrentDelayMs){o.internal.video.prevGoogCurrentDelayMs=e.googCurrentDelayMs}var i=e.googCurrentDelayMs-o.internal.video.prevGoogCurrentDelayMs;o.internal.video.prevGoogCurrentDelayMs=e.googCurrentDelayMs;o.video.latency=i.toFixed(1);if(o.video.latency<0){o.video.latency=0}}if(!!e.packetsLost){var r=0;if(!o.internal.video.prevPacketsLost){o.internal.video.prevPacketsLost=e.packetsLost}var i=e.packetsLost-o.internal.video.prevPacketsLost;o.internal.video.prevPacketsLost=e.packetsLost;o.video.packetsLost=i.toFixed(1);if(o.video.packetsLost<0){o.video.packetsLost=0}}};u.bweforvideo=function(e){if(e.type!=="VideoBwe")return;o.bandwidth.availableSendBandwidth=e.googAvailableSendBandwidth;o.bandwidth.googActualEncBitrate=e.googActualEncBitrate;o.bandwidth.googAvailableSendBandwidth=e.googAvailableSendBandwidth;o.bandwidth.googAvailableReceiveBandwidth=e.googAvailableReceiveBandwidth;o.bandwidth.googRetransmitBitrate=e.googRetransmitBitrate;o.bandwidth.googTargetEncBitrate=e.googTargetEncBitrate;o.bandwidth.googBucketDelay=e.googBucketDelay;o.bandwidth.googTransmitBitrate=e.googTransmitBitrate};u.candidatePair=function(e){if(e.type!=="googCandidatePair"&&e.type!=="candidate-pair"&&e.type!=="local-candidate"&&e.type!=="remote-candidate")return;if(e.googActiveConnection=="true"){Object.keys(o.internal.candidates).forEach((function(t){var r=o.internal.candidates[t];if(r.ipAddress.indexOf(e.googLocalAddress)!==-1){o.connectionType.local.candidateType=r.candidateType;o.connectionType.local.ipAddress=r.ipAddress;o.connectionType.local.networkType=r.networkType;o.connectionType.local.transport=r.transport}if(r.ipAddress.indexOf(e.googRemoteAddress)!==-1){o.connectionType.remote.candidateType=r.candidateType;o.connectionType.remote.ipAddress=r.ipAddress;o.connectionType.remote.networkType=r.networkType;o.connectionType.remote.transport=r.transport}}));o.connectionType.transport=e.googTransportType;var t=o.internal.candidates[e.localCandidateId];if(t){if(t.ipAddress){o.connectionType.systemIpAddress=t.ipAddress}}var r=o.internal.candidates[e.remoteCandidateId];if(r){if(r.ipAddress){o.connectionType.systemIpAddress=r.ipAddress}}}if(e.type==="candidate-pair"){if(e.selected===true&&e.nominated===true&&e.state==="succeeded"){var t=o.internal.candidates[e.remoteCandidateId];var r=o.internal.candidates[e.remoteCandidateId]}}if(e.type==="local-candidate"){o.connectionType.local.candidateType=e.candidateType;o.connectionType.local.ipAddress=e.ipAddress;o.connectionType.local.networkType=e.networkType;o.connectionType.local.transport=e.mozLocalTransport||e.transport}if(e.type==="remote-candidate"){o.connectionType.remote.candidateType=e.candidateType;o.connectionType.remote.ipAddress=e.ipAddress;o.connectionType.remote.networkType=e.networkType;o.connectionType.remote.transport=e.mozRemoteTransport||e.transport}if(c){var i=e.localCandidateId?"send":"recv";if(!i)return;if(!!e.bytesSent){var n=0;if(!o.internal.video[i].prevBytesSent){o.internal.video[i].prevBytesSent=e.bytesSent}var a=e.bytesSent-o.internal.video[i].prevBytesSent;o.internal.video[i].prevBytesSent=e.bytesSent;n=a/1024;o.video[i].availableBandwidth=n.toFixed(1);o.video.bytesSent=n.toFixed(1)}if(!!e.bytesReceived){var n=0;if(!o.internal.video[i].prevBytesReceived){o.internal.video[i].prevBytesReceived=e.bytesReceived}var a=e.bytesReceived-o.internal.video[i].prevBytesReceived;o.internal.video[i].prevBytesReceived=e.bytesReceived;n=a/1024;o.video.bytesReceived=n.toFixed(1)}if(!!e.availableOutgoingBitrate){var n=0;if(!o.internal.video[i].prevAvailableOutgoingBitrate){o.internal.video[i].prevAvailableOutgoingBitrate=e.availableOutgoingBitrate}var a=e.availableOutgoingBitrate-o.internal.video[i].prevAvailableOutgoingBitrate;o.internal.video[i].prevAvailableOutgoingBitrate=e.availableOutgoingBitrate;n=a/1024;o.video.availableOutgoingBitrate=n.toFixed(1)}if(!!e.availableIncomingBitrate){var n=0;if(!o.internal.video[i].prevAvailableIncomingBitrate){o.internal.video[i].prevAvailableIncomingBitrate=e.availableIncomingBitrate}var a=e.availableIncomingBitrate-o.internal.video[i].prevAvailableIncomingBitrate;o.internal.video[i].prevAvailableIncomingBitrate=e.availableIncomingBitrate;n=a/1024;o.video.availableIncomingBitrate=n.toFixed(1)}}};var p={};var d={};var h={};var g={};u.localcandidate=function(e){if(e.type!=="localcandidate"&&e.type!=="local-candidate")return;if(!e.id)return;if(!p[e.id]){p[e.id]=[]}if(!d[e.id]){d[e.id]=[]}if(!h[e.id]){h[e.id]=[]}if(!g[e.id]){g[e.id]=[]}if(e.candidateType&&p[e.id].indexOf(e.candidateType)===-1){p[e.id].push(e.candidateType)}if(e.transport&&d[e.id].indexOf(e.transport)===-1){d[e.id].push(e.transport)}if(e.ipAddress&&h[e.id].indexOf(e.ipAddress+":"+e.portNumber)===-1){h[e.id].push(e.ipAddress+":"+e.portNumber)}if(e.networkType&&g[e.id].indexOf(e.networkType)===-1){g[e.id].push(e.networkType)}o.internal.candidates[e.id]={candidateType:p[e.id],ipAddress:h[e.id],portNumber:e.portNumber,networkType:g[e.id],priority:e.priority,transport:d[e.id],timestamp:e.timestamp,id:e.id,type:e.type};o.connectionType.local.candidateType=p[e.id];o.connectionType.local.ipAddress=h[e.id];o.connectionType.local.networkType=g[e.id];o.connectionType.local.transport=d[e.id]};var v={};var m={};var y={};var S={};u.remotecandidate=function(e){if(e.type!=="remotecandidate"&&e.type!=="remote-candidate")return;if(!e.id)return;if(!v[e.id]){v[e.id]=[]}if(!m[e.id]){m[e.id]=[]}if(!y[e.id]){y[e.id]=[]}if(!S[e.id]){S[e.id]=[]}if(e.candidateType&&v[e.id].indexOf(e.candidateType)===-1){v[e.id].push(e.candidateType)}if(e.transport&&m[e.id].indexOf(e.transport)===-1){m[e.id].push(e.transport)}if(e.ipAddress&&y[e.id].indexOf(e.ipAddress+":"+e.portNumber)===-1){y[e.id].push(e.ipAddress+":"+e.portNumber)}if(e.networkType&&S[e.id].indexOf(e.networkType)===-1){S[e.id].push(e.networkType)}o.internal.candidates[e.id]={candidateType:v[e.id],ipAddress:y[e.id],portNumber:e.portNumber,networkType:S[e.id],priority:e.priority,transport:m[e.id],timestamp:e.timestamp,id:e.id,type:e.type};o.connectionType.remote.candidateType=v[e.id];o.connectionType.remote.ipAddress=y[e.id];o.connectionType.remote.networkType=S[e.id];o.connectionType.remote.transport=m[e.id]};u.dataSentReceived=function(e){if(!e.googCodecName||e.mediaType!=="video"&&e.mediaType!=="audio")return;if(!!e.bytesSent){o[e.mediaType].bytesSent=parseInt(e.bytesSent)}if(!!e.bytesReceived){o[e.mediaType].bytesReceived=parseInt(e.bytesReceived)}};u.inboundrtp=function(e){if(!c)return;if(e.type!=="inbound-rtp")return;var t=e.mediaType||"audio";var r=e.isRemote?"recv":"send";if(!r)return;if(!!e.bytesSent){var i=0;if(!o.internal[t][r].prevBytesSent){o.internal[t][r].prevBytesSent=e.bytesSent}var n=e.bytesSent-o.internal[t][r].prevBytesSent;o.internal[t][r].prevBytesSent=e.bytesSent;i=n/1024;o[t][r].availableBandwidth=i.toFixed(1);o[t].bytesSent=i.toFixed(1)}if(!!e.bytesReceived){var i=0;if(!o.internal[t][r].prevBytesReceived){o.internal[t][r].prevBytesReceived=e.bytesReceived}var n=e.bytesReceived-o.internal[t][r].prevBytesReceived;o.internal[t][r].prevBytesReceived=e.bytesReceived;i=n/1024;o[t].bytesReceived=i.toFixed(1)}};u.outboundrtp=function(e){if(!c)return;if(e.type!=="outbound-rtp")return;var t=e.mediaType||"audio";var r=e.isRemote?"recv":"send";if(!r)return;if(!!e.bytesSent){var i=0;if(!o.internal[t][r].prevBytesSent){o.internal[t][r].prevBytesSent=e.bytesSent}var n=e.bytesSent-o.internal[t][r].prevBytesSent;o.internal[t][r].prevBytesSent=e.bytesSent;i=n/1024;o[t][r].availableBandwidth=i.toFixed(1);o[t].bytesSent=i.toFixed(1)}if(!!e.bytesReceived){var i=0;if(!o.internal[t][r].prevBytesReceived){o.internal[t][r].prevBytesReceived=e.bytesReceived}var n=e.bytesReceived-o.internal[t][r].prevBytesReceived;o.internal[t][r].prevBytesReceived=e.bytesReceived;i=n/1024;o[t].bytesReceived=i.toFixed(1)}};u.track=function(e){if(!c)return;if(e.type!=="track")return;var t=e.remoteSource===true?"send":"recv";if(e.frameWidth&&e.frameHeight){o.resolutions[t].width=e.frameWidth;o.resolutions[t].height=e.frameHeight}};var T={audio:{send:[],recv:[]},video:{send:[],recv:[]}};u.ssrc=function(e){if(!e.googCodecName||e.mediaType!=="video"&&e.mediaType!=="audio")return;if(e.type!=="ssrc")return;var t=e.id.split("_").pop();if(T[e.mediaType][t].indexOf(e.ssrc)===-1){T[e.mediaType][t].push(e.ssrc)}o[e.mediaType][t].streams=T[e.mediaType][t].length};getStatsLooper()};if(true){e.exports=getStats}if(true){!(i=[],n=function(){return getStats}.apply(t,i),n!==undefined&&(e.exports=n))}},948809:e=>{e.exports=function(e){return e!=null&&(isBuffer(e)||isSlowBuffer(e)||!!e._isBuffer)};function isBuffer(e){return!!e.constructor&&typeof e.constructor.isBuffer==="function"&&e.constructor.isBuffer(e)}function isSlowBuffer(e){return typeof e.readFloatLE==="function"&&typeof e.slice==="function"&&isBuffer(e.slice(0,0))}},661586:(e,t,r)=>{(function(){var t=r(829677),i=r(970943).utf8,n=r(948809),a=r(970943).bin,md5=function(e,r){if(e.constructor==String)if(r&&r.encoding==="binary")e=a.stringToBytes(e);else e=i.stringToBytes(e);else if(n(e))e=Array.prototype.slice.call(e,0);else if(!Array.isArray(e))e=e.toString();var s=t.bytesToWords(e),o=e.length*8,u=1732584193,c=-271733879,l=-1732584194,f=271733878;for(var p=0;p<s.length;p++){s[p]=(s[p]<<8|s[p]>>>24)&16711935|(s[p]<<24|s[p]>>>8)&4278255360}s[o>>>5]|=128<<o%32;s[(o+64>>>9<<4)+14]=o;var d=md5._ff,h=md5._gg,g=md5._hh,v=md5._ii;for(var p=0;p<s.length;p+=16){var m=u,y=c,S=l,T=f;u=d(u,c,l,f,s[p+0],7,-680876936);f=d(f,u,c,l,s[p+1],12,-389564586);l=d(l,f,u,c,s[p+2],17,606105819);c=d(c,l,f,u,s[p+3],22,-1044525330);u=d(u,c,l,f,s[p+4],7,-176418897);f=d(f,u,c,l,s[p+5],12,1200080426);l=d(l,f,u,c,s[p+6],17,-1473231341);c=d(c,l,f,u,s[p+7],22,-45705983);u=d(u,c,l,f,s[p+8],7,1770035416);f=d(f,u,c,l,s[p+9],12,-1958414417);l=d(l,f,u,c,s[p+10],17,-42063);c=d(c,l,f,u,s[p+11],22,-1990404162);u=d(u,c,l,f,s[p+12],7,1804603682);f=d(f,u,c,l,s[p+13],12,-40341101);l=d(l,f,u,c,s[p+14],17,-1502002290);c=d(c,l,f,u,s[p+15],22,1236535329);u=h(u,c,l,f,s[p+1],5,-165796510);f=h(f,u,c,l,s[p+6],9,-1069501632);l=h(l,f,u,c,s[p+11],14,643717713);c=h(c,l,f,u,s[p+0],20,-373897302);u=h(u,c,l,f,s[p+5],5,-701558691);f=h(f,u,c,l,s[p+10],9,38016083);l=h(l,f,u,c,s[p+15],14,-660478335);c=h(c,l,f,u,s[p+4],20,-405537848);u=h(u,c,l,f,s[p+9],5,568446438);f=h(f,u,c,l,s[p+14],9,-1019803690);l=h(l,f,u,c,s[p+3],14,-187363961);c=h(c,l,f,u,s[p+8],20,1163531501);u=h(u,c,l,f,s[p+13],5,-1444681467);f=h(f,u,c,l,s[p+2],9,-51403784);l=h(l,f,u,c,s[p+7],14,1735328473);c=h(c,l,f,u,s[p+12],20,-1926607734);u=g(u,c,l,f,s[p+5],4,-378558);f=g(f,u,c,l,s[p+8],11,-2022574463);l=g(l,f,u,c,s[p+11],16,1839030562);c=g(c,l,f,u,s[p+14],23,-35309556);u=g(u,c,l,f,s[p+1],4,-1530992060);f=g(f,u,c,l,s[p+4],11,1272893353);l=g(l,f,u,c,s[p+7],16,-155497632);c=g(c,l,f,u,s[p+10],23,-1094730640);u=g(u,c,l,f,s[p+13],4,681279174);f=g(f,u,c,l,s[p+0],11,-358537222);l=g(l,f,u,c,s[p+3],16,-722521979);c=g(c,l,f,u,s[p+6],23,76029189);u=g(u,c,l,f,s[p+9],4,-640364487);f=g(f,u,c,l,s[p+12],11,-421815835);l=g(l,f,u,c,s[p+15],16,530742520);c=g(c,l,f,u,s[p+2],23,-995338651);u=v(u,c,l,f,s[p+0],6,-198630844);f=v(f,u,c,l,s[p+7],10,1126891415);l=v(l,f,u,c,s[p+14],15,-1416354905);c=v(c,l,f,u,s[p+5],21,-57434055);u=v(u,c,l,f,s[p+12],6,1700485571);f=v(f,u,c,l,s[p+3],10,-1894986606);l=v(l,f,u,c,s[p+10],15,-1051523);c=v(c,l,f,u,s[p+1],21,-2054922799);u=v(u,c,l,f,s[p+8],6,1873313359);f=v(f,u,c,l,s[p+15],10,-30611744);l=v(l,f,u,c,s[p+6],15,-1560198380);c=v(c,l,f,u,s[p+13],21,1309151649);u=v(u,c,l,f,s[p+4],6,-145523070);f=v(f,u,c,l,s[p+11],10,-1120210379);l=v(l,f,u,c,s[p+2],15,718787259);c=v(c,l,f,u,s[p+9],21,-343485551);u=u+m>>>0;c=c+y>>>0;l=l+S>>>0;f=f+T>>>0}return t.endian([u,c,l,f])};md5._ff=function(e,t,r,i,n,a,s){var o=e+(t&r|~t&i)+(n>>>0)+s;return(o<<a|o>>>32-a)+t};md5._gg=function(e,t,r,i,n,a,s){var o=e+(t&i|r&~i)+(n>>>0)+s;return(o<<a|o>>>32-a)+t};md5._hh=function(e,t,r,i,n,a,s){var o=e+(t^r^i)+(n>>>0)+s;return(o<<a|o>>>32-a)+t};md5._ii=function(e,t,r,i,n,a,s){var o=e+(r^(t|~i))+(n>>>0)+s;return(o<<a|o>>>32-a)+t};md5._blocksize=16;md5._digestsize=16;e.exports=function(e,r){if(e===undefined||e===null)throw new Error("Illegal argument "+e);var i=t.wordsToBytes(md5(e,r));return r&&r.asBytes?i:r&&r.asString?a.bytesToString(i):t.bytesToHex(i)}})()},405431:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.AudioHelper=void 0;var r=function(){function AudioHelper(e){if(e===void 0){e={}}this._enabled=!!e.enabled;this.loadAudio(e)}AudioHelper.prototype._playSound=function(e,t,r){if(!this._enabled||!e)return this;if(!this._audio[e]){if(t){this._audio[e]=new Audio;this._audio[e].src=e;this._audio[e].loop=true;this._audio[e].volume=r;this._audio[e].playPromise=this._audio[e].play()}}else{if(t){this._audio[e].currentTime=0;this._audio[e].playPromise=this._audio[e].play()}else{var i=this._audio[e];if(i.playPromise!==undefined){i.playPromise.then((function(){i.pause()}))}}}return this};AudioHelper.prototype.loadAudio=function(e){this._incoming=e.incoming;this._outgoing=e.outgoing;this._audio={}};AudioHelper.prototype.setVolume=function(e){if(e<0){e=0}if(e>1){e=1}this.volume=e;for(var t in this._audio){if(this._audio.hasOwnProperty(t)){this._audio[t].volume=e}}};AudioHelper.prototype.playIncoming=function(e){return this._playSound(this._incoming,e,this.volume||.5)};AudioHelper.prototype.playOutgoing=function(e){return this._playSound(this._outgoing,e,this.volume||1)};return AudioHelper}();t.AudioHelper=r},852895:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.defaultMediaConstraints=t.responseTimeout=t.uuidKey=t.messages=void 0;t.messages={park:{reqid:1,command:"callpark"},startRecord:{reqid:2,command:"startcallrecord"},stopRecord:{reqid:3,command:"stopcallrecord"},flip:{reqid:3,command:"callflip",target:""},monitor:{reqid:4,command:"monitor"},barge:{reqid:5,command:"barge"},whisper:{reqid:6,command:"whisper"},takeover:{reqid:7,command:"takeover"},toVoicemail:{reqid:11,command:"toVoicemail"},ignore:{reqid:12,command:"ignore"},receiveConfirm:{reqid:17,command:"receiveConfirm"},replyWithMessage:{reqid:14,command:"replyWithMessage"}};t.uuidKey="rc-webPhone-uuid";t.responseTimeout=6e4;t.defaultMediaConstraints={audio:true,video:false}},191190:function(e,t,r){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,r,i){if(i===undefined)i=r;Object.defineProperty(e,i,{enumerable:true,get:function(){return t[r]}})}:function(e,t,r,i){if(i===undefined)i=r;e[i]=t[r]});var n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:true,value:t})}:function(e,t){e["default"]=t});var a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)if(Object.hasOwnProperty.call(e,r))i(t,e,r);n(t,e);return t};Object.defineProperty(t,"__esModule",{value:true});var s=r(533260);var o=r(654700);var u=r(852895);var c=r(262714);var l=a(r(60227));var f=r(365832).i8;var p=function(){function WebPhone(e,t){if(e===void 0){e={}}if(t===void 0){t={}}this.sipInfo=e.sipInfo[0]||e.sipInfo;this.sipFlags=e.sipFlags;this.uuidKey=t.uuidKey||u.uuidKey;var r=t.uuid||localStorage.getItem(this.uuidKey)||c.uuid();localStorage.setItem(this.uuidKey,r);this.appKey=t.appKey;this.appName=t.appName;this.appVersion=t.appVersion;var i=navigator.userAgent.match(/\((.*?)\)/);var n=(i&&i.length&&i[1]).replace(/[^a-zA-Z0-9.:_]+/g,"-")||"";var a=(t.appName?t.appName+(t.appVersion?"/"+t.appVersion:"")+" ":"")+(n?n:"")+(" RCWEBPHONE/"+f);var l=t.modifiers||[];if(t.enableDefaultModifiers!==false){l.push(o.Web.Modifiers.stripG722);l.push(o.Web.Modifiers.stripTcpCandidates)}if(t.enableMidLinesInSDP){l.push(o.Web.Modifiers.addMidLines)}var p="unified-plan";if(t.enablePlanB){p="plan-b"}var d=t.stunServers||this.sipInfo.stunServers||["stun.l.google.com:19302"];var h=t.turnServers;var g=t.iceTransportPolicy||"all";var v=[];if(t.enableTurnServers&&t.turnServers!==undefined&&t.turnServers.length!==0){h.forEach((function(e){v.push(e)}));t.iceCheckingTimeout=t.iceCheckingTimeout||2e3}d.forEach((function(e){e=!/^(stun:)/.test(e)?"stun:"+e:e;v.push({urls:e})}));var m=t.sessionDescriptionHandlerFactoryOptions||{peerConnectionOptions:{iceCheckingTimeout:t.iceCheckingTimeout||this.sipInfo.iceCheckingTimeout||this.sipInfo.iceGatheringTimeout||500,rtcConfiguration:{sdpSemantics:p,iceServers:v,iceTransportPolicy:g}},constraints:t.mediaConstraints||u.defaultMediaConstraints,modifiers:l};var y=navigator.userAgent.toLowerCase();var S=false;var T=false;if(y.indexOf("safari")>-1&&y.indexOf("chrome")<0){S=true}else if(y.indexOf("firefox")>-1&&y.indexOf("chrome")<0){T=true}if(T){m.alwaysAcquireMediaFirst=true}var b=t.sessionDescriptionHandlerFactory||[];var _=e.sipErrorCodes&&e.sipErrorCodes.length?e.sipErrorCodes:["408","502","503","504"];var C=[];if(this.sipInfo.outboundProxy&&this.sipInfo.transport){C.push({wsUri:this.sipInfo.transport.toLowerCase()+"://"+this.sipInfo.outboundProxy,weight:10})}if(this.sipInfo.outboundProxyBackup&&this.sipInfo.transport){C.push({wsUri:this.sipInfo.transport.toLowerCase()+"://"+this.sipInfo.outboundProxyBackup,weight:0})}C=C.length?C:this.sipInfo.wsServers;var A=t.maxReconnectionAttemptsNoBackup||15;var E=t.maxReconnectionAttemptsWithBackup||10;var I=t.reconnectionTimeoutNoBackup||5;var R=t.reconnectionTimeoutWithBackup||4;var w={uri:"sip:"+this.sipInfo.username+"@"+this.sipInfo.domain,transportOptions:{wsServers:C,traceSip:true,maxReconnectionAttempts:C.length===1?A:E,reconnectionTimeout:C.length===1?I:R,connectionTimeout:5},authorizationUser:this.sipInfo.authorizationId,password:this.sipInfo.password,log:{level:t.logLevel||1,builtinEnabled:typeof t.builtinEnabled==="undefined"?true:t.builtinEnabled,connector:t.connector||null},domain:this.sipInfo.domain,autostart:false,autostop:typeof t.autoStop==="undefined"?true:t.autoStop,register:true,userAgentString:a,sessionDescriptionHandlerFactoryOptions:m,sessionDescriptionHandlerFactory:b,allowLegacyNotifications:true,registerOptions:{instanceId:t.instanceId||undefined,regId:t.regId||undefined}};t.sipErrorCodes=_;t.switchBackInterval=this.sipInfo.switchBackInterval;this.userAgent=s.patchUserAgent(new o.UA(w),this.sipInfo,t,r)}WebPhone.version="0.8.9";WebPhone.uuid=c.uuid;WebPhone.delay=c.delay;WebPhone.extend=c.extend;WebPhone.MediaStreams=l.default;WebPhone.MediaStreamsImpl=l.MediaStreamsImpl;return WebPhone}();t["default"]=p},60227:function(e,t){"use strict";var r=this&&this.__awaiter||function(e,t,r,i){function adopt(e){return e instanceof r?e:new r((function(t){t(e)}))}return new(r||(r=Promise))((function(r,n){function fulfilled(e){try{step(i.next(e))}catch(e){n(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){n(e)}}function step(e){e.done?r(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};var i=this&&this.__generator||function(e,t){var r={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},i,n,a,s;return s={next:verb(0),throw:verb(1),return:verb(2)},typeof Symbol==="function"&&(s[Symbol.iterator]=function(){return this}),s;function verb(e){return function(t){return step([e,t])}}function step(s){if(i)throw new TypeError("Generator is already executing.");while(r)try{if(i=1,n&&(a=s[0]&2?n["return"]:s[0]?n["throw"]||((a=n["return"])&&a.call(n),0):n.next)&&!(a=a.call(n,s[1])).done)return a;if(n=0,a)s=[s[0]&2,a.value];switch(s[0]){case 0:case 1:a=s;break;case 4:r.label++;return{value:s[1],done:false};case 5:r.label++;n=s[1];s=[0];continue;case 7:s=r.ops.pop();r.trys.pop();continue;default:if(!(a=r.trys,a=a.length>0&&a[a.length-1])&&(s[0]===6||s[0]===2)){r=0;continue}if(s[0]===3&&(!a||s[1]>a[0]&&s[1]<a[3])){r.label=s[1];break}if(s[0]===6&&r.label<a[1]){r.label=a[1];a=s;break}if(a&&r.label<a[2]){r.label=a[2];r.ops.push(s);break}if(a[2])r.ops.pop();r.trys.pop();continue}s=t.call(e,r)}catch(e){s=[6,e];n=0}finally{i=a=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:true}}};Object.defineProperty(t,"__esModule",{value:true});t.MediaStreams=t.MediaStreamsImpl=t.RTPReport=t.Browsers=void 0;var n;(function(e){e["new"]="mediaConnectionStateNew";e["checking"]="mediaConnectionStateChecking";e["connected"]="mediaConnectionStateConnected";e["completed"]="mediaConnectionStateCompleted";e["failed"]="mediaConnectionStateFailed";e["disconnected"]="mediaConnectionStateDisconnected";e["closed"]="mediaConnectionStateClosed"})(n||(n={}));var a;(function(e){e["MSIE"]="IE";e["Chrome"]="Chrome";e["Firefox"]="Firefox";e["Safari"]="Safari";e["Opera"]="Opera"})(a=t.Browsers||(t.Browsers={}));var s=function(){function RTPReport(){this.outboundRtpReport={};this.inboundRtpReport={};this.rttMS={};this.localCandidates=[];this.remoteCandidates=[];this.transport={}}return RTPReport}();t.RTPReport=s;var o=function(){function MediaStreams(e){this.mediaStreamsImpl=new u(e);this.release=this.mediaStreamsImpl.release.bind(this.mediaStreamsImpl);this.reconnectMedia=this.mediaStreamsImpl.reconnectMedia.bind(this.mediaStreamsImpl);this.getMediaStats=this.mediaStreamsImpl.getMediaStats.bind(this.mediaStreamsImpl);this.stopMediaStats=this.mediaStreamsImpl.stopMediaStats.bind(this.mediaStreamsImpl)}Object.defineProperty(MediaStreams.prototype,"onRTPStat",{set:function(e){this.mediaStreamsImpl.onRTPStat=e},enumerable:false,configurable:true});Object.defineProperty(MediaStreams.prototype,"onMediaConnectionStateChange",{set:function(e){this.mediaStreamsImpl.onMediaConnectionStateChange=e},enumerable:false,configurable:true});return MediaStreams}();t.MediaStreams=o;t["default"]=o;var u=function(){function MediaStreamsImpl(e){var t=this;this.ktag="MediaStreams";this.onIceCandidate=function(e){if(e.candidate===null){t.rcWPLogd(t.tag,"ice candidate completed for reconnect media");t.session.sessionDescriptionHandler.off("iceCandidate",t.onIceCandidate);t.session.reinvite()}};this.ktag="MediaStreams";if(!e){this.rcWPLoge(this.ktag,"The session cannot be null!");throw new Error("Fail to create the media session. session is null or undefined!")}this.session=e;this.onMediaConnectionStateChange=null;this.onStateChange=this.onPeerConnectionStateChange.bind(this);if(this.session&&this.session.sessionDescriptionHandler){this.session.sessionDescriptionHandler.on("iceConnection",this.onStateChange);this.session.sessionDescriptionHandler.on("iceConnectionChecking",this.onStateChange);this.session.sessionDescriptionHandler.on("iceConnectionConnected",this.onStateChange);this.session.sessionDescriptionHandler.on("iceConnectionCompleted",this.onStateChange);this.session.sessionDescriptionHandler.on("iceConnectionFailed",this.onStateChange);this.session.sessionDescriptionHandler.on("iceConnectionDisconnected",this.onStateChange);this.session.sessionDescriptionHandler.on("iceConnectionClosed",this.onStateChange)}this.isChrome=this.browser()===a["Chrome"];this.isFirefox=this.browser()===a["Firefox"];this.isSafari=this.browser()===a["Safari"];this.preRTT={currentRoundTripTime:0};if(!this.isChrome&&!this.isFirefox&&!this.isSafari){this.rcWPLoge(this.ktag,"The web browser "+this.browser()+" is not in the recommended list [Chrome, Safari, Firefox] !")}}MediaStreamsImpl.prototype.getMediaStats=function(e,t){var r=this;if(e===void 0){e=null}if(t===void 0){t=1e3}if(e){this.onRTPStat=e}if(this.mediaStatsTimer){clearTimeout(this.mediaStatsTimer);this.mediaStatsTimer=null}this.mediaStatsTimer=setInterval((function(){r.mediaStatsTimerCallback()}),t)};MediaStreamsImpl.prototype.mediaStatsTimerCallback=function(){var e=this.session.sessionDescriptionHandler.peerConnection;if(!e){this.rcWPLoge(this.ktag,"the peer connection cannot be null");return}var t=e.iceConnectionState;if(t!=="connected"&&t!=="completed"){this.preRTT["currentRoundTripTime"]=0;return}var r=this.session.listeners("rtpStat");if(!this.session.onRTPStat&&!this.onRTPStat&&r.length<=0){this.rcWPLoge(this.ktag,'No callback to accept receive media report. usage: session.on("rtpStat") = function(report) or session.onRTPStat = function(report) or set a mediaCallback as a paramter');return}this.getRTPReport(new s)};MediaStreamsImpl.prototype.stopMediaStats=function(){if(this.mediaStatsTimer){clearTimeout(this.mediaStatsTimer);this.onRTPStat=null}};Object.defineProperty(MediaStreamsImpl.prototype,"tag",{get:function(){return this.ktag},enumerable:false,configurable:true});MediaStreamsImpl.prototype.onPeerConnectionStateChange=function(e){var t="unknown";if(n.hasOwnProperty(e.peerConnection.iceConnectionState)){t=n[e.peerConnection.iceConnectionState];if(this.onMediaConnectionStateChange){this.onMediaConnectionStateChange(this.session,t)}else if(this.session&&this.session.onMediaConnectionStateChange){this.session.onMediaConnectionStateChange(this.session,t)}else{this.session.emit(t)}}else{this.rcWPLogd(this.tag,"Unknown peerConnection state: "+e.peerConnection.iceConnectionState)}this.rcWPLogd(this.tag,"peerConnection State: "+t)};MediaStreamsImpl.prototype.reconnectMedia=function(e){var t=this;return new Promise((function(n,a){return r(this,void 0,void 0,(function(){var r,s,o,u,c;return i(this,(function(i){switch(i.label){case 0:if(!t.session)return[3,6];r={offerToReceiveAudio:1,offerToReceiveVideo:0,iceRestart:true};s=e&&e.RTCOptions||r;if(!e){e={}}if(!e.extraHeaders){e.extraHeaders=t.session.ua.defaultHeaders}e.eventHandlers={succeeded:n,failed:a};o=t.session.sessionDescriptionHandler.peerConnection;u=void 0;i.label=1;case 1:i.trys.push([1,4,,5]);return[4,o.createOffer(s)];case 2:u=i.sent();t.session.sessionDescriptionHandler.on("iceCandidate",t.onIceCandidate);return[4,o.setLocalDescription(u)];case 3:i.sent();t.rcWPLogd(t.tag,"reconnecting media");n("reconnecting media");return[3,5];case 4:c=i.sent();t.rcWPLoge(t.tag,c);a(c);return[3,5];case 5:return[3,7];case 6:a(new Error("The session cannot be empty"));i.label=7;case 7:return[2]}}))}))}))};MediaStreamsImpl.prototype.getRTPReport=function(e){var t=this;var r=this;var i=r.session.sessionDescriptionHandler.peerConnection;i.getStats().then((function(t){t.forEach((function(t){switch(t.type){case"inbound-rtp":Object.keys(t).forEach((function(r){switch(r){case"bytesReceived":case"packetsReceived":case"jitter":case"packetsLost":case"fractionLost":case"mediaType":e.inboundRtpReport[r]=t[r];break;case"roundTripTime":e.rttMS[r]=t[r];break}}));break;case"outbound-rtp":Object.keys(t).forEach((function(r){switch(r){case"bytesSent":case"packetsSent":case"mediaType":e.outboundRtpReport[r]=t[r];break}}));break;case"candidate-pair":Object.keys(t).forEach((function(r){switch(r){case"currentRoundTripTime":e.rttMS[r]=t[r];break}}));break;case"local-candidate":var r={};Object.keys(t).forEach((function(e){switch(e){case"id":case"isRemote":case"ip":case"candidateType":case"networkType":case"priority":case"port":r[e]=t[e];break}}));e.localCandidates.push(r);break;case"remote-candidate":var i={};Object.keys(t).forEach((function(e){switch(e){case"id":case"isRemote":case"ip":case"priority":case"port":case"candidateType":i[e]=t[e];break}}));e.remoteCandidates.push(i);break;case"media-source":e.outboundRtpReport["rtpLocalAudioLevel"]=t.audioLevel?t.audioLevel:0;break;case"track":if(!t.remoteSource){break}e.inboundRtpReport["rtpRemoteAudioLevel"]=t.audioLevel?t.audioLevel:0;break;case"transport":Object.keys(t).forEach((function(r){switch(r){case"dtlsState":case"packetsSent":case"packetsReceived":case"selectedCandidatePairChanges":case"selectedCandidatePairId":e.transport[r]=t[r];break}}));break;default:break}}));if(!e.rttMS.hasOwnProperty("currentRoundTripTime")){if(!e.rttMS.hasOwnProperty("roundTripTime")){e.rttMS["currentRoundTripTime"]=r.preRTT["currentRoundTripTime"]}else{e.rttMS["currentRoundTripTime"]=e.rttMS["roundTripTime"];delete e.rttMS["roundTripTime"]}}else{e.rttMS["currentRoundTripTime"]=Math.round(e.rttMS["currentRoundTripTime"]*1e3)}if(e.rttMS.hasOwnProperty("currentRoundTripTime")){r.preRTT["currentRoundTripTime"]=e.rttMS["currentRoundTripTime"]}if(r.session){if(r.session.onRTPStat){r.session.onRTPStat(e,r.session)}else if(r.onRTPStat){r.onRTPStat(e,r.session)}else{r.session.emit("rtpStat",e,r.session)}}})).catch((function(e){t.rcWPLoge(r.ktag,JSON.stringify(e))}))};MediaStreamsImpl.prototype.browser=function(){if(navigator.userAgent.search("MSIE")>=0){return a["MSIE"]}else if(navigator.userAgent.search("Chrome")>=0){return a["Chrome"]}else if(navigator.userAgent.search("Firefox")>=0){return a["Firefox"]}else if(navigator.userAgent.search("Safari")>=0&&navigator.userAgent.search("Chrome")<0){return a["Safari"]}else if(navigator.userAgent.search("Opera")>=0){return a["Opera"]}return"unknown"};MediaStreamsImpl.prototype.release=function(){if(this.mediaStatsTimer){clearTimeout(this.mediaStatsTimer);this.mediaStatsTimer=null}if(this.session){this.session.sessionDescriptionHandler.removeListener("iceConnection",this.onStateChange);this.session.sessionDescriptionHandler.removeListener("iceConnectionChecking",this.onStateChange);this.session.sessionDescriptionHandler.removeListener("iceConnectionConnected",this.onStateChange);this.session.sessionDescriptionHandler.removeListener("iceConnectionCompleted",this.onStateChange);this.session.sessionDescriptionHandler.removeListener("iceConnectionFailed",this.onStateChange);this.session.sessionDescriptionHandler.removeListener("iceConnectionDisconnected",this.onStateChange);this.session.sessionDescriptionHandler.removeListener("iceConnectionClosed",this.onStateChange)}};MediaStreamsImpl.prototype.rcWPLoge=function(e,t){if(this.session){this.session.logger.error(e+" "+t)}};MediaStreamsImpl.prototype.rcWPLogd=function(e,t){if(this.session){this.session.logger.log(e+" "+t)}};return MediaStreamsImpl}();t.MediaStreamsImpl=u},952703:function(e,t,r){"use strict";var i=this&&this.__assign||function(){i=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++){t=arguments[r];for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n))e[n]=t[n]}return e};return i.apply(this,arguments)};var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:true});t.startQosStatsCollection=void 0;var a=n(r(789924));var formatFloat=function(e){return parseFloat(e.toString()).toFixed(2)};t.startQosStatsCollection=function(e){var t=getQoSStatsTemplate();t.callID=e.request.callId||"";t.fromTag=e.request.fromTag||"";t.toTag=e.request.toTag||"";t.localID=e.request.headers.From[0].raw||e.request.headers.From[0];t.remoteID=e.request.headers.To[0].raw||e.request.headers.To[0];t.origID=e.request.headers.From[0].raw||e.request.headers.From[0];var r;if(!a.default)throw new Error("getStats module was not provided!");a.default(e.sessionDescriptionHandler.peerConnection,(function(i){r=i;t.status=true;var n=getNetworkType(r.connectionType);t.localAddr=r.connectionType.local.ipAddress[0];t.remoteAddr=r.connectionType.remote.ipAddress[0];r.results.forEach((function(r){if(r.type==="localcandidate"){t.localcandidate=r}if(r.type==="remotecandidate"){t.remotecandidate=r}if(r.type==="ssrc"&&r.id.includes("send")&&e.ua.enableMediaReportLogging){if(parseInt(r.audioInputLevel,10)===0){e.logger.log("AudioInputLevel is 0. The local track might be muted or could have potential one-way audio issue. Check Microphone Volume settings.");e.emit("no-input-volume")}}if(r.type==="ssrc"&&r.id.includes("recv")){t.jitterBufferDiscardRate=r.googSecondaryDiscardedRate||0;t.packetLost=r.packetsLost;t.packetsReceived=r.packetsReceived;t.totalSumJitter+=parseFloat(r.googJitterBufferMs);t.totalIntervalCount+=1;t.JBM=Math.max(t.JBM,parseFloat(r.googJitterBufferMs));t.netType=addToMap(t.netType,n);if(e.ua.enableMediaReportLogging){if(parseInt(r.audioOutputLevel,10)<=1){e.logger.log("Remote audioOutput level is 1. The remote track might be muted or could have potential one-way audio issue");e.emit("no-output-volume")}}}}))}),e.ua.qosCollectInterval);e.on("terminated",(function(){r&&r.nomore();e.logger.log("Release media streams");e.mediaStreams&&e.mediaStreams.release();publishQosStats(e,t)}))};var publishQosStats=function(e,t,r){if(r===void 0){r={}}r=r||{};var i=navigator["connection"].effectiveType||"";var n=calculateNetworkUsage(t)||"";var a=r.targetUrl||"rtcpxr@rtcpxr.ringcentral.com:5060";var s=r.event||"vq-rtcpxr";r.expires=60;r.contentType="application/vq-rtcpxr";r.extraHeaders=(r.extraHeaders||[]).concat(e.ua.defaultHeaders);r.extraHeaders.push("p-rc-client-info:"+"cpuRC=0:0;cpuOS=0:0;netType="+n+";ram=0:0;effectiveType="+i);var o=calculateStats(t);var u=createPublishBody(o);var c=e.ua.publish(a,s,u,r);e.logger.log("Local Candidate: "+JSON.stringify(t.localcandidate));e.logger.log("Remote Candidate: "+JSON.stringify(t.remotecandidate));t.status=false;c.close();e.emit("qos-published",u)};var calculateNetworkUsage=function(e){var t=[];for(var r=0,i=Object.entries(e.netType);r<i.length;r++){var n=i[r],a=n[0],s=n[1];t.push(a+":"+formatFloat(s*100/e.totalIntervalCount))}return t.join()};var calculateStats=function(e){var t=e.packetLost*100/(e.packetsReceived+e.packetLost)||0;var r=e.totalIntervalCount>0?e.totalSumJitter/e.totalIntervalCount:0;return i(i({},e),{NLR:formatFloat(t),JBN:formatFloat(r),JDR:formatFloat(e.jitterBufferDiscardRate),MOSLQ:0})};var createPublishBody=function(e){var t=e.NLR||0;var r=e.JBM||0;var i=e.JBN||0;var n=e.JDR||0;var a=e.MOSLQ||0;var s=e.callID||"";var o=e.fromTag||"";var u=e.toTag||"";var c=e.localID||"";var l=e.remoteID||"";var f=e.localAddr||"";var p=e.remoteAddr||"";return"VQSessionReport: CallTerm\r\n"+("CallID: "+s+"\r\n")+("LocalID: "+c+"\r\n")+("RemoteID: "+l+"\r\n")+("OrigID: "+c+"\r\n")+("LocalAddr: IP="+f+" SSRC=0x00000000\r\n")+("RemoteAddr: IP="+p+" SSRC=0x00000000\r\n")+"LocalMetrics:\r\n"+"Timestamps: START=0 STOP=0\r\n"+"SessionDesc: PT=0 PD=opus SR=0 FD=0 FPP=0 PPS=0 PLC=0 SSUP=on\r\n"+("JitterBuffer: JBA=0 JBR=0 JBN="+i+" JBM="+r+" JBX=0\r\n")+("PacketLoss: NLR="+t+" JDR="+n+"\r\n")+"BurstGapLoss: BLD=0 BD=0 GLD=0 GD=0 GMIN=0\r\n"+"Delay: RTD=0 ESD=0 SOWD=0 IAJ=0\r\n"+("QualityEst: MOSLQ="+a+" MOSCQ=0.0\r\n")+("DialogID: "+s+";to-tag="+u+";from-tag="+o)};var getQoSStatsTemplate=function(){return{localAddr:"",remoteAddr:"",callID:"",localID:"",remoteID:"",origID:"",fromTag:"",toTag:"",timestamp:{start:"",stop:""},netType:{},packetLost:0,packetsReceived:0,jitterBufferNominal:0,jitterBufferMax:0,jitterBufferDiscardRate:0,totalSumJitter:0,totalIntervalCount:0,NLR:"",JBM:0,JBN:"",JDR:"",MOSLQ:0,status:false,localcandidate:{},remotecandidate:{}}};var addToMap=function(e,t){var r;if(e===void 0){e={}}return i(i({},e),(r={},r[t]=(t in e?parseInt(e[t]):0)+1,r))};var s;(function(e){e["bluetooth"]="Bluetooth";e["cellular"]="Cellulars";e["ethernet"]="Ethernet";e["wifi"]="WiFi";e["vpn"]="VPN";e["wimax"]="WiMax";e["2g"]="2G";e["3g"]="3G";e["4g"]="4G"})(s||(s={}));var getNetworkType=function(e){var t=e.systemNetworkType||"unknown";var r=e.local.networkType||["unknown"];var i=!t||t==="unknown"?r[0]:t;return i in s?s[i]:i}},401555:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.isNoAudio=void 0;function isNoAudio(e){if(!e.inboundRtpReport){return true}if(!e.outboundRtpReport){return true}if(e.inboundRtpReport.packetsReceived===0||e.outboundRtpReport.packetsSent===0){return true}return false}t.isNoAudio=isNoAudio},812905:function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){function adopt(e){return e instanceof r?e:new r((function(t){t(e)}))}return new(r||(r=Promise))((function(r,n){function fulfilled(e){try{step(i.next(e))}catch(e){n(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){n(e)}}function step(e){e.done?r(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};var n=this&&this.__generator||function(e,t){var r={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},i,n,a,s;return s={next:verb(0),throw:verb(1),return:verb(2)},typeof Symbol==="function"&&(s[Symbol.iterator]=function(){return this}),s;function verb(e){return function(t){return step([e,t])}}function step(s){if(i)throw new TypeError("Generator is already executing.");while(r)try{if(i=1,n&&(a=s[0]&2?n["return"]:s[0]?n["throw"]||((a=n["return"])&&a.call(n),0):n.next)&&!(a=a.call(n,s[1])).done)return a;if(n=0,a)s=[s[0]&2,a.value];switch(s[0]){case 0:case 1:a=s;break;case 4:r.label++;return{value:s[1],done:false};case 5:r.label++;n=s[1];s=[0];continue;case 7:s=r.ops.pop();r.trys.pop();continue;default:if(!(a=r.trys,a=a.length>0&&a[a.length-1])&&(s[0]===6||s[0]===2)){r=0;continue}if(s[0]===3&&(!a||s[1]>a[0]&&s[1]<a[3])){r.label=s[1];break}if(s[0]===6&&r.label<a[1]){r.label=a[1];a=s;break}if(a&&r.label<a[2]){r.label=a[2];r.ops.push(s);break}if(a[2])r.ops.pop();r.trys.pop();continue}s=t.call(e,r)}catch(e){s=[6,e];n=0}finally{i=a=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:true}}};var a=this&&this.__spreadArrays||function(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;for(var i=Array(e),n=0,t=0;t<r;t++)for(var a=arguments[t],s=0,o=a.length;s<o;s++,n++)i[n]=a[s];return i};Object.defineProperty(t,"__esModule",{value:true});t.patchIncomingSession=t.patchSession=void 0;var s=r(654700);var o=r(852895);var u=r(952703);var c=r(262714);var l=r(60227);var f=r(401555);t.patchSession=function(e){if(e.__patched)return e;e.__patched=true;e.__sendRequest=e.sendRequest;e.__receiveRequest=e.receiveRequest;e.__accept=e.accept;e.__hold=e.hold;e.__unhold=e.unhold;e.__dtmf=e.dtmf;e.__reinvite=e.reinvite;e.sendRequest=sendRequest.bind(e);e.receiveRequest=receiveRequest.bind(e);e.accept=accept.bind(e);e.hold=hold.bind(e);e.unhold=unhold.bind(e);e.dtmf=dtmf.bind(e);e.reinvite=reinvite.bind(e);e.warmTransfer=warmTransfer.bind(e);e.blindTransfer=blindTransfer.bind(e);e.transfer=transfer.bind(e);e.park=park.bind(e);e.forward=forward.bind(e);e.startRecord=startRecord.bind(e);e.stopRecord=stopRecord.bind(e);e.flip=flip.bind(e);e.whisper=whisper.bind(e);e.barge=barge.bind(e);e.mute=mute.bind(e);e.unmute=unmute.bind(e);e.onLocalHold=onLocalHold.bind(e);e.media=e.ua.media;e.addTrack=addTrack.bind(e);e.stopMediaStats=stopMediaStats.bind(e);e.getIncomingInfoContent=getIncomingInfoContent.bind(e);e.sendMoveResponse=sendMoveResponse.bind(e);e.sendReceive=sendReceive.bind(e);e._sendReinvite=sendReinvite.bind(e);e.on("replaced",t.patchSession);e.on("progress",(function(t){stopPlaying();if(t.statusCode===183){e.logger.log("Receiving 183 In Progress from server");e.createDialog(t,"UAC");e.hasAnswer=true;e.status=s.Session.C.STATUS_EARLY_MEDIA;e.logger.log("Created UAC Dialog");e.sessionDescriptionHandler.setDescription(t.body).catch((function(r){e.logger.warn(r);e.failed(t,s.C.causes.BAD_MEDIA_DESCRIPTION);e.terminate({status_code:488,reason_phrase:"Bad Media Description"});e.logger.log("Call failed with Bad Media Description")}))}}));if(e.media)e.on("trackAdded",addTrack);var stopPlaying=function(){e.ua.audioHelper.playOutgoing(false);e.ua.audioHelper.playIncoming(false);e.removeListener("accepted",stopPlaying);e.removeListener("rejected",stopPlaying);e.removeListener("bye",stopPlaying);e.removeListener("terminated",stopPlaying);e.removeListener("cancel",stopPlaying);e.removeListener("failed",stopPlaying);e.removeListener("replaced",stopPlaying)};e.on("accepted",stopPlaying);e.on("rejected",stopPlaying);e.on("bye",stopPlaying);e.on("terminated",stopPlaying);e.on("cancel",stopPlaying);e.on("failed",stopPlaying);e.on("replaced",stopPlaying);e.on("reinviteAccepted",t.patchIncomingSession);if(e.ua.enableQos){e.on("SessionDescriptionHandler-created",(function(){e.logger.log("SessionDescriptionHandler Created");u.startQosStatsCollection(e);navigator.mediaDevices.enumerateDevices().then((function(t){t.forEach((function(t){e.logger.log(t.kind+" = "+t.label+JSON.stringify(t))}))}))}))}if(e.ua.onSession)e.ua.onSession(e);e.mediaStatsStarted=false;e.noAudioReportCount=0;e.reinviteForNoAudioSent=false;return e};t.patchIncomingSession=function(e){try{parseRcHeader(e)}catch(t){e.logger.error("Can't parse RC headers from invite request due to "+t)}e.canUseRCMCallControl=canUseRCMCallControl;e.createSessionMessage=createSessionMessage;e.sendSessionMessage=sendSessionMessage;e.sendReceiveConfirm=sendReceiveConfirm;e.ignore=ignore;e.toVoicemail=toVoicemail;e.replyWithMessage=replyWithMessage;e.receiveRequest=receiveRequest};var parseRcHeaderString=function(e){if(e===void 0){e=""}var t={};var r=e.split(/; */);r.forEach((function(e){var r=e.indexOf("=");if(r<0){return}var i=e.substr(0,r).trim();var n=e.substr(++r,e.length).trim();if(undefined===t[i]){t[i]=n}}));return t};var parseRcHeader=function(e){var t=e.request.headers["P-Rc"];var r=e.request.headers["P-Rc-Api-Call-Info"];if(t&&t.length){var i=t[0].raw;var n=new DOMParser;var a=n.parseFromString(i,"text/xml");var s=a.getElementsByTagName("Hdr")[0];var o=a.getElementsByTagName("Bdy")[0];if(s){e.rcHeaders={sid:s.getAttribute("SID"),request:s.getAttribute("Req"),from:s.getAttribute("From"),to:s.getAttribute("To")}}if(o){c.extend(e.rcHeaders,{srvLvl:o.getAttribute("SrvLvl"),srvLvlExt:o.getAttribute("SrvLvlExt"),nm:o.getAttribute("Nm"),toNm:o.getAttribute("ToNm")})}}if(r&&r.length){var u=r[0].raw;if(u){var l=parseRcHeaderString(u);c.extend(e.rcHeaders,l)}}};var p=2e3;function canUseRCMCallControl(){return!!this.rcHeaders}function createSessionMessage(e){if(!this.rcHeaders){return undefined}c.extend(e,{sid:this.rcHeaders.sid,request:this.rcHeaders.request,from:this.rcHeaders.to,to:this.rcHeaders.from});return this.ua.createRcMessage(e)}function ignore(){return i(this,void 0,void 0,(function(){var e=this;return n(this,(function(t){return[2,this._sendReceiveConfirmPromise.then((function(){return e.sendSessionMessage(o.messages.ignore)}))]}))}))}function sendSessionMessage(e){return i(this,void 0,void 0,(function(){return n(this,(function(t){if(!this.rcHeaders){this.logger.error("Can't send SIP MESSAGE related to session: no RC headers available")}return[2,this.ua.sendMessage(this.rcHeaders.from,this.createSessionMessage(e))]}))}))}function sendReceiveConfirm(){return i(this,void 0,void 0,(function(){return n(this,(function(e){return[2,this.sendSessionMessage(o.messages.receiveConfirm)]}))}))}function toVoicemail(){return i(this,void 0,void 0,(function(){var e=this;return n(this,(function(t){return[2,this._sendReceiveConfirmPromise.then((function(){return e.sendSessionMessage(o.messages.toVoicemail)}))]}))}))}function replyWithMessage(e){return i(this,void 0,void 0,(function(){var t;var r=this;return n(this,(function(i){t='RepTp="'+e.replyType+'"';if(e.replyType===0){t+=' Bdy="'+e.replyText+'"'}else if(e.replyType===1||e.replyType===4){t+=' Vl="'+e.timeValue+'"';t+=' Units="'+e.timeUnits+'"';t+=' Dir="'+e.callbackDirection+'"'}return[2,this._sendReceiveConfirmPromise.then((function(){return r.sendSessionMessage({reqid:o.messages.replyWithMessage.reqid,body:t})}))]}))}))}function sendReceive(e,t,r){return i(this,void 0,void 0,(function(){var i;return n(this,(function(n){r=r||{};c.extend(t,r);delete t.extraHeaders;return[2,new Promise((function(n,a){var u=(r.extraHeaders||[]).concat(e.ua.defaultHeaders).concat(["Content-Type: application/json;charset=utf-8"]);e.sendRequest(s.C.INFO,{body:JSON.stringify({request:t}),extraHeaders:u,receiveResponse:function(r){var s=null;if(r.statusCode===200){i=r.cseq;var onInfo_1=function(o){if(r.cseq!==i)return;var u=o&&o.body||"{}";var c;try{c=JSON.parse(u)}catch(e){c={}}if(c.response&&c.response.command===t.command){if(c.response.result){s&&clearTimeout(s);e.removeListener("RC_SIP_INFO",onInfo_1);if(c.response.result.code.toString()==="0"){return n(c.response.result)}return a(c.response.result)}}};s=setTimeout((function(){a(new Error("Timeout: no reply"));e.removeListener("RC_SIP_INFO",onInfo_1)}),o.responseTimeout);e.on("RC_SIP_INFO",onInfo_1)}else{a(new Error("The INFO response status code is: "+r.statusCode+" (waiting for 200)"))}}})}))]}))}))}function sendRequest(e,t){if(e===s.C.PRACK){return this}return this.__sendRequest(e,t)}function setRecord(e,t){return i(this,void 0,void 0,(function(){var r,i;return n(this,(function(n){switch(n.label){case 0:r=!!t?o.messages.startRecord:o.messages.stopRecord;if(!(e.__onRecord&&!t||!e.__onRecord&&t))return[3,2];return[4,sendReceive(e,r)];case 1:i=n.sent();e.__onRecord=!!t;return[2,i];case 2:return[2]}}))}))}function setLocalHold(e,t){return i(this,void 0,void 0,(function(){return n(this,(function(r){switch(r.label){case 0:if(!t)return[3,2];return[4,e.__hold()];case 1:r.sent();return[3,4];case 2:return[4,e.__unhold()];case 3:r.sent();r.label=4;case 4:return[2]}}))}))}function getIncomingInfoContent(e){if(!e||!e.body){return{}}var t={};try{t=JSON.parse(e.body)}catch(e){return{}}return t}function sendMoveResponse(e,t,r,i){if(i===void 0){i={}}var n=a(i.extraHeaders||[],this.ua.defaultHeaders,["Content-Type: application/json;charset=utf-8"]);this.sendRequest(s.C.INFO,{body:JSON.stringify({response:{reqId:e,command:"move",result:{code:t,description:r}}}),extraHeaders:n})}function receiveRequest(e){var t,r,i;switch(e.method){case s.C.UPDATE:this.logger.log("Receive UPDATE request. Do nothing just return 200 OK");e.reply(200);this.emit("updateReceived",e);return this;case s.C.INFO:var n=this.getIncomingInfoContent(e);if(((t=n===null||n===void 0?void 0:n.request)===null||t===void 0?void 0:t.reqId)&&((r=n===null||n===void 0?void 0:n.request)===null||r===void 0?void 0:r.command)==="move"&&((i=n===null||n===void 0?void 0:n.request)===null||i===void 0?void 0:i.target)==="rcv"){e.reply(200);this.emit("moveToRcv",n.request);return this}this.emit("RC_SIP_INFO",e);if(this.status===s.Session.C.STATUS_CONFIRMED||this.status===s.Session.C.STATUS_WAITING_FOR_ACK){var a=e.getHeader("content-type");if(a.match(/^application\/json/i)){e.reply(200);return this}}break}return this.__receiveRequest.apply(this,arguments)}function accept(e){var t=this;if(e===void 0){e={}}e=e||{};e.extraHeaders=(e.extraHeaders||[]).concat(this.ua.defaultHeaders);e.RTCConstraints=e.RTCConstraints||{optional:[{DtlsSrtpKeyAgreement:"true"}]};return new Promise((function(r,i){var onAnswered=function(){r(t);t.removeListener("failed",onFail)};var onFail=function(e){i(e);t.removeListener("accepted",onAnswered)};t.once("accepted",onAnswered);t.once("failed",onFail);t.__accept(e)}))}function dtmf(e,t,r){if(t===void 0){t=100}if(r===void 0){r=50}t=parseInt(t.toString());r=parseInt(r.toString());var i=this.sessionDescriptionHandler.peerConnection;var n=i.getSenders();var a=n.find((function(e){return e.track&&e.track.kind==="audio"}));var s=a.dtmf;if(s!==undefined&&s){this.logger.log("Send DTMF: "+e+" Duration: "+t+" InterToneGap: "+r);return s.insertDTMF(e,t,r)}var o=s&&!s.canInsertDTMF?"can't insert DTMF":"Unknown";throw new Error("Send DTMF failed: "+(!s?"no sender":o))}function sendReinvite(e){if(e===void 0){e={}}return i(this,void 0,void 0,(function(){var t,r,i;var a=this;return n(this,(function(n){switch(n.label){case 0:if(this.pendingReinvite){throw new Error("Reinvite in progress. Please wait until complete, then try again.")}if(!this.sessionDescriptionHandler){throw new Error("No SessionDescriptionHandler, can't send reinvite..")}this.pendingReinvite=true;e.modifiers=e.modifiers||[];n.label=1;case 1:n.trys.push([1,5,,6]);return[4,this.sessionDescriptionHandler.getDescription(e.sessionDescriptionHandlerOptions,e.modifiers)];case 2:t=n.sent();return[4,new Promise((function(e,r){a.sendRequest(s.C.INVITE,{body:t,receiveResponse:function(t){if(t.statusCode===200)e(t)}})}))];case 3:r=n.sent();return[4,this.receiveReinviteResponse(r)];case 4:n.sent();return[2,r];case 5:i=n.sent();this.pendingReinvite=false;throw new Error("Reinvite Failed with the reason "+i.message);case 6:return[2]}}))}))}function hold(){return i(this,void 0,void 0,(function(){var e,t,r;return n(this,(function(i){switch(i.label){case 0:if(this.status!==s.Session.C.STATUS_WAITING_FOR_ACK&&this.status!==s.Session.C.STATUS_CONFIRMED){throw new s.Exceptions.InvalidStateError(this.status)}if(this.localHold){throw new Error("Session already on hold")}this.stopMediaStats();e={modifiers:[]};e.modifiers.push(this.sessionDescriptionHandler.holdModifier);i.label=1;case 1:i.trys.push([1,3,,4]);this.logger.log("Hold Initiated");return[4,this._sendReinvite(e)];case 2:t=i.sent();this.localHold=t.statusCode===200&&this.sessionDescriptionHandler.getDirection()==="sendonly";this.logger.log("Hold completed, localhold is set to "+this.localHold);return[3,4];case 3:r=i.sent();throw new Error("Hold could not be completed");case 4:return[2]}}))}))}function unhold(){return i(this,void 0,void 0,(function(){var e,t;return n(this,(function(r){switch(r.label){case 0:if(this.status!==s.Session.C.STATUS_WAITING_FOR_ACK&&this.status!==s.Session.C.STATUS_CONFIRMED){throw new s.Exceptions.InvalidStateError(this.status)}if(!this.localHold){throw new Error("Session not on hold, cannot unhold")}r.label=1;case 1:r.trys.push([1,3,,4]);this.logger.log("Unhold Initiated");return[4,this._sendReinvite()];case 2:e=r.sent();this.localHold=e.statusCode===200&&this.sessionDescriptionHandler.getDirection()==="sendonly";this.logger.log("Unhold completed, localhold is set to "+this.localHold);return[3,4];case 3:t=r.sent();throw new Error("Unhold could not be completed");case 4:return[2]}}))}))}function blindTransfer(e,t){if(t===void 0){t={}}this.logger.log("Call transfer initiated");return Promise.resolve(this.refer(e,t))}function warmTransfer(e,t){if(t===void 0){t={}}return i(this,void 0,void 0,(function(){return n(this,(function(r){t.extraHeaders=(t.extraHeaders||[]).concat(this.ua.defaultHeaders);this.logger.log("Completing warm transfer");return[2,Promise.resolve(this.refer(e,t))]}))}))}function transfer(e,t){if(t===void 0){t={}}return i(this,void 0,void 0,(function(){return n(this,(function(r){t.extraHeaders=(t.extraHeaders||[]).concat(this.ua.defaultHeaders);return[2,this.blindTransfer(e,t)]}))}))}function forward(e,t,r){return i(this,void 0,void 0,(function(){var i;var a=this;return n(this,(function(n){switch(n.label){case 0:i=null;return[4,this.accept(t)];case 1:n.sent();return[2,new Promise((function(t){i=setInterval((function(){if(a.status===s.Session.C.STATUS_CONFIRMED){clearInterval(i);a.mute();setTimeout((function(){t(a.transfer(e,r))}),700)}}),50)}))]}}))}))}function startRecord(){return i(this,void 0,void 0,(function(){return n(this,(function(e){return[2,setRecord(this,true)]}))}))}function stopRecord(){return i(this,void 0,void 0,(function(){return n(this,(function(e){return[2,setRecord(this,false)]}))}))}function flip(e){return i(this,void 0,void 0,(function(){return n(this,(function(t){return[2,sendReceive(this,o.messages.flip,{target:e})]}))}))}function whisper(){return i(this,void 0,void 0,(function(){return n(this,(function(e){return[2,sendReceive(this,o.messages.whisper)]}))}))}function barge(){return i(this,void 0,void 0,(function(){return n(this,(function(e){return[2,sendReceive(this,o.messages.barge)]}))}))}function park(){return sendReceive(this,o.messages.park)}function reinvite(e,t){if(e===void 0){e={}}if(t===void 0){t=null}e.sessionDescriptionHandlerOptions=e.sessionDescriptionHandlerOptions||{};return this.__reinvite(e,t)}function toggleMute(e,t){var r=e.sessionDescriptionHandler.peerConnection;if(r.getSenders){r.getSenders().forEach((function(e){if(e.track){e.track.enabled=!t}}))}}function mute(e){if(this.status!==s.Session.C.STATUS_CONFIRMED){this.logger.warn("An active call is required to mute audio");return}this.logger.log("Muting Audio");if(!e){this.emit("muted",this)}return toggleMute(this,true)}function unmute(e){if(this.status!==s.Session.C.STATUS_CONFIRMED){this.logger.warn("An active call is required to unmute audio");return}this.logger.log("Unmuting Audio");if(!e){this.emit("unmuted",this)}return toggleMute(this,false)}function onLocalHold(){return this.localHold}function addTrack(e,t){var r=this;var i=this.sessionDescriptionHandler.peerConnection;var n;var a;if(e&&t){n=e;a=t}else if(this.media){n=this.media.remote;a=this.media.local}else{throw new Error("HTML Media Element not Defined")}var s=new MediaStream;if(i.getReceivers){i.getReceivers().forEach((function(e){var t=e.track;if(t){s.addTrack(t);r.logger.log("Remote track added")}}))}else{s=i.getRemoteStreams()[0];this.logger.log("Remote track added")}n.srcObject=s;n.play().catch((function(){r.logger.error("Remote play was rejected")}));var o=new MediaStream;if(i.getSenders){i.getSenders().forEach((function(e){var t=e.track;if(t&&t.kind==="audio"){o.addTrack(t);r.logger.log("Local track added")}}))}else{o=i.getLocalStreams()[0];this.logger.log("Local track added")}a.srcObject=o;a.play().catch((function(){r.logger.error("Local play was rejected")}));if(o&&s&&!this.mediaStatsStarted){this.mediaStreams=new l.MediaStreams(this);this.logger.log("Start gathering media report");this.mediaStatsStarted=true;this.mediaStreams.getMediaStats((function(e){if(r.ua.enableMediaReportLogging){r.logger.log("Got media report: "+JSON.stringify(e))}if(!r.reinviteForNoAudioSent&&f.isNoAudio(e)){r.logger.log("No audio report");r.noAudioReportCount++;if(r.noAudioReportCount===3){r.logger.log("No audio for 6 sec. Trying to recover audio by sending Re-invite");r.mediaStreams.reconnectMedia();r.reinviteForNoAudioSent=true;r.noAudioReportCount=0}}else if(!f.isNoAudio(e)){r.noAudioReportCount=0}}),p)}}function stopMediaStats(){this.logger.log("Stopping media stats collection");if(!this){return}this.mediaStreams&&this.mediaStreams.stopMediaStats();this.mediaStatsStarted=false;this.noAudioReportCount=0}},466849:function(e,t){"use strict";var r=this&&this.__awaiter||function(e,t,r,i){function adopt(e){return e instanceof r?e:new r((function(t){t(e)}))}return new(r||(r=Promise))((function(r,n){function fulfilled(e){try{step(i.next(e))}catch(e){n(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){n(e)}}function step(e){e.done?r(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};var i=this&&this.__generator||function(e,t){var r={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},i,n,a,s;return s={next:verb(0),throw:verb(1),return:verb(2)},typeof Symbol==="function"&&(s[Symbol.iterator]=function(){return this}),s;function verb(e){return function(t){return step([e,t])}}function step(s){if(i)throw new TypeError("Generator is already executing.");while(r)try{if(i=1,n&&(a=s[0]&2?n["return"]:s[0]?n["throw"]||((a=n["return"])&&a.call(n),0):n.next)&&!(a=a.call(n,s[1])).done)return a;if(n=0,a)s=[s[0]&2,a.value];switch(s[0]){case 0:case 1:a=s;break;case 4:r.label++;return{value:s[1],done:false};case 5:r.label++;n=s[1];s=[0];continue;case 7:s=r.ops.pop();r.trys.pop();continue;default:if(!(a=r.trys,a=a.length>0&&a[a.length-1])&&(s[0]===6||s[0]===2)){r=0;continue}if(s[0]===3&&(!a||s[1]>a[0]&&s[1]<a[3])){r.label=s[1];break}if(s[0]===6&&r.label<a[1]){r.label=a[1];a=s;break}if(a&&r.label<a[2]){r.label=a[2];r.ops.push(s);break}if(a[2])r.ops.pop();r.trys.pop();continue}s=t.call(e,r)}catch(e){s=[6,e];n=0}finally{i=a=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:true}}};Object.defineProperty(t,"__esModule",{value:true});t.TransportConstructorWrapper=void 0;t.TransportConstructorWrapper=function(e,t){return function(r,i){var n=new e(r,i);n.nextReconnectInterval=0;n.sipErrorCodes=t.sipErrorCodes;n.switchBackInterval=t.switchBackInterval;n.mainProxy=n.configuration.wsServers[0];n.computeRandomTimeout=computeRandomTimeout;n.reconnect=reconnect.bind(n);n.isSipErrorCode=isSipErrorCode.bind(n);n.scheduleSwitchBackMainProxy=scheduleSwitchBackMainProxy.bind(n);n.onSipErrorCode=onSipErrorCode.bind(n);n.__isCurrentMainProxy=__isCurrentMainProxy.bind(n);n.__afterWSConnected=__afterWSConnected.bind(n);n.__onConnectedToBackup=__onConnectedToBackup.bind(n);n.__onConnectedToMain=__onConnectedToMain.bind(n);n.__clearSwitchBackTimer=__clearSwitchBackTimer.bind(n);n.__connect=n.connect;n.connect=__connect.bind(n);n.on("connected",n.__afterWSConnected);return n}};var n={STATUS_CONNECTING:0,STATUS_OPEN:1,STATUS_CLOSING:2,STATUS_CLOSED:3};var computeRandomTimeout=function(e,t,r){if(e===void 0){e=1}if(t===void 0){t=0}if(r===void 0){r=0}if(t<0||r<0||e<1){throw new Error("Arguments must be positive numbers")}var i=Math.floor(Math.random()*Math.abs(r-t))+t;var n=(e-1)*(t+r)/2;return i+n};function __connect(e){return r(this,void 0,void 0,(function(){var t=this;return i(this,(function(n){switch(n.label){case 0:return[4,this.__connect(e).catch((function(e){return r(t,void 0,void 0,(function(){return i(this,(function(t){switch(t.label){case 0:this.emit("wsConnectionError",e);this.logger.warn("Connection Error occured. Trying to reconnect to websocket...");this.onError(e);this.disconnect({force:true});this.disposeWs();return[4,this.reconnect()];case 1:t.sent();return[2]}}))}))}))];case 1:return[2,n.sent()]}}))}))}function reconnect(e){return r(this,void 0,void 0,(function(){var t,r;var a=this;return i(this,(function(i){switch(i.label){case 0:if(this.reconnectionAttempts>0){this.logger.warn("Reconnection attempt "+this.reconnectionAttempts+" failed")}if(!e)return[3,3];this.logger.warn("forcing connect to main WS server");return[4,this.disconnect({force:true})];case 1:i.sent();this.server=this.getNextWsServer(true);this.reconnectionAttempts=0;return[4,this.connect()];case 2:i.sent();return[2];case 3:if(this.noAvailableServers()){this.logger.warn("no available ws servers left - going to closed state");this.status=n.STATUS_CLOSED;this.emit("closed");this.resetServerErrorStatus();this.server=this.getNextWsServer(true);this.__clearSwitchBackTimer();return[2]}if(!this.isConnected())return[3,6];this.logger.warn("attempted to reconnect while connected - forcing disconnect");return[4,this.disconnect({force:true})];case 4:i.sent();return[4,this.reconnect()];case 5:i.sent();return[2];case 6:t=(this.configuration.reconnectionTimeout-2)*1e3;r=(this.configuration.reconnectionTimeout+2)*1e3;this.reconnectionAttempts+=1;this.nextReconnectInterval=this.computeRandomTimeout(this.reconnectionAttempts,t,r);if(!(this.reconnectionAttempts>this.configuration.maxReconnectionAttempts))return[3,8];this.logger.warn("maximum reconnection attempts for WebSocket "+this.server.wsUri);this.logger.warn("transport "+this.server.wsUri+" failed | connection state set to 'error'");this.server.isError=true;this.emit("transportError");this.server=this.getNextWsServer();this.reconnectionAttempts=0;return[4,this.reconnect()];case 7:i.sent();return[3,9];case 8:this.logger.warn("trying to reconnect to WebSocket "+this.server.wsUri+" (reconnection attempt "+this.reconnectionAttempts+")");this.reconnectTimer=setTimeout((function(){a.connect();a.reconnectTimer=undefined}),this.nextReconnectInterval);this.logger.warn("next reconnection attempt in:"+Math.round(this.nextReconnectInterval/1e3)+" seconds.");i.label=9;case 9:return[2]}}))}))}function isSipErrorCode(e){var t=e.substring(0,e.indexOf("\r\n"));var r=t.split(" ")[1];return r&&this.sipErrorCodes&&this.sipErrorCodes.length&&this.sipErrorCodes.includes(r)}function scheduleSwitchBackMainProxy(){var e=this;var t=15*60*1e3;var r=this.switchBackInterval?this.switchBackInterval*1e3:null;if(r){r+=this.computeRandomTimeout(1,0,t);this.logger.warn("Try to switch back to main proxy after "+Math.round(r/1e3/60)+" min");this.mainProxy.switchBackTimer=setTimeout((function(){e.mainProxy.isError=false;e.mainProxy.switchBackTimer=null;e.logger.warn("switchBack initiated");e.emit("switchBackProxy")}),r)}else{this.logger.warn("switchBackInterval is not set. Will be switched with next provision update ")}}function onSipErrorCode(){return r(this,void 0,void 0,(function(){return i(this,(function(e){switch(e.label){case 0:this.logger.warn("Error received from the server. Disconnecting from the proxy");this.server.isError=true;this.emit("transportError");return[4,this.disconnect({force:true})];case 1:e.sent();this.server=this.getNextWsServer();this.reconnectionAttempts=0;return[2,this.reconnect()]}}))}))}function __isCurrentMainProxy(){return this.server===this.configuration.wsServers[0]}function __clearSwitchBackTimer(){if(this.mainProxy.switchBackTimer){clearTimeout(this.mainProxy.switchBackTimer);this.mainProxy.switchBackTimer=null}}function __onConnectedToMain(){this.__clearSwitchBackTimer()}function __onConnectedToBackup(){if(!this.mainProxy.switchBackTimer){this.scheduleSwitchBackMainProxy()}}function __afterWSConnected(){this.__isCurrentMainProxy()?this.__onConnectedToMain():this.__onConnectedToBackup()}},533260:function(e,t,r){"use strict";var i=this&&this.__assign||function(){i=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++){t=arguments[r];for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n))e[n]=t[n]}return e};return i.apply(this,arguments)};var n=this&&this.__spreadArrays||function(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;for(var i=Array(e),n=0,t=0;t<r;t++)for(var a=arguments[t],s=0,o=a.length;s<o;s++,n++)i[n]=a[s];return i};Object.defineProperty(t,"__esModule",{value:true});t.patchUserAgent=void 0;var a=r(405431);var s=r(812905);var o=r(466849);t.patchUserAgent=function(e,t,r,i){e.defaultHeaders=["P-rc-endpoint-id: "+i,"Client-id:"+r.appKey];e.media={};e.enableQos=r.enableQos;e.enableMediaReportLogging=r.enableMediaReportLogging;e.qosCollectInterval=r.qosCollectInterval||5e3;if(r.media&&(r.media.remote&&r.media.local)){e.media.remote=r.media.remote;e.media.local=r.media.local}else e.media=null;e.sipInfo=t;e.__invite=e.invite;e.invite=invite.bind(e);e.__register=e.register;e.register=register.bind(e);e.__unregister=e.unregister;e.unregister=unregister.bind(e);e.switchFrom=switchFrom.bind(e);e.audioHelper=new a.AudioHelper(r.audioHelper);e.__transportConstructor=e.configuration.transportConstructor;e.configuration.transportConstructor=o.TransportConstructorWrapper(e.__transportConstructor,r);e.onSession=r.onSession||null;e.createRcMessage=createRcMessage;e.sendMessage=sendMessage;e.__onTransportConnected=e.onTransportConnected;e.onTransportConnected=onTransportConnected.bind(e);e.on("invite",(function(t){e.audioHelper.playIncoming(true);s.patchSession(t);s.patchIncomingSession(t);t.logger.log("UA recieved incoming call invite");t._sendReceiveConfirmPromise=t.sendReceiveConfirm().then((function(){t.logger.log("sendReceiveConfirm success")})).catch((function(e){t.logger.error("failed to send receive confirmation via SIP MESSAGE due to "+e)}))}));e.on("registrationFailed",(function(t){if(!t){return}var r=t.data||t;if(r&&typeof r==="string"&&e.transport.isSipErrorCode(r)){e.transport.onSipErrorCode()}e.logger.warn("UA Registration Failed")}));e.on("notify",(function(t){var r=t.request;var i=r&&r.headers&&r.headers.Event&&r.headers.Event[0];if(i&&i.raw==="check-sync"){e.emit("provisionUpdate")}e.logger.log("UA recieved notify")}));e.start();return e};function onTransportConnected(){if(this.configuration.register){return this.register()}}function createRcMessage(e){e.body=e.body||"";return"<Msg>"+'<Hdr SID="'+e.sid+'" Req="'+e.request+'" From="'+e.from+'" To="'+e.to+'" Cmd="'+e.reqid+'"/> '+'<Bdy Cln="'+this.sipInfo.authorizationId+'" '+e.body+"/>"+"</Msg>"}function sendMessage(e,t){var r=this;var i={};i.contentType="x-rc/agent";i.extraHeaders=[];i.extraHeaders.push("P-rc-ws: "+this.contact);return new Promise((function(n,a){var s=r.message(e,t,i);s.once("accepted",(function(e,t){return n(e)}));s.once("failed",(function(e,t){return a(new Error(t))}))}))}function register(e){if(e===void 0){e={}}return this.__register.call(this,i(i({},e),{extraHeaders:n(e.extraHeaders||[],this.defaultHeaders)}))}function unregister(e){if(e===void 0){e={}}return this.__unregister.call(this,i(i({},e),{extraHeaders:n(e.extraHeaders||[],this.defaultHeaders)}))}function invite(e,t){if(t===void 0){t={}}t.extraHeaders=(t.extraHeaders||[]).concat(this.defaultHeaders);t.extraHeaders.push("P-Asserted-Identity: sip:"+(t.fromNumber||this.sipInfo.username)+"@"+this.sipInfo.domain);if(t.homeCountryId){t.extraHeaders.push("P-rc-country-id: "+t.homeCountryId)}t.RTCConstraints=t.RTCConstraints||{optional:[{DtlsSrtpKeyAgreement:"true"}]};this.audioHelper.playOutgoing(true);this.logger.log("Invite to "+e+" created with playOutgoing set to true");return s.patchSession(this.__invite(e,t))}function switchFrom(e,t){if(t===void 0){t={}}var r=[];r.push("Replaces: "+e.id+";to-tag="+e.sipData.fromTag+";from-tag="+e.sipData.toTag);r.push("RC-call-type: replace");var i=e.direction==="Outbound"?e.to:e.from;var n=e.direction==="Outbound"?e.from:e.to;t.extraHeaders=(t.extraHeaders||[]).concat(r);t.fromNumber=t.fromNumber||n;return this.invite(i,t)}},262714:function(e,t){"use strict";var r=this&&this.__awaiter||function(e,t,r,i){function adopt(e){return e instanceof r?e:new r((function(t){t(e)}))}return new(r||(r=Promise))((function(r,n){function fulfilled(e){try{step(i.next(e))}catch(e){n(e)}}function rejected(e){try{step(i["throw"](e))}catch(e){n(e)}}function step(e){e.done?r(e.value):adopt(e.value).then(fulfilled,rejected)}step((i=i.apply(e,t||[])).next())}))};var i=this&&this.__generator||function(e,t){var r={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},i,n,a,s;return s={next:verb(0),throw:verb(1),return:verb(2)},typeof Symbol==="function"&&(s[Symbol.iterator]=function(){return this}),s;function verb(e){return function(t){return step([e,t])}}function step(s){if(i)throw new TypeError("Generator is already executing.");while(r)try{if(i=1,n&&(a=s[0]&2?n["return"]:s[0]?n["throw"]||((a=n["return"])&&a.call(n),0):n.next)&&!(a=a.call(n,s[1])).done)return a;if(n=0,a)s=[s[0]&2,a.value];switch(s[0]){case 0:case 1:a=s;break;case 4:r.label++;return{value:s[1],done:false};case 5:r.label++;n=s[1];s=[0];continue;case 7:s=r.ops.pop();r.trys.pop();continue;default:if(!(a=r.trys,a=a.length>0&&a[a.length-1])&&(s[0]===6||s[0]===2)){r=0;continue}if(s[0]===3&&(!a||s[1]>a[0]&&s[1]<a[3])){r.label=s[1];break}if(s[0]===6&&r.label<a[1]){r.label=a[1];a=s;break}if(a&&r.label<a[2]){r.label=a[2];r.ops.push(s);break}if(a[2])r.ops.pop();r.trys.pop();continue}s=t.call(e,r)}catch(e){s=[6,e];n=0}finally{i=a=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:true}}};Object.defineProperty(t,"__esModule",{value:true});t.extend=t.delay=t.uuid=void 0;t.uuid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=Math.random()*16|0;var r=e==="x"?t:t&3|8;return r.toString(16)}))};t.delay=function(e){return r(void 0,void 0,void 0,(function(){return i(this,(function(t){return[2,new Promise((function(t){return setTimeout(t,e)}))]}))}))};t.extend=function(e,t){if(e===void 0){e={}}if(t===void 0){t={}}return Object.assign(e||{},t||{})}},513669:function(e,t,r){"use strict";var i=this&&this.__extends||function(){var extendStatics=function(e,t){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r]};return extendStatics(e,t)};return function(e,t){extendStatics(e,t);function __(){this.constructor=e}e.prototype=t===null?Object.create(t):(__.prototype=t.prototype,new __)}}();Object.defineProperty(t,"__esModule",{value:true});var n=r(850343);var a=r(846182);var s=r(130523);var o=r(15257);var u=r(130700);var c=r(669825);var l=function(e){i(ClientContext,e);function ClientContext(t,r,i,n){var a=e.call(this)||this;a.data={};ClientContext.initializer(a,t,r,i,n);return a}ClientContext.initializer=function(e,t,r,i,n){e.type=s.TypeStrings.ClientContext;if(i===undefined){throw new TypeError("Not enough arguments")}e.ua=t;e.logger=t.getLogger("sip.clientcontext");e.method=r;var a=t.normalizeTarget(i);if(!a){throw new TypeError("Invalid target: "+i)}n=Object.create(n||Object.prototype);n.extraHeaders=(n.extraHeaders||[]).slice();e.request=new u.OutgoingRequest(e.method,a,e.ua,n.params,n.extraHeaders);if(n.body){e.body={};e.body.body=n.body;if(n.contentType){e.body.contentType=n.contentType}e.request.body=e.body}if(e.request.from){e.localIdentity=e.request.from}if(e.request.to){e.remoteIdentity=e.request.to}};ClientContext.prototype.send=function(){var e=new o.RequestSender(this,this.ua);e.send();return this};ClientContext.prototype.receiveResponse=function(e){var t=e.statusCode||0;var r=c.Utils.getReasonPhrase(t);switch(true){case/^1[0-9]{2}$/.test(t.toString()):this.emit("progress",e,r);break;case/^2[0-9]{2}$/.test(t.toString()):if(this.ua.applicants[this.toString()]){delete this.ua.applicants[this.toString()]}this.emit("accepted",e,r);break;default:if(this.ua.applicants[this.toString()]){delete this.ua.applicants[this.toString()]}this.emit("rejected",e,r);this.emit("failed",e,r);break}};ClientContext.prototype.onRequestTimeout=function(){this.emit("failed",undefined,a.C.causes.REQUEST_TIMEOUT)};ClientContext.prototype.onTransportError=function(){this.emit("failed",undefined,a.C.causes.CONNECTION_ERROR)};return ClientContext}(n.EventEmitter);t.ClientContext=l},846182:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});var i=r(861508);var n;(function(e){e.USER_AGENT=i.title+"/"+i.version;e.SIP="sip";e.SIPS="sips";var t;(function(e){e["CONNECTION_ERROR"]="Connection Error";e["INTERNAL_ERROR"]="Internal Error";e["REQUEST_TIMEOUT"]="Request Timeout";e["SIP_FAILURE_CODE"]="SIP Failure Code";e["ADDRESS_INCOMPLETE"]="Address Incomplete";e["AUTHENTICATION_ERROR"]="Authentication Error";e["BUSY"]="Busy";e["DIALOG_ERROR"]="Dialog Error";e["INCOMPATIBLE_SDP"]="Incompatible SDP";e["NOT_FOUND"]="Not Found";e["REDIRECTED"]="Redirected";e["REJECTED"]="Rejected";e["UNAVAILABLE"]="Unavailable";e["BAD_MEDIA_DESCRIPTION"]="Bad Media Description";e["CANCELED"]="Canceled";e["EXPIRES"]="Expires";e["NO_ACK"]="No ACK";e["NO_ANSWER"]="No Answer";e["NO_PRACK"]="No PRACK";e["RTP_TIMEOUT"]="RTP Timeout";e["USER_DENIED_MEDIA_ACCESS"]="User Denied Media Access";e["WEBRTC_ERROR"]="WebRTC Error";e["WEBRTC_NOT_SUPPORTED"]="WebRTC Not Supported"})(t=e.causes||(e.causes={}));var r;(function(e){e["REQUIRED"]="required";e["SUPPORTED"]="supported";e["UNSUPPORTED"]="none"})(r=e.supported||(e.supported={}));e.SIP_ERROR_CAUSES={ADDRESS_INCOMPLETE:[484],AUTHENTICATION_ERROR:[401,407],BUSY:[486,600],INCOMPATIBLE_SDP:[488,606],NOT_FOUND:[404,604],REDIRECTED:[300,301,302,305,380],REJECTED:[403,603],UNAVAILABLE:[480,410,408,430]};e.ACK="ACK";e.BYE="BYE";e.CANCEL="CANCEL";e.INFO="INFO";e.INVITE="INVITE";e.MESSAGE="MESSAGE";e.NOTIFY="NOTIFY";e.OPTIONS="OPTIONS";e.REGISTER="REGISTER";e.UPDATE="UPDATE";e.SUBSCRIBE="SUBSCRIBE";e.PUBLISH="PUBLISH";e.REFER="REFER";e.PRACK="PRACK";e.REASON_PHRASE={100:"Trying",180:"Ringing",181:"Call Is Being Forwarded",182:"Queued",183:"Session Progress",199:"Early Dialog Terminated",200:"OK",202:"Accepted",204:"No Notification",300:"Multiple Choices",301:"Moved Permanently",302:"Moved Temporarily",305:"Use Proxy",380:"Alternative Service",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",410:"Gone",412:"Conditional Request Failed",413:"Request Entity Too Large",414:"Request-URI Too Long",415:"Unsupported Media Type",416:"Unsupported URI Scheme",417:"Unknown Resource-Priority",420:"Bad Extension",421:"Extension Required",422:"Session Interval Too Small",423:"Interval Too Brief",428:"Use Identity Header",429:"Provide Referrer Identity",430:"Flow Failed",433:"Anonymity Disallowed",436:"Bad Identity-Info",437:"Unsupported Certificate",438:"Invalid Identity Header",439:"First Hop Lacks Outbound Support",440:"Max-Breadth Exceeded",469:"Bad Info Package",470:"Consent Needed",478:"Unresolvable Destination",480:"Temporarily Unavailable",481:"Call/Transaction Does Not Exist",482:"Loop Detected",483:"Too Many Hops",484:"Address Incomplete",485:"Ambiguous",486:"Busy Here",487:"Request Terminated",488:"Not Acceptable Here",489:"Bad Event",491:"Request Pending",493:"Undecipherable",494:"Security Agreement Required",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Server Time-out",505:"Version Not Supported",513:"Message Too Large",580:"Precondition Failure",600:"Busy Everywhere",603:"Decline",604:"Does Not Exist Anywhere",606:"Not Acceptable"};e.OPTION_TAGS={"100rel":true,199:true,answermode:true,"early-session":true,eventlist:true,explicitsub:true,"from-change":true,"geolocation-http":true,"geolocation-sip":true,gin:true,gruu:true,histinfo:true,ice:true,join:true,"multiple-refer":true,norefersub:true,nosub:true,outbound:true,path:true,policy:true,precondition:true,pref:true,privacy:true,"recipient-list-invite":true,"recipient-list-message":true,"recipient-list-subscribe":true,replaces:true,"resource-priority":true,"sdp-anat":true,"sec-agree":true,tdialog:true,timer:true,uui:true};var n;(function(e){e["INFO"]="info";e["RTP"]="rtp"})(n=e.dtmfType||(e.dtmfType={}))})(n=t.C||(t.C={}))},122517:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});var i=r(846182);var n=r(130523);var a=r(15257);var s=r(130700);var o=function(){function Dialog(e,t,r,i){this.pracked=[];this.uacPendingReply=false;this.uasPendingReply=false;this.type=n.TypeStrings.Dialog;if(!t.hasHeader("contact")){throw new Error("unable to create a Dialog without Contact header field")}if(t.type===n.TypeStrings.IncomingResponse){var a=t.statusCode;i=a&&a<200?n.DialogStatus.STATUS_EARLY:n.DialogStatus.STATUS_CONFIRMED}else{i=i||n.DialogStatus.STATUS_CONFIRMED}var s=t.parseHeader("contact");if(r==="UAS"&&t.type===n.TypeStrings.IncomingRequest){this.id={callId:t.callId,localTag:t.toTag,remoteTag:t.fromTag,toString:function(){return t.callId+t.toTag+t.fromTag}};this.state=i;this.remoteSeqnum=t.cseq;this.localUri=(t.parseHeader("to")||{}).uri;this.remoteUri=(t.parseHeader("from")||{}).uri;this.remoteTarget=s.uri;this.routeSet=t.getHeaders("record-route");this.inviteSeqnum=t.cseq;this.localSeqnum=t.cseq}else{this.id={callId:t.callId,localTag:t.fromTag,remoteTag:t.toTag,toString:function(){return t.callId+t.fromTag+t.toTag}};this.state=i;this.inviteSeqnum=t.cseq;this.localSeqnum=t.cseq;this.localUri=t.parseHeader("from").uri;this.pracked=[];this.remoteUri=t.parseHeader("to").uri;this.remoteTarget=s.uri;this.routeSet=t.getHeaders("record-route").reverse()}this.logger=e.ua.getLogger("sip.dialog",this.id.toString());this.owner=e;e.ua.dialogs[this.id.toString()]=this;this.logger.log("new "+r+" dialog created with status "+(this.state===n.DialogStatus.STATUS_EARLY?"EARLY":"CONFIRMED"));e.emit("dialog",this)}Dialog.prototype.update=function(e,t){this.state=n.DialogStatus.STATUS_CONFIRMED;this.logger.log("dialog "+this.id.toString()+"  changed to CONFIRMED state");if(t==="UAC"){this.routeSet=e.getHeaders("record-route").reverse()}};Dialog.prototype.terminate=function(){this.logger.log("dialog "+this.id.toString()+" deleted");if(this.sessionDescriptionHandler&&this.state!==n.DialogStatus.STATUS_CONFIRMED){this.sessionDescriptionHandler.close()}delete this.owner.ua.dialogs[this.id.toString()]};Dialog.prototype.createRequest=function(e,t,r){if(t===void 0){t=[]}t=t.slice();if(!this.localSeqnum){this.localSeqnum=Math.floor(Math.random()*1e4)}var n=e===i.C.CANCEL||e===i.C.ACK?this.inviteSeqnum:this.localSeqnum+=1;var a=new s.OutgoingRequest(e,this.remoteTarget,this.owner.ua,{cseq:n,callId:this.id.callId,fromUri:this.localUri,fromTag:this.id.localTag,toIri:this.remoteUri,toTag:this.id.remoteTag,routeSet:this.routeSet},t,r);a.dialog=this;return a};Dialog.prototype.checkInDialogRequest=function(e){var t=this;if(!this.remoteSeqnum){this.remoteSeqnum=e.cseq}else if(e.cseq<this.remoteSeqnum){if(e.method!==i.C.ACK){e.reply(500)}return e.cseq===this.inviteSeqnum}switch(e.method){case i.C.INVITE:if(this.uacPendingReply===true){e.reply(491)}else if(this.uasPendingReply===true&&e.cseq>this.remoteSeqnum){var r=Math.floor(Math.random()*10)+1;e.reply(500,undefined,["Retry-After:"+r]);this.remoteSeqnum=e.cseq;return false}else{this.uasPendingReply=true;var stateChanged_1=function(){if(e.serverTransaction&&(e.serverTransaction.state===n.TransactionStatus.STATUS_ACCEPTED||e.serverTransaction.state===n.TransactionStatus.STATUS_COMPLETED||e.serverTransaction.state===n.TransactionStatus.STATUS_TERMINATED)){e.serverTransaction.removeListener("stateChanged",stateChanged_1);t.uasPendingReply=false}};if(e.serverTransaction){e.serverTransaction.on("stateChanged",stateChanged_1)}}if(e.hasHeader("contact")&&e.serverTransaction){e.serverTransaction.on("stateChanged",(function(){if(e.serverTransaction&&e.serverTransaction.state===n.TransactionStatus.STATUS_ACCEPTED){t.remoteTarget=e.parseHeader("contact").uri}}))}break;case i.C.NOTIFY:if(e.hasHeader("contact")&&e.serverTransaction){e.serverTransaction.on("stateChanged",(function(){if(e.serverTransaction&&e.serverTransaction.state===n.TransactionStatus.STATUS_COMPLETED){t.remoteTarget=e.parseHeader("contact").uri}}))}break}if(e.cseq>this.remoteSeqnum){this.remoteSeqnum=e.cseq}return true};Dialog.prototype.sendRequest=function(e,t,r){var s=this;if(r===void 0){r={}}var o=(r.extraHeaders||[]).slice();var u;if(r.body){if(r.body.body){u=r.body}else{u={};u.body=r.body;if(r.contentType){u.contentType=r.contentType}}}var c=this.createRequest(t,o,u);var dialogSend=function(t){var r=new a.RequestSender({request:c,onRequestTimeout:e.onRequestTimeout.bind(e),onTransportError:e.onTransportError.bind(e),receiveResponse:function(r){if(r.statusCode===408||r.statusCode===481){e.onDialogError(r)}else if(r.method===i.C.INVITE&&r.statusCode===491){if(t){e.receiveResponse(r)}else{c.cseq=s.localSeqnum+=1;setTimeout((function(){if(s.owner.status!==undefined&&s.owner.status!==n.SessionStatus.STATUS_TERMINATED){dialogSend(true)}}),1e3)}}else{e.receiveResponse(r)}}},s.owner.ua);r.send();if(!r.clientTransaction||r.clientTransaction.type===n.TypeStrings.AckClientTransaction){return}else if(c.method===i.C.INVITE&&r.clientTransaction&&r.clientTransaction.state!==n.TransactionStatus.STATUS_TERMINATED){s.uacPendingReply=true;var stateChanged_2=function(){var e=r.clientTransaction.state;if(!r.clientTransaction||r.clientTransaction.type===n.TypeStrings.AckClientTransaction){return}else if(r.clientTransaction&&(e===n.TransactionStatus.STATUS_ACCEPTED||e===n.TransactionStatus.STATUS_COMPLETED||e===n.TransactionStatus.STATUS_TERMINATED)){r.clientTransaction.removeListener("stateChanged",stateChanged_2);s.uacPendingReply=false}};r.clientTransaction.on("stateChanged",stateChanged_2)}};dialogSend(false);return c};Dialog.prototype.receiveRequest=function(e){if(!this.checkInDialogRequest(e)){return}this.owner.receiveRequest(e)};Dialog.C=n.DialogStatus;return Dialog}();t.Dialog=o},670109:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});var i=r(374678);var n=r(130523);var a=r(669825);var s=function(){function DigestAuthentication(e){this.type=n.TypeStrings.DigestAuthentication;this.logger=e.getLogger("sipjs.digestauthentication");this.username=e.configuration.authorizationUser;this.password=e.configuration.password;this.nc=0;this.ncHex="00000000"}DigestAuthentication.prototype.authenticate=function(e,t,r){this.algorithm=t.algorithm;this.realm=t.realm;this.nonce=t.nonce;this.opaque=t.opaque;this.stale=t.stale;if(this.algorithm){if(this.algorithm!=="MD5"){this.logger.warn("challenge with Digest algorithm different than 'MD5', authentication aborted");return false}}else{this.algorithm="MD5"}if(!this.realm){this.logger.warn("challenge without Digest realm, authentication aborted");return false}if(!this.nonce){this.logger.warn("challenge without Digest nonce, authentication aborted");return false}if(t.qop){if(t.qop.indexOf("auth")>-1){this.qop="auth"}else if(t.qop.indexOf("auth-int")>-1){this.qop="auth-int"}else{this.logger.warn("challenge without Digest qop different than 'auth' or 'auth-int', authentication aborted");return false}}else{this.qop=undefined}this.method=e.method;this.uri=e.ruri;this.cnonce=a.Utils.createRandomToken(12);this.nc+=1;this.updateNcHex();if(this.nc===4294967296){this.nc=1;this.ncHex="00000001"}this.calculateResponse(r);return true};DigestAuthentication.prototype.toString=function(){var e=[];if(!this.response){throw new Error("response field does not exist, cannot generate Authorization header")}e.push("algorithm="+this.algorithm);e.push('username="'+this.username+'"');e.push('realm="'+this.realm+'"');e.push('nonce="'+this.nonce+'"');e.push('uri="'+this.uri+'"');e.push('response="'+this.response+'"');if(this.opaque){e.push('opaque="'+this.opaque+'"')}if(this.qop){e.push("qop="+this.qop);e.push('cnonce="'+this.cnonce+'"');e.push("nc="+this.ncHex)}return"Digest "+e.join(", ")};DigestAuthentication.prototype.updateNcHex=function(){var e=Number(this.nc).toString(16);this.ncHex="00000000".substr(0,8-e.length)+e};DigestAuthentication.prototype.calculateResponse=function(e){var t;var r=i(this.username+":"+this.realm+":"+this.password);if(this.qop==="auth"){t=i(this.method+":"+this.uri);this.response=i(r+":"+this.nonce+":"+this.ncHex+":"+this.cnonce+":auth:"+t)}else if(this.qop==="auth-int"){t=i(this.method+":"+this.uri+":"+i(e?e:""));this.response=i(r+":"+this.nonce+":"+this.ncHex+":"+this.cnonce+":auth-int:"+t)}else if(this.qop===undefined){t=i(this.method+":"+this.uri);this.response=i(r+":"+this.nonce+":"+t)}};return DigestAuthentication}();t.DigestAuthentication=s},130523:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});var r;(function(e){e[e["STATUS_EARLY"]=1]="STATUS_EARLY";e[e["STATUS_CONFIRMED"]=2]="STATUS_CONFIRMED"})(r=t.DialogStatus||(t.DialogStatus={}));var i;(function(e){e[e["STATUS_NULL"]=0]="STATUS_NULL";e[e["STATUS_INVITE_SENT"]=1]="STATUS_INVITE_SENT";e[e["STATUS_1XX_RECEIVED"]=2]="STATUS_1XX_RECEIVED";e[e["STATUS_INVITE_RECEIVED"]=3]="STATUS_INVITE_RECEIVED";e[e["STATUS_WAITING_FOR_ANSWER"]=4]="STATUS_WAITING_FOR_ANSWER";e[e["STATUS_ANSWERED"]=5]="STATUS_ANSWERED";e[e["STATUS_WAITING_FOR_PRACK"]=6]="STATUS_WAITING_FOR_PRACK";e[e["STATUS_WAITING_FOR_ACK"]=7]="STATUS_WAITING_FOR_ACK";e[e["STATUS_CANCELED"]=8]="STATUS_CANCELED";e[e["STATUS_TERMINATED"]=9]="STATUS_TERMINATED";e[e["STATUS_ANSWERED_WAITING_FOR_PRACK"]=10]="STATUS_ANSWERED_WAITING_FOR_PRACK";e[e["STATUS_EARLY_MEDIA"]=11]="STATUS_EARLY_MEDIA";e[e["STATUS_CONFIRMED"]=12]="STATUS_CONFIRMED"})(i=t.SessionStatus||(t.SessionStatus={}));var n;(function(e){e[e["STATUS_TRYING"]=1]="STATUS_TRYING";e[e["STATUS_PROCEEDING"]=2]="STATUS_PROCEEDING";e[e["STATUS_CALLING"]=3]="STATUS_CALLING";e[e["STATUS_ACCEPTED"]=4]="STATUS_ACCEPTED";e[e["STATUS_COMPLETED"]=5]="STATUS_COMPLETED";e[e["STATUS_TERMINATED"]=6]="STATUS_TERMINATED";e[e["STATUS_CONFIRMED"]=7]="STATUS_CONFIRMED"})(n=t.TransactionStatus||(t.TransactionStatus={}));var a;(function(e){e[e["AckClientTransaction"]=0]="AckClientTransaction";e[e["ClientContext"]=1]="ClientContext";e[e["ConfigurationError"]=2]="ConfigurationError";e[e["Dialog"]=3]="Dialog";e[e["DigestAuthentication"]=4]="DigestAuthentication";e[e["DTMF"]=5]="DTMF";e[e["IncomingMessage"]=6]="IncomingMessage";e[e["IncomingRequest"]=7]="IncomingRequest";e[e["IncomingResponse"]=8]="IncomingResponse";e[e["InvalidStateError"]=9]="InvalidStateError";e[e["InviteClientContext"]=10]="InviteClientContext";e[e["InviteClientTransaction"]=11]="InviteClientTransaction";e[e["InviteServerContext"]=12]="InviteServerContext";e[e["InviteServerTransaction"]=13]="InviteServerTransaction";e[e["Logger"]=14]="Logger";e[e["LoggerFactory"]=15]="LoggerFactory";e[e["MethodParameterError"]=16]="MethodParameterError";e[e["NameAddrHeader"]=17]="NameAddrHeader";e[e["NonInviteClientTransaction"]=18]="NonInviteClientTransaction";e[e["NonInviteServerTransaction"]=19]="NonInviteServerTransaction";e[e["NotSupportedError"]=20]="NotSupportedError";e[e["OutgoingRequest"]=21]="OutgoingRequest";e[e["Parameters"]=22]="Parameters";e[e["PublishContext"]=23]="PublishContext";e[e["ReferClientContext"]=24]="ReferClientContext";e[e["ReferServerContext"]=25]="ReferServerContext";e[e["RegisterContext"]=26]="RegisterContext";e[e["RenegotiationError"]=27]="RenegotiationError";e[e["RequestSender"]=28]="RequestSender";e[e["ServerContext"]=29]="ServerContext";e[e["Session"]=30]="Session";e[e["SessionDescriptionHandler"]=31]="SessionDescriptionHandler";e[e["SessionDescriptionHandlerError"]=32]="SessionDescriptionHandlerError";e[e["SessionDescriptionHandlerObserver"]=33]="SessionDescriptionHandlerObserver";e[e["Subscription"]=34]="Subscription";e[e["Transport"]=35]="Transport";e[e["TransportError"]=36]="TransportError";e[e["UA"]=37]="UA";e[e["URI"]=38]="URI"})(a=t.TypeStrings||(t.TypeStrings={}));var s;(function(e){e[e["STATUS_INIT"]=0]="STATUS_INIT";e[e["STATUS_STARTING"]=1]="STATUS_STARTING";e[e["STATUS_READY"]=2]="STATUS_READY";e[e["STATUS_USER_CLOSED"]=3]="STATUS_USER_CLOSED";e[e["STATUS_NOT_READY"]=4]="STATUS_NOT_READY"})(s=t.UAStatus||(t.UAStatus={}))},325840:function(e,t,r){"use strict";var i=this&&this.__extends||function(){var extendStatics=function(e,t){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r]};return extendStatics(e,t)};return function(e,t){extendStatics(e,t);function __(){this.constructor=e}e.prototype=t===null?Object.create(t):(__.prototype=t.prototype,new __)}}();Object.defineProperty(t,"__esModule",{value:true});var n=r(130523);var a=function(e){i(Exception,e);function Exception(t,r,i){var n=e.call(this,i)||this;n.code=t;n.name=r;n.message=i;return n}return Exception}(Error);var s;(function(e){var t=function(e){i(ConfigurationError,e);function ConfigurationError(t,r){var i=e.call(this,1,"CONFIGURATION_ERROR",!r?"Missing parameter: "+t:"Invalid value "+JSON.stringify(r)+" for parameter '"+t+"'")||this;i.type=n.TypeStrings.ConfigurationError;i.parameter=t;i.value=r;return i}return ConfigurationError}(a);e.ConfigurationError=t;var r=function(e){i(InvalidStateError,e);function InvalidStateError(t){var r=e.call(this,2,"INVALID_STATE_ERROR","Invalid status: "+t)||this;r.type=n.TypeStrings.InvalidStateError;r.status=t;return r}return InvalidStateError}(a);e.InvalidStateError=r;var s=function(e){i(NotSupportedError,e);function NotSupportedError(t){var r=e.call(this,3,"NOT_SUPPORTED_ERROR",t)||this;r.type=n.TypeStrings.NotSupportedError;return r}return NotSupportedError}(a);e.NotSupportedError=s;var o=function(e){i(RenegotiationError,e);function RenegotiationError(t){var r=e.call(this,5,"RENEGOTIATION_ERROR",t)||this;r.type=n.TypeStrings.RenegotiationError;return r}return RenegotiationError}(a);e.RenegotiationError=o;var u=function(e){i(MethodParameterError,e);function MethodParameterError(t,r,i){var a=e.call(this,6,"METHOD_PARAMETER_ERROR",!i?"Missing parameter: "+r:"Invalid value "+JSON.stringify(i)+" for parameter '"+r+"'")||this;a.type=n.TypeStrings.MethodParameterError;a.method=t;a.parameter=r;a.value=i;return a}return MethodParameterError}(a);e.MethodParameterError=u;var c=function(e){i(TransportError,e);function TransportError(t){var r=e.call(this,7,"TRANSPORT_ERROR",t)||this;r.type=n.TypeStrings.TransportError;return r}return TransportError}(a);e.TransportError=c;var l=function(e){i(SessionDescriptionHandlerError,e);function SessionDescriptionHandlerError(t,r,i){var a=e.call(this,8,"SESSION_DESCRIPTION_HANDLER_ERROR",i||"Error with Session Description Handler")||this;a.type=n.TypeStrings.SessionDescriptionHandlerError;a.method=t;a.error=r;return a}return SessionDescriptionHandlerError}(a);e.SessionDescriptionHandlerError=l})(s=t.Exceptions||(t.Exceptions={}))},179089:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});var i=r(630775);var n;(function(e){function parse(e,t){var r={startRule:t};try{i.parse(e,r)}catch(e){r.data=-1}return r.data}e.parse=parse;function nameAddrHeaderParse(t){var r=e.parse(t,"Name_Addr_Header");return r!==-1?r:undefined}e.nameAddrHeaderParse=nameAddrHeaderParse;function URIParse(t){var r=e.parse(t,"SIP_URI");return r!==-1?r:undefined}e.URIParse=URIParse})(n=t.Grammar||(t.Grammar={}))},630775:function(e,t,r){"use strict";var i=this&&this.__extends||function(){var extendStatics=function(e,t){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r]};return extendStatics(e,t)};return function(e,t){extendStatics(e,t);function __(){this.constructor=e}e.prototype=t===null?Object.create(t):(__.prototype=t.prototype,new __)}}();Object.defineProperty(t,"__esModule",{value:true});var n=r(444881);var a=r(822049);var s=function(e){i(SyntaxError,e);function SyntaxError(t,r,i,n){var a=e.call(this)||this;a.message=t;a.expected=r;a.found=i;a.location=n;a.name="SyntaxError";if(typeof Error.captureStackTrace==="function"){Error.captureStackTrace(a,SyntaxError)}return a}SyntaxError.buildMessage=function(e,t){function hex(e){return e.charCodeAt(0).toString(16).toUpperCase()}function literalEscape(e){return e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(e){return"\\x0"+hex(e)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(e){return"\\x"+hex(e)}))}function classEscape(e){return e.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(e){return"\\x0"+hex(e)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(e){return"\\x"+hex(e)}))}function describeExpectation(e){switch(e.type){case"literal":return'"'+literalEscape(e.text)+'"';case"class":var t=e.parts.map((function(e){return Array.isArray(e)?classEscape(e[0])+"-"+classEscape(e[1]):classEscape(e)}));return"["+(e.inverted?"^":"")+t+"]";case"any":return"any character";case"end":return"end of input";case"other":return e.description}}function describeExpected(e){var t=e.map(describeExpectation);var r;var i;t.sort();if(t.length>0){for(r=1,i=1;r<t.length;r++){if(t[r-1]!==t[r]){t[i]=t[r];i++}}t.length=i}switch(t.length){case 1:return t[0];case 2:return t[0]+" or "+t[1];default:return t.slice(0,-1).join(", ")+", or "+t[t.length-1]}}function describeFound(e){return e?'"'+literalEscape(e)+'"':"end of input"}return"Expected "+describeExpected(e)+" but "+describeFound(t)+" found."};return SyntaxError}(Error);t.SyntaxError=s;function peg$parse(e,t){t=t!==undefined?t:{};var r={};var i={Contact:peg$parseContact,Name_Addr_Header:peg$parseName_Addr_Header,Record_Route:peg$parseRecord_Route,Request_Response:peg$parseRequest_Response,SIP_URI:peg$parseSIP_URI,Subscription_State:peg$parseSubscription_State,Supported:peg$parseSupported,Require:peg$parseRequire,Via:peg$parseVia,absoluteURI:peg$parseabsoluteURI,Call_ID:peg$parseCall_ID,Content_Disposition:peg$parseContent_Disposition,Content_Length:peg$parseContent_Length,Content_Type:peg$parseContent_Type,CSeq:peg$parseCSeq,displayName:peg$parsedisplayName,Event:peg$parseEvent,From:peg$parseFrom,host:peg$parsehost,Max_Forwards:peg$parseMax_Forwards,Min_SE:peg$parseMin_SE,Proxy_Authenticate:peg$parseProxy_Authenticate,quoted_string:peg$parsequoted_string,Refer_To:peg$parseRefer_To,Replaces:peg$parseReplaces,Session_Expires:peg$parseSession_Expires,stun_URI:peg$parsestun_URI,To:peg$parseTo,turn_URI:peg$parseturn_URI,uuid:peg$parseuuid,WWW_Authenticate:peg$parseWWW_Authenticate,challenge:peg$parsechallenge,sipfrag:peg$parsesipfrag,Referred_By:peg$parseReferred_By};var o=peg$parseContact;var u="\r\n";var c=peg$literalExpectation("\r\n",false);var l=/^[0-9]/;var f=peg$classExpectation([["0","9"]],false,false);var p=/^[a-zA-Z]/;var d=peg$classExpectation([["a","z"],["A","Z"]],false,false);var h=/^[0-9a-fA-F]/;var g=peg$classExpectation([["0","9"],["a","f"],["A","F"]],false,false);var v=/^[\0-\xFF]/;var m=peg$classExpectation([["\0","\xff"]],false,false);var y=/^["]/;var S=peg$classExpectation(['"'],false,false);var T=" ";var b=peg$literalExpectation(" ",false);var _="\t";var C=peg$literalExpectation("\t",false);var A=/^[a-zA-Z0-9]/;var E=peg$classExpectation([["a","z"],["A","Z"],["0","9"]],false,false);var I=";";var R=peg$literalExpectation(";",false);var w="/";var $=peg$literalExpectation("/",false);var x="?";var O=peg$literalExpectation("?",false);var D=":";var k=peg$literalExpectation(":",false);var N="@";var U=peg$literalExpectation("@",false);var L="&";var P=peg$literalExpectation("&",false);var M="=";var H=peg$literalExpectation("=",false);var q="+";var j=peg$literalExpectation("+",false);var F="$";var B=peg$literalExpectation("$",false);var W=",";var G=peg$literalExpectation(",",false);var z="-";var K=peg$literalExpectation("-",false);var V="_";var Y=peg$literalExpectation("_",false);var Q=".";var J=peg$literalExpectation(".",false);var X="!";var Z=peg$literalExpectation("!",false);var ee="~";var te=peg$literalExpectation("~",false);var re="*";var ie=peg$literalExpectation("*",false);var ne="'";var ae=peg$literalExpectation("'",false);var se="(";var oe=peg$literalExpectation("(",false);var ue=")";var ce=peg$literalExpectation(")",false);var le="%";var fe=peg$literalExpectation("%",false);var peg$c58=function(){return" "};var peg$c59=function(){return":"};var pe=/^[!-~]/;var de=peg$classExpectation([["!","~"]],false,false);var he=/^[\x80-\uFFFF]/;var ge=peg$classExpectation([["\x80","\uffff"]],false,false);var ve=/^[\x80-\xBF]/;var me=peg$classExpectation([["\x80","\xbf"]],false,false);var ye=/^[a-f]/;var Se=peg$classExpectation([["a","f"]],false,false);var Te="`";var be=peg$literalExpectation("`",false);var _e="<";var Ce=peg$literalExpectation("<",false);var Ae=">";var Ee=peg$literalExpectation(">",false);var Ie="\\";var Re=peg$literalExpectation("\\",false);var we="[";var $e=peg$literalExpectation("[",false);var xe="]";var Oe=peg$literalExpectation("]",false);var De="{";var ke=peg$literalExpectation("{",false);var Ne="}";var Ue=peg$literalExpectation("}",false);var peg$c84=function(){return"*"};var peg$c85=function(){return"/"};var peg$c86=function(){return"="};var peg$c87=function(){return"("};var peg$c88=function(){return")"};var peg$c89=function(){return">"};var peg$c90=function(){return"<"};var peg$c91=function(){return","};var peg$c92=function(){return";"};var peg$c93=function(){return":"};var peg$c94=function(){return'"'};var Le=/^[!-']/;var Pe=peg$classExpectation([["!","'"]],false,false);var Me=/^[*-[]/;var He=peg$classExpectation([["*","["]],false,false);var qe=/^[\]-~]/;var je=peg$classExpectation([["]","~"]],false,false);var peg$c101=function(e){return e};var Fe=/^[#-[]/;var Be=peg$classExpectation([["#","["]],false,false);var We=/^[\0-\t]/;var Ge=peg$classExpectation([["\0","\t"]],false,false);var ze=/^[\x0B-\f]/;var Ke=peg$classExpectation([["\v","\f"]],false,false);var Ve=/^[\x0E-\x7F]/;var Ye=peg$classExpectation([["\x0e","\x7f"]],false,false);var peg$c110=function(){t=t||{data:{}};t.data.uri=new a.URI(t.data.scheme,t.data.user,t.data.host,t.data.port);delete t.data.scheme;delete t.data.user;delete t.data.host;delete t.data.host_type;delete t.data.port};var peg$c111=function(){t=t||{data:{}};t.data.uri=new a.URI(t.data.scheme,t.data.user,t.data.host,t.data.port,t.data.uri_params,t.data.uri_headers);delete t.data.scheme;delete t.data.user;delete t.data.host;delete t.data.host_type;delete t.data.port;delete t.data.uri_params;if(t.startRule==="SIP_URI"){t.data=t.data.uri}};var Qe="sips";var Je=peg$literalExpectation("sips",true);var Xe="sip";var Ze=peg$literalExpectation("sip",true);var peg$c116=function(e){t=t||{data:{}};t.data.scheme=e};var peg$c117=function(){t=t||{data:{}};t.data.user=decodeURIComponent(text().slice(0,-1))};var peg$c118=function(){t=t||{data:{}};t.data.password=text()};var peg$c119=function(){t=t||{data:{}};t.data.host=text();return t.data.host};var peg$c120=function(){t=t||{data:{}};t.data.host_type="domain";return text()};var et=/^[a-zA-Z0-9_\-]/;var tt=peg$classExpectation([["a","z"],["A","Z"],["0","9"],"_","-"],false,false);var rt=/^[a-zA-Z0-9\-]/;var it=peg$classExpectation([["a","z"],["A","Z"],["0","9"],"-"],false,false);var peg$c125=function(){t=t||{data:{}};t.data.host_type="IPv6";return text()};var nt="::";var at=peg$literalExpectation("::",false);var peg$c128=function(){t=t||{data:{}};t.data.host_type="IPv6";return text()};var peg$c129=function(){t=t||{data:{}};t.data.host_type="IPv4";return text()};var st="25";var ot=peg$literalExpectation("25",false);var ut=/^[0-5]/;var ct=peg$classExpectation([["0","5"]],false,false);var lt="2";var ft=peg$literalExpectation("2",false);var pt=/^[0-4]/;var dt=peg$classExpectation([["0","4"]],false,false);var ht="1";var gt=peg$literalExpectation("1",false);var vt=/^[1-9]/;var mt=peg$classExpectation([["1","9"]],false,false);var peg$c142=function(e){t=t||{data:{}};e=parseInt(e.join(""));t.data.port=e;return e};var yt="transport=";var St=peg$literalExpectation("transport=",true);var Tt="udp";var bt=peg$literalExpectation("udp",true);var _t="tcp";var Ct=peg$literalExpectation("tcp",true);var At="sctp";var Et=peg$literalExpectation("sctp",true);var It="tls";var Rt=peg$literalExpectation("tls",true);var peg$c153=function(e){t=t||{data:{}};if(!t.data.uri_params)t.data.uri_params={};t.data.uri_params["transport"]=e.toLowerCase()};var wt="user=";var $t=peg$literalExpectation("user=",true);var xt="phone";var Ot=peg$literalExpectation("phone",true);var Dt="ip";var kt=peg$literalExpectation("ip",true);var peg$c160=function(e){t=t||{data:{}};if(!t.data.uri_params)t.data.uri_params={};t.data.uri_params["user"]=e.toLowerCase()};var Nt="method=";var Ut=peg$literalExpectation("method=",true);var peg$c163=function(e){t=t||{data:{}};if(!t.data.uri_params)t.data.uri_params={};t.data.uri_params["method"]=e};var Lt="ttl=";var Pt=peg$literalExpectation("ttl=",true);var peg$c166=function(e){t=t||{data:{}};if(!t.data.params)t.data.params={};t.data.params["ttl"]=e};var Mt="maddr=";var Ht=peg$literalExpectation("maddr=",true);var peg$c169=function(e){t=t||{data:{}};if(!t.data.uri_params)t.data.uri_params={};t.data.uri_params["maddr"]=e};var qt="lr";var jt=peg$literalExpectation("lr",true);var peg$c172=function(){t=t||{data:{}};if(!t.data.uri_params)t.data.uri_params={};t.data.uri_params["lr"]=undefined};var peg$c173=function(e,r){t=t||{data:{}};if(!t.data.uri_params)t.data.uri_params={};if(r===null){r=undefined}else{r=r[1]}t.data.uri_params[e.toLowerCase()]=r};var peg$c174=function(e,r){e=e.join("").toLowerCase();r=r.join("");t=t||{data:{}};if(!t.data.uri_headers)t.data.uri_headers={};if(!t.data.uri_headers[e]){t.data.uri_headers[e]=[r]}else{t.data.uri_headers[e].push(r)}};var peg$c175=function(){t=t||{data:{}};if(t.startRule==="Refer_To"){t.data.uri=new a.URI(t.data.scheme,t.data.user,t.data.host,t.data.port,t.data.uri_params,t.data.uri_headers);delete t.data.scheme;delete t.data.user;delete t.data.host;delete t.data.host_type;delete t.data.port;delete t.data.uri_params}};var Ft="//";var Bt=peg$literalExpectation("//",false);var peg$c178=function(){t=t||{data:{}};t.data.scheme=text()};var Wt=peg$literalExpectation("SIP",true);var peg$c180=function(){t=t||{data:{}};t.data.sip_version=text()};var Gt="INVITE";var zt=peg$literalExpectation("INVITE",false);var Kt="ACK";var Vt=peg$literalExpectation("ACK",false);var Yt="VXACH";var Qt=peg$literalExpectation("VXACH",false);var Jt="OPTIONS";var Xt=peg$literalExpectation("OPTIONS",false);var Zt="BYE";var er=peg$literalExpectation("BYE",false);var tr="CANCEL";var rr=peg$literalExpectation("CANCEL",false);var ir="REGISTER";var nr=peg$literalExpectation("REGISTER",false);var ar="SUBSCRIBE";var sr=peg$literalExpectation("SUBSCRIBE",false);var or="NOTIFY";var ur=peg$literalExpectation("NOTIFY",false);var cr="REFER";var lr=peg$literalExpectation("REFER",false);var fr="PUBLISH";var pr=peg$literalExpectation("PUBLISH",false);var peg$c203=function(){t=t||{data:{}};t.data.method=text();return t.data.method};var peg$c204=function(e){t=t||{data:{}};t.data.status_code=parseInt(e.join(""))};var peg$c205=function(){t=t||{data:{}};t.data.reason_phrase=text()};var peg$c206=function(){t=t||{data:{}};t.data=text()};var peg$c207=function(){var e,r;t=t||{data:{}};r=t.data.multi_header.length;for(e=0;e<r;e++){if(t.data.multi_header[e].parsed===null){t.data=null;break}}if(t.data!==null){t.data=t.data.multi_header}else{t.data=-1}};var peg$c208=function(){var e;t=t||{data:{}};if(!t.data.multi_header)t.data.multi_header=[];try{e=new n.NameAddrHeader(t.data.uri,t.data.displayName,t.data.params);delete t.data.uri;delete t.data.displayName;delete t.data.params}catch(t){e=null}t.data.multi_header.push({position:Mn,offset:location().start.offset,parsed:e})};var peg$c209=function(e){e=text().trim();if(e[0]==='"'){e=e.substring(1,e.length-1)}t=t||{data:{}};t.data.displayName=e};var dr="q";var hr=peg$literalExpectation("q",true);var peg$c212=function(e){t=t||{data:{}};if(!t.data.params)t.data.params={};t.data.params["q"]=e};var gr="expires";var vr=peg$literalExpectation("expires",true);var peg$c215=function(e){t=t||{data:{}};if(!t.data.params)t.data.params={};t.data.params["expires"]=e};var peg$c216=function(e){return parseInt(e.join(""))};var mr="0";var yr=peg$literalExpectation("0",false);var peg$c219=function(){return parseFloat(text())};var peg$c220=function(e,r){t=t||{data:{}};if(!t.data.params)t.data.params={};if(r===null){r=undefined}else{r=r[1]}t.data.params[e.toLowerCase()]=r};var Sr="render";var Tr=peg$literalExpectation("render",true);var br="session";var _r=peg$literalExpectation("session",true);var Cr="icon";var Ar=peg$literalExpectation("icon",true);var Er="alert";var Ir=peg$literalExpectation("alert",true);var peg$c229=function(){t=t||{data:{}};if(t.startRule==="Content_Disposition"){t.data.type=text().toLowerCase()}};var Rr="handling";var wr=peg$literalExpectation("handling",true);var $r="optional";var xr=peg$literalExpectation("optional",true);var Or="required";var Dr=peg$literalExpectation("required",true);var peg$c236=function(e){t=t||{data:{}};t.data=parseInt(e.join(""))};var peg$c237=function(){t=t||{data:{}};t.data=text()};var kr="text";var Nr=peg$literalExpectation("text",true);var Ur="image";var Lr=peg$literalExpectation("image",true);var Pr="audio";var Mr=peg$literalExpectation("audio",true);var Hr="video";var qr=peg$literalExpectation("video",true);var jr="application";var Fr=peg$literalExpectation("application",true);var Br="message";var Wr=peg$literalExpectation("message",true);var Gr="multipart";var zr=peg$literalExpectation("multipart",true);var Kr="x-";var Vr=peg$literalExpectation("x-",true);var peg$c254=function(e){t=t||{data:{}};t.data.value=parseInt(e.join(""))};var peg$c255=function(e){t=t||{data:{}};t.data=e};var peg$c256=function(e){t=t||{data:{}};t.data.event=e.toLowerCase()};var peg$c257=function(){t=t||{data:{}};var e=t.data.tag;t.data=new n.NameAddrHeader(t.data.uri,t.data.displayName,t.data.params);if(e){t.data.setParam("tag",e)}};var Yr="tag";var Qr=peg$literalExpectation("tag",true);var peg$c260=function(e){t=t||{data:{}};t.data.tag=e};var peg$c261=function(e){t=t||{data:{}};t.data=parseInt(e.join(""))};var peg$c262=function(e){t=t||{data:{}};t.data=e};var peg$c263=function(){t=t||{data:{}};t.data=new n.NameAddrHeader(t.data.uri,t.data.displayName,t.data.params)};var Jr="digest";var Xr=peg$literalExpectation("Digest",true);var Zr="realm";var ei=peg$literalExpectation("realm",true);var peg$c268=function(e){t=t||{data:{}};t.data.realm=e};var ti="domain";var ri=peg$literalExpectation("domain",true);var ii="nonce";var ni=peg$literalExpectation("nonce",true);var peg$c273=function(e){t=t||{data:{}};t.data.nonce=e};var ai="opaque";var si=peg$literalExpectation("opaque",true);var peg$c276=function(e){t=t||{data:{}};t.data.opaque=e};var oi="stale";var ui=peg$literalExpectation("stale",true);var ci="true";var li=peg$literalExpectation("true",true);var peg$c281=function(){t=t||{data:{}};t.data.stale=true};var fi="false";var pi=peg$literalExpectation("false",true);var peg$c284=function(){t=t||{data:{}};t.data.stale=false};var di="algorithm";var hi=peg$literalExpectation("algorithm",true);var gi="md5";var vi=peg$literalExpectation("MD5",true);var mi="md5-sess";var yi=peg$literalExpectation("MD5-sess",true);var peg$c291=function(e){t=t||{data:{}};t.data.algorithm=e.toUpperCase()};var Si="qop";var Ti=peg$literalExpectation("qop",true);var bi="auth-int";var _i=peg$literalExpectation("auth-int",true);var Ci="auth";var Ai=peg$literalExpectation("auth",true);var peg$c298=function(e){t=t||{data:{}};t.data.qop||(t.data.qop=[]);t.data.qop.push(e.toLowerCase())};var peg$c299=function(e){t=t||{data:{}};t.data.value=parseInt(e.join(""))};var peg$c300=function(){var e,r;t=t||{data:{}};r=t.data.multi_header.length;for(e=0;e<r;e++){if(t.data.multi_header[e].parsed===null){t.data=null;break}}if(t.data!==null){t.data=t.data.multi_header}else{t.data=-1}};var peg$c301=function(){var e;t=t||{data:{}};if(!t.data.multi_header)t.data.multi_header=[];try{e=new n.NameAddrHeader(t.data.uri,t.data.displayName,t.data.params);delete t.data.uri;delete t.data.displayName;delete t.data.params}catch(t){e=null}t.data.multi_header.push({position:Mn,offset:location().start.offset,parsed:e})};var peg$c302=function(){t=t||{data:{}};t.data=new n.NameAddrHeader(t.data.uri,t.data.displayName,t.data.params)};var peg$c303=function(){t=t||{data:{}};if(!(t.data.replaces_from_tag&&t.data.replaces_to_tag)){t.data=-1}};var peg$c304=function(){t=t||{data:{}};t.data={call_id:t.data}};var Ei="from-tag";var Ii=peg$literalExpectation("from-tag",true);var peg$c307=function(e){t=t||{data:{}};t.data.replaces_from_tag=e};var Ri="to-tag";var wi=peg$literalExpectation("to-tag",true);var peg$c310=function(e){t=t||{data:{}};t.data.replaces_to_tag=e};var $i="early-only";var xi=peg$literalExpectation("early-only",true);var peg$c313=function(){t=t||{data:{}};t.data.early_only=true};var peg$c314=function(e,t){return t};var peg$c315=function(e,t){return list(e,t)};var peg$c316=function(e){t=t||{data:{}};if(t.startRule==="Require"){t.data=e||[]}};var peg$c317=function(e){t=t||{data:{}};t.data.value=parseInt(e.join(""))};var Oi="active";var Di=peg$literalExpectation("active",true);var ki="pending";var Ni=peg$literalExpectation("pending",true);var Ui="terminated";var Li=peg$literalExpectation("terminated",true);var peg$c324=function(){t=t||{data:{}};t.data.state=text()};var Pi="reason";var Mi=peg$literalExpectation("reason",true);var peg$c327=function(e){t=t||{data:{}};if(typeof e!=="undefined")t.data.reason=e};var peg$c328=function(e){t=t||{data:{}};if(typeof e!=="undefined")t.data.expires=e};var Hi="retry_after";var qi=peg$literalExpectation("retry_after",true);var peg$c331=function(e){t=t||{data:{}};if(typeof e!=="undefined")t.data.retry_after=e};var ji="deactivated";var Fi=peg$literalExpectation("deactivated",true);var Bi="probation";var Wi=peg$literalExpectation("probation",true);var Gi="rejected";var zi=peg$literalExpectation("rejected",true);var Ki="timeout";var Vi=peg$literalExpectation("timeout",true);var Yi="giveup";var Qi=peg$literalExpectation("giveup",true);var Ji="noresource";var Xi=peg$literalExpectation("noresource",true);var Zi="invariant";var en=peg$literalExpectation("invariant",true);var peg$c346=function(e){t=t||{data:{}};if(t.startRule==="Supported"){t.data=e||[]}};var peg$c347=function(){t=t||{data:{}};var e=t.data.tag;t.data=new n.NameAddrHeader(t.data.uri,t.data.displayName,t.data.params);if(e){t.data.setParam("tag",e)}};var tn="ttl";var rn=peg$literalExpectation("ttl",true);var peg$c350=function(e){t=t||{data:{}};t.data.ttl=e};var nn="maddr";var an=peg$literalExpectation("maddr",true);var peg$c353=function(e){t=t||{data:{}};t.data.maddr=e};var sn="received";var on=peg$literalExpectation("received",true);var peg$c356=function(e){t=t||{data:{}};t.data.received=e};var un="branch";var cn=peg$literalExpectation("branch",true);var peg$c359=function(e){t=t||{data:{}};t.data.branch=e};var ln="rport";var fn=peg$literalExpectation("rport",true);var peg$c362=function(e){t=t||{data:{}};if(typeof e!=="undefined")t.data.rport=e.join("")};var peg$c363=function(e){t=t||{data:{}};t.data.protocol=e};var pn=peg$literalExpectation("UDP",true);var dn=peg$literalExpectation("TCP",true);var hn=peg$literalExpectation("TLS",true);var gn=peg$literalExpectation("SCTP",true);var peg$c368=function(e){t=t||{data:{}};t.data.transport=e};var peg$c369=function(){t=t||{data:{}};t.data.host=text()};var peg$c370=function(e){t=t||{data:{}};t.data.port=parseInt(e.join(""))};var peg$c371=function(e){return parseInt(e.join(""))};var peg$c372=function(e){t=t||{data:{}};if(t.startRule==="Session_Expires"){t.data.deltaSeconds=e}};var vn="refresher";var mn=peg$literalExpectation("refresher",false);var yn="uas";var Sn=peg$literalExpectation("uas",false);var Tn="uac";var bn=peg$literalExpectation("uac",false);var peg$c379=function(e){t=t||{data:{}};if(t.startRule==="Session_Expires"){t.data.refresher=e}};var peg$c380=function(e){t=t||{data:{}};if(t.startRule==="Min_SE"){t.data=e}};var _n="stuns";var Cn=peg$literalExpectation("stuns",true);var An="stun";var En=peg$literalExpectation("stun",true);var peg$c385=function(e){t=t||{data:{}};t.data.scheme=e};var peg$c386=function(e){t=t||{data:{}};t.data.host=e};var In="?transport=";var Rn=peg$literalExpectation("?transport=",false);var wn="turns";var $n=peg$literalExpectation("turns",true);var xn="turn";var On=peg$literalExpectation("turn",true);var peg$c393=function(e){t=t||{data:{}};t.data.transport=e};var peg$c394=function(){t=t||{data:{}};t.data=text()};var Dn="Referred-By";var kn=peg$literalExpectation("Referred-By",false);var Nn="b";var Un=peg$literalExpectation("b",false);var Ln="cid";var Pn=peg$literalExpectation("cid",false);var Mn=0;var Hn=0;var qn=[{line:1,column:1}];var jn=0;var Fn=[];var Bn=0;var Wn;if(t.startRule!==undefined){if(!(t.startRule in i)){throw new Error("Can't start parsing from rule \""+t.startRule+'".')}o=i[t.startRule]}function text(){return e.substring(Hn,Mn)}function location(){return peg$computeLocation(Hn,Mn)}function expected(t,r){r=r!==undefined?r:peg$computeLocation(Hn,Mn);throw peg$buildStructuredError([peg$otherExpectation(t)],e.substring(Hn,Mn),r)}function error(e,t){t=t!==undefined?t:peg$computeLocation(Hn,Mn);throw peg$buildSimpleError(e,t)}function peg$literalExpectation(e,t){return{type:"literal",text:e,ignoreCase:t}}function peg$classExpectation(e,t,r){return{type:"class",parts:e,inverted:t,ignoreCase:r}}function peg$anyExpectation(){return{type:"any"}}function peg$endExpectation(){return{type:"end"}}function peg$otherExpectation(e){return{type:"other",description:e}}function peg$computePosDetails(t){var r=qn[t];var i;if(r){return r}else{i=t-1;while(!qn[i]){i--}r=qn[i];r={line:r.line,column:r.column};while(i<t){if(e.charCodeAt(i)===10){r.line++;r.column=1}else{r.column++}i++}qn[t]=r;return r}}function peg$computeLocation(e,t){var r=peg$computePosDetails(e);var i=peg$computePosDetails(t);return{start:{offset:e,line:r.line,column:r.column},end:{offset:t,line:i.line,column:i.column}}}function peg$fail(e){if(Mn<jn){return}if(Mn>jn){jn=Mn;Fn=[]}Fn.push(e)}function peg$buildSimpleError(e,t){return new s(e,[],"",t)}function peg$buildStructuredError(e,t,r){return new s(s.buildMessage(e,t),e,t,r)}function peg$parseCRLF(){var t;if(e.substr(Mn,2)===u){t=u;Mn+=2}else{t=r;if(Bn===0){peg$fail(c)}}return t}function peg$parseDIGIT(){var t;if(l.test(e.charAt(Mn))){t=e.charAt(Mn);Mn++}else{t=r;if(Bn===0){peg$fail(f)}}return t}function peg$parseALPHA(){var t;if(p.test(e.charAt(Mn))){t=e.charAt(Mn);Mn++}else{t=r;if(Bn===0){peg$fail(d)}}return t}function peg$parseHEXDIG(){var t;if(h.test(e.charAt(Mn))){t=e.charAt(Mn);Mn++}else{t=r;if(Bn===0){peg$fail(g)}}return t}function peg$parseWSP(){var e;e=peg$parseSP();if(e===r){e=peg$parseHTAB()}return e}function peg$parseOCTET(){var t;if(v.test(e.charAt(Mn))){t=e.charAt(Mn);Mn++}else{t=r;if(Bn===0){peg$fail(m)}}return t}function peg$parseDQUOTE(){var t;if(y.test(e.charAt(Mn))){t=e.charAt(Mn);Mn++}else{t=r;if(Bn===0){peg$fail(S)}}return t}function peg$parseSP(){var t;if(e.charCodeAt(Mn)===32){t=T;Mn++}else{t=r;if(Bn===0){peg$fail(b)}}return t}function peg$parseHTAB(){var t;if(e.charCodeAt(Mn)===9){t=_;Mn++}else{t=r;if(Bn===0){peg$fail(C)}}return t}function peg$parsealphanum(){var t;if(A.test(e.charAt(Mn))){t=e.charAt(Mn);Mn++}else{t=r;if(Bn===0){peg$fail(E)}}return t}function peg$parsereserved(){var t;if(e.charCodeAt(Mn)===59){t=I;Mn++}else{t=r;if(Bn===0){peg$fail(R)}}if(t===r){if(e.charCodeAt(Mn)===47){t=w;Mn++}else{t=r;if(Bn===0){peg$fail($)}}if(t===r){if(e.charCodeAt(Mn)===63){t=x;Mn++}else{t=r;if(Bn===0){peg$fail(O)}}if(t===r){if(e.charCodeAt(Mn)===58){t=D;Mn++}else{t=r;if(Bn===0){peg$fail(k)}}if(t===r){if(e.charCodeAt(Mn)===64){t=N;Mn++}else{t=r;if(Bn===0){peg$fail(U)}}if(t===r){if(e.charCodeAt(Mn)===38){t=L;Mn++}else{t=r;if(Bn===0){peg$fail(P)}}if(t===r){if(e.charCodeAt(Mn)===61){t=M;Mn++}else{t=r;if(Bn===0){peg$fail(H)}}if(t===r){if(e.charCodeAt(Mn)===43){t=q;Mn++}else{t=r;if(Bn===0){peg$fail(j)}}if(t===r){if(e.charCodeAt(Mn)===36){t=F;Mn++}else{t=r;if(Bn===0){peg$fail(B)}}if(t===r){if(e.charCodeAt(Mn)===44){t=W;Mn++}else{t=r;if(Bn===0){peg$fail(G)}}}}}}}}}}}return t}function peg$parseunreserved(){var e;e=peg$parsealphanum();if(e===r){e=peg$parsemark()}return e}function peg$parsemark(){var t;if(e.charCodeAt(Mn)===45){t=z;Mn++}else{t=r;if(Bn===0){peg$fail(K)}}if(t===r){if(e.charCodeAt(Mn)===95){t=V;Mn++}else{t=r;if(Bn===0){peg$fail(Y)}}if(t===r){if(e.charCodeAt(Mn)===46){t=Q;Mn++}else{t=r;if(Bn===0){peg$fail(J)}}if(t===r){if(e.charCodeAt(Mn)===33){t=X;Mn++}else{t=r;if(Bn===0){peg$fail(Z)}}if(t===r){if(e.charCodeAt(Mn)===126){t=ee;Mn++}else{t=r;if(Bn===0){peg$fail(te)}}if(t===r){if(e.charCodeAt(Mn)===42){t=re;Mn++}else{t=r;if(Bn===0){peg$fail(ie)}}if(t===r){if(e.charCodeAt(Mn)===39){t=ne;Mn++}else{t=r;if(Bn===0){peg$fail(ae)}}if(t===r){if(e.charCodeAt(Mn)===40){t=se;Mn++}else{t=r;if(Bn===0){peg$fail(oe)}}if(t===r){if(e.charCodeAt(Mn)===41){t=ue;Mn++}else{t=r;if(Bn===0){peg$fail(ce)}}}}}}}}}}return t}function peg$parseescaped(){var t,i,n,a,s;t=Mn;i=Mn;if(e.charCodeAt(Mn)===37){n=le;Mn++}else{n=r;if(Bn===0){peg$fail(fe)}}if(n!==r){a=peg$parseHEXDIG();if(a!==r){s=peg$parseHEXDIG();if(s!==r){n=[n,a,s];i=n}else{Mn=i;i=r}}else{Mn=i;i=r}}else{Mn=i;i=r}if(i!==r){t=e.substring(t,Mn)}else{t=i}return t}function peg$parseLWS(){var e,t,i,n;e=Mn;t=Mn;i=[];n=peg$parseWSP();while(n!==r){i.push(n);n=peg$parseWSP()}if(i!==r){n=peg$parseCRLF();if(n!==r){i=[i,n];t=i}else{Mn=t;t=r}}else{Mn=t;t=r}if(t===r){t=null}if(t!==r){i=[];n=peg$parseWSP();if(n!==r){while(n!==r){i.push(n);n=peg$parseWSP()}}else{i=r}if(i!==r){Hn=e;t=peg$c58();e=t}else{Mn=e;e=r}}else{Mn=e;e=r}return e}function peg$parseSWS(){var e;e=peg$parseLWS();if(e===r){e=null}return e}function peg$parseHCOLON(){var t,i,n,a;t=Mn;i=[];n=peg$parseSP();if(n===r){n=peg$parseHTAB()}while(n!==r){i.push(n);n=peg$parseSP();if(n===r){n=peg$parseHTAB()}}if(i!==r){if(e.charCodeAt(Mn)===58){n=D;Mn++}else{n=r;if(Bn===0){peg$fail(k)}}if(n!==r){a=peg$parseSWS();if(a!==r){Hn=t;i=peg$c59();t=i}else{Mn=t;t=r}}else{Mn=t;t=r}}else{Mn=t;t=r}return t}function peg$parseTEXT_UTF8_TRIM(){var t,i,n,a,s,o,u;t=Mn;i=Mn;n=[];a=peg$parseTEXT_UTF8char();if(a!==r){while(a!==r){n.push(a);a=peg$parseTEXT_UTF8char()}}else{n=r}if(n!==r){a=[];s=Mn;o=[];u=peg$parseLWS();while(u!==r){o.push(u);u=peg$parseLWS()}if(o!==r){u=peg$parseTEXT_UTF8char();if(u!==r){o=[o,u];s=o}else{Mn=s;s=r}}else{Mn=s;s=r}while(s!==r){a.push(s);s=Mn;o=[];u=peg$parseLWS();while(u!==r){o.push(u);u=peg$parseLWS()}if(o!==r){u=peg$parseTEXT_UTF8char();if(u!==r){o=[o,u];s=o}else{Mn=s;s=r}}else{Mn=s;s=r}}if(a!==r){n=[n,a];i=n}else{Mn=i;i=r}}else{Mn=i;i=r}if(i!==r){t=e.substring(t,Mn)}else{t=i}return t}function peg$parseTEXT_UTF8char(){var t;if(pe.test(e.charAt(Mn))){t=e.charAt(Mn);Mn++}else{t=r;if(Bn===0){peg$fail(de)}}if(t===r){t=peg$parseUTF8_NONASCII()}return t}function peg$parseUTF8_NONASCII(){var t;if(he.test(e.charAt(Mn))){t=e.charAt(Mn);Mn++}else{t=r;if(Bn===0){peg$fail(ge)}}return t}function peg$parseUTF8_CONT(){var t;if(ve.test(e.charAt(Mn))){t=e.charAt(Mn);Mn++}else{t=r;if(Bn===0){peg$fail(me)}}return t}function peg$parseLHEX(){var t;t=peg$parseDIGIT();if(t===r){if(ye.test(e.charAt(Mn))){t=e.charAt(Mn);Mn++}else{t=r;if(Bn===0){peg$fail(Se)}}}return t}function peg$parsetoken(){var t,i,n;t=Mn;i=[];n=peg$parsealphanum();if(n===r){if(e.charCodeAt(Mn)===45){n=z;Mn++}else{n=r;if(Bn===0){peg$fail(K)}}if(n===r){if(e.charCodeAt(Mn)===46){n=Q;Mn++}else{n=r;if(Bn===0){peg$fail(J)}}if(n===r){if(e.charCodeAt(Mn)===33){n=X;Mn++}else{n=r;if(Bn===0){peg$fail(Z)}}if(n===r){if(e.charCodeAt(Mn)===37){n=le;Mn++}else{n=r;if(Bn===0){peg$fail(fe)}}if(n===r){if(e.charCodeAt(Mn)===42){n=re;Mn++}else{n=r;if(Bn===0){peg$fail(ie)}}if(n===r){if(e.charCodeAt(Mn)===95){n=V;Mn++}else{n=r;if(Bn===0){peg$fail(Y)}}if(n===r){if(e.charCodeAt(Mn)===43){n=q;Mn++}else{n=r;if(Bn===0){peg$fail(j)}}if(n===r){if(e.charCodeAt(Mn)===96){n=Te;Mn++}else{n=r;if(Bn===0){peg$fail(be)}}if(n===r){if(e.charCodeAt(Mn)===39){n=ne;Mn++}else{n=r;if(Bn===0){peg$fail(ae)}}if(n===r){if(e.charCodeAt(Mn)===126){n=ee;Mn++}else{n=r;if(Bn===0){peg$fail(te)}}}}}}}}}}}}if(n!==r){while(n!==r){i.push(n);n=peg$parsealphanum();if(n===r){if(e.charCodeAt(Mn)===45){n=z;Mn++}else{n=r;if(Bn===0){peg$fail(K)}}if(n===r){if(e.charCodeAt(Mn)===46){n=Q;Mn++}else{n=r;if(Bn===0){peg$fail(J)}}if(n===r){if(e.charCodeAt(Mn)===33){n=X;Mn++}else{n=r;if(Bn===0){peg$fail(Z)}}if(n===r){if(e.charCodeAt(Mn)===37){n=le;Mn++}else{n=r;if(Bn===0){peg$fail(fe)}}if(n===r){if(e.charCodeAt(Mn)===42){n=re;Mn++}else{n=r;if(Bn===0){peg$fail(ie)}}if(n===r){if(e.charCodeAt(Mn)===95){n=V;Mn++}else{n=r;if(Bn===0){peg$fail(Y)}}if(n===r){if(e.charCodeAt(Mn)===43){n=q;Mn++}else{n=r;if(Bn===0){peg$fail(j)}}if(n===r){if(e.charCodeAt(Mn)===96){n=Te;Mn++}else{n=r;if(Bn===0){peg$fail(be)}}if(n===r){if(e.charCodeAt(Mn)===39){n=ne;Mn++}else{n=r;if(Bn===0){peg$fail(ae)}}if(n===r){if(e.charCodeAt(Mn)===126){n=ee;Mn++}else{n=r;if(Bn===0){peg$fail(te)}}}}}}}}}}}}}}else{i=r}if(i!==r){t=e.substring(t,Mn)}else{t=i}return t}function peg$parsetoken_nodot(){var t,i,n;t=Mn;i=[];n=peg$parsealphanum();if(n===r){if(e.charCodeAt(Mn)===45){n=z;Mn++}else{n=r;if(Bn===0){peg$fail(K)}}if(n===r){if(e.charCodeAt(Mn)===33){n=X;Mn++}else{n=r;if(Bn===0){peg$fail(Z)}}if(n===r){if(e.charCodeAt(Mn)===37){n=le;Mn++}else{n=r;if(Bn===0){peg$fail(fe)}}if(n===r){if(e.charCodeAt(Mn)===42){n=re;Mn++}else{n=r;if(Bn===0){peg$fail(ie)}}if(n===r){if(e.charCodeAt(Mn)===95){n=V;Mn++}else{n=r;if(Bn===0){peg$fail(Y)}}if(n===r){if(e.charCodeAt(Mn)===43){n=q;Mn++}else{n=r;if(Bn===0){peg$fail(j)}}if(n===r){if(e.charCodeAt(Mn)===96){n=Te;Mn++}else{n=r;if(Bn===0){peg$fail(be)}}if(n===r){if(e.charCodeAt(Mn)===39){n=ne;Mn++}else{n=r;if(Bn===0){peg$fail(ae)}}if(n===r){if(e.charCodeAt(Mn)===126){n=ee;Mn++}else{n=r;if(Bn===0){peg$fail(te)}}}}}}}}}}}if(n!==r){while(n!==r){i.push(n);n=peg$parsealphanum();if(n===r){if(e.charCodeAt(Mn)===45){n=z;Mn++}else{n=r;if(Bn===0){peg$fail(K)}}if(n===r){if(e.charCodeAt(Mn)===33){n=X;Mn++}else{n=r;if(Bn===0){peg$fail(Z)}}if(n===r){if(e.charCodeAt(Mn)===37){n=le;Mn++}else{n=r;if(Bn===0){peg$fail(fe)}}if(n===r){if(e.charCodeAt(Mn)===42){n=re;Mn++}else{n=r;if(Bn===0){peg$fail(ie)}}if(n===r){if(e.charCodeAt(Mn)===95){n=V;Mn++}else{n=r;if(Bn===0){peg$fail(Y)}}if(n===r){if(e.charCodeAt(Mn)===43){n=q;Mn++}else{n=r;if(Bn===0){peg$fail(j)}}if(n===r){if(e.charCodeAt(Mn)===96){n=Te;Mn++}else{n=r;if(Bn===0){peg$fail(be)}}if(n===r){if(e.charCodeAt(Mn)===39){n=ne;Mn++}else{n=r;if(Bn===0){peg$fail(ae)}}if(n===r){if(e.charCodeAt(Mn)===126){n=ee;Mn++}else{n=r;if(Bn===0){peg$fail(te)}}}}}}}}}}}}}else{i=r}if(i!==r){t=e.substring(t,Mn)}else{t=i}return t}function peg$parseseparators(){var t;if(e.charCodeAt(Mn)===40){t=se;Mn++}else{t=r;if(Bn===0){peg$fail(oe)}}if(t===r){if(e.charCodeAt(Mn)===41){t=ue;Mn++}else{t=r;if(Bn===0){peg$fail(ce)}}if(t===r){if(e.charCodeAt(Mn)===60){t=_e;Mn++}else{t=r;if(Bn===0){peg$fail(Ce)}}if(t===r){if(e.charCodeAt(Mn)===62){t=Ae;Mn++}else{t=r;if(Bn===0){peg$fail(Ee)}}if(t===r){if(e.charCodeAt(Mn)===64){t=N;Mn++}else{t=r;if(Bn===0){peg$fail(U)}}if(t===r){if(e.charCodeAt(Mn)===44){t=W;Mn++}else{t=r;if(Bn===0){peg$fail(G)}}if(t===r){if(e.charCodeAt(Mn)===59){t=I;Mn++}else{t=r;if(Bn===0){peg$fail(R)}}if(t===r){if(e.charCodeAt(Mn)===58){t=D;Mn++}else{t=r;if(Bn===0){peg$fail(k)}}if(t===r){if(e.charCodeAt(Mn)===92){t=Ie;Mn++}else{t=r;if(Bn===0){peg$fail(Re)}}if(t===r){t=peg$parseDQUOTE();if(t===r){if(e.charCodeAt(Mn)===47){t=w;Mn++}else{t=r;if(Bn===0){peg$fail($)}}if(t===r){if(e.charCodeAt(Mn)===91){t=we;Mn++}else{t=r;if(Bn===0){peg$fail($e)}}if(t===r){if(e.charCodeAt(Mn)===93){t=xe;Mn++}else{t=r;if(Bn===0){peg$fail(Oe)}}if(t===r){if(e.charCodeAt(Mn)===63){t=x;Mn++}else{t=r;if(Bn===0){peg$fail(O)}}if(t===r){if(e.charCodeAt(Mn)===61){t=M;Mn++}else{t=r;if(Bn===0){peg$fail(H)}}if(t===r){if(e.charCodeAt(Mn)===123){t=De;Mn++}else{t=r;if(Bn===0){peg$fail(ke)}}if(t===r){if(e.charCodeAt(Mn)===125){t=Ne;Mn++}else{t=r;if(Bn===0){peg$fail(Ue)}}if(t===r){t=peg$parseSP();if(t===r){t=peg$parseHTAB()}}}}}}}}}}}}}}}}}}return t}function peg$parseword(){var t,i,n;t=Mn;i=[];n=peg$parsealphanum();if(n===r){if(e.charCodeAt(Mn)===45){n=z;Mn++}else{n=r;if(Bn===0){peg$fail(K)}}if(n===r){if(e.charCodeAt(Mn)===46){n=Q;Mn++}else{n=r;if(Bn===0){peg$fail(J)}}if(n===r){if(e.charCodeAt(Mn)===33){n=X;Mn++}else{n=r;if(Bn===0){peg$fail(Z)}}if(n===r){if(e.charCodeAt(Mn)===37){n=le;Mn++}else{n=r;if(Bn===0){peg$fail(fe)}}if(n===r){if(e.charCodeAt(Mn)===42){n=re;Mn++}else{n=r;if(Bn===0){peg$fail(ie)}}if(n===r){if(e.charCodeAt(Mn)===95){n=V;Mn++}else{n=r;if(Bn===0){peg$fail(Y)}}if(n===r){if(e.charCodeAt(Mn)===43){n=q;Mn++}else{n=r;if(Bn===0){peg$fail(j)}}if(n===r){if(e.charCodeAt(Mn)===96){n=Te;Mn++}else{n=r;if(Bn===0){peg$fail(be)}}if(n===r){if(e.charCodeAt(Mn)===39){n=ne;Mn++}else{n=r;if(Bn===0){peg$fail(ae)}}if(n===r){if(e.charCodeAt(Mn)===126){n=ee;Mn++}else{n=r;if(Bn===0){peg$fail(te)}}if(n===r){if(e.charCodeAt(Mn)===40){n=se;Mn++}else{n=r;if(Bn===0){peg$fail(oe)}}if(n===r){if(e.charCodeAt(Mn)===41){n=ue;Mn++}else{n=r;if(Bn===0){peg$fail(ce)}}if(n===r){if(e.charCodeAt(Mn)===60){n=_e;Mn++}else{n=r;if(Bn===0){peg$fail(Ce)}}if(n===r){if(e.charCodeAt(Mn)===62){n=Ae;Mn++}else{n=r;if(Bn===0){peg$fail(Ee)}}if(n===r){if(e.charCodeAt(Mn)===58){n=D;Mn++}else{n=r;if(Bn===0){peg$fail(k)}}if(n===r){if(e.charCodeAt(Mn)===92){n=Ie;Mn++}else{n=r;if(Bn===0){peg$fail(Re)}}if(n===r){n=peg$parseDQUOTE();if(n===r){if(e.charCodeAt(Mn)===47){n=w;Mn++}else{n=r;if(Bn===0){peg$fail($)}}if(n===r){if(e.charCodeAt(Mn)===91){n=we;Mn++}else{n=r;if(Bn===0){peg$fail($e)}}if(n===r){if(e.charCodeAt(Mn)===93){n=xe;Mn++}else{n=r;if(Bn===0){peg$fail(Oe)}}if(n===r){if(e.charCodeAt(Mn)===63){n=x;Mn++}else{n=r;if(Bn===0){peg$fail(O)}}if(n===r){if(e.charCodeAt(Mn)===123){n=De;Mn++}else{n=r;if(Bn===0){peg$fail(ke)}}if(n===r){if(e.charCodeAt(Mn)===125){n=Ne;Mn++}else{n=r;if(Bn===0){peg$fail(Ue)}}}}}}}}}}}}}}}}}}}}}}}}}if(n!==r){while(n!==r){i.push(n);n=peg$parsealphanum();if(n===r){if(e.charCodeAt(Mn)===45){n=z;Mn++}else{n=r;if(Bn===0){peg$fail(K)}}if(n===r){if(e.charCodeAt(Mn)===46){n=Q;Mn++}else{n=r;if(Bn===0){peg$fail(J)}}if(n===r){if(e.charCodeAt(Mn)===33){n=X;Mn++}else{n=r;if(Bn===0){peg$fail(Z)}}if(n===r){if(e.charCodeAt(Mn)===37){n=le;Mn++}else{n=r;if(Bn===0){peg$fail(fe)}}if(n===r){if(e.charCodeAt(Mn)===42){n=re;Mn++}else{n=r;if(Bn===0){peg$fail(ie)}}if(n===r){if(e.charCodeAt(Mn)===95){n=V;Mn++}else{n=r;if(Bn===0){peg$fail(Y)}}if(n===r){if(e.charCodeAt(Mn)===43){n=q;Mn++}else{n=r;if(Bn===0){peg$fail(j)}}if(n===r){if(e.charCodeAt(Mn)===96){n=Te;Mn++}else{n=r;if(Bn===0){peg$fail(be)}}if(n===r){if(e.charCodeAt(Mn)===39){n=ne;Mn++}else{n=r;if(Bn===0){peg$fail(ae)}}if(n===r){if(e.charCodeAt(Mn)===126){n=ee;Mn++}else{n=r;if(Bn===0){peg$fail(te)}}if(n===r){if(e.charCodeAt(Mn)===40){n=se;Mn++}else{n=r;if(Bn===0){peg$fail(oe)}}if(n===r){if(e.charCodeAt(Mn)===41){n=ue;Mn++}else{n=r;if(Bn===0){peg$fail(ce)}}if(n===r){if(e.charCodeAt(Mn)===60){n=_e;Mn++}else{n=r;if(Bn===0){peg$fail(Ce)}}if(n===r){if(e.charCodeAt(Mn)===62){n=Ae;Mn++}else{n=r;if(Bn===0){peg$fail(Ee)}}if(n===r){if(e.charCodeAt(Mn)===58){n=D;Mn++}else{n=r;if(Bn===0){peg$fail(k)}}if(n===r){if(e.charCodeAt(Mn)===92){n=Ie;Mn++}else{n=r;if(Bn===0){peg$fail(Re)}}if(n===r){n=peg$parseDQUOTE();if(n===r){if(e.charCodeAt(Mn)===47){n=w;Mn++}else{n=r;if(Bn===0){peg$fail($)}}if(n===r){if(e.charCodeAt(Mn)===91){n=we;Mn++}else{n=r;if(Bn===0){peg$fail($e)}}if(n===r){if(e.charCodeAt(Mn)===93){n=xe;Mn++}else{n=r;if(Bn===0){peg$fail(Oe)}}if(n===r){if(e.charCodeAt(Mn)===63){n=x;Mn++}else{n=r;if(Bn===0){peg$fail(O)}}if(n===r){if(e.charCodeAt(Mn)===123){n=De;Mn++}else{n=r;if(Bn===0){peg$fail(ke)}}if(n===r){if(e.charCodeAt(Mn)===125){n=Ne;Mn++}else{n=r;if(Bn===0){peg$fail(Ue)}}}}}}}}}}}}}}}}}}}}}}}}}}}else{i=r}if(i!==r){t=e.substring(t,Mn)}else{t=i}return t}function peg$parseSTAR(){var t,i,n,a;t=Mn;i=peg$parseSWS();if(i!==r){if(e.charCodeAt(Mn)===42){n=re;Mn++}else{n=r;if(Bn===0){peg$fail(ie)}}if(n!==r){a=peg$parseSWS();if(a!==r){Hn=t;i=peg$c84();t=i}else{Mn=t;t=r}}else{Mn=t;t=r}}else{Mn=t;t=r}return t}function peg$parseSLASH(){var t,i,n,a;t=Mn;i=peg$parseSWS();if(i!==r){if(e.charCodeAt(Mn)===47){n=w;Mn++}else{n=r;if(Bn===0){peg$fail($)}}if(n!==r){a=peg$parseSWS();if(a!==r){Hn=t;i=peg$c85();t=i}else{Mn=t;t=r}}else{Mn=t;t=r}}else{Mn=t;t=r}return t}function peg$parseEQUAL(){var t,i,n,a;t=Mn;i=peg$parseSWS();if(i!==r){if(e.charCodeAt(Mn)===61){n=M;Mn++}else{n=r;if(Bn===0){peg$fail(H)}}if(n!==r){a=peg$parseSWS();if(a!==r){Hn=t;i=peg$c86();t=i}else{Mn=t;t=r}}else{Mn=t;t=r}}else{Mn=t;t=r}return t}function peg$parseLPAREN(){var t,i,n,a;t=Mn;i=peg$parseSWS();if(i!==r){if(e.charCodeAt(Mn)===40){n=se;Mn++}else{n=r;if(Bn===0){peg$fail(oe)}}if(n!==r){a=peg$parseSWS();if(a!==r){Hn=t;i=peg$c87();t=i}else{Mn=t;t=r}}else{Mn=t;t=r}}else{Mn=t;t=r}return t}function peg$parseRPAREN(){var t,i,n,a;t=Mn;i=peg$parseSWS();if(i!==r){if(e.charCodeAt(Mn)===41){n=ue;Mn++}else{n=r;if(Bn===0){peg$fail(ce)}}if(n!==r){a=peg$parseSWS();if(a!==r){Hn=t;i=peg$c88();t=i}else{Mn=t;t=r}}else{Mn=t;t=r}}else{Mn=t;t=r}return t}function peg$parseRAQUOT(){var t,i,n;t=Mn;if(e.charCodeAt(Mn)===62){i=Ae;Mn++}else{i=r;if(Bn===0){peg$fail(Ee)}}if(i!==r){n=peg$parseSWS();if(n!==r){Hn=t;i=peg$c89();t=i}else{Mn=t;t=r}}else{Mn=t;t=r}return t}function peg$parseLAQUOT(){var t,i,n;t=Mn;i=peg$parseSWS();if(i!==r){if(e.charCodeAt(Mn)===60){n=_e;Mn++}else{n=r;if(Bn===0){peg$fail(Ce)}}if(n!==r){Hn=t;i=peg$c90();t=i}else{Mn=t;t=r}}else{Mn=t;t=r}return t}function peg$parseCOMMA(){var t,i,n,a;t=Mn;i=peg$parseSWS();if(i!==r){if(e.charCodeAt(Mn)===44){n=W;Mn++}else{n=r;if(Bn===0){peg$fail(G)}}if(n!==r){a=peg$parseSWS();if(a!==r){Hn=t;i=peg$c91();t=i}else{Mn=t;t=r}}else{Mn=t;t=r}}else{Mn=t;t=r}return t}function peg$parseSEMI(){var t,i,n,a;t=Mn;i=peg$parseSWS();if(i!==r){if(e.charCodeAt(Mn)===59){n=I;Mn++}else{n=r;if(Bn===0){peg$fail(R)}}if(n!==r){a=peg$parseSWS();if(a!==r){Hn=t;i=peg$c92();t=i}else{Mn=t;t=r}}else{Mn=t;t=r}}else{Mn=t;t=r}return t}function peg$parseCOLON(){var t,i,n,a;t=Mn;i=peg$parseSWS();if(i!==r){if(e.charCodeAt(Mn)===58){n=D;Mn++}else{n=r;if(Bn===0){peg$fail(k)}}if(n!==r){a=peg$parseSWS();if(a!==r){Hn=t;i=peg$c93();t=i}else{Mn=t;t=r}}else{Mn=t;t=r}}else{Mn=t;t=r}return t}function peg$parseLDQUOT(){var e,t,i;e=Mn;t=peg$parseSWS();if(t!==r){i=peg$parseDQUOTE();if(i!==r){Hn=e;t=peg$c94();e=t}else{Mn=e;e=r}}else{Mn=e;e=r}return e}function peg$parseRDQUOT(){var e,t,i;e=Mn;t=peg$parseDQUOTE();if(t!==r){i=peg$parseSWS();if(i!==r){Hn=e;t=peg$c94();e=t}else{Mn=e;e=r}}else{Mn=e;e=r}return e}function peg$parsecomment(){var e,t,i,n;e=Mn;t=peg$parseLPAREN();if(t!==r){i=[];n=peg$parsectext();if(n===r){n=peg$parsequoted_pair();if(n===r){n=peg$parsecomment()}}while(n!==r){i.push(n);n=peg$parsectext();if(n===r){n=peg$parsequoted_pair();if(n===r){n=peg$parsecomment()}}}if(i!==r){n=peg$parseRPAREN();if(n!==r){t=[t,i,n];e=t}else{Mn=e;e=r}}else{Mn=e;e=r}}else{Mn=e;e=r}return e}function peg$parsectext(){var t;if(Le.test(e.charAt(Mn))){t=e.charAt(Mn);Mn++}else{t=r;if(Bn===0){peg$fail(Pe)}}if(t===r){if(Me.test(e.charAt(Mn))){t=e.charAt(Mn);Mn++}else{t=r;if(Bn===0){peg$fail(He)}}if(t===r){if(qe.test(e.charAt(Mn))){t=e.charAt(Mn);Mn++}else{t=r;if(Bn===0){peg$fail(je)}}if(t===r){t=peg$parseUTF8_NONASCII();if(t===r){t=peg$parseLWS()}}}}return t}function peg$parsequoted_string(){var t,i,n,a,s,o;t=Mn;i=Mn;n=peg$parseSWS();if(n!==r){a=peg$parseDQUOTE();if(a!==r){s=[];o=peg$parseqdtext();if(o===r){o=peg$parsequoted_pair()}while(o!==r){s.push(o);o=peg$parseqdtext();if(o===r){o=peg$parsequoted_pair()}}if(s!==r){o=peg$parseDQUOTE();if(o!==r){n=[n,a,s,o];i=n}else{Mn=i;i=r}}else{Mn=i;i=r}}else{Mn=i;i=r}}else{Mn=i;i=r}if(i!==r){t=e.substring(t,Mn)}else{t=i}return t}function peg$parsequoted_string_clean(){var t,i,n,a,s,o;t=Mn;i=peg$parseSWS();if(i!==r){n=peg$parseDQUOTE();if(n!==r){a=Mn;s=[];o=peg$parseqdtext();if(o===r){o=peg$parsequoted_pair()}while(o!==r){s.push(o);o=peg$parseqdtext();if(o===r){o=peg$parsequoted_pair()}}if(s!==r){a=e.substring(a,Mn)}else{a=s}if(a!==r){s=peg$parseDQUOTE();if(s!==r){Hn=t;i=peg$c101(a);t=i}else{Mn=t;t=r}}else{Mn=t;t=r}}else{Mn=t;t=r}}else{Mn=t;t=r}return t}function peg$parseqdtext(){var t;t=peg$parseLWS();if(t===r){if(e.charCodeAt(Mn)===33){t=X;Mn++}else{t=r;if(Bn===0){peg$fail(Z)}}if(t===r){if(Fe.test(e.charAt(Mn))){t=e.charAt(Mn);Mn++}else{t=r;if(Bn===0){peg$fail(Be)}}if(t===r){if(qe.test(e.charAt(Mn))){t=e.charAt(Mn);Mn++}else{t=r;if(Bn===0){peg$fail(je)}}if(t===r){t=peg$parseUTF8_NONASCII()}}}}return t}function peg$parsequoted_pair(){var t,i,n;t=Mn;if(e.charCodeAt(Mn)===92){i=Ie;Mn++}else{i=r;if(Bn===0){peg$fail(Re)}}if(i!==r){if(We.test(e.charAt(Mn))){n=e.charAt(Mn);Mn++}else{n=r;if(Bn===0){peg$fail(Ge)}}if(n===r){if(ze.test(e.charAt(Mn))){n=e.charAt(Mn);Mn++}else{n=r;if(Bn===0){peg$fail(Ke)}}if(n===r){if(Ve.test(e.charAt(Mn))){n=e.charAt(Mn);Mn++}else{n=r;if(Bn===0){peg$fail(Ye)}}}}if(n!==r){i=[i,n];t=i}else{Mn=t;t=r}}else{Mn=t;t=r}return t}function peg$parseSIP_URI_noparams(){var t,i,n,a,s;t=Mn;i=peg$parseuri_scheme();if(i!==r){if(e.charCodeAt(Mn)===58){n=D;Mn++}else{n=r;if(Bn===0){peg$fail(k)}}if(n!==r){a=peg$parseuserinfo();if(a===r){a=null}if(a!==r){s=peg$parsehostport();if(s!==r){Hn=t;i=peg$c110();t=i}else{Mn=t;t=r}}else{Mn=t;t=r}}else{Mn=t;t=r}}else{Mn=t;t=r}return t}function peg$parseSIP_URI(){var t,i,n,a,s,o,u;t=Mn;i=peg$parseuri_scheme();if(i!==r){if(e.charCodeAt(Mn)===58){n=D;Mn++}else{n=r;if(Bn===0){peg$fail(k)}}if(n!==r){a=peg$parseuserinfo();if(a===r){a=null}if(a!==r){s=peg$parsehostport();if(s!==r){o=peg$parseuri_parameters();if(o!==r){u=peg$parseheaders();if(u===r){u=null}if(u!==r){Hn=t;i=peg$c111();t=i}else{Mn=t;t=r}}else{Mn=t;t=r}}else{Mn=t;t=r}}else{Mn=t;t=r}}else{Mn=t;t=r}}else{Mn=t;t=r}return t}function peg$parseuri_scheme(){var t,i;t=Mn;if(e.substr(Mn,4).toLowerCase()===Qe){i=e.substr(Mn,4);Mn+=4}else{i=r;if(Bn===0){peg$fail(Je)}}if(i===r){if(e.substr(Mn,3).toLowerCase()===Xe){i=e.substr(Mn,3);Mn+=3}else{i=r;if(Bn===0){peg$fail(Ze)}}}if(i!==r){Hn=t;i=peg$c116(i)}t=i;return t}function peg$parseuserinfo(){var t,i,n,a,s;t=Mn;i=peg$parseuser();if(i!==r){n=Mn;if(e.charCodeAt(Mn)===58){a=D;Mn++}else{a=r;if(Bn===0){peg$fail(k)}}if(a!==r){s=peg$parsepassword();if(s!==r){a=[a,s];n=a}else{Mn=n;n=r}}else{Mn=n;n=r}if(n===r){n=null}if(n!==r){if(e.charCodeAt(Mn)===64){a=N;Mn++}else{a=r;if(Bn===0){peg$fail(U)}}if(a!==r){Hn=t;i=peg$c117();t=i}else{Mn=t;t=r}}else{Mn=t;t=r}}else{Mn=t;t=r}return t}function peg$parseuser(){var e,t;e=[];t=peg$parseunreserved();if(t===r){t=peg$parseescaped();if(t===r){t=peg$parseuser_unreserved()}}if(t!==r){while(t!==r){e.push(t);t=peg$parseunreserved();if(t===r){t=peg$parseescaped();if(t===r){t=peg$parseuser_unreserved()}}}}else{e=r}return e}function peg$parseuser_unreserved(){var t;if(e.charCodeAt(Mn)===38){t=L;Mn++}else{t=r;if(Bn===0){peg$fail(P)}}if(t===r){if(e.charCodeAt(Mn)===61){t=M;Mn++}else{t=r;if(Bn===0){peg$fail(H)}}if(t===r){if(e.charCodeAt(Mn)===43){t=q;Mn++}else{t=r;if(Bn===0){peg$fail(j)}}if(t===r){if(e.charCodeAt(Mn)===36){t=F;Mn++}else{t=r;if(Bn===0){peg$fail(B)}}if(t===r){if(e.charCodeAt(Mn)===44){t=W;Mn++}else{t=r;if(Bn===0){peg$fail(G)}}if(t===r){if(e.charCodeAt(Mn)===59){t=I;Mn++}else{t=r;if(Bn===0){peg$fail(R)}}if(t===r){if(e.charCodeAt(Mn)===63){t=x;Mn++}else{t=r;if(Bn===0){peg$fail(O)}}if(t===r){if(e.charCodeAt(Mn)===47){t=w;Mn++}else{t=r;if(Bn===0){peg$fail($)}}}}}}}}}return t}function peg$parsepassword(){var t,i,n;t=Mn;i=[];n=peg$parseunreserved();if(n===r){n=peg$parseescaped();if(n===r){if(e.charCodeAt(Mn)===38){n=L;Mn++}else{n=r;if(Bn===0){peg$fail(P)}}if(n===r){if(e.charCodeAt(Mn)===61){n=M;Mn++}else{n=r;if(Bn===0){peg$fail(H)}}if(n===r){if(e.charCodeAt(Mn)===43){n=q;Mn++}else{n=r;if(Bn===0){peg$fail(j)}}if(n===r){if(e.charCodeAt(Mn)===36){n=F;Mn++}else{n=r;if(Bn===0){peg$fail(B)}}if(n===r){if(e.charCodeAt(Mn)===44){n=W;Mn++}else{n=r;if(Bn===0){peg$fail(G)}}}}}}}}while(n!==r){i.push(n);n=peg$parseunreserved();if(n===r){n=peg$parseescaped();if(n===r){if(e.charCodeAt(Mn)===38){n=L;Mn++}else{n=r;if(Bn===0){peg$fail(P)}}if(n===r){if(e.charCodeAt(Mn)===61){n=M;Mn++}else{n=r;if(Bn===0){peg$fail(H)}}if(n===r){if(e.charCodeAt(Mn)===43){n=q;Mn++}else{n=r;if(Bn===0){peg$fail(j)}}if(n===r){if(e.charCodeAt(Mn)===36){n=F;Mn++}else{n=r;if(Bn===0){peg$fail(B)}}if(n===r){if(e.charCodeAt(Mn)===44){n=W;Mn++}else{n=r;if(Bn===0){peg$fail(G)}}}}}}}}}if(i!==r){Hn=t;i=peg$c118()}t=i;return t}function peg$parsehostport(){var t,i,n,a,s;t=Mn;i=peg$parsehost();if(i!==r){n=Mn;if(e.charCodeAt(Mn)===58){a=D;Mn++}else{a=r;if(Bn===0){peg$fail(k)}}if(a!==r){s=peg$parseport();if(s!==r){a=[a,s];n=a}else{Mn=n;n=r}}else{Mn=n;n=r}if(n===r){n=null}if(n!==r){i=[i,n];t=i}else{Mn=t;t=r}}else{Mn=t;t=r}return t}function peg$parsehost(){var e,t;e=Mn;t=peg$parsehostname();if(t===r){t=peg$parseIPv4address();if(t===r){t=peg$parseIPv6reference()}}if(t!==r){Hn=e;t=peg$c119()}e=t;return e}function peg$parsehostname(){var t,i,n,a,s;t=Mn;i=[];n=Mn;a=peg$parsedomainlabel();if(a!==r){if(e.charCodeAt(Mn)===46){s=Q;Mn++}else{s=r;if(Bn===0){peg$fail(J)}}if(s!==r){a=[a,s];n=a}else{Mn=n;n=r}}else{Mn=n;n=r}while(n!==r){i.push(n);n=Mn;a=peg$parsedomainlabel();if(a!==r){if(e.charCodeAt(Mn)===46){s=Q;Mn++}else{s=r;if(Bn===0){peg$fail(J)}}if(s!==r){a=[a,s];n=a}else{Mn=n;n=r}}else{Mn=n;n=r}}if(i!==r){n=peg$parsetoplabel();if(n!==r){if(e.charCodeAt(Mn)===46){a=Q;Mn++}else{a=r;if(Bn===0){peg$fail(J)}}if(a===r){a=null}if(a!==r){Hn=t;i=peg$c120();t=i}else{Mn=t;t=r}}else{Mn=t;t=r}}else{Mn=t;t=r}return t}function peg$parsedomainlabel(){var t,i;t=[];if(et.test(e.charAt(Mn))){i=e.charAt(Mn);Mn++}else{i=r;if(Bn===0){peg$fail(tt)}}if(i!==r){while(i!==r){t.push(i);if(et.test(e.charAt(Mn))){i=e.charAt(Mn);Mn++}else{i=r;if(Bn===0){peg$fail(tt)}}}}else{t=r}return t}function peg$parsetoplabel(){var t,i,n,a;t=Mn;if(p.test(e.charAt(Mn))){i=e.charAt(Mn);Mn++}else{i=r;if(Bn===0){peg$fail(d)}}if(i!==r){n=[];if(rt.test(e.charAt(Mn))){a=e.charAt(Mn);Mn++}else{a=r;if(Bn===0){peg$fail(it)}}while(a!==r){n.push(a);if(rt.test(e.charAt(Mn))){a=e.charAt(Mn);Mn++}else{a=r;if(Bn===0){peg$fail(it)}}}if(n!==r){i=[i,n];t=i}else{Mn=t;t=r}}else{Mn=t;t=r}return t}function peg$parseIPv6reference(){var t,i,n,a;t=Mn;if(e.charCodeAt(Mn)===91){i=we;Mn++}else{i=r;if(Bn===0){peg$fail($e)}}if(i!==r){n=peg$parseIPv6address();if(n!==r){if(e.charCodeAt(Mn)===93){a=xe;Mn++}else{a=r;if(Bn===0){peg$fail(Oe)}}if(a!==r){Hn=t;i=peg$c125();t=i}else{Mn=t;t=r}}else{Mn=t;t=r}}else{Mn=t;t=r}return t}function peg$parseIPv6address(){var t,i,n,a,s,o,u,c,l,f,p,d,h,g,v;t=Mn;i=Mn;n=peg$parseh16();if(n!==r){if(e.charCodeAt(Mn)===58){a=D;Mn++}else{a=r;if(Bn===0){peg$fail(k)}}if(a!==r){s=peg$parseh16();if(s!==r){if(e.charCodeAt(Mn)===58){o=D;Mn++}else{o=r;if(Bn===0){peg$fail(k)}}if(o!==r){u=peg$parseh16();if(u!==r){if(e.charCodeAt(Mn)===58){c=D;Mn++}else{c=r;if(Bn===0){peg$fail(k)}}if(c!==r){l=peg$parseh16();if(l!==r){if(e.charCodeAt(Mn)===58){f=D;Mn++}else{f=r;if(Bn===0){peg$fail(k)}}if(f!==r){p=peg$parseh16();if(p!==r){if(e.charCodeAt(Mn)===58){d=D;Mn++}else{d=r;if(Bn===0){peg$fail(k)}}if(d!==r){h=peg$parseh16();if(h!==r){if(e.charCodeAt(Mn)===58){g=D;Mn++}else{g=r;if(Bn===0){peg$fail(k)}}if(g!==r){v=peg$parsels32();if(v!==r){n=[n,a,s,o,u,c,l,f,p,d,h,g,v];i=n}else{Mn=i;i=r}}else{Mn=i;i=r}}else{Mn=i;i=r}}else{Mn=i;i=r}}else{Mn=i;i=r}}else{Mn=i;i=r}}else{Mn=i;i=r}}else{Mn=i;i=r}}else{Mn=i;i=r}}else{Mn=i;i=r}}else{Mn=i;i=r}}else{Mn=i;i=r}}else{Mn=i;i=r}if(i===r){i=Mn;if(e.substr(Mn,2)===nt){n=nt;Mn+=2}else{n=r;if(Bn===0){peg$fail(at)}}if(n!==r){a=peg$parseh16();if(a!==r){if(e.charCodeAt(Mn)===58){s=D;Mn++}else{s=r;if(Bn===0){peg$fail(k)}}if(s!==r){o=peg$parseh16();if(o!==r){if(e.charCodeAt(Mn)===58){u=D;Mn++}else{u=r;if(Bn===0){peg$fail(k)}}if(u!==r){c=peg$parseh16();if(c!==r){if(e.charCodeAt(Mn)===58){l=D;Mn++}else{l=r;if(Bn===0){peg$fail(k)}}if(l!==r){f=peg$parseh16();if(f!==r){if(e.charCodeAt(Mn)===58){p=D;Mn++}else{p=r;if(Bn===0){peg$fail(k)}}if(p!==r){d=peg$parseh16();if(d!==r){if(e.charCodeAt(Mn)===58){h=D;Mn++}else{h=r;if(Bn===0){peg$fail(k)}}if(h!==r){g=peg$parsels32();if(g!==r){n=[n,a,s,o,u,c,l,f,p,d,h,g];i=n}else{Mn=i;i=r}}else{Mn=i;i=r}}else{Mn=i;i=r}}else{Mn=i;i=r}}else{Mn=i;i=r}}else{Mn=i;i=r}}else{Mn=i;i=r}}else{Mn=i;i=r}}else{Mn=i;i=r}}else{Mn=i;i=r}}else{Mn=i;i=r}}else{Mn=i;i=r}if(i===r){i=Mn;if(e.substr(Mn,2)===nt){n=nt;Mn+=2}else{n=r;if(Bn===0){peg$fail(at)}}if(n!==r){a=peg$parseh16();if(a!==r){if(e.charCodeAt(Mn)===58){s=D;Mn++}else{s=r;if(Bn===0){peg$fail(k)}}if(s!==r){o=peg$parseh16();if(o!==r){if(e.charCodeAt(Mn)===58){u=D;Mn++}else{u=r;if(Bn===0){peg$fail(k)}}if(u!==r){c=peg$parseh16();if(c!==r){if(e.charCodeAt(Mn)===58){l=D;Mn++}else{l=r;if(Bn===0){peg$fail(k)}}if(l!==r){f=peg$parseh16();if(f!==r){if(e.charCodeAt(Mn)===58){p=D;Mn++}else{p=r;if(Bn===0){peg$fail(k)}}if(p!==r){d=peg$parsels32();if(d!==r){n=[n,a,s,o,u,c,l,f,p,d];i=n}else{Mn=i;i=r}}else{Mn=i;i=r}}else{Mn=i;i=r}}else{Mn=i;i=r}}else{Mn=i;i=r}}else{Mn=i;i=r}}else{Mn=i;i=r}}else{Mn=i;i=r}}else{Mn=i;i=r}}else{Mn=i;i=r}if(i===r){i=Mn;if(e.substr(Mn,2)===nt){n=nt;Mn+=2}else{n=r;if(Bn===0){peg$fail(at)}}if(n!==r){a=peg$parseh16();if(a!==r){if(e.charCodeAt(Mn)===58){s=D;Mn++}else{s=r;if(Bn===0){peg$fail(k)}}if(s!==r){o=peg$parseh16();if(o!==r){if(e.charCodeAt(Mn)===58){u=D;Mn++}else{u=r;if(Bn===0){peg$fail(k)}}if(u!==r){c=peg$parseh16();if(c!==r){if(e.charCodeAt(Mn)===58){l=D;Mn++}else{l=r;if(Bn===0){peg$fail(k)}}if(l!==r){f=peg$parsels32();if(f!==r){n=[n,a,s,o,u,c,l,f];i=n}else{Mn=i;i=r}}else{Mn=i;i=r}}else{Mn=i;i=r}}else{Mn=i;i=r}}else{Mn=i;i=r}}else{Mn=i;i=r}}else{Mn=i;i=r}}else{Mn=i;i=r}if(i===r){i=Mn;if(e.substr(Mn,2)===nt){n=nt;Mn+=2}else{n=r;if(Bn===0){peg$fail(at)}}if(n!==r){a=peg$parseh16();if(a!==r){if(e.charCodeAt(Mn)===58){s=D;Mn++}else{s=r;if(Bn===0){peg$fail(k)}}if(s!==r){o=peg$parseh16();if(o!==r){if(e.charCodeAt(Mn)===58){u=D;Mn++}else{u=r;if(Bn===0){peg$fail(k)}}if(u!==r){c=peg$parsels32();if(c!==r){n=[n,a,s,o,u,c];i=n}else{Mn=i;i=r}}else{Mn=i;i=r}}else{Mn=i;i=r}}else{Mn=i;i=r}}else{Mn=i;i=r}}else{Mn=i;i=r}if(i===r){i=Mn;if(e.substr(Mn,2)===nt){n=nt;Mn+=2}else{n=r;if(Bn===0){peg$fail(at)}}if(n!==r){a=peg$parseh16();if(a!==r){if(e.charCodeAt(Mn)===58){s=D;Mn++}else{s=r;if(Bn===0){peg$fail(k)}}if(s!==r){o=peg$parsels32();if(o!==r){n=[n,a,s,o];i=n}else{Mn=i;i=r}}else{Mn=i;i=r}}else{Mn=i;i=r}}else{Mn=i;i=r}if(i===r){i=Mn;if(e.substr(Mn,2)===nt){n=nt;Mn+=2}else{n=r;if(Bn===0){peg$fail(at)}}if(n!==r){a=peg$parsels32();if(a!==r){n=[n,a];i=n}else{Mn=i;i=r}}else{Mn=i;i=r}if(i===r){i=Mn;if(e.substr(Mn,2)===nt){n=nt;Mn+=2}else{n=r;if(Bn===0){peg$fail(at)}}if(n!==r){a=peg$parseh16();if(a!==r){n=[n,a];i=n}else{Mn=i;i=r}}else{Mn=i;i=r}if(i===r){i=Mn;n=peg$parseh16();if(n!==r){if(e.substr(Mn,2)===nt){a=nt;Mn+=2}else{a=r;if(Bn===0){peg$fail(at)}}if(a!==r){s=peg$parseh16();if(s!==r){if(e.charCodeAt(Mn)===58){o=D;Mn++}else{o=r;if(Bn===0){peg$fail(k)}}if(o!==r){u=peg$parseh16();if(u!==r){if(e.charCodeAt(Mn)===58){c=D;Mn++}else{c=r;if(Bn===0){peg$fail(k)}}if(c!==r){l=peg$parseh16();if(l!==r){if(e.charCodeAt(Mn)===58){f=D;Mn++}else{f=r;if(Bn===0){peg$fail(k)}}if(f!==r){p=peg$parseh16();if(p!==r){if(e.charCodeAt(Mn)===58){d=D;Mn++}else{d=r;if(Bn===0){peg$fail(k)}}if(d!==r){h=peg$parsels32();if(h!==r){n=[n,a,s,o,u,c,l,f,p,d,h];i=n}else{Mn=i;i=r}}else{Mn=i;i=r}}else{Mn=i;i=r}}else{Mn=i;i=r}}else{Mn=i;i=r}}else{Mn=i;i=r}}else{Mn=i;i=r}}else{Mn=i;i=r}}else{Mn=i;i=r}}else{Mn=i;i=r}}else{Mn=i;i=r}if(i===r){i=Mn;n=peg$parseh16();if(n!==r){a=Mn;if(e.charCodeAt(Mn)===58){s=D;Mn++}else{s=r;if(Bn===0){peg$fail(k)}}if(s!==r){o=peg$parseh16();if(o!==r){s=[s,o];a=s}else{Mn=a;a=r}}else{Mn=a;a=r}if(a===r){a=null}if(a!==r){if(e.substr(Mn,2)===nt){s=nt;Mn+=2}else{s=r;if(Bn===0){peg$fail(at)}}if(s!==r){o=peg$parseh16();if(o!==r){if(e.charCodeAt(Mn)===58){u=D;Mn++}else{u=r;if(Bn===0){peg$fail(k)}}if(u!==r){c=peg$parseh16();if(c!==r){if(e.charCodeAt(Mn)===58){l=D;Mn++}else{l=r;if(Bn===0){peg$fail(k)}}if(l!==r){f=peg$parseh16();if(f!==r){if(e.charCodeAt(Mn)===58){p=D;Mn++}else{p=r;if(Bn===0){peg$fail(k)}}if(p!==r){d=peg$parsels32();if(d!==r){n=[n,a,s,o,u,c,l,f,p,d];i=n}else{Mn=i;i=r}}else{Mn=i;i=r}}else{Mn=i;i=r}}else{Mn=i;i=r}}else{Mn=i;i=r}}else{Mn=i;i=r}}else{Mn=i;i=r}}else{Mn=i;i=r}}else{Mn=i;i=r}}else{Mn=i;i=r}if(i===r){i=Mn;n=peg$parseh16();if(n!==r){a=Mn;if(e.charCodeAt(Mn)===58){s=D;Mn++}else{s=r;if(Bn===0){peg$fail(k)}}if(s!==r){o=peg$parseh16();if(o!==r){s=[s,o];a=s}else{Mn=a;a=r}}else{Mn=a;a=r}if(a===r){a=null}if(a!==r){s=Mn;if(e.charCodeAt(Mn)===58){o=D;Mn++}else{o=r;if(Bn===0){peg$fail(k)}}if(o!==r){u=peg$parseh16();if(u!==r){o=[o,u];s=o}else{Mn=s;s=r}}else{Mn=s;s=r}if(s===r){s=null}if(s!==r){if(e.substr(Mn,2)===nt){o=nt;Mn+=2}else{o=r;if(Bn===0){peg$fail(at)}}if(o!==r){u=peg$parseh16();if(u!==r){if(e.charCodeAt(Mn)===58){c=D;Mn++}else{c=r;if(Bn===0){peg$fail(k)}}if(c!==r){l=peg$parseh16();if(l!==r){if(e.charCodeAt(Mn)===58){f=D;Mn++}else{f=r;if(Bn===0){peg$fail(k)}}if(f!==r){p=peg$parsels32();if(p!==r){n=[n,a,s,o,u,c,l,f,p];i=n}else{Mn=i;i=r}}else{Mn=i;i=r}}else{Mn=i;i=r}}else{Mn=i;i=r}}else{Mn=i;i=r}}else{Mn=i;i=r}}else{Mn=i;i=r}}else{Mn=i;i=r}}else{Mn=i;i=r}if(i===r){i=Mn;n=peg$parseh16();if(n!==r){a=Mn;if(e.charCodeAt(Mn)===58){s=D;Mn++}else{s=r;if(Bn===0){peg$fail(k)}}if(s!==r){o=peg$parseh16();if(o!==r){s=[s,o];a=s}else{Mn=a;a=r}}else{Mn=a;a=r}if(a===r){a=null}if(a!==r){s=Mn;if(e.charCodeAt(Mn)===58){o=D;Mn++}else{o=r;if(Bn===0){peg$fail(k)}}if(o!==r){u=peg$parseh16();if(u!==r){o=[o,u];s=o}else{Mn=s;s=r}}else{Mn=s;s=r}if(s===r){s=null}if(s!==r){o=Mn;if(e.charCodeAt(Mn)===58){u=D;Mn++}else{u=r;if(Bn===0){peg$fail(k)}}if(u!==r){c=peg$parseh16();if(c!==r){u=[u,c];o=u}else{Mn=o;o=r}}else{Mn=o;o=r}if(o===r){o=null}if(o!==r){if(e.substr(Mn,2)===nt){u=nt;Mn+=2}else{u=r;if(Bn===0){peg$fail(at)}}if(u!==r){c=peg$parseh16();if(c!==r){if(e.charCodeAt(Mn)===58){l=D;Mn++}else{l=r;if(Bn===0){peg$fail(k)}}if(l!==r){f=peg$parsels32();if(f!==r){n=[n,a,s,o,u,c,l,f];i=n}else{Mn=i;i=r}}else{Mn=i;i=r}}else{Mn=i;i=r}}else{Mn=i;i=r}}else{Mn=i;i=r}}else{Mn=i;i=r}}else{Mn=i;i=r}}else{Mn=i;i=r}if(i===r){i=Mn;n=peg$parseh16();if(n!==r){a=Mn;if(e.charCodeAt(Mn)===58){s=D;Mn++}else{s=r;if(Bn===0){peg$fail(k)}}if(s!==r){o=peg$parseh16();if(o!==r){s=[s,o];a=s}else{Mn=a;a=r}}else{Mn=a;a=r}if(a===r){a=null}if(a!==r){s=Mn;if(e.charCodeAt(Mn)===58){o=D;Mn++}else{o=r;if(Bn===0){peg$fail(k)}}if(o!==r){u=peg$parseh16();if(u!==r){o=[o,u];s=o}else{Mn=s;s=r}}else{Mn=s;s=r}if(s===r){s=null}if(s!==r){o=Mn;if(e.charCodeAt(Mn)===58){u=D;Mn++}else{u=r;if(Bn===0){peg$fail(k)}}if(u!==r){c=peg$parseh16();if(c!==r){u=[u,c];o=u}else{Mn=o;o=r}}else{Mn=o;o=r}if(o===r){o=null}if(o!==r){u=Mn;if(e.charCodeAt(Mn)===58){c=D;Mn++}else{c=r;if(Bn===0){peg$fail(k)}}if(c!==r){l=peg$parseh16();if(l!==r){c=[c,l];u=c}else{Mn=u;u=r}}else{Mn=u;u=r}if(u===r){u=null}if(u!==r){if(e.substr(Mn,2)===nt){c=nt;Mn+=2}else{c=r;if(Bn===0){peg$fail(at)}}if(c!==r){l=peg$parsels32();if(l!==r){n=[n,a,s,o,u,c,l];i=n}else{Mn=i;i=r}}else{Mn=i;i=r}}else{Mn=i;i=r}}else{Mn=i;i=r}}else{Mn=i;i=r}}else{Mn=i;i=r}}else{Mn=i;i=r}if(i===r){i=Mn;n=peg$parseh16();if(n!==r){a=Mn;if(e.charCodeAt(Mn)===58){s=D;Mn++}else{s=r;if(Bn===0){peg$fail(k)}}if(s!==r){o=peg$parseh16();if(o!==r){s=[s,o];a=s}else{Mn=a;a=r}}else{Mn=a;a=r}if(a===r){a=null}if(a!==r){s=Mn;if(e.charCodeAt(Mn)===58){o=D;Mn++}else{o=r;if(Bn===0){peg$fail(k)}}if(o!==r){u=peg$parseh16();if(u!==r){o=[o,u];s=o}else{Mn=s;s=r}}else{Mn=s;s=r}if(s===r){s=null}if(s!==r){o=Mn;if(e.charCodeAt(Mn)===58){u=D;Mn++}else{u=r;if(Bn===0){peg$fail(k)}}if(u!==r){c=peg$parseh16();if(c!==r){u=[u,c];o=u}else{Mn=o;o=r}}else{Mn=o;o=r}if(o===r){o=null}if(o!==r){u=Mn;if(e.charCodeAt(Mn)===58){c=D;Mn++}else{c=r;if(Bn===0){peg$fail(k)}}if(c!==r){l=peg$parseh16();if(l!==r){c=[c,l];u=c}else{Mn=u;u=r}}else{Mn=u;u=r}if(u===r){u=null}if(u!==r){c=Mn;if(e.charCodeAt(Mn)===58){l=D;Mn++}else{l=r;if(Bn===0){peg$fail(k)}}if(l!==r){f=peg$parseh16();if(f!==r){l=[l,f];c=l}else{Mn=c;c=r}}else{Mn=c;c=r}if(c===r){c=null}if(c!==r){if(e.substr(Mn,2)===nt){l=nt;Mn+=2}else{l=r;if(Bn===0){peg$fail(at)}}if(l!==r){f=peg$parseh16();if(f!==r){n=[n,a,s,o,u,c,l,f];i=n}else{Mn=i;i=r}}else{Mn=i;i=r}}else{Mn=i;i=r}}else{Mn=i;i=r}}else{Mn=i;i=r}}else{Mn=i;i=r}}else{Mn=i;i=r}}else{Mn=i;i=r}if(i===r){i=Mn;n=peg$parseh16();if(n!==r){a=Mn;if(e.charCodeAt(Mn)===58){s=D;Mn++}else{s=r;if(Bn===0){peg$fail(k)}}if(s!==r){o=peg$parseh16();if(o!==r){s=[s,o];a=s}else{Mn=a;a=r}}else{Mn=a;a=r}if(a===r){a=null}if(a!==r){s=Mn;if(e.charCodeAt(Mn)===58){o=D;Mn++}else{o=r;if(Bn===0){peg$fail(k)}}if(o!==r){u=peg$parseh16();if(u!==r){o=[o,u];s=o}else{Mn=s;s=r}}else{Mn=s;s=r}if(s===r){s=null}if(s!==r){o=Mn;if(e.charCodeAt(Mn)===58){u=D;Mn++}else{u=r;if(Bn===0){peg$fail(k)}}if(u!==r){c=peg$parseh16();if(c!==r){u=[u,c];o=u}else{Mn=o;o=r}}else{Mn=o;o=r}if(o===r){o=null}if(o!==r){u=Mn;if(e.charCodeAt(Mn)===58){c=D;Mn++}else{c=r;if(Bn===0){peg$fail(k)}}if(c!==r){l=peg$parseh16();if(l!==r){c=[c,l];u=c}else{Mn=u;u=r}}else{Mn=u;u=r}if(u===r){u=null}if(u!==r){c=Mn;if(e.charCodeAt(Mn)===58){l=D;Mn++}else{l=r;if(Bn===0){peg$fail(k)}}if(l!==r){f=peg$parseh16();if(f!==r){l=[l,f];c=l}else{Mn=c;c=r}}else{Mn=c;c=r}if(c===r){c=null}if(c!==r){l=Mn;if(e.charCodeAt(Mn)===58){f=D;Mn++}else{f=r;if(Bn===0){peg$fail(k)}}if(f!==r){p=peg$parseh16();if(p!==r){f=[f,p];l=f}else{Mn=l;l=r}}else{Mn=l;l=r}if(l===r){l=null}if(l!==r){if(e.substr(Mn,2)===nt){f=nt;Mn+=2}else{f=r;if(Bn===0){peg$fail(at)}}if(f!==r){n=[n,a,s,o,u,c,l,f];i=n}else{Mn=i;i=r}}else{Mn=i;i=r}}else{Mn=i;i=r}}else{Mn=i;i=r}}else{Mn=i;i=r}}else{Mn=i;i=r}}else{Mn=i;i=r}}else{Mn=i;i=r}}}}}}}}}}}}}}}if(i!==r){Hn=t;i=peg$c128()}t=i;return t}function peg$parseh16(){var e,t,i,n,a;e=Mn;t=peg$parseHEXDIG();if(t!==r){i=peg$parseHEXDIG();if(i===r){i=null}if(i!==r){n=peg$parseHEXDIG();if(n===r){n=null}if(n!==r){a=peg$parseHEXDIG();if(a===r){a=null}if(a!==r){t=[t,i,n,a];e=t}else{Mn=e;e=r}}else{Mn=e;e=r}}else{Mn=e;e=r}}else{Mn=e;e=r}return e}function peg$parsels32(){var t,i,n,a;t=Mn;i=peg$parseh16();if(i!==r){if(e.charCodeAt(Mn)===58){n=D;Mn++}else{n=r;if(Bn===0){peg$fail(k)}}if(n!==r){a=peg$parseh16();if(a!==r){i=[i,n,a];t=i}else{Mn=t;t=r}}else{Mn=t;t=r}}else{Mn=t;t=r}if(t===r){t=peg$parseIPv4address()}return t}function peg$parseIPv4address(){var t,i,n,a,s,o,u,c;t=Mn;i=peg$parsedec_octet();if(i!==r){if(e.charCodeAt(Mn)===46){n=Q;Mn++}else{n=r;if(Bn===0){peg$fail(J)}}if(n!==r){a=peg$parsedec_octet();if(a!==r){if(e.charCodeAt(Mn)===46){s=Q;Mn++}else{s=r;if(Bn===0){peg$fail(J)}}if(s!==r){o=peg$parsedec_octet();if(o!==r){if(e.charCodeAt(Mn)===46){u=Q;Mn++}else{u=r;if(Bn===0){peg$fail(J)}}if(u!==r){c=peg$parsedec_octet();if(c!==r){Hn=t;i=peg$c129();t=i}else{Mn=t;t=r}}else{Mn=t;t=r}}else{Mn=t;t=r}}else{Mn=t;t=r}}else{Mn=t;t=r}}else{Mn=t;t=r}}else{Mn=t;t=r}return t}function peg$parsedec_octet(){var t,i,n,a;t=Mn;if(e.substr(Mn,2)===st){i=st;Mn+=2}else{i=r;if(Bn===0){peg$fail(ot)}}if(i!==r){if(ut.test(e.charAt(Mn))){n=e.charAt(Mn);Mn++}else{n=r;if(Bn===0){peg$fail(ct)}}if(n!==r){i=[i,n];t=i}else{Mn=t;t=r}}else{Mn=t;t=r}if(t===r){t=Mn;if(e.charCodeAt(Mn)===50){i=lt;Mn++}else{i=r;if(Bn===0){peg$fail(ft)}}if(i!==r){if(pt.test(e.charAt(Mn))){n=e.charAt(Mn);Mn++}else{n=r;if(Bn===0){peg$fail(dt)}}if(n!==r){a=peg$parseDIGIT();if(a!==r){i=[i,n,a];t=i}else{Mn=t;t=r}}else{Mn=t;t=r}}else{Mn=t;t=r}if(t===r){t=Mn;if(e.charCodeAt(Mn)===49){i=ht;Mn++}else{i=r;if(Bn===0){peg$fail(gt)}}if(i!==r){n=peg$parseDIGIT();if(n!==r){a=peg$parseDIGIT();if(a!==r){i=[i,n,a];t=i}else{Mn=t;t=r}}else{Mn=t;t=r}}else{Mn=t;t=r}if(t===r){t=Mn;if(vt.test(e.charAt(Mn))){i=e.charAt(Mn);Mn++}else{i=r;if(Bn===0){peg$fail(mt)}}if(i!==r){n=peg$parseDIGIT();if(n!==r){i=[i,n];t=i}else{Mn=t;t=r}}else{Mn=t;t=r}if(t===r){t=peg$parseDIGIT()}}}}return t}function peg$parseport(){var e,t,i,n,a,s,o;e=Mn;t=Mn;i=peg$parseDIGIT();if(i===r){i=null}if(i!==r){n=peg$parseDIGIT();if(n===r){n=null}if(n!==r){a=peg$parseDIGIT();if(a===r){a=null}if(a!==r){s=peg$parseDIGIT();if(s===r){s=null}if(s!==r){o=peg$parseDIGIT();if(o===r){o=null}if(o!==r){i=[i,n,a,s,o];t=i}else{Mn=t;t=r}}else{Mn=t;t=r}}else{Mn=t;t=r}}else{Mn=t;t=r}}else{Mn=t;t=r}if(t!==r){Hn=e;t=peg$c142(t)}e=t;return e}function peg$parseuri_parameters(){var t,i,n,a;t=[];i=Mn;if(e.charCodeAt(Mn)===59){n=I;Mn++}else{n=r;if(Bn===0){peg$fail(R)}}if(n!==r){a=peg$parseuri_parameter();if(a!==r){n=[n,a];i=n}else{Mn=i;i=r}}else{Mn=i;i=r}while(i!==r){t.push(i);i=Mn;if(e.charCodeAt(Mn)===59){n=I;Mn++}else{n=r;if(Bn===0){peg$fail(R)}}if(n!==r){a=peg$parseuri_parameter();if(a!==r){n=[n,a];i=n}else{Mn=i;i=r}}else{Mn=i;i=r}}return t}function peg$parseuri_parameter(){var e;e=peg$parsetransport_param();if(e===r){e=peg$parseuser_param();if(e===r){e=peg$parsemethod_param();if(e===r){e=peg$parsettl_param();if(e===r){e=peg$parsemaddr_param();if(e===r){e=peg$parselr_param();if(e===r){e=peg$parseother_param()}}}}}}return e}function peg$parsetransport_param(){var t,i,n;t=Mn;if(e.substr(Mn,10).toLowerCase()===yt){i=e.substr(Mn,10);Mn+=10}else{i=r;if(Bn===0){peg$fail(St)}}if(i!==r){if(e.substr(Mn,3).toLowerCase()===Tt){n=e.substr(Mn,3);Mn+=3}else{n=r;if(Bn===0){peg$fail(bt)}}if(n===r){if(e.substr(Mn,3).toLowerCase()===_t){n=e.substr(Mn,3);Mn+=3}else{n=r;if(Bn===0){peg$fail(Ct)}}if(n===r){if(e.substr(Mn,4).toLowerCase()===At){n=e.substr(Mn,4);Mn+=4}else{n=r;if(Bn===0){peg$fail(Et)}}if(n===r){if(e.substr(Mn,3).toLowerCase()===It){n=e.substr(Mn,3);Mn+=3}else{n=r;if(Bn===0){peg$fail(Rt)}}if(n===r){n=peg$parsetoken()}}}}if(n!==r){Hn=t;i=peg$c153(n);t=i}else{Mn=t;t=r}}else{Mn=t;t=r}return t}function peg$parseuser_param(){var t,i,n;t=Mn;if(e.substr(Mn,5).toLowerCase()===wt){i=e.substr(Mn,5);Mn+=5}else{i=r;if(Bn===0){peg$fail($t)}}if(i!==r){if(e.substr(Mn,5).toLowerCase()===xt){n=e.substr(Mn,5);Mn+=5}else{n=r;if(Bn===0){peg$fail(Ot)}}if(n===r){if(e.substr(Mn,2).toLowerCase()===Dt){n=e.substr(Mn,2);Mn+=2}else{n=r;if(Bn===0){peg$fail(kt)}}if(n===r){n=peg$parsetoken()}}if(n!==r){Hn=t;i=peg$c160(n);t=i}else{Mn=t;t=r}}else{Mn=t;t=r}return t}function peg$parsemethod_param(){var t,i,n;t=Mn;if(e.substr(Mn,7).toLowerCase()===Nt){i=e.substr(Mn,7);Mn+=7}else{i=r;if(Bn===0){peg$fail(Ut)}}if(i!==r){n=peg$parseMethod();if(n!==r){Hn=t;i=peg$c163(n);t=i}else{Mn=t;t=r}}else{Mn=t;t=r}return t}function peg$parsettl_param(){var t,i,n;t=Mn;if(e.substr(Mn,4).toLowerCase()===Lt){i=e.substr(Mn,4);Mn+=4}else{i=r;if(Bn===0){peg$fail(Pt)}}if(i!==r){n=peg$parsettl();if(n!==r){Hn=t;i=peg$c166(n);t=i}else{Mn=t;t=r}}else{Mn=t;t=r}return t}function peg$parsemaddr_param(){var t,i,n;t=Mn;if(e.substr(Mn,6).toLowerCase()===Mt){i=e.substr(Mn,6);Mn+=6}else{i=r;if(Bn===0){peg$fail(Ht)}}if(i!==r){n=peg$parsehost();if(n!==r){Hn=t;i=peg$c169(n);t=i}else{Mn=t;t=r}}else{Mn=t;t=r}return t}function peg$parselr_param(){var t,i,n,a,s;t=Mn;if(e.substr(Mn,2).toLowerCase()===qt){i=e.substr(Mn,2);Mn+=2}else{i=r;if(Bn===0){peg$fail(jt)}}if(i!==r){n=Mn;if(e.charCodeAt(Mn)===61){a=M;Mn++}else{a=r;if(Bn===0){peg$fail(H)}}if(a!==r){s=peg$parsetoken();if(s!==r){a=[a,s];n=a}else{Mn=n;n=r}}else{Mn=n;n=r}if(n===r){n=null}if(n!==r){Hn=t;i=peg$c172();t=i}else{Mn=t;t=r}}else{Mn=t;t=r}return t}function peg$parseother_param(){var t,i,n,a,s;t=Mn;i=peg$parsepname();if(i!==r){n=Mn;if(e.charCodeAt(Mn)===61){a=M;Mn++}else{a=r;if(Bn===0){peg$fail(H)}}if(a!==r){s=peg$parsepvalue();if(s!==r){a=[a,s];n=a}else{Mn=n;n=r}}else{Mn=n;n=r}if(n===r){n=null}if(n!==r){Hn=t;i=peg$c173(i,n);t=i}else{Mn=t;t=r}}else{Mn=t;t=r}return t}function peg$parsepname(){var t,i,n;t=Mn;i=[];n=peg$parseparamchar();if(n!==r){while(n!==r){i.push(n);n=peg$parseparamchar()}}else{i=r}if(i!==r){t=e.substring(t,Mn)}else{t=i}return t}function peg$parsepvalue(){var t,i,n;t=Mn;i=[];n=peg$parseparamchar();if(n!==r){while(n!==r){i.push(n);n=peg$parseparamchar()}}else{i=r}if(i!==r){t=e.substring(t,Mn)}else{t=i}return t}function peg$parseparamchar(){var e;e=peg$parseparam_unreserved();if(e===r){e=peg$parseunreserved();if(e===r){e=peg$parseescaped()}}return e}function peg$parseparam_unreserved(){var t;if(e.charCodeAt(Mn)===91){t=we;Mn++}else{t=r;if(Bn===0){peg$fail($e)}}if(t===r){if(e.charCodeAt(Mn)===93){t=xe;Mn++}else{t=r;if(Bn===0){peg$fail(Oe)}}if(t===r){if(e.charCodeAt(Mn)===47){t=w;Mn++}else{t=r;if(Bn===0){peg$fail($)}}if(t===r){if(e.charCodeAt(Mn)===58){t=D;Mn++}else{t=r;if(Bn===0){peg$fail(k)}}if(t===r){if(e.charCodeAt(Mn)===38){t=L;Mn++}else{t=r;if(Bn===0){peg$fail(P)}}if(t===r){if(e.charCodeAt(Mn)===43){t=q;Mn++}else{t=r;if(Bn===0){peg$fail(j)}}if(t===r){if(e.charCodeAt(Mn)===36){t=F;Mn++}else{t=r;if(Bn===0){peg$fail(B)}}}}}}}}return t}function peg$parseheaders(){var t,i,n,a,s,o,u;t=Mn;if(e.charCodeAt(Mn)===63){i=x;Mn++}else{i=r;if(Bn===0){peg$fail(O)}}if(i!==r){n=peg$parseheader();if(n!==r){a=[];s=Mn;if(e.charCodeAt(Mn)===38){o=L;Mn++}else{o=r;if(Bn===0){peg$fail(P)}}if(o!==r){u=peg$parseheader();if(u!==r){o=[o,u];s=o}else{Mn=s;s=r}}else{Mn=s;s=r}while(s!==r){a.push(s);s=Mn;if(e.charCodeAt(Mn)===38){o=L;Mn++}else{o=r;if(Bn===0){peg$fail(P)}}if(o!==r){u=peg$parseheader();if(u!==r){o=[o,u];s=o}else{Mn=s;s=r}}else{Mn=s;s=r}}if(a!==r){i=[i,n,a];t=i}else{Mn=t;t=r}}else{Mn=t;t=r}}else{Mn=t;t=r}return t}function peg$parseheader(){var t,i,n,a;t=Mn;i=peg$parsehname();if(i!==r){if(e.charCodeAt(Mn)===61){n=M;Mn++}else{n=r;if(Bn===0){peg$fail(H)}}if(n!==r){a=peg$parsehvalue();if(a!==r){Hn=t;i=peg$c174(i,a);t=i}else{Mn=t;t=r}}else{Mn=t;t=r}}else{Mn=t;t=r}return t}function peg$parsehname(){var e,t;e=[];t=peg$parsehnv_unreserved();if(t===r){t=peg$parseunreserved();if(t===r){t=peg$parseescaped()}}if(t!==r){while(t!==r){e.push(t);t=peg$parsehnv_unreserved();if(t===r){t=peg$parseunreserved();if(t===r){t=peg$parseescaped()}}}}else{e=r}return e}function peg$parsehvalue(){var e,t;e=[];t=peg$parsehnv_unreserved();if(t===r){t=peg$parseunreserved();if(t===r){t=peg$parseescaped()}}while(t!==r){e.push(t);t=peg$parsehnv_unreserved();if(t===r){t=peg$parseunreserved();if(t===r){t=peg$parseescaped()}}}return e}function peg$parsehnv_unreserved(){var t;if(e.charCodeAt(Mn)===91){t=we;Mn++}else{t=r;if(Bn===0){peg$fail($e)}}if(t===r){if(e.charCodeAt(Mn)===93){t=xe;Mn++}else{t=r;if(Bn===0){peg$fail(Oe)}}if(t===r){if(e.charCodeAt(Mn)===47){t=w;Mn++}else{t=r;if(Bn===0){peg$fail($)}}if(t===r){if(e.charCodeAt(Mn)===63){t=x;Mn++}else{t=r;if(Bn===0){peg$fail(O)}}if(t===r){if(e.charCodeAt(Mn)===58){t=D;Mn++}else{t=r;if(Bn===0){peg$fail(k)}}if(t===r){if(e.charCodeAt(Mn)===43){t=q;Mn++}else{t=r;if(Bn===0){peg$fail(j)}}if(t===r){if(e.charCodeAt(Mn)===36){t=F;Mn++}else{t=r;if(Bn===0){peg$fail(B)}}}}}}}}return t}function peg$parseRequest_Response(){var e;e=peg$parseStatus_Line();if(e===r){e=peg$parseRequest_Line()}return e}function peg$parseRequest_Line(){var e,t,i,n,a,s;e=Mn;t=peg$parseMethod();if(t!==r){i=peg$parseSP();if(i!==r){n=peg$parseRequest_URI();if(n!==r){a=peg$parseSP();if(a!==r){s=peg$parseSIP_Version();if(s!==r){t=[t,i,n,a,s];e=t}else{Mn=e;e=r}}else{Mn=e;e=r}}else{Mn=e;e=r}}else{Mn=e;e=r}}else{Mn=e;e=r}return e}function peg$parseRequest_URI(){var e;e=peg$parseSIP_URI();if(e===r){e=peg$parseabsoluteURI()}return e}function peg$parseabsoluteURI(){var t,i,n,a;t=Mn;i=peg$parsescheme();if(i!==r){if(e.charCodeAt(Mn)===58){n=D;Mn++}else{n=r;if(Bn===0){peg$fail(k)}}if(n!==r){a=peg$parsehier_part();if(a===r){a=peg$parseopaque_part()}if(a!==r){Hn=t;i=peg$c175();t=i}else{Mn=t;t=r}}else{Mn=t;t=r}}else{Mn=t;t=r}return t}function peg$parsehier_part(){var t,i,n,a,s;t=Mn;i=peg$parsenet_path();if(i===r){i=peg$parseabs_path()}if(i!==r){n=Mn;if(e.charCodeAt(Mn)===63){a=x;Mn++}else{a=r;if(Bn===0){peg$fail(O)}}if(a!==r){s=peg$parsequery();if(s!==r){a=[a,s];n=a}else{Mn=n;n=r}}else{Mn=n;n=r}if(n===r){n=null}if(n!==r){i=[i,n];t=i}else{Mn=t;t=r}}else{Mn=t;t=r}return t}function peg$parsenet_path(){var t,i,n,a;t=Mn;if(e.substr(Mn,2)===Ft){i=Ft;Mn+=2}else{i=r;if(Bn===0){peg$fail(Bt)}}if(i!==r){n=peg$parseauthority();if(n!==r){a=peg$parseabs_path();if(a===r){a=null}if(a!==r){i=[i,n,a];t=i}else{Mn=t;t=r}}else{Mn=t;t=r}}else{Mn=t;t=r}return t}function peg$parseabs_path(){var t,i,n;t=Mn;if(e.charCodeAt(Mn)===47){i=w;Mn++}else{i=r;if(Bn===0){peg$fail($)}}if(i!==r){n=peg$parsepath_segments();if(n!==r){i=[i,n];t=i}else{Mn=t;t=r}}else{Mn=t;t=r}return t}function peg$parseopaque_part(){var e,t,i,n;e=Mn;t=peg$parseuric_no_slash();if(t!==r){i=[];n=peg$parseuric();while(n!==r){i.push(n);n=peg$parseuric()}if(i!==r){t=[t,i];e=t}else{Mn=e;e=r}}else{Mn=e;e=r}return e}function peg$parseuric(){var e;e=peg$parsereserved();if(e===r){e=peg$parseunreserved();if(e===r){e=peg$parseescaped()}}return e}function peg$parseuric_no_slash(){var t;t=peg$parseunreserved();if(t===r){t=peg$parseescaped();if(t===r){if(e.charCodeAt(Mn)===59){t=I;Mn++}else{t=r;if(Bn===0){peg$fail(R)}}if(t===r){if(e.charCodeAt(Mn)===63){t=x;Mn++}else{t=r;if(Bn===0){peg$fail(O)}}if(t===r){if(e.charCodeAt(Mn)===58){t=D;Mn++}else{t=r;if(Bn===0){peg$fail(k)}}if(t===r){if(e.charCodeAt(Mn)===64){t=N;Mn++}else{t=r;if(Bn===0){peg$fail(U)}}if(t===r){if(e.charCodeAt(Mn)===38){t=L;Mn++}else{t=r;if(Bn===0){peg$fail(P)}}if(t===r){if(e.charCodeAt(Mn)===61){t=M;Mn++}else{t=r;if(Bn===0){peg$fail(H)}}if(t===r){if(e.charCodeAt(Mn)===43){t=q;Mn++}else{t=r;if(Bn===0){peg$fail(j)}}if(t===r){if(e.charCodeAt(Mn)===36){t=F;Mn++}else{t=r;if(Bn===0){peg$fail(B)}}if(t===r){if(e.charCodeAt(Mn)===44){t=W;Mn++}else{t=r;if(Bn===0){peg$fail(G)}}}}}}}}}}}}return t}function peg$parsepath_segments(){var t,i,n,a,s,o;t=Mn;i=peg$parsesegment();if(i!==r){n=[];a=Mn;if(e.charCodeAt(Mn)===47){s=w;Mn++}else{s=r;if(Bn===0){peg$fail($)}}if(s!==r){o=peg$parsesegment();if(o!==r){s=[s,o];a=s}else{Mn=a;a=r}}else{Mn=a;a=r}while(a!==r){n.push(a);a=Mn;if(e.charCodeAt(Mn)===47){s=w;Mn++}else{s=r;if(Bn===0){peg$fail($)}}if(s!==r){o=peg$parsesegment();if(o!==r){s=[s,o];a=s}else{Mn=a;a=r}}else{Mn=a;a=r}}if(n!==r){i=[i,n];t=i}else{Mn=t;t=r}}else{Mn=t;t=r}return t}function peg$parsesegment(){var t,i,n,a,s,o;t=Mn;i=[];n=peg$parsepchar();while(n!==r){i.push(n);n=peg$parsepchar()}if(i!==r){n=[];a=Mn;if(e.charCodeAt(Mn)===59){s=I;Mn++}else{s=r;if(Bn===0){peg$fail(R)}}if(s!==r){o=peg$parseparam();if(o!==r){s=[s,o];a=s}else{Mn=a;a=r}}else{Mn=a;a=r}while(a!==r){n.push(a);a=Mn;if(e.charCodeAt(Mn)===59){s=I;Mn++}else{s=r;if(Bn===0){peg$fail(R)}}if(s!==r){o=peg$parseparam();if(o!==r){s=[s,o];a=s}else{Mn=a;a=r}}else{Mn=a;a=r}}if(n!==r){i=[i,n];t=i}else{Mn=t;t=r}}else{Mn=t;t=r}return t}function peg$parseparam(){var e,t;e=[];t=peg$parsepchar();while(t!==r){e.push(t);t=peg$parsepchar()}return e}function peg$parsepchar(){var t;t=peg$parseunreserved();if(t===r){t=peg$parseescaped();if(t===r){if(e.charCodeAt(Mn)===58){t=D;Mn++}else{t=r;if(Bn===0){peg$fail(k)}}if(t===r){if(e.charCodeAt(Mn)===64){t=N;Mn++}else{t=r;if(Bn===0){peg$fail(U)}}if(t===r){if(e.charCodeAt(Mn)===38){t=L;Mn++}else{t=r;if(Bn===0){peg$fail(P)}}if(t===r){if(e.charCodeAt(Mn)===61){t=M;Mn++}else{t=r;if(Bn===0){peg$fail(H)}}if(t===r){if(e.charCodeAt(Mn)===43){t=q;Mn++}else{t=r;if(Bn===0){peg$fail(j)}}if(t===r){if(e.charCodeAt(Mn)===36){t=F;Mn++}else{t=r;if(Bn===0){peg$fail(B)}}if(t===r){if(e.charCodeAt(Mn)===44){t=W;Mn++}else{t=r;if(Bn===0){peg$fail(G)}}}}}}}}}}return t}function peg$parsescheme(){var t,i,n,a,s;t=Mn;i=Mn;n=peg$parseALPHA();if(n!==r){a=[];s=peg$parseALPHA();if(s===r){s=peg$parseDIGIT();if(s===r){if(e.charCodeAt(Mn)===43){s=q;Mn++}else{s=r;if(Bn===0){peg$fail(j)}}if(s===r){if(e.charCodeAt(Mn)===45){s=z;Mn++}else{s=r;if(Bn===0){peg$fail(K)}}if(s===r){if(e.charCodeAt(Mn)===46){s=Q;Mn++}else{s=r;if(Bn===0){peg$fail(J)}}}}}}while(s!==r){a.push(s);s=peg$parseALPHA();if(s===r){s=peg$parseDIGIT();if(s===r){if(e.charCodeAt(Mn)===43){s=q;Mn++}else{s=r;if(Bn===0){peg$fail(j)}}if(s===r){if(e.charCodeAt(Mn)===45){s=z;Mn++}else{s=r;if(Bn===0){peg$fail(K)}}if(s===r){if(e.charCodeAt(Mn)===46){s=Q;Mn++}else{s=r;if(Bn===0){peg$fail(J)}}}}}}}if(a!==r){n=[n,a];i=n}else{Mn=i;i=r}}else{Mn=i;i=r}if(i!==r){Hn=t;i=peg$c178()}t=i;return t}function peg$parseauthority(){var e;e=peg$parsesrvr();if(e===r){e=peg$parsereg_name()}return e}function peg$parsesrvr(){var t,i,n,a;t=Mn;i=Mn;n=peg$parseuserinfo();if(n!==r){if(e.charCodeAt(Mn)===64){a=N;Mn++}else{a=r;if(Bn===0){peg$fail(U)}}if(a!==r){n=[n,a];i=n}else{Mn=i;i=r}}else{Mn=i;i=r}if(i===r){i=null}if(i!==r){n=peg$parsehostport();if(n!==r){i=[i,n];t=i}else{Mn=t;t=r}}else{Mn=t;t=r}if(t===r){t=null}return t}function peg$parsereg_name(){var t,i;t=[];i=peg$parseunreserved();if(i===r){i=peg$parseescaped();if(i===r){if(e.charCodeAt(Mn)===36){i=F;Mn++}else{i=r;if(Bn===0){peg$fail(B)}}if(i===r){if(e.charCodeAt(Mn)===44){i=W;Mn++}else{i=r;if(Bn===0){peg$fail(G)}}if(i===r){if(e.charCodeAt(Mn)===59){i=I;Mn++}else{i=r;if(Bn===0){peg$fail(R)}}if(i===r){if(e.charCodeAt(Mn)===58){i=D;Mn++}else{i=r;if(Bn===0){peg$fail(k)}}if(i===r){if(e.charCodeAt(Mn)===64){i=N;Mn++}else{i=r;if(Bn===0){peg$fail(U)}}if(i===r){if(e.charCodeAt(Mn)===38){i=L;Mn++}else{i=r;if(Bn===0){peg$fail(P)}}if(i===r){if(e.charCodeAt(Mn)===61){i=M;Mn++}else{i=r;if(Bn===0){peg$fail(H)}}if(i===r){if(e.charCodeAt(Mn)===43){i=q;Mn++}else{i=r;if(Bn===0){peg$fail(j)}}}}}}}}}}}if(i!==r){while(i!==r){t.push(i);i=peg$parseunreserved();if(i===r){i=peg$parseescaped();if(i===r){if(e.charCodeAt(Mn)===36){i=F;Mn++}else{i=r;if(Bn===0){peg$fail(B)}}if(i===r){if(e.charCodeAt(Mn)===44){i=W;Mn++}else{i=r;if(Bn===0){peg$fail(G)}}if(i===r){if(e.charCodeAt(Mn)===59){i=I;Mn++}else{i=r;if(Bn===0){peg$fail(R)}}if(i===r){if(e.charCodeAt(Mn)===58){i=D;Mn++}else{i=r;if(Bn===0){peg$fail(k)}}if(i===r){if(e.charCodeAt(Mn)===64){i=N;Mn++}else{i=r;if(Bn===0){peg$fail(U)}}if(i===r){if(e.charCodeAt(Mn)===38){i=L;Mn++}else{i=r;if(Bn===0){peg$fail(P)}}if(i===r){if(e.charCodeAt(Mn)===61){i=M;Mn++}else{i=r;if(Bn===0){peg$fail(H)}}if(i===r){if(e.charCodeAt(Mn)===43){i=q;Mn++}else{i=r;if(Bn===0){peg$fail(j)}}}}}}}}}}}}}else{t=r}return t}function peg$parsequery(){var e,t;e=[];t=peg$parseuric();while(t!==r){e.push(t);t=peg$parseuric()}return e}function peg$parseSIP_Version(){var t,i,n,a,s,o,u;t=Mn;if(e.substr(Mn,3).toLowerCase()===Xe){i=e.substr(Mn,3);Mn+=3}else{i=r;if(Bn===0){peg$fail(Wt)}}if(i!==r){if(e.charCodeAt(Mn)===47){n=w;Mn++}else{n=r;if(Bn===0){peg$fail($)}}if(n!==r){a=[];s=peg$parseDIGIT();if(s!==r){while(s!==r){a.push(s);s=peg$parseDIGIT()}}else{a=r}if(a!==r){if(e.charCodeAt(Mn)===46){s=Q;Mn++}else{s=r;if(Bn===0){peg$fail(J)}}if(s!==r){o=[];u=peg$parseDIGIT();if(u!==r){while(u!==r){o.push(u);u=peg$parseDIGIT()}}else{o=r}if(o!==r){Hn=t;i=peg$c180();t=i}else{Mn=t;t=r}}else{Mn=t;t=r}}else{Mn=t;t=r}}else{Mn=t;t=r}}else{Mn=t;t=r}return t}function peg$parseINVITEm(){var t;if(e.substr(Mn,6)===Gt){t=Gt;Mn+=6}else{t=r;if(Bn===0){peg$fail(zt)}}return t}function peg$parseACKm(){var t;if(e.substr(Mn,3)===Kt){t=Kt;Mn+=3}else{t=r;if(Bn===0){peg$fail(Vt)}}return t}function peg$parsePRACKm(){var t;if(e.substr(Mn,5)===Yt){t=Yt;Mn+=5}else{t=r;if(Bn===0){peg$fail(Qt)}}return t}function peg$parseOPTIONSm(){var t;if(e.substr(Mn,7)===Jt){t=Jt;Mn+=7}else{t=r;if(Bn===0){peg$fail(Xt)}}return t}function peg$parseBYEm(){var t;if(e.substr(Mn,3)===Zt){t=Zt;Mn+=3}else{t=r;if(Bn===0){peg$fail(er)}}return t}function peg$parseCANCELm(){var t;if(e.substr(Mn,6)===tr){t=tr;Mn+=6}else{t=r;if(Bn===0){peg$fail(rr)}}return t}function peg$parseREGISTERm(){var t;if(e.substr(Mn,8)===ir){t=ir;Mn+=8}else{t=r;if(Bn===0){peg$fail(nr)}}return t}function peg$parseSUBSCRIBEm(){var t;if(e.substr(Mn,9)===ar){t=ar;Mn+=9}else{t=r;if(Bn===0){peg$fail(sr)}}return t}function peg$parseNOTIFYm(){var t;if(e.substr(Mn,6)===or){t=or;Mn+=6}else{t=r;if(Bn===0){peg$fail(ur)}}return t}function peg$parseREFERm(){var t;if(e.substr(Mn,5)===cr){t=cr;Mn+=5}else{t=r;if(Bn===0){peg$fail(lr)}}return t}function peg$parsePUBLISHm(){var t;if(e.substr(Mn,7)===fr){t=fr;Mn+=7}else{t=r;if(Bn===0){peg$fail(pr)}}return t}function peg$parseMethod(){var e,t;e=Mn;t=peg$parseINVITEm();if(t===r){t=peg$parseACKm();if(t===r){t=peg$parseOPTIONSm();if(t===r){t=peg$parseBYEm();if(t===r){t=peg$parseCANCELm();if(t===r){t=peg$parseREGISTERm();if(t===r){t=peg$parseSUBSCRIBEm();if(t===r){t=peg$parsePUBLISHm();if(t===r){t=peg$parseNOTIFYm();if(t===r){t=peg$parseREFERm();if(t===r){t=peg$parsetoken()}}}}}}}}}}if(t!==r){Hn=e;t=peg$c203()}e=t;return e}function peg$parseStatus_Line(){var e,t,i,n,a,s;e=Mn;t=peg$parseSIP_Version();if(t!==r){i=peg$parseSP();if(i!==r){n=peg$parseStatus_Code();if(n!==r){a=peg$parseSP();if(a!==r){s=peg$parseReason_Phrase();if(s!==r){t=[t,i,n,a,s];e=t}else{Mn=e;e=r}}else{Mn=e;e=r}}else{Mn=e;e=r}}else{Mn=e;e=r}}else{Mn=e;e=r}return e}function peg$parseStatus_Code(){var e,t;e=Mn;t=peg$parseextension_code();if(t!==r){Hn=e;t=peg$c204(t)}e=t;return e}function peg$parseextension_code(){var e,t,i,n;e=Mn;t=peg$parseDIGIT();if(t!==r){i=peg$parseDIGIT();if(i!==r){n=peg$parseDIGIT();if(n!==r){t=[t,i,n];e=t}else{Mn=e;e=r}}else{Mn=e;e=r}}else{Mn=e;e=r}return e}function peg$parseReason_Phrase(){var e,t,i;e=Mn;t=[];i=peg$parsereserved();if(i===r){i=peg$parseunreserved();if(i===r){i=peg$parseescaped();if(i===r){i=peg$parseUTF8_NONASCII();if(i===r){i=peg$parseUTF8_CONT();if(i===r){i=peg$parseSP();if(i===r){i=peg$parseHTAB()}}}}}}while(i!==r){t.push(i);i=peg$parsereserved();if(i===r){i=peg$parseunreserved();if(i===r){i=peg$parseescaped();if(i===r){i=peg$parseUTF8_NONASCII();if(i===r){i=peg$parseUTF8_CONT();if(i===r){i=peg$parseSP();if(i===r){i=peg$parseHTAB()}}}}}}}if(t!==r){Hn=e;t=peg$c205()}e=t;return e}function peg$parseAllow_Events(){var e,t,i,n,a,s;e=Mn;t=peg$parseevent_type();if(t!==r){i=[];n=Mn;a=peg$parseCOMMA();if(a!==r){s=peg$parseevent_type();if(s!==r){a=[a,s];n=a}else{Mn=n;n=r}}else{Mn=n;n=r}while(n!==r){i.push(n);n=Mn;a=peg$parseCOMMA();if(a!==r){s=peg$parseevent_type();if(s!==r){a=[a,s];n=a}else{Mn=n;n=r}}else{Mn=n;n=r}}if(i!==r){t=[t,i];e=t}else{Mn=e;e=r}}else{Mn=e;e=r}return e}function peg$parseCall_ID(){var t,i,n,a,s;t=Mn;i=peg$parseword();if(i!==r){n=Mn;if(e.charCodeAt(Mn)===64){a=N;Mn++}else{a=r;if(Bn===0){peg$fail(U)}}if(a!==r){s=peg$parseword();if(s!==r){a=[a,s];n=a}else{Mn=n;n=r}}else{Mn=n;n=r}if(n===r){n=null}if(n!==r){Hn=t;i=peg$c206();t=i}else{Mn=t;t=r}}else{Mn=t;t=r}return t}function peg$parseContact(){var e,t,i,n,a,s,o;e=Mn;t=peg$parseSTAR();if(t===r){t=Mn;i=peg$parsecontact_param();if(i!==r){n=[];a=Mn;s=peg$parseCOMMA();if(s!==r){o=peg$parsecontact_param();if(o!==r){s=[s,o];a=s}else{Mn=a;a=r}}else{Mn=a;a=r}while(a!==r){n.push(a);a=Mn;s=peg$parseCOMMA();if(s!==r){o=peg$parsecontact_param();if(o!==r){s=[s,o];a=s}else{Mn=a;a=r}}else{Mn=a;a=r}}if(n!==r){i=[i,n];t=i}else{Mn=t;t=r}}else{Mn=t;t=r}}if(t!==r){Hn=e;t=peg$c207()}e=t;return e}function peg$parsecontact_param(){var e,t,i,n,a,s;e=Mn;t=peg$parseSIP_URI_noparams();if(t===r){t=peg$parsename_addr()}if(t!==r){i=[];n=Mn;a=peg$parseSEMI();if(a!==r){s=peg$parsecontact_params();if(s!==r){a=[a,s];n=a}else{Mn=n;n=r}}else{Mn=n;n=r}while(n!==r){i.push(n);n=Mn;a=peg$parseSEMI();if(a!==r){s=peg$parsecontact_params();if(s!==r){a=[a,s];n=a}else{Mn=n;n=r}}else{Mn=n;n=r}}if(i!==r){Hn=e;t=peg$c208();e=t}else{Mn=e;e=r}}else{Mn=e;e=r}return e}function peg$parsename_addr(){var e,t,i,n,a;e=Mn;t=peg$parsedisplayName();if(t===r){t=null}if(t!==r){i=peg$parseLAQUOT();if(i!==r){n=peg$parseSIP_URI();if(n!==r){a=peg$parseRAQUOT();if(a!==r){t=[t,i,n,a];e=t}else{Mn=e;e=r}}else{Mn=e;e=r}}else{Mn=e;e=r}}else{Mn=e;e=r}return e}function peg$parsedisplayName(){var e,t,i,n,a,s,o;e=Mn;t=Mn;i=peg$parsetoken();if(i!==r){n=[];a=Mn;s=peg$parseLWS();if(s!==r){o=peg$parsetoken();if(o!==r){s=[s,o];a=s}else{Mn=a;a=r}}else{Mn=a;a=r}while(a!==r){n.push(a);a=Mn;s=peg$parseLWS();if(s!==r){o=peg$parsetoken();if(o!==r){s=[s,o];a=s}else{Mn=a;a=r}}else{Mn=a;a=r}}if(n!==r){i=[i,n];t=i}else{Mn=t;t=r}}else{Mn=t;t=r}if(t===r){t=peg$parsequoted_string()}if(t!==r){Hn=e;t=peg$c209(t)}e=t;return e}function peg$parsecontact_params(){var e;e=peg$parsec_p_q();if(e===r){e=peg$parsec_p_expires();if(e===r){e=peg$parsegeneric_param()}}return e}function peg$parsec_p_q(){var t,i,n,a;t=Mn;if(e.substr(Mn,1).toLowerCase()===dr){i=e.charAt(Mn);Mn++}else{i=r;if(Bn===0){peg$fail(hr)}}if(i!==r){n=peg$parseEQUAL();if(n!==r){a=peg$parseqvalue();if(a!==r){Hn=t;i=peg$c212(a);t=i}else{Mn=t;t=r}}else{Mn=t;t=r}}else{Mn=t;t=r}return t}function peg$parsec_p_expires(){var t,i,n,a;t=Mn;if(e.substr(Mn,7).toLowerCase()===gr){i=e.substr(Mn,7);Mn+=7}else{i=r;if(Bn===0){peg$fail(vr)}}if(i!==r){n=peg$parseEQUAL();if(n!==r){a=peg$parsedelta_seconds();if(a!==r){Hn=t;i=peg$c215(a);t=i}else{Mn=t;t=r}}else{Mn=t;t=r}}else{Mn=t;t=r}return t}function peg$parsedelta_seconds(){var e,t,i;e=Mn;t=[];i=peg$parseDIGIT();if(i!==r){while(i!==r){t.push(i);i=peg$parseDIGIT()}}else{t=r}if(t!==r){Hn=e;t=peg$c216(t)}e=t;return e}function peg$parseqvalue(){var t,i,n,a,s,o,u;t=Mn;if(e.charCodeAt(Mn)===48){i=mr;Mn++}else{i=r;if(Bn===0){peg$fail(yr)}}if(i!==r){n=Mn;if(e.charCodeAt(Mn)===46){a=Q;Mn++}else{a=r;if(Bn===0){peg$fail(J)}}if(a!==r){s=peg$parseDIGIT();if(s===r){s=null}if(s!==r){o=peg$parseDIGIT();if(o===r){o=null}if(o!==r){u=peg$parseDIGIT();if(u===r){u=null}if(u!==r){a=[a,s,o,u];n=a}else{Mn=n;n=r}}else{Mn=n;n=r}}else{Mn=n;n=r}}else{Mn=n;n=r}if(n===r){n=null}if(n!==r){Hn=t;i=peg$c219();t=i}else{Mn=t;t=r}}else{Mn=t;t=r}return t}function peg$parsegeneric_param(){var e,t,i,n,a;e=Mn;t=peg$parsetoken();if(t!==r){i=Mn;n=peg$parseEQUAL();if(n!==r){a=peg$parsegen_value();if(a!==r){n=[n,a];i=n}else{Mn=i;i=r}}else{Mn=i;i=r}if(i===r){i=null}if(i!==r){Hn=e;t=peg$c220(t,i);e=t}else{Mn=e;e=r}}else{Mn=e;e=r}return e}function peg$parsegen_value(){var e;e=peg$parsetoken();if(e===r){e=peg$parsehost();if(e===r){e=peg$parsequoted_string()}}return e}function peg$parseContent_Disposition(){var e,t,i,n,a,s;e=Mn;t=peg$parsedisp_type();if(t!==r){i=[];n=Mn;a=peg$parseSEMI();if(a!==r){s=peg$parsedisp_param();if(s!==r){a=[a,s];n=a}else{Mn=n;n=r}}else{Mn=n;n=r}while(n!==r){i.push(n);n=Mn;a=peg$parseSEMI();if(a!==r){s=peg$parsedisp_param();if(s!==r){a=[a,s];n=a}else{Mn=n;n=r}}else{Mn=n;n=r}}if(i!==r){t=[t,i];e=t}else{Mn=e;e=r}}else{Mn=e;e=r}return e}function peg$parsedisp_type(){var t,i;t=Mn;if(e.substr(Mn,6).toLowerCase()===Sr){i=e.substr(Mn,6);Mn+=6}else{i=r;if(Bn===0){peg$fail(Tr)}}if(i===r){if(e.substr(Mn,7).toLowerCase()===br){i=e.substr(Mn,7);Mn+=7}else{i=r;if(Bn===0){peg$fail(_r)}}if(i===r){if(e.substr(Mn,4).toLowerCase()===Cr){i=e.substr(Mn,4);Mn+=4}else{i=r;if(Bn===0){peg$fail(Ar)}}if(i===r){if(e.substr(Mn,5).toLowerCase()===Er){i=e.substr(Mn,5);Mn+=5}else{i=r;if(Bn===0){peg$fail(Ir)}}if(i===r){i=peg$parsetoken()}}}}if(i!==r){Hn=t;i=peg$c229()}t=i;return t}function peg$parsedisp_param(){var e;e=peg$parsehandling_param();if(e===r){e=peg$parsegeneric_param()}return e}function peg$parsehandling_param(){var t,i,n,a;t=Mn;if(e.substr(Mn,8).toLowerCase()===Rr){i=e.substr(Mn,8);Mn+=8}else{i=r;if(Bn===0){peg$fail(wr)}}if(i!==r){n=peg$parseEQUAL();if(n!==r){if(e.substr(Mn,8).toLowerCase()===$r){a=e.substr(Mn,8);Mn+=8}else{a=r;if(Bn===0){peg$fail(xr)}}if(a===r){if(e.substr(Mn,8).toLowerCase()===Or){a=e.substr(Mn,8);Mn+=8}else{a=r;if(Bn===0){peg$fail(Dr)}}if(a===r){a=peg$parsetoken()}}if(a!==r){i=[i,n,a];t=i}else{Mn=t;t=r}}else{Mn=t;t=r}}else{Mn=t;t=r}return t}function peg$parseContent_Encoding(){var e,t,i,n,a,s;e=Mn;t=peg$parsetoken();if(t!==r){i=[];n=Mn;a=peg$parseCOMMA();if(a!==r){s=peg$parsetoken();if(s!==r){a=[a,s];n=a}else{Mn=n;n=r}}else{Mn=n;n=r}while(n!==r){i.push(n);n=Mn;a=peg$parseCOMMA();if(a!==r){s=peg$parsetoken();if(s!==r){a=[a,s];n=a}else{Mn=n;n=r}}else{Mn=n;n=r}}if(i!==r){t=[t,i];e=t}else{Mn=e;e=r}}else{Mn=e;e=r}return e}function peg$parseContent_Length(){var e,t,i;e=Mn;t=[];i=peg$parseDIGIT();if(i!==r){while(i!==r){t.push(i);i=peg$parseDIGIT()}}else{t=r}if(t!==r){Hn=e;t=peg$c236(t)}e=t;return e}function peg$parseContent_Type(){var e,t;e=Mn;t=peg$parsemedia_type();if(t!==r){Hn=e;t=peg$c237()}e=t;return e}function peg$parsemedia_type(){var e,t,i,n,a,s,o,u;e=Mn;t=peg$parsem_type();if(t!==r){i=peg$parseSLASH();if(i!==r){n=peg$parsem_subtype();if(n!==r){a=[];s=Mn;o=peg$parseSEMI();if(o!==r){u=peg$parsem_parameter();if(u!==r){o=[o,u];s=o}else{Mn=s;s=r}}else{Mn=s;s=r}while(s!==r){a.push(s);s=Mn;o=peg$parseSEMI();if(o!==r){u=peg$parsem_parameter();if(u!==r){o=[o,u];s=o}else{Mn=s;s=r}}else{Mn=s;s=r}}if(a!==r){t=[t,i,n,a];e=t}else{Mn=e;e=r}}else{Mn=e;e=r}}else{Mn=e;e=r}}else{Mn=e;e=r}return e}function peg$parsem_type(){var e;e=peg$parsediscrete_type();if(e===r){e=peg$parsecomposite_type()}return e}function peg$parsediscrete_type(){var t;if(e.substr(Mn,4).toLowerCase()===kr){t=e.substr(Mn,4);Mn+=4}else{t=r;if(Bn===0){peg$fail(Nr)}}if(t===r){if(e.substr(Mn,5).toLowerCase()===Ur){t=e.substr(Mn,5);Mn+=5}else{t=r;if(Bn===0){peg$fail(Lr)}}if(t===r){if(e.substr(Mn,5).toLowerCase()===Pr){t=e.substr(Mn,5);Mn+=5}else{t=r;if(Bn===0){peg$fail(Mr)}}if(t===r){if(e.substr(Mn,5).toLowerCase()===Hr){t=e.substr(Mn,5);Mn+=5}else{t=r;if(Bn===0){peg$fail(qr)}}if(t===r){if(e.substr(Mn,11).toLowerCase()===jr){t=e.substr(Mn,11);Mn+=11}else{t=r;if(Bn===0){peg$fail(Fr)}}if(t===r){t=peg$parseextension_token()}}}}}return t}function peg$parsecomposite_type(){var t;if(e.substr(Mn,7).toLowerCase()===Br){t=e.substr(Mn,7);Mn+=7}else{t=r;if(Bn===0){peg$fail(Wr)}}if(t===r){if(e.substr(Mn,9).toLowerCase()===Gr){t=e.substr(Mn,9);Mn+=9}else{t=r;if(Bn===0){peg$fail(zr)}}if(t===r){t=peg$parseextension_token()}}return t}function peg$parseextension_token(){var e;e=peg$parsetoken();if(e===r){e=peg$parsex_token()}return e}function peg$parsex_token(){var t,i,n;t=Mn;if(e.substr(Mn,2).toLowerCase()===Kr){i=e.substr(Mn,2);Mn+=2}else{i=r;if(Bn===0){peg$fail(Vr)}}if(i!==r){n=peg$parsetoken();if(n!==r){i=[i,n];t=i}else{Mn=t;t=r}}else{Mn=t;t=r}return t}function peg$parsem_subtype(){var e;e=peg$parseextension_token();if(e===r){e=peg$parsetoken()}return e}function peg$parsem_parameter(){var e,t,i,n;e=Mn;t=peg$parsetoken();if(t!==r){i=peg$parseEQUAL();if(i!==r){n=peg$parsem_value();if(n!==r){t=[t,i,n];e=t}else{Mn=e;e=r}}else{Mn=e;e=r}}else{Mn=e;e=r}return e}function peg$parsem_value(){var e;e=peg$parsetoken();if(e===r){e=peg$parsequoted_string()}return e}function peg$parseCSeq(){var e,t,i,n;e=Mn;t=peg$parseCSeq_value();if(t!==r){i=peg$parseLWS();if(i!==r){n=peg$parseMethod();if(n!==r){t=[t,i,n];e=t}else{Mn=e;e=r}}else{Mn=e;e=r}}else{Mn=e;e=r}return e}function peg$parseCSeq_value(){var e,t,i;e=Mn;t=[];i=peg$parseDIGIT();if(i!==r){while(i!==r){t.push(i);i=peg$parseDIGIT()}}else{t=r}if(t!==r){Hn=e;t=peg$c254(t)}e=t;return e}function peg$parseExpires(){var e,t;e=Mn;t=peg$parsedelta_seconds();if(t!==r){Hn=e;t=peg$c255(t)}e=t;return e}function peg$parseEvent(){var e,t,i,n,a,s;e=Mn;t=peg$parseevent_type();if(t!==r){i=[];n=Mn;a=peg$parseSEMI();if(a!==r){s=peg$parsegeneric_param();if(s!==r){a=[a,s];n=a}else{Mn=n;n=r}}else{Mn=n;n=r}while(n!==r){i.push(n);n=Mn;a=peg$parseSEMI();if(a!==r){s=peg$parsegeneric_param();if(s!==r){a=[a,s];n=a}else{Mn=n;n=r}}else{Mn=n;n=r}}if(i!==r){Hn=e;t=peg$c256(t);e=t}else{Mn=e;e=r}}else{Mn=e;e=r}return e}function peg$parseevent_type(){var t,i,n,a,s,o,u;t=Mn;i=Mn;n=peg$parsetoken_nodot();if(n!==r){a=[];s=Mn;if(e.charCodeAt(Mn)===46){o=Q;Mn++}else{o=r;if(Bn===0){peg$fail(J)}}if(o!==r){u=peg$parsetoken_nodot();if(u!==r){o=[o,u];s=o}else{Mn=s;s=r}}else{Mn=s;s=r}while(s!==r){a.push(s);s=Mn;if(e.charCodeAt(Mn)===46){o=Q;Mn++}else{o=r;if(Bn===0){peg$fail(J)}}if(o!==r){u=peg$parsetoken_nodot();if(u!==r){o=[o,u];s=o}else{Mn=s;s=r}}else{Mn=s;s=r}}if(a!==r){n=[n,a];i=n}else{Mn=i;i=r}}else{Mn=i;i=r}if(i!==r){t=e.substring(t,Mn)}else{t=i}return t}function peg$parseFrom(){var e,t,i,n,a,s;e=Mn;t=peg$parseSIP_URI_noparams();if(t===r){t=peg$parsename_addr()}if(t!==r){i=[];n=Mn;a=peg$parseSEMI();if(a!==r){s=peg$parsefrom_param();if(s!==r){a=[a,s];n=a}else{Mn=n;n=r}}else{Mn=n;n=r}while(n!==r){i.push(n);n=Mn;a=peg$parseSEMI();if(a!==r){s=peg$parsefrom_param();if(s!==r){a=[a,s];n=a}else{Mn=n;n=r}}else{Mn=n;n=r}}if(i!==r){Hn=e;t=peg$c257();e=t}else{Mn=e;e=r}}else{Mn=e;e=r}return e}function peg$parsefrom_param(){var e;e=peg$parsetag_param();if(e===r){e=peg$parsegeneric_param()}return e}function peg$parsetag_param(){var t,i,n,a;t=Mn;if(e.substr(Mn,3).toLowerCase()===Yr){i=e.substr(Mn,3);Mn+=3}else{i=r;if(Bn===0){peg$fail(Qr)}}if(i!==r){n=peg$parseEQUAL();if(n!==r){a=peg$parsetoken();if(a!==r){Hn=t;i=peg$c260(a);t=i}else{Mn=t;t=r}}else{Mn=t;t=r}}else{Mn=t;t=r}return t}function peg$parseMax_Forwards(){var e,t,i;e=Mn;t=[];i=peg$parseDIGIT();if(i!==r){while(i!==r){t.push(i);i=peg$parseDIGIT()}}else{t=r}if(t!==r){Hn=e;t=peg$c261(t)}e=t;return e}function peg$parseMin_Expires(){var e,t;e=Mn;t=peg$parsedelta_seconds();if(t!==r){Hn=e;t=peg$c262(t)}e=t;return e}function peg$parseName_Addr_Header(){var e,t,i,n,a,s,o,u,c;e=Mn;t=[];i=peg$parsedisplayName();while(i!==r){t.push(i);i=peg$parsedisplayName()}if(t!==r){i=peg$parseLAQUOT();if(i!==r){n=peg$parseSIP_URI();if(n!==r){a=peg$parseRAQUOT();if(a!==r){s=[];o=Mn;u=peg$parseSEMI();if(u!==r){c=peg$parsegeneric_param();if(c!==r){u=[u,c];o=u}else{Mn=o;o=r}}else{Mn=o;o=r}while(o!==r){s.push(o);o=Mn;u=peg$parseSEMI();if(u!==r){c=peg$parsegeneric_param();if(c!==r){u=[u,c];o=u}else{Mn=o;o=r}}else{Mn=o;o=r}}if(s!==r){Hn=e;t=peg$c263();e=t}else{Mn=e;e=r}}else{Mn=e;e=r}}else{Mn=e;e=r}}else{Mn=e;e=r}}else{Mn=e;e=r}return e}function peg$parseProxy_Authenticate(){var e;e=peg$parsechallenge();return e}function peg$parsechallenge(){var t,i,n,a,s,o,u,c;t=Mn;if(e.substr(Mn,6).toLowerCase()===Jr){i=e.substr(Mn,6);Mn+=6}else{i=r;if(Bn===0){peg$fail(Xr)}}if(i!==r){n=peg$parseLWS();if(n!==r){a=peg$parsedigest_cln();if(a!==r){s=[];o=Mn;u=peg$parseCOMMA();if(u!==r){c=peg$parsedigest_cln();if(c!==r){u=[u,c];o=u}else{Mn=o;o=r}}else{Mn=o;o=r}while(o!==r){s.push(o);o=Mn;u=peg$parseCOMMA();if(u!==r){c=peg$parsedigest_cln();if(c!==r){u=[u,c];o=u}else{Mn=o;o=r}}else{Mn=o;o=r}}if(s!==r){i=[i,n,a,s];t=i}else{Mn=t;t=r}}else{Mn=t;t=r}}else{Mn=t;t=r}}else{Mn=t;t=r}if(t===r){t=peg$parseother_challenge()}return t}function peg$parseother_challenge(){var e,t,i,n,a,s,o,u;e=Mn;t=peg$parsetoken();if(t!==r){i=peg$parseLWS();if(i!==r){n=peg$parseauth_param();if(n!==r){a=[];s=Mn;o=peg$parseCOMMA();if(o!==r){u=peg$parseauth_param();if(u!==r){o=[o,u];s=o}else{Mn=s;s=r}}else{Mn=s;s=r}while(s!==r){a.push(s);s=Mn;o=peg$parseCOMMA();if(o!==r){u=peg$parseauth_param();if(u!==r){o=[o,u];s=o}else{Mn=s;s=r}}else{Mn=s;s=r}}if(a!==r){t=[t,i,n,a];e=t}else{Mn=e;e=r}}else{Mn=e;e=r}}else{Mn=e;e=r}}else{Mn=e;e=r}return e}function peg$parseauth_param(){var e,t,i,n;e=Mn;t=peg$parsetoken();if(t!==r){i=peg$parseEQUAL();if(i!==r){n=peg$parsetoken();if(n===r){n=peg$parsequoted_string()}if(n!==r){t=[t,i,n];e=t}else{Mn=e;e=r}}else{Mn=e;e=r}}else{Mn=e;e=r}return e}function peg$parsedigest_cln(){var e;e=peg$parserealm();if(e===r){e=peg$parsedomain();if(e===r){e=peg$parsenonce();if(e===r){e=peg$parseopaque();if(e===r){e=peg$parsestale();if(e===r){e=peg$parsealgorithm();if(e===r){e=peg$parseqop_options();if(e===r){e=peg$parseauth_param()}}}}}}}return e}function peg$parserealm(){var t,i,n,a;t=Mn;if(e.substr(Mn,5).toLowerCase()===Zr){i=e.substr(Mn,5);Mn+=5}else{i=r;if(Bn===0){peg$fail(ei)}}if(i!==r){n=peg$parseEQUAL();if(n!==r){a=peg$parserealm_value();if(a!==r){i=[i,n,a];t=i}else{Mn=t;t=r}}else{Mn=t;t=r}}else{Mn=t;t=r}return t}function peg$parserealm_value(){var e,t;e=Mn;t=peg$parsequoted_string_clean();if(t!==r){Hn=e;t=peg$c268(t)}e=t;return e}function peg$parsedomain(){var t,i,n,a,s,o,u,c,l;t=Mn;if(e.substr(Mn,6).toLowerCase()===ti){i=e.substr(Mn,6);Mn+=6}else{i=r;if(Bn===0){peg$fail(ri)}}if(i!==r){n=peg$parseEQUAL();if(n!==r){a=peg$parseLDQUOT();if(a!==r){s=peg$parseURI();if(s!==r){o=[];u=Mn;c=[];l=peg$parseSP();if(l!==r){while(l!==r){c.push(l);l=peg$parseSP()}}else{c=r}if(c!==r){l=peg$parseURI();if(l!==r){c=[c,l];u=c}else{Mn=u;u=r}}else{Mn=u;u=r}while(u!==r){o.push(u);u=Mn;c=[];l=peg$parseSP();if(l!==r){while(l!==r){c.push(l);l=peg$parseSP()}}else{c=r}if(c!==r){l=peg$parseURI();if(l!==r){c=[c,l];u=c}else{Mn=u;u=r}}else{Mn=u;u=r}}if(o!==r){u=peg$parseRDQUOT();if(u!==r){i=[i,n,a,s,o,u];t=i}else{Mn=t;t=r}}else{Mn=t;t=r}}else{Mn=t;t=r}}else{Mn=t;t=r}}else{Mn=t;t=r}}else{Mn=t;t=r}return t}function peg$parseURI(){var e;e=peg$parseabsoluteURI();if(e===r){e=peg$parseabs_path()}return e}function peg$parsenonce(){var t,i,n,a;t=Mn;if(e.substr(Mn,5).toLowerCase()===ii){i=e.substr(Mn,5);Mn+=5}else{i=r;if(Bn===0){peg$fail(ni)}}if(i!==r){n=peg$parseEQUAL();if(n!==r){a=peg$parsenonce_value();if(a!==r){i=[i,n,a];t=i}else{Mn=t;t=r}}else{Mn=t;t=r}}else{Mn=t;t=r}return t}function peg$parsenonce_value(){var e,t;e=Mn;t=peg$parsequoted_string_clean();if(t!==r){Hn=e;t=peg$c273(t)}e=t;return e}function peg$parseopaque(){var t,i,n,a;t=Mn;if(e.substr(Mn,6).toLowerCase()===ai){i=e.substr(Mn,6);Mn+=6}else{i=r;if(Bn===0){peg$fail(si)}}if(i!==r){n=peg$parseEQUAL();if(n!==r){a=peg$parsequoted_string_clean();if(a!==r){Hn=t;i=peg$c276(a);t=i}else{Mn=t;t=r}}else{Mn=t;t=r}}else{Mn=t;t=r}return t}function peg$parsestale(){var t,i,n,a,s;t=Mn;if(e.substr(Mn,5).toLowerCase()===oi){i=e.substr(Mn,5);Mn+=5}else{i=r;if(Bn===0){peg$fail(ui)}}if(i!==r){n=peg$parseEQUAL();if(n!==r){a=Mn;if(e.substr(Mn,4).toLowerCase()===ci){s=e.substr(Mn,4);Mn+=4}else{s=r;if(Bn===0){peg$fail(li)}}if(s!==r){Hn=a;s=peg$c281()}a=s;if(a===r){a=Mn;if(e.substr(Mn,5).toLowerCase()===fi){s=e.substr(Mn,5);Mn+=5}else{s=r;if(Bn===0){peg$fail(pi)}}if(s!==r){Hn=a;s=peg$c284()}a=s}if(a!==r){i=[i,n,a];t=i}else{Mn=t;t=r}}else{Mn=t;t=r}}else{Mn=t;t=r}return t}function peg$parsealgorithm(){var t,i,n,a;t=Mn;if(e.substr(Mn,9).toLowerCase()===di){i=e.substr(Mn,9);Mn+=9}else{i=r;if(Bn===0){peg$fail(hi)}}if(i!==r){n=peg$parseEQUAL();if(n!==r){if(e.substr(Mn,3).toLowerCase()===gi){a=e.substr(Mn,3);Mn+=3}else{a=r;if(Bn===0){peg$fail(vi)}}if(a===r){if(e.substr(Mn,8).toLowerCase()===mi){a=e.substr(Mn,8);Mn+=8}else{a=r;if(Bn===0){peg$fail(yi)}}if(a===r){a=peg$parsetoken()}}if(a!==r){Hn=t;i=peg$c291(a);t=i}else{Mn=t;t=r}}else{Mn=t;t=r}}else{Mn=t;t=r}return t}function peg$parseqop_options(){var t,i,n,a,s,o,u,c,l,f;t=Mn;if(e.substr(Mn,3).toLowerCase()===Si){i=e.substr(Mn,3);Mn+=3}else{i=r;if(Bn===0){peg$fail(Ti)}}if(i!==r){n=peg$parseEQUAL();if(n!==r){a=peg$parseLDQUOT();if(a!==r){s=Mn;o=peg$parseqop_value();if(o!==r){u=[];c=Mn;if(e.charCodeAt(Mn)===44){l=W;Mn++}else{l=r;if(Bn===0){peg$fail(G)}}if(l!==r){f=peg$parseqop_value();if(f!==r){l=[l,f];c=l}else{Mn=c;c=r}}else{Mn=c;c=r}while(c!==r){u.push(c);c=Mn;if(e.charCodeAt(Mn)===44){l=W;Mn++}else{l=r;if(Bn===0){peg$fail(G)}}if(l!==r){f=peg$parseqop_value();if(f!==r){l=[l,f];c=l}else{Mn=c;c=r}}else{Mn=c;c=r}}if(u!==r){o=[o,u];s=o}else{Mn=s;s=r}}else{Mn=s;s=r}if(s!==r){o=peg$parseRDQUOT();if(o!==r){i=[i,n,a,s,o];t=i}else{Mn=t;t=r}}else{Mn=t;t=r}}else{Mn=t;t=r}}else{Mn=t;t=r}}else{Mn=t;t=r}return t}function peg$parseqop_value(){var t,i;t=Mn;if(e.substr(Mn,8).toLowerCase()===bi){i=e.substr(Mn,8);Mn+=8}else{i=r;if(Bn===0){peg$fail(_i)}}if(i===r){if(e.substr(Mn,4).toLowerCase()===Ci){i=e.substr(Mn,4);Mn+=4}else{i=r;if(Bn===0){peg$fail(Ai)}}if(i===r){i=peg$parsetoken()}}if(i!==r){Hn=t;i=peg$c298(i)}t=i;return t}function peg$parseProxy_Require(){var e,t,i,n,a,s;e=Mn;t=peg$parsetoken();if(t!==r){i=[];n=Mn;a=peg$parseCOMMA();if(a!==r){s=peg$parsetoken();if(s!==r){a=[a,s];n=a}else{Mn=n;n=r}}else{Mn=n;n=r}while(n!==r){i.push(n);n=Mn;a=peg$parseCOMMA();if(a!==r){s=peg$parsetoken();if(s!==r){a=[a,s];n=a}else{Mn=n;n=r}}else{Mn=n;n=r}}if(i!==r){t=[t,i];e=t}else{Mn=e;e=r}}else{Mn=e;e=r}return e}function peg$parseRAck(){var e,t,i,n,a,s;e=Mn;t=peg$parseRAck_value();if(t!==r){i=peg$parseLWS();if(i!==r){n=peg$parseRAck_value();if(n!==r){a=peg$parseLWS();if(a!==r){s=peg$parseMethod();if(s!==r){t=[t,i,n,a,s];e=t}else{Mn=e;e=r}}else{Mn=e;e=r}}else{Mn=e;e=r}}else{Mn=e;e=r}}else{Mn=e;e=r}return e}function peg$parseRAck_value(){var e,t,i;e=Mn;t=[];i=peg$parseDIGIT();if(i!==r){while(i!==r){t.push(i);i=peg$parseDIGIT()}}else{t=r}if(t!==r){Hn=e;t=peg$c299(t)}e=t;return e}function peg$parseRecord_Route(){var e,t,i,n,a,s;e=Mn;t=peg$parserec_route();if(t!==r){i=[];n=Mn;a=peg$parseCOMMA();if(a!==r){s=peg$parserec_route();if(s!==r){a=[a,s];n=a}else{Mn=n;n=r}}else{Mn=n;n=r}while(n!==r){i.push(n);n=Mn;a=peg$parseCOMMA();if(a!==r){s=peg$parserec_route();if(s!==r){a=[a,s];n=a}else{Mn=n;n=r}}else{Mn=n;n=r}}if(i!==r){Hn=e;t=peg$c300();e=t}else{Mn=e;e=r}}else{Mn=e;e=r}return e}function peg$parserec_route(){var e,t,i,n,a,s;e=Mn;t=peg$parsename_addr();if(t!==r){i=[];n=Mn;a=peg$parseSEMI();if(a!==r){s=peg$parsegeneric_param();if(s!==r){a=[a,s];n=a}else{Mn=n;n=r}}else{Mn=n;n=r}while(n!==r){i.push(n);n=Mn;a=peg$parseSEMI();if(a!==r){s=peg$parsegeneric_param();if(s!==r){a=[a,s];n=a}else{Mn=n;n=r}}else{Mn=n;n=r}}if(i!==r){Hn=e;t=peg$c301();e=t}else{Mn=e;e=r}}else{Mn=e;e=r}return e}function peg$parseRefer_To(){var e,t,i,n,a,s;e=Mn;t=peg$parseSIP_URI_noparams();if(t===r){t=peg$parsename_addr();if(t===r){t=Mn;i=peg$parseLAQUOT();if(i===r){i=null}if(i!==r){n=peg$parseabsoluteURI();if(n!==r){a=peg$parseRAQUOT();if(a===r){a=null}if(a!==r){i=[i,n,a];t=i}else{Mn=t;t=r}}else{Mn=t;t=r}}else{Mn=t;t=r}}}if(t!==r){i=[];n=Mn;a=peg$parseSEMI();if(a!==r){s=peg$parsegeneric_param();if(s!==r){a=[a,s];n=a}else{Mn=n;n=r}}else{Mn=n;n=r}while(n!==r){i.push(n);n=Mn;a=peg$parseSEMI();if(a!==r){s=peg$parsegeneric_param();if(s!==r){a=[a,s];n=a}else{Mn=n;n=r}}else{Mn=n;n=r}}if(i!==r){Hn=e;t=peg$c302();e=t}else{Mn=e;e=r}}else{Mn=e;e=r}return e}function peg$parseReplaces(){var e,t,i,n,a,s;e=Mn;t=peg$parsereplaces_call_id();if(t!==r){i=[];n=Mn;a=peg$parseSEMI();if(a!==r){s=peg$parsereplaces_params();if(s!==r){a=[a,s];n=a}else{Mn=n;n=r}}else{Mn=n;n=r}while(n!==r){i.push(n);n=Mn;a=peg$parseSEMI();if(a!==r){s=peg$parsereplaces_params();if(s!==r){a=[a,s];n=a}else{Mn=n;n=r}}else{Mn=n;n=r}}if(i!==r){Hn=e;t=peg$c303();e=t}else{Mn=e;e=r}}else{Mn=e;e=r}return e}function peg$parsereplaces_call_id(){var e,t;e=Mn;t=peg$parseCall_ID();if(t!==r){Hn=e;t=peg$c304()}e=t;return e}function peg$parsereplaces_params(){var t,i,n,a;t=Mn;if(e.substr(Mn,8).toLowerCase()===Ei){i=e.substr(Mn,8);Mn+=8}else{i=r;if(Bn===0){peg$fail(Ii)}}if(i!==r){n=peg$parseEQUAL();if(n!==r){a=peg$parsetoken();if(a!==r){Hn=t;i=peg$c307(a);t=i}else{Mn=t;t=r}}else{Mn=t;t=r}}else{Mn=t;t=r}if(t===r){t=Mn;if(e.substr(Mn,6).toLowerCase()===Ri){i=e.substr(Mn,6);Mn+=6}else{i=r;if(Bn===0){peg$fail(wi)}}if(i!==r){n=peg$parseEQUAL();if(n!==r){a=peg$parsetoken();if(a!==r){Hn=t;i=peg$c310(a);t=i}else{Mn=t;t=r}}else{Mn=t;t=r}}else{Mn=t;t=r}if(t===r){t=Mn;if(e.substr(Mn,10).toLowerCase()===$i){i=e.substr(Mn,10);Mn+=10}else{i=r;if(Bn===0){peg$fail(xi)}}if(i!==r){Hn=t;i=peg$c313()}t=i;if(t===r){t=peg$parsegeneric_param()}}}return t}function peg$parseRequire(){var e,t,i,n,a,s,o;e=Mn;t=Mn;i=peg$parsetoken();if(i!==r){n=[];a=Mn;s=peg$parseCOMMA();if(s!==r){o=peg$parsetoken();if(o!==r){Hn=a;s=peg$c314(i,o);a=s}else{Mn=a;a=r}}else{Mn=a;a=r}while(a!==r){n.push(a);a=Mn;s=peg$parseCOMMA();if(s!==r){o=peg$parsetoken();if(o!==r){Hn=a;s=peg$c314(i,o);a=s}else{Mn=a;a=r}}else{Mn=a;a=r}}if(n!==r){Hn=t;i=peg$c315(i,n);t=i}else{Mn=t;t=r}}else{Mn=t;t=r}if(t===r){t=null}if(t!==r){Hn=e;t=peg$c316(t)}e=t;return e}function peg$parseRoute(){var e,t,i,n,a,s;e=Mn;t=peg$parseroute_param();if(t!==r){i=[];n=Mn;a=peg$parseCOMMA();if(a!==r){s=peg$parseroute_param();if(s!==r){a=[a,s];n=a}else{Mn=n;n=r}}else{Mn=n;n=r}while(n!==r){i.push(n);n=Mn;a=peg$parseCOMMA();if(a!==r){s=peg$parseroute_param();if(s!==r){a=[a,s];n=a}else{Mn=n;n=r}}else{Mn=n;n=r}}if(i!==r){t=[t,i];e=t}else{Mn=e;e=r}}else{Mn=e;e=r}return e}function peg$parseroute_param(){var e,t,i,n,a,s;e=Mn;t=peg$parsename_addr();if(t!==r){i=[];n=Mn;a=peg$parseSEMI();if(a!==r){s=peg$parsegeneric_param();if(s!==r){a=[a,s];n=a}else{Mn=n;n=r}}else{Mn=n;n=r}while(n!==r){i.push(n);n=Mn;a=peg$parseSEMI();if(a!==r){s=peg$parsegeneric_param();if(s!==r){a=[a,s];n=a}else{Mn=n;n=r}}else{Mn=n;n=r}}if(i!==r){t=[t,i];e=t}else{Mn=e;e=r}}else{Mn=e;e=r}return e}function peg$parseRSeq(){var e,t,i;e=Mn;t=[];i=peg$parseDIGIT();if(i!==r){while(i!==r){t.push(i);i=peg$parseDIGIT()}}else{t=r}if(t!==r){Hn=e;t=peg$c317(t)}e=t;return e}function peg$parseSubscription_State(){var e,t,i,n,a,s;e=Mn;t=peg$parsesubstate_value();if(t!==r){i=[];n=Mn;a=peg$parseSEMI();if(a!==r){s=peg$parsesubexp_params();if(s!==r){a=[a,s];n=a}else{Mn=n;n=r}}else{Mn=n;n=r}while(n!==r){i.push(n);n=Mn;a=peg$parseSEMI();if(a!==r){s=peg$parsesubexp_params();if(s!==r){a=[a,s];n=a}else{Mn=n;n=r}}else{Mn=n;n=r}}if(i!==r){t=[t,i];e=t}else{Mn=e;e=r}}else{Mn=e;e=r}return e}function peg$parsesubstate_value(){var t,i;t=Mn;if(e.substr(Mn,6).toLowerCase()===Oi){i=e.substr(Mn,6);Mn+=6}else{i=r;if(Bn===0){peg$fail(Di)}}if(i===r){if(e.substr(Mn,7).toLowerCase()===ki){i=e.substr(Mn,7);Mn+=7}else{i=r;if(Bn===0){peg$fail(Ni)}}if(i===r){if(e.substr(Mn,10).toLowerCase()===Ui){i=e.substr(Mn,10);Mn+=10}else{i=r;if(Bn===0){peg$fail(Li)}}if(i===r){i=peg$parsetoken()}}}if(i!==r){Hn=t;i=peg$c324()}t=i;return t}function peg$parsesubexp_params(){var t,i,n,a;t=Mn;if(e.substr(Mn,6).toLowerCase()===Pi){i=e.substr(Mn,6);Mn+=6}else{i=r;if(Bn===0){peg$fail(Mi)}}if(i!==r){n=peg$parseEQUAL();if(n!==r){a=peg$parseevent_reason_value();if(a!==r){Hn=t;i=peg$c327(a);t=i}else{Mn=t;t=r}}else{Mn=t;t=r}}else{Mn=t;t=r}if(t===r){t=Mn;if(e.substr(Mn,7).toLowerCase()===gr){i=e.substr(Mn,7);Mn+=7}else{i=r;if(Bn===0){peg$fail(vr)}}if(i!==r){n=peg$parseEQUAL();if(n!==r){a=peg$parsedelta_seconds();if(a!==r){Hn=t;i=peg$c328(a);t=i}else{Mn=t;t=r}}else{Mn=t;t=r}}else{Mn=t;t=r}if(t===r){t=Mn;if(e.substr(Mn,11).toLowerCase()===Hi){i=e.substr(Mn,11);Mn+=11}else{i=r;if(Bn===0){peg$fail(qi)}}if(i!==r){n=peg$parseEQUAL();if(n!==r){a=peg$parsedelta_seconds();if(a!==r){Hn=t;i=peg$c331(a);t=i}else{Mn=t;t=r}}else{Mn=t;t=r}}else{Mn=t;t=r}if(t===r){t=peg$parsegeneric_param()}}}return t}function peg$parseevent_reason_value(){var t;if(e.substr(Mn,11).toLowerCase()===ji){t=e.substr(Mn,11);Mn+=11}else{t=r;if(Bn===0){peg$fail(Fi)}}if(t===r){if(e.substr(Mn,9).toLowerCase()===Bi){t=e.substr(Mn,9);Mn+=9}else{t=r;if(Bn===0){peg$fail(Wi)}}if(t===r){if(e.substr(Mn,8).toLowerCase()===Gi){t=e.substr(Mn,8);Mn+=8}else{t=r;if(Bn===0){peg$fail(zi)}}if(t===r){if(e.substr(Mn,7).toLowerCase()===Ki){t=e.substr(Mn,7);Mn+=7}else{t=r;if(Bn===0){peg$fail(Vi)}}if(t===r){if(e.substr(Mn,6).toLowerCase()===Yi){t=e.substr(Mn,6);Mn+=6}else{t=r;if(Bn===0){peg$fail(Qi)}}if(t===r){if(e.substr(Mn,10).toLowerCase()===Ji){t=e.substr(Mn,10);Mn+=10}else{t=r;if(Bn===0){peg$fail(Xi)}}if(t===r){if(e.substr(Mn,9).toLowerCase()===Zi){t=e.substr(Mn,9);Mn+=9}else{t=r;if(Bn===0){peg$fail(en)}}if(t===r){t=peg$parsetoken()}}}}}}}return t}function peg$parseSubject(){var e;e=peg$parseTEXT_UTF8_TRIM();if(e===r){e=null}return e}function peg$parseSupported(){var e,t,i,n,a,s,o;e=Mn;t=Mn;i=peg$parsetoken();if(i!==r){n=[];a=Mn;s=peg$parseCOMMA();if(s!==r){o=peg$parsetoken();if(o!==r){Hn=a;s=peg$c314(i,o);a=s}else{Mn=a;a=r}}else{Mn=a;a=r}while(a!==r){n.push(a);a=Mn;s=peg$parseCOMMA();if(s!==r){o=peg$parsetoken();if(o!==r){Hn=a;s=peg$c314(i,o);a=s}else{Mn=a;a=r}}else{Mn=a;a=r}}if(n!==r){Hn=t;i=peg$c315(i,n);t=i}else{Mn=t;t=r}}else{Mn=t;t=r}if(t===r){t=null}if(t!==r){Hn=e;t=peg$c346(t)}e=t;return e}function peg$parseTo(){var e,t,i,n,a,s;e=Mn;t=peg$parseSIP_URI_noparams();if(t===r){t=peg$parsename_addr()}if(t!==r){i=[];n=Mn;a=peg$parseSEMI();if(a!==r){s=peg$parseto_param();if(s!==r){a=[a,s];n=a}else{Mn=n;n=r}}else{Mn=n;n=r}while(n!==r){i.push(n);n=Mn;a=peg$parseSEMI();if(a!==r){s=peg$parseto_param();if(s!==r){a=[a,s];n=a}else{Mn=n;n=r}}else{Mn=n;n=r}}if(i!==r){Hn=e;t=peg$c347();e=t}else{Mn=e;e=r}}else{Mn=e;e=r}return e}function peg$parseto_param(){var e;e=peg$parsetag_param();if(e===r){e=peg$parsegeneric_param()}return e}function peg$parseVia(){var e,t,i,n,a,s;e=Mn;t=peg$parsevia_parm();if(t!==r){i=[];n=Mn;a=peg$parseCOMMA();if(a!==r){s=peg$parsevia_parm();if(s!==r){a=[a,s];n=a}else{Mn=n;n=r}}else{Mn=n;n=r}while(n!==r){i.push(n);n=Mn;a=peg$parseCOMMA();if(a!==r){s=peg$parsevia_parm();if(s!==r){a=[a,s];n=a}else{Mn=n;n=r}}else{Mn=n;n=r}}if(i!==r){t=[t,i];e=t}else{Mn=e;e=r}}else{Mn=e;e=r}return e}function peg$parsevia_parm(){var e,t,i,n,a,s,o,u;e=Mn;t=peg$parsesent_protocol();if(t!==r){i=peg$parseLWS();if(i!==r){n=peg$parsesent_by();if(n!==r){a=[];s=Mn;o=peg$parseSEMI();if(o!==r){u=peg$parsevia_params();if(u!==r){o=[o,u];s=o}else{Mn=s;s=r}}else{Mn=s;s=r}while(s!==r){a.push(s);s=Mn;o=peg$parseSEMI();if(o!==r){u=peg$parsevia_params();if(u!==r){o=[o,u];s=o}else{Mn=s;s=r}}else{Mn=s;s=r}}if(a!==r){t=[t,i,n,a];e=t}else{Mn=e;e=r}}else{Mn=e;e=r}}else{Mn=e;e=r}}else{Mn=e;e=r}return e}function peg$parsevia_params(){var e;e=peg$parsevia_ttl();if(e===r){e=peg$parsevia_maddr();if(e===r){e=peg$parsevia_received();if(e===r){e=peg$parsevia_branch();if(e===r){e=peg$parseresponse_port();if(e===r){e=peg$parsegeneric_param()}}}}}return e}function peg$parsevia_ttl(){var t,i,n,a;t=Mn;if(e.substr(Mn,3).toLowerCase()===tn){i=e.substr(Mn,3);Mn+=3}else{i=r;if(Bn===0){peg$fail(rn)}}if(i!==r){n=peg$parseEQUAL();if(n!==r){a=peg$parsettl();if(a!==r){Hn=t;i=peg$c350(a);t=i}else{Mn=t;t=r}}else{Mn=t;t=r}}else{Mn=t;t=r}return t}function peg$parsevia_maddr(){var t,i,n,a;t=Mn;if(e.substr(Mn,5).toLowerCase()===nn){i=e.substr(Mn,5);Mn+=5}else{i=r;if(Bn===0){peg$fail(an)}}if(i!==r){n=peg$parseEQUAL();if(n!==r){a=peg$parsehost();if(a!==r){Hn=t;i=peg$c353(a);t=i}else{Mn=t;t=r}}else{Mn=t;t=r}}else{Mn=t;t=r}return t}function peg$parsevia_received(){var t,i,n,a;t=Mn;if(e.substr(Mn,8).toLowerCase()===sn){i=e.substr(Mn,8);Mn+=8}else{i=r;if(Bn===0){peg$fail(on)}}if(i!==r){n=peg$parseEQUAL();if(n!==r){a=peg$parseIPv4address();if(a===r){a=peg$parseIPv6address();if(a===r){a=peg$parseIPv6reference()}}if(a!==r){Hn=t;i=peg$c356(a);t=i}else{Mn=t;t=r}}else{Mn=t;t=r}}else{Mn=t;t=r}return t}function peg$parsevia_branch(){var t,i,n,a;t=Mn;if(e.substr(Mn,6).toLowerCase()===un){i=e.substr(Mn,6);Mn+=6}else{i=r;if(Bn===0){peg$fail(cn)}}if(i!==r){n=peg$parseEQUAL();if(n!==r){a=peg$parsetoken();if(a!==r){Hn=t;i=peg$c359(a);t=i}else{Mn=t;t=r}}else{Mn=t;t=r}}else{Mn=t;t=r}return t}function peg$parseresponse_port(){var t,i,n,a,s;t=Mn;if(e.substr(Mn,5).toLowerCase()===ln){i=e.substr(Mn,5);Mn+=5}else{i=r;if(Bn===0){peg$fail(fn)}}if(i!==r){n=peg$parseEQUAL();if(n!==r){a=[];s=peg$parseDIGIT();while(s!==r){a.push(s);s=peg$parseDIGIT()}if(a!==r){Hn=t;i=peg$c362(a);t=i}else{Mn=t;t=r}}else{Mn=t;t=r}}else{Mn=t;t=r}return t}function peg$parsesent_protocol(){var e,t,i,n,a,s;e=Mn;t=peg$parseprotocol_name();if(t!==r){i=peg$parseSLASH();if(i!==r){n=peg$parsetoken();if(n!==r){a=peg$parseSLASH();if(a!==r){s=peg$parsetransport();if(s!==r){t=[t,i,n,a,s];e=t}else{Mn=e;e=r}}else{Mn=e;e=r}}else{Mn=e;e=r}}else{Mn=e;e=r}}else{Mn=e;e=r}return e}function peg$parseprotocol_name(){var t,i;t=Mn;if(e.substr(Mn,3).toLowerCase()===Xe){i=e.substr(Mn,3);Mn+=3}else{i=r;if(Bn===0){peg$fail(Wt)}}if(i===r){i=peg$parsetoken()}if(i!==r){Hn=t;i=peg$c363(i)}t=i;return t}function peg$parsetransport(){var t,i;t=Mn;if(e.substr(Mn,3).toLowerCase()===Tt){i=e.substr(Mn,3);Mn+=3}else{i=r;if(Bn===0){peg$fail(pn)}}if(i===r){if(e.substr(Mn,3).toLowerCase()===_t){i=e.substr(Mn,3);Mn+=3}else{i=r;if(Bn===0){peg$fail(dn)}}if(i===r){if(e.substr(Mn,3).toLowerCase()===It){i=e.substr(Mn,3);Mn+=3}else{i=r;if(Bn===0){peg$fail(hn)}}if(i===r){if(e.substr(Mn,4).toLowerCase()===At){i=e.substr(Mn,4);Mn+=4}else{i=r;if(Bn===0){peg$fail(gn)}}if(i===r){i=peg$parsetoken()}}}}if(i!==r){Hn=t;i=peg$c368(i)}t=i;return t}function peg$parsesent_by(){var e,t,i,n,a;e=Mn;t=peg$parseviaHost();if(t!==r){i=Mn;n=peg$parseCOLON();if(n!==r){a=peg$parsevia_port();if(a!==r){n=[n,a];i=n}else{Mn=i;i=r}}else{Mn=i;i=r}if(i===r){i=null}if(i!==r){t=[t,i];e=t}else{Mn=e;e=r}}else{Mn=e;e=r}return e}function peg$parseviaHost(){var e,t;e=Mn;t=peg$parsehostname();if(t===r){t=peg$parseIPv4address();if(t===r){t=peg$parseIPv6reference()}}if(t!==r){Hn=e;t=peg$c369()}e=t;return e}function peg$parsevia_port(){var e,t,i,n,a,s,o;e=Mn;t=Mn;i=peg$parseDIGIT();if(i===r){i=null}if(i!==r){n=peg$parseDIGIT();if(n===r){n=null}if(n!==r){a=peg$parseDIGIT();if(a===r){a=null}if(a!==r){s=peg$parseDIGIT();if(s===r){s=null}if(s!==r){o=peg$parseDIGIT();if(o===r){o=null}if(o!==r){i=[i,n,a,s,o];t=i}else{Mn=t;t=r}}else{Mn=t;t=r}}else{Mn=t;t=r}}else{Mn=t;t=r}}else{Mn=t;t=r}if(t!==r){Hn=e;t=peg$c370(t)}e=t;return e}function peg$parsettl(){var e,t,i,n,a;e=Mn;t=Mn;i=peg$parseDIGIT();if(i!==r){n=peg$parseDIGIT();if(n===r){n=null}if(n!==r){a=peg$parseDIGIT();if(a===r){a=null}if(a!==r){i=[i,n,a];t=i}else{Mn=t;t=r}}else{Mn=t;t=r}}else{Mn=t;t=r}if(t!==r){Hn=e;t=peg$c371(t)}e=t;return e}function peg$parseWWW_Authenticate(){var e;e=peg$parsechallenge();return e}function peg$parseSession_Expires(){var e,t,i,n,a,s;e=Mn;t=peg$parsedelta_seconds();if(t!==r){i=[];n=Mn;a=peg$parseSEMI();if(a!==r){s=peg$parsese_params();if(s!==r){a=[a,s];n=a}else{Mn=n;n=r}}else{Mn=n;n=r}while(n!==r){i.push(n);n=Mn;a=peg$parseSEMI();if(a!==r){s=peg$parsese_params();if(s!==r){a=[a,s];n=a}else{Mn=n;n=r}}else{Mn=n;n=r}}if(i!==r){Hn=e;t=peg$c372(t);e=t}else{Mn=e;e=r}}else{Mn=e;e=r}return e}function peg$parsese_params(){var e;e=peg$parserefresher_param();if(e===r){e=peg$parsegeneric_param()}return e}function peg$parserefresher_param(){var t,i,n,a;t=Mn;if(e.substr(Mn,9)===vn){i=vn;Mn+=9}else{i=r;if(Bn===0){peg$fail(mn)}}if(i!==r){n=peg$parseEQUAL();if(n!==r){if(e.substr(Mn,3)===yn){a=yn;Mn+=3}else{a=r;if(Bn===0){peg$fail(Sn)}}if(a===r){if(e.substr(Mn,3)===Tn){a=Tn;Mn+=3}else{a=r;if(Bn===0){peg$fail(bn)}}}if(a!==r){Hn=t;i=peg$c379(a);t=i}else{Mn=t;t=r}}else{Mn=t;t=r}}else{Mn=t;t=r}return t}function peg$parseMin_SE(){var e,t,i,n,a,s;e=Mn;t=peg$parsedelta_seconds();if(t!==r){i=[];n=Mn;a=peg$parseSEMI();if(a!==r){s=peg$parsegeneric_param();if(s!==r){a=[a,s];n=a}else{Mn=n;n=r}}else{Mn=n;n=r}while(n!==r){i.push(n);n=Mn;a=peg$parseSEMI();if(a!==r){s=peg$parsegeneric_param();if(s!==r){a=[a,s];n=a}else{Mn=n;n=r}}else{Mn=n;n=r}}if(i!==r){Hn=e;t=peg$c380(t);e=t}else{Mn=e;e=r}}else{Mn=e;e=r}return e}function peg$parseextension_header(){var e,t,i,n;e=Mn;t=peg$parsetoken();if(t!==r){i=peg$parseHCOLON();if(i!==r){n=peg$parseheader_value();if(n!==r){t=[t,i,n];e=t}else{Mn=e;e=r}}else{Mn=e;e=r}}else{Mn=e;e=r}return e}function peg$parseheader_value(){var e,t;e=[];t=peg$parseTEXT_UTF8char();if(t===r){t=peg$parseUTF8_CONT();if(t===r){t=peg$parseLWS()}}while(t!==r){e.push(t);t=peg$parseTEXT_UTF8char();if(t===r){t=peg$parseUTF8_CONT();if(t===r){t=peg$parseLWS()}}}return e}function peg$parsemessage_body(){var e,t;e=[];t=peg$parseOCTET();while(t!==r){e.push(t);t=peg$parseOCTET()}return e}function peg$parsestun_URI(){var t,i,n,a;t=Mn;i=peg$parsestun_scheme();if(i!==r){if(e.charCodeAt(Mn)===58){n=D;Mn++}else{n=r;if(Bn===0){peg$fail(k)}}if(n!==r){a=peg$parsestun_host_port();if(a!==r){i=[i,n,a];t=i}else{Mn=t;t=r}}else{Mn=t;t=r}}else{Mn=t;t=r}return t}function peg$parsestun_scheme(){var t,i;t=Mn;if(e.substr(Mn,5).toLowerCase()===_n){i=e.substr(Mn,5);Mn+=5}else{i=r;if(Bn===0){peg$fail(Cn)}}if(i===r){if(e.substr(Mn,4).toLowerCase()===An){i=e.substr(Mn,4);Mn+=4}else{i=r;if(Bn===0){peg$fail(En)}}}if(i!==r){Hn=t;i=peg$c385(i)}t=i;return t}function peg$parsestun_host_port(){var t,i,n,a,s;t=Mn;i=peg$parsestun_host();if(i!==r){n=Mn;if(e.charCodeAt(Mn)===58){a=D;Mn++}else{a=r;if(Bn===0){peg$fail(k)}}if(a!==r){s=peg$parseport();if(s!==r){a=[a,s];n=a}else{Mn=n;n=r}}else{Mn=n;n=r}if(n===r){n=null}if(n!==r){i=[i,n];t=i}else{Mn=t;t=r}}else{Mn=t;t=r}return t}function peg$parsestun_host(){var e,t;e=Mn;t=peg$parseIPv4address();if(t===r){t=peg$parseIPv6reference();if(t===r){t=peg$parsereg_name()}}if(t!==r){Hn=e;t=peg$c386(t)}e=t;return e}function peg$parsestun_unreserved(){var t;t=peg$parseALPHA();if(t===r){t=peg$parseDIGIT();if(t===r){if(e.charCodeAt(Mn)===45){t=z;Mn++}else{t=r;if(Bn===0){peg$fail(K)}}if(t===r){if(e.charCodeAt(Mn)===46){t=Q;Mn++}else{t=r;if(Bn===0){peg$fail(J)}}if(t===r){if(e.charCodeAt(Mn)===95){t=V;Mn++}else{t=r;if(Bn===0){peg$fail(Y)}}if(t===r){if(e.charCodeAt(Mn)===126){t=ee;Mn++}else{t=r;if(Bn===0){peg$fail(te)}}}}}}}return t}function peg$parsesub_delims(){var t;if(e.charCodeAt(Mn)===33){t=X;Mn++}else{t=r;if(Bn===0){peg$fail(Z)}}if(t===r){if(e.charCodeAt(Mn)===36){t=F;Mn++}else{t=r;if(Bn===0){peg$fail(B)}}if(t===r){if(e.charCodeAt(Mn)===38){t=L;Mn++}else{t=r;if(Bn===0){peg$fail(P)}}if(t===r){if(e.charCodeAt(Mn)===39){t=ne;Mn++}else{t=r;if(Bn===0){peg$fail(ae)}}if(t===r){if(e.charCodeAt(Mn)===40){t=se;Mn++}else{t=r;if(Bn===0){peg$fail(oe)}}if(t===r){if(e.charCodeAt(Mn)===41){t=ue;Mn++}else{t=r;if(Bn===0){peg$fail(ce)}}if(t===r){if(e.charCodeAt(Mn)===42){t=re;Mn++}else{t=r;if(Bn===0){peg$fail(ie)}}if(t===r){if(e.charCodeAt(Mn)===43){t=q;Mn++}else{t=r;if(Bn===0){peg$fail(j)}}if(t===r){if(e.charCodeAt(Mn)===44){t=W;Mn++}else{t=r;if(Bn===0){peg$fail(G)}}if(t===r){if(e.charCodeAt(Mn)===59){t=I;Mn++}else{t=r;if(Bn===0){peg$fail(R)}}if(t===r){if(e.charCodeAt(Mn)===61){t=M;Mn++}else{t=r;if(Bn===0){peg$fail(H)}}}}}}}}}}}}return t}function peg$parseturn_URI(){var t,i,n,a,s,o,u;t=Mn;i=peg$parseturn_scheme();if(i!==r){if(e.charCodeAt(Mn)===58){n=D;Mn++}else{n=r;if(Bn===0){peg$fail(k)}}if(n!==r){a=peg$parsestun_host_port();if(a!==r){s=Mn;if(e.substr(Mn,11)===In){o=In;Mn+=11}else{o=r;if(Bn===0){peg$fail(Rn)}}if(o!==r){u=peg$parsetransport();if(u!==r){o=[o,u];s=o}else{Mn=s;s=r}}else{Mn=s;s=r}if(s===r){s=null}if(s!==r){i=[i,n,a,s];t=i}else{Mn=t;t=r}}else{Mn=t;t=r}}else{Mn=t;t=r}}else{Mn=t;t=r}return t}function peg$parseturn_scheme(){var t,i;t=Mn;if(e.substr(Mn,5).toLowerCase()===wn){i=e.substr(Mn,5);Mn+=5}else{i=r;if(Bn===0){peg$fail($n)}}if(i===r){if(e.substr(Mn,4).toLowerCase()===xn){i=e.substr(Mn,4);Mn+=4}else{i=r;if(Bn===0){peg$fail(On)}}}if(i!==r){Hn=t;i=peg$c385(i)}t=i;return t}function peg$parseturn_transport(){var t,i,n;t=Mn;if(e.substr(Mn,3).toLowerCase()===Tt){i=e.substr(Mn,3);Mn+=3}else{i=r;if(Bn===0){peg$fail(bt)}}if(i===r){if(e.substr(Mn,3).toLowerCase()===_t){i=e.substr(Mn,3);Mn+=3}else{i=r;if(Bn===0){peg$fail(Ct)}}if(i===r){i=[];n=peg$parseunreserved();while(n!==r){i.push(n);n=peg$parseunreserved()}}}if(i!==r){Hn=t;i=peg$c393(i)}t=i;return t}function peg$parseuuid(){var t,i,n,a,s,o,u,c,l,f;t=Mn;i=peg$parsehex8();if(i!==r){if(e.charCodeAt(Mn)===45){n=z;Mn++}else{n=r;if(Bn===0){peg$fail(K)}}if(n!==r){a=peg$parsehex4();if(a!==r){if(e.charCodeAt(Mn)===45){s=z;Mn++}else{s=r;if(Bn===0){peg$fail(K)}}if(s!==r){o=peg$parsehex4();if(o!==r){if(e.charCodeAt(Mn)===45){u=z;Mn++}else{u=r;if(Bn===0){peg$fail(K)}}if(u!==r){c=peg$parsehex4();if(c!==r){if(e.charCodeAt(Mn)===45){l=z;Mn++}else{l=r;if(Bn===0){peg$fail(K)}}if(l!==r){f=peg$parsehex12();if(f!==r){Hn=t;i=peg$c394();t=i}else{Mn=t;t=r}}else{Mn=t;t=r}}else{Mn=t;t=r}}else{Mn=t;t=r}}else{Mn=t;t=r}}else{Mn=t;t=r}}else{Mn=t;t=r}}else{Mn=t;t=r}}else{Mn=t;t=r}return t}function peg$parsehex4(){var e,t,i,n,a;e=Mn;t=peg$parseHEXDIG();if(t!==r){i=peg$parseHEXDIG();if(i!==r){n=peg$parseHEXDIG();if(n!==r){a=peg$parseHEXDIG();if(a!==r){t=[t,i,n,a];e=t}else{Mn=e;e=r}}else{Mn=e;e=r}}else{Mn=e;e=r}}else{Mn=e;e=r}return e}function peg$parsehex8(){var e,t,i;e=Mn;t=peg$parsehex4();if(t!==r){i=peg$parsehex4();if(i!==r){t=[t,i];e=t}else{Mn=e;e=r}}else{Mn=e;e=r}return e}function peg$parsehex12(){var e,t,i,n;e=Mn;t=peg$parsehex4();if(t!==r){i=peg$parsehex4();if(i!==r){n=peg$parsehex4();if(n!==r){t=[t,i,n];e=t}else{Mn=e;e=r}}else{Mn=e;e=r}}else{Mn=e;e=r}return e}function peg$parsesipfrag(){var e,t,i,n,a,s;e=Mn;t=peg$parseRequest_Response();if(t!==r){i=[];n=peg$parseheader();while(n!==r){i.push(n);n=peg$parseheader()}if(i!==r){n=Mn;a=peg$parseCRLF();if(a!==r){s=peg$parsemessage_body();if(s!==r){a=[a,s];n=a}else{Mn=n;n=r}}else{Mn=n;n=r}if(n===r){n=null}if(n!==r){t=[t,i,n];e=t}else{Mn=e;e=r}}else{Mn=e;e=r}}else{Mn=e;e=r}return e}function peg$parseReferred_By(){var t,i,n,a,s,o,u,c;t=Mn;if(e.substr(Mn,11)===Dn){i=Dn;Mn+=11}else{i=r;if(Bn===0){peg$fail(kn)}}if(i===r){if(e.charCodeAt(Mn)===98){i=Nn;Mn++}else{i=r;if(Bn===0){peg$fail(Un)}}}if(i!==r){n=peg$parseHCOLON();if(n!==r){a=peg$parsereferrer_uri();if(a!==r){s=[];o=Mn;u=peg$parseSEMI();if(u!==r){c=peg$parsereferredby_id_param();if(c===r){c=peg$parsegeneric_param()}if(c!==r){u=[u,c];o=u}else{Mn=o;o=r}}else{Mn=o;o=r}while(o!==r){s.push(o);o=Mn;u=peg$parseSEMI();if(u!==r){c=peg$parsereferredby_id_param();if(c===r){c=peg$parsegeneric_param()}if(c!==r){u=[u,c];o=u}else{Mn=o;o=r}}else{Mn=o;o=r}}if(s!==r){i=[i,n,a,s];t=i}else{Mn=t;t=r}}else{Mn=t;t=r}}else{Mn=t;t=r}}else{Mn=t;t=r}return t}function peg$parsereferrer_uri(){var e;e=peg$parsename_addr();if(e===r){e=peg$parseSIP_URI_noparams()}return e}function peg$parsereferredby_id_param(){var t,i,n,a;t=Mn;if(e.substr(Mn,3)===Ln){i=Ln;Mn+=3}else{i=r;if(Bn===0){peg$fail(Pn)}}if(i!==r){n=peg$parseEQUAL();if(n!==r){a=peg$parsesip_clean_msg_id();if(a!==r){i=[i,n,a];t=i}else{Mn=t;t=r}}else{Mn=t;t=r}}else{Mn=t;t=r}return t}function peg$parsesip_clean_msg_id(){var t,i,n,a,s,o;t=Mn;i=peg$parseLDQUOT();if(i!==r){n=peg$parsemark();if(n!==r){if(e.charCodeAt(Mn)===64){a=N;Mn++}else{a=r;if(Bn===0){peg$fail(U)}}if(a!==r){s=peg$parsemark();if(s===r){s=peg$parsehost()}if(s!==r){o=peg$parseRDQUOT();if(o!==r){i=[i,n,a,s,o];t=i}else{Mn=t;t=r}}else{Mn=t;t=r}}else{Mn=t;t=r}}else{Mn=t;t=r}}else{Mn=t;t=r}return t}t.data={};function list(e,t){return[e].concat(t)}Wn=o();if(Wn!==r&&Mn===e.length){return Wn}else{if(Wn!==r&&Mn<e.length){peg$fail(peg$endExpectation())}throw peg$buildStructuredError(Fn,jn<e.length?e.charAt(jn):null,jn<e.length?peg$computeLocation(jn,jn+1):peg$computeLocation(jn,jn))}}t.parse=peg$parse},47102:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});var i=r(130523);var n;(function(e){e[e["error"]=0]="error";e[e["warn"]=1]="warn";e[e["log"]=2]="log";e[e["debug"]=3]="debug"})(n=t.Levels||(t.Levels={}));var a=function(){function LoggerFactory(){this.builtinEnabled=true;this._level=n.log;this.loggers={};this.type=i.TypeStrings.LoggerFactory;this.logger=this.getLogger("sip:loggerfactory")}Object.defineProperty(LoggerFactory.prototype,"level",{get:function(){return this._level},set:function(e){if(e>=0&&e<=3){this._level=e}else if(e>3){this._level=3}else if(n.hasOwnProperty(e)){this._level=e}else{this.logger.error("invalid 'level' parameter value: "+JSON.stringify(e))}},enumerable:true,configurable:true});Object.defineProperty(LoggerFactory.prototype,"connector",{get:function(){return this._connector},set:function(e){if(!e){this._connector=undefined}else if(typeof e==="function"){this._connector=e}else{this.logger.error("invalid 'connector' parameter value: "+JSON.stringify(e))}},enumerable:true,configurable:true});LoggerFactory.prototype.getLogger=function(e,t){if(t&&this.level===3){return new s(this,e,t)}else if(this.loggers[e]){return this.loggers[e]}else{var r=new s(this,e);this.loggers[e]=r;return r}};LoggerFactory.prototype.genericLog=function(e,t,r,i){if(this.level>=e){if(this.builtinEnabled){this.print(console[n[e]],t,r,i)}if(this.connector){this.connector(n[e],t,r,i)}}};LoggerFactory.prototype.print=function(e,t,r,i){if(typeof i==="string"){var n=[new Date,t];if(r){n.push(r)}i=n.concat(i).join(" | ")}e.call(console,i)};return LoggerFactory}();t.LoggerFactory=a;var s=function(){function Logger(e,t,r){this.type=i.TypeStrings.Logger;this.logger=e;this.category=t;this.label=r}Logger.prototype.error=function(e){this.genericLog(n.error,e)};Logger.prototype.warn=function(e){this.genericLog(n.warn,e)};Logger.prototype.log=function(e){this.genericLog(n.log,e)};Logger.prototype.debug=function(e){this.genericLog(n.debug,e)};Logger.prototype.genericLog=function(e,t){this.logger.genericLog(e,this.category,this.label,t)};return Logger}();t.Logger=s},444881:function(e,t,r){"use strict";var i=this&&this.__extends||function(){var extendStatics=function(e,t){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r]};return extendStatics(e,t)};return function(e,t){extendStatics(e,t);function __(){this.constructor=e}e.prototype=t===null?Object.create(t):(__.prototype=t.prototype,new __)}}();Object.defineProperty(t,"__esModule",{value:true});var n=r(130523);var a=r(822049);var s=function(e){i(NameAddrHeader,e);function NameAddrHeader(t,r,i){var a=e.call(this,i)||this;a.type=n.TypeStrings.NameAddrHeader;if(!t||!(t.type===n.TypeStrings.URI)){throw new TypeError('missing or invalid "uri" parameter')}a.uri=t;a._displayName=r;return a}Object.defineProperty(NameAddrHeader.prototype,"friendlyName",{get:function(){return this.displayName||this.uri.aor},enumerable:true,configurable:true});Object.defineProperty(NameAddrHeader.prototype,"displayName",{get:function(){return this._displayName},set:function(e){this._displayName=e},enumerable:true,configurable:true});NameAddrHeader.prototype.clone=function(){return new NameAddrHeader(this.uri.clone(),this._displayName,JSON.parse(JSON.stringify(this.parameters)))};NameAddrHeader.prototype.toString=function(){var e=this.displayName||this.displayName==="0"?'"'+this.displayName+'" ':"";e+="<"+this.uri.toString()+">";for(var t in this.parameters){if(this.parameters.hasOwnProperty(t)){e+=";"+t;if(this.parameters[t]!==null){e+="="+this.parameters[t]}}}return e};return NameAddrHeader}(a.Parameters);t.NameAddrHeader=s},890106:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});var i=r(130523);var n=r(179089);var a=r(130700);var s;(function(e){function getHeader(e,t){var r=t;var i=0;var n=0;if(e.substring(r,r+2).match(/(^\r\n)/)){return-2}while(i===0){n=e.indexOf("\r\n",r);if(n===-1){return n}if(!e.substring(n+2,n+4).match(/(^\r\n)/)&&e.charAt(n+2).match(/(^\s+)/)){r=n+2}else{i=n}}return i}e.getHeader=getHeader;function parseHeader(e,t,r,a){var s=t.indexOf(":",r);var o=t.substring(r,s).trim();var u=t.substring(s+1,a).trim();var c;switch(o.toLowerCase()){case"via":case"v":e.addHeader("via",u);if(e.getHeaders("via").length===1){c=e.parseHeader("Via");if(c){e.via=c;e.viaBranch=c.branch}}else{c=0}break;case"from":case"f":e.setHeader("from",u);c=e.parseHeader("from");if(c){e.from=c;e.fromTag=c.getParam("tag")}break;case"to":case"t":e.setHeader("to",u);c=e.parseHeader("to");if(c){e.to=c;e.toTag=c.getParam("tag")}break;case"record-route":c=n.Grammar.parse(u,"Record_Route");if(c===-1){c=undefined;break}for(var l in c){if(c[l]){e.addHeader("record-route",u.substring(c[l].position,c[l].offset));e.headers["Record-Route"][e.getHeaders("record-route").length-1].parsed=c[l].parsed}}break;case"call-id":case"i":e.setHeader("call-id",u);c=e.parseHeader("call-id");if(c){e.callId=u}break;case"contact":case"m":c=n.Grammar.parse(u,"Contact");if(c===-1){c=undefined;break}for(var l in c){if(c[l]){e.addHeader("contact",u.substring(c[l].position,c[l].offset));e.headers.Contact[e.getHeaders("contact").length-1].parsed=c[l].parsed}}break;case"content-length":case"l":e.setHeader("content-length",u);c=e.parseHeader("content-length");break;case"content-type":case"c":e.setHeader("content-type",u);c=e.parseHeader("content-type");break;case"cseq":e.setHeader("cseq",u);c=e.parseHeader("cseq");if(c){e.cseq=c.value}if(e.type===i.TypeStrings.IncomingResponse){e.method=c.method}break;case"max-forwards":e.setHeader("max-forwards",u);c=e.parseHeader("max-forwards");break;case"www-authenticate":e.setHeader("www-authenticate",u);c=e.parseHeader("www-authenticate");break;case"proxy-authenticate":e.setHeader("proxy-authenticate",u);c=e.parseHeader("proxy-authenticate");break;case"refer-to":case"r":e.setHeader("refer-to",u);c=e.parseHeader("refer-to");if(c){e.referTo=c}break;default:e.setHeader(o,u);c=0}if(c===undefined){return{error:"error parsing header '"+o+"'"}}else{return true}}e.parseHeader=parseHeader;function parseMessage(e,t){var r=0;var i=e.indexOf("\r\n");var s=t.getLogger("sip.parser");if(i===-1){s.warn("no CRLF found, not a SIP message, discarded");return}var o=e.substring(0,i);var u=n.Grammar.parse(o,"Request_Response");var c;if(u===-1){s.warn('error parsing first line of SIP message: "'+o+'"');return}else if(!u.status_code){c=new a.IncomingRequest(t);c.method=u.method;c.ruri=u.uri}else{c=new a.IncomingResponse(t);c.statusCode=u.status_code;c.reasonPhrase=u.reason_phrase}c.data=e;r=i+2;var l;while(true){i=getHeader(e,r);if(i===-2){l=r+2;break}else if(i===-1){s.error("malformed message");return}var f=parseHeader(c,e,r,i);if(f!==true){s.error(u.error);return}r=i+2}if(c.hasHeader("content-length")){c.body=e.substr(l,Number(c.getHeader("content-length")))}else{c.body=e.substring(l)}return c}e.parseMessage=parseMessage})(s=t.Parser||(t.Parser={}))},60816:function(e,t,r){"use strict";var i=this&&this.__extends||function(){var extendStatics=function(e,t){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r]};return extendStatics(e,t)};return function(e,t){extendStatics(e,t);function __(){this.constructor=e}e.prototype=t===null?Object.create(t):(__.prototype=t.prototype,new __)}}();Object.defineProperty(t,"__esModule",{value:true});var n=r(513669);var a=r(846182);var s=r(130523);var o=r(325840);var u=r(130700);var c=r(669825);var l=function(e){i(PublishContext,e);function PublishContext(t,r,i,n){if(n===void 0){n={}}var u=this;n.extraHeaders=(n.extraHeaders||[]).slice();n.contentType=n.contentType||"text/plain";if(typeof n.expires!=="number"||n.expires%1!==0){n.expires=3600}else{n.expires=Number(n.expires)}if(typeof n.unpublishOnClose!=="boolean"){n.unpublishOnClose=true}if(r===undefined||r===null||r===""){throw new o.Exceptions.MethodParameterError("Publish","Target",r)}else{r=t.normalizeTarget(r);if(r===undefined){throw new o.Exceptions.MethodParameterError("Publish","Target",r)}}u=e.call(this,t,a.C.PUBLISH,r,n)||this;u.type=s.TypeStrings.PublishContext;u.options=n;u.target=r;if(i===undefined||i===null||i===""){throw new o.Exceptions.MethodParameterError("Publish","Event",i)}else{u.event=i}u.logger=t.getLogger("sip.publish");u.pubRequestExpires=u.options.expires;t.on("transportCreated",(function(e){e.on("transportError",(function(){return u.onTransportError()}))}));return u}PublishContext.prototype.publish=function(e){if(this.publishRefreshTimer){clearTimeout(this.publishRefreshTimer);this.publishRefreshTimer=undefined}this.options.body=e;this.pubRequestBody=this.options.body;if(this.pubRequestExpires===0){this.pubRequestExpires=this.options.expires;this.pubRequestEtag=undefined}if(!this.ua.publishers[this.target.toString()+":"+this.event]){this.ua.publishers[this.target.toString()+":"+this.event]=this}this.sendPublishRequest()};PublishContext.prototype.unpublish=function(){if(this.publishRefreshTimer){clearTimeout(this.publishRefreshTimer);this.publishRefreshTimer=undefined}this.pubRequestBody=undefined;this.pubRequestExpires=0;if(this.pubRequestEtag!==undefined){this.sendPublishRequest()}};PublishContext.prototype.close=function(){if(this.options.unpublishOnClose){this.unpublish()}else{if(this.publishRefreshTimer){clearTimeout(this.publishRefreshTimer);this.publishRefreshTimer=undefined}this.pubRequestBody=undefined;this.pubRequestExpires=0;this.pubRequestEtag=undefined}if(this.ua.publishers[this.target.toString()+":"+this.event]){delete this.ua.publishers[this.target.toString()+":"+this.event]}};PublishContext.prototype.onRequestTimeout=function(){e.prototype.onRequestTimeout.call(this);this.emit("unpublished",undefined,a.C.causes.REQUEST_TIMEOUT)};PublishContext.prototype.onTransportError=function(){e.prototype.onTransportError.call(this);this.emit("unpublished",undefined,a.C.causes.CONNECTION_ERROR)};PublishContext.prototype.receiveResponse=function(e){var t=this;var r=e.statusCode||0;var i=c.Utils.getReasonPhrase(r);switch(true){case/^1[0-9]{2}$/.test(r.toString()):this.emit("progress",e,i);break;case/^2[0-9]{2}$/.test(r.toString()):if(e.hasHeader("SIP-ETag")){this.pubRequestEtag=e.getHeader("SIP-ETag")}else{this.logger.warn("SIP-ETag header missing in a 200-class response to PUBLISH")}if(e.hasHeader("Expires")){var n=Number(e.getHeader("Expires"));if(typeof n==="number"&&n>=0&&n<=this.pubRequestExpires){this.pubRequestExpires=n}else{this.logger.warn("Bad Expires header in a 200-class response to PUBLISH")}}else{this.logger.warn("Expires header missing in a 200-class response to PUBLISH")}if(this.pubRequestExpires!==0){this.publishRefreshTimer=setTimeout((function(){return t.refreshRequest()}),this.pubRequestExpires*900);this.emit("published",e,i)}else{this.emit("unpublished",e,i)}break;case/^412$/.test(r.toString()):if(this.pubRequestEtag!==undefined&&this.pubRequestExpires!==0){this.logger.warn("412 response to PUBLISH, recovering");this.pubRequestEtag=undefined;this.emit("progress",e,i);this.publish(this.options.body)}else{this.logger.warn("412 response to PUBLISH, recovery failed");this.pubRequestExpires=0;this.emit("failed",e,i);this.emit("unpublished",e,i)}break;case/^423$/.test(r.toString()):if(this.pubRequestExpires!==0&&e.hasHeader("Min-Expires")){var a=Number(e.getHeader("Min-Expires"));if(typeof a==="number"||a>this.pubRequestExpires){this.logger.warn("423 code in response to PUBLISH, adjusting the Expires value and trying to recover");this.pubRequestExpires=a;this.emit("progress",e,i);this.publish(this.options.body)}else{this.logger.warn("Bad 423 response Min-Expires header received for PUBLISH");this.pubRequestExpires=0;this.emit("failed",e,i);this.emit("unpublished",e,i)}}else{this.logger.warn("423 response to PUBLISH, recovery failed");this.pubRequestExpires=0;this.emit("failed",e,i);this.emit("unpublished",e,i)}break;default:this.pubRequestExpires=0;this.emit("failed",e,i);this.emit("unpublished",e,i);break}if(this.pubRequestExpires===0){if(this.publishRefreshTimer){clearTimeout(this.publishRefreshTimer);this.publishRefreshTimer=undefined}this.pubRequestBody=undefined;this.pubRequestEtag=undefined}};PublishContext.prototype.refreshRequest=function(){if(this.publishRefreshTimer){clearTimeout(this.publishRefreshTimer);this.publishRefreshTimer=undefined}this.pubRequestBody=undefined;if(this.pubRequestEtag===undefined){throw new o.Exceptions.MethodParameterError("Publish","Body",undefined)}if(this.pubRequestExpires===0){throw new o.Exceptions.MethodParameterError("Publish","Expire",this.pubRequestExpires)}this.sendPublishRequest()};PublishContext.prototype.sendPublishRequest=function(){var e=Object.create(this.options||Object.prototype);e.extraHeaders=(this.options.extraHeaders||[]).slice();e.extraHeaders.push("Event: "+this.event);e.extraHeaders.push("Expires: "+this.pubRequestExpires);if(this.pubRequestEtag!==undefined){e.extraHeaders.push("SIP-If-Match: "+this.pubRequestEtag)}this.request=new u.OutgoingRequest(a.C.PUBLISH,this.target,this.ua,this.options.params,e.extraHeaders);if(this.pubRequestBody!==undefined){this.request.body={};this.request.body.body=this.pubRequestBody;this.request.body.contentType=this.options.contentType}this.send()};return PublishContext}(n.ClientContext);t.PublishContext=l},70266:function(e,t,r){"use strict";var i=this&&this.__extends||function(){var extendStatics=function(e,t){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r]};return extendStatics(e,t)};return function(e,t){extendStatics(e,t);function __(){this.constructor=e}e.prototype=t===null?Object.create(t):(__.prototype=t.prototype,new __)}}();var n=this&&this.__assign||function(){n=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++){t=arguments[r];for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n))e[n]=t[n]}return e};return n.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:true});var a=r(513669);var s=r(846182);var o=r(130523);var u=r(325840);var c=r(179089);var l=r(669825);function loadConfig(e){var t={expires:600,extraContactHeaderParams:[],instanceId:undefined,params:{},regId:undefined,registrar:undefined};var r=getConfigurationCheck();for(var i in r.mandatory){if(!e.hasOwnProperty(i)){throw new u.Exceptions.ConfigurationError(i)}else{var n=e[i];var a=r.mandatory[i](n);if(a!==undefined){t[i]=a}else{throw new u.Exceptions.ConfigurationError(i,n)}}}for(var i in r.optional){if(e.hasOwnProperty(i)){var n=e[i];if(n instanceof Array&&n.length===0){continue}if(n===null||n===""||n===undefined||typeof n==="number"&&isNaN(n)){continue}var a=r.optional[i](n);if(a!==undefined){t[i]=a}else{throw new u.Exceptions.ConfigurationError(i,n)}}}return t}function getConfigurationCheck(){return{mandatory:{},optional:{expires:function(e){if(l.Utils.isDecimal(e)){var t=Number(e);if(t>=0){return t}}},extraContactHeaderParams:function(e){if(e instanceof Array){return e.filter((function(e){return typeof e==="string"}))}},instanceId:function(e){if(typeof e!=="string"){return}if(/^uuid:/i.test(e)){e=e.substr(5)}if(c.Grammar.parse(e,"uuid")===-1){return}else{return e}},params:function(e){if(typeof e==="object"){return e}},regId:function(e){if(l.Utils.isDecimal(e)){var t=Number(e);if(t>=0){return t}}},registrar:function(e){if(typeof e!=="string"){return}if(!/^sip:/i.test(e)){e=s.C.SIP+":"+e}var t=c.Grammar.URIParse(e);if(!t){return}else if(t.user){return}else{return t}}}}}var f=function(e){i(RegisterContext,e);function RegisterContext(t,r){if(r===void 0){r={}}var i=this;var n=loadConfig(r);if(n.regId&&!n.instanceId){n.instanceId=l.Utils.newUUID()}else if(!n.regId&&n.instanceId){n.regId=1}n.params.toUri=n.params.toUri||t.configuration.uri;n.params.toDisplayName=n.params.toDisplayName||t.configuration.displayName;n.params.callId=n.params.callId||l.Utils.createRandomToken(22);n.params.cseq=n.params.cseq||Math.floor(Math.random()*1e4);if(!n.registrar){var a={};if(typeof t.configuration.uri==="object"){a=t.configuration.uri.clone();a.user=undefined}else{a=t.configuration.uri}n.registrar=a}i=e.call(this,t,s.C.REGISTER,n.registrar,n)||this;i.type=o.TypeStrings.RegisterContext;i.options=n;i.logger=t.getLogger("sip.registercontext");i.logger.log("configuration parameters for RegisterContext after validation:");for(var u in n){if(n.hasOwnProperty(u)){i.logger.log("\xb7 "+u+": "+JSON.stringify(n[u]))}}i.expires=n.expires;i.cseq=n.params.cseq;i.contact=t.contact.toString();i.registered=false;t.on("transportCreated",(function(e){e.on("disconnected",(function(){return i.onTransportDisconnected()}))}));return i}RegisterContext.prototype.register=function(e){var t=this;if(e===void 0){e={}}this.options=n({},this.options,e);var r=(this.options.extraHeaders||[]).slice();r.push("Contact: "+this.generateContactHeader(this.expires));r.push("Allow: "+["ACK","CANCEL","INVITE","MESSAGE","BYE","OPTIONS","INFO","NOTIFY","REFER"].toString());this.closeHeaders=this.options.closeWithHeaders?(this.options.extraHeaders||[]).slice():[];this.receiveResponse=function(e){if(e.cseq!==t.cseq){return}if(t.registrationTimer!==undefined){clearTimeout(t.registrationTimer);t.registrationTimer=undefined}var r=(e.statusCode||0).toString();switch(true){case/^1[0-9]{2}$/.test(r):t.emit("progress",e);break;case/^2[0-9]{2}$/.test(r):t.emit("accepted",e);var i=void 0;if(e.hasHeader("expires")){i=Number(e.getHeader("expires"))}if(t.registrationExpiredTimer!==undefined){clearTimeout(t.registrationExpiredTimer);t.registrationExpiredTimer=undefined}var n=e.getHeaders("contact").length;if(!n){t.logger.warn("no Contact header in response to REGISTER, response ignored");break}var a=void 0;while(n--){a=e.parseHeader("contact",n);if(a.uri.user===t.ua.contact.uri.user){i=a.getParam("expires");break}else{a=undefined}}if(!a){t.logger.warn("no Contact header pointing to us, response ignored");break}if(i===undefined){i=t.expires}t.registrationTimer=setTimeout((function(){t.registrationTimer=undefined;t.register(t.options)}),i*1e3-3e3);t.registrationExpiredTimer=setTimeout((function(){t.logger.warn("registration expired");if(t.registered){t.unregistered(undefined,s.C.causes.EXPIRES)}}),i*1e3);if(a.hasParam("temp-gruu")){t.ua.contact.temp_gruu=c.Grammar.URIParse(a.getParam("temp-gruu").replace(/"/g,""))}if(a.hasParam("pub-gruu")){t.ua.contact.pub_gruu=c.Grammar.URIParse(a.getParam("pub-gruu").replace(/"/g,""))}t.registered=true;t.emit("registered",e||undefined);break;case/^423$/.test(r):if(e.hasHeader("min-expires")){t.expires=Number(e.getHeader("min-expires"));t.register(t.options)}else{t.logger.warn("423 response received for REGISTER without Min-Expires");t.registrationFailure(e,s.C.causes.SIP_FAILURE_CODE)}break;default:t.registrationFailure(e,l.Utils.sipErrorCause(e.statusCode||0))}};this.onRequestTimeout=function(){t.registrationFailure(undefined,s.C.causes.REQUEST_TIMEOUT)};this.onTransportError=function(){t.registrationFailure(undefined,s.C.causes.CONNECTION_ERROR)};this.cseq++;if(this.request){this.request.cseq=this.cseq;this.request.setHeader("cseq",this.cseq+" REGISTER");this.request.extraHeaders=r}this.send()};RegisterContext.prototype.close=function(){var e={all:false,extraHeaders:this.closeHeaders};this.registeredBefore=this.registered;if(this.registered){this.unregister(e)}};RegisterContext.prototype.unregister=function(e){var t=this;if(e===void 0){e={}}if(!this.registered&&!e.all){this.logger.warn("Already unregistered, but sending an unregister anyways.")}var r=(e.extraHeaders||[]).slice();this.registered=false;if(this.registrationTimer!==undefined){clearTimeout(this.registrationTimer);this.registrationTimer=undefined}if(e.all){r.push("Contact: *");r.push("Expires: 0")}else{r.push("Contact: "+this.generateContactHeader(0))}this.receiveResponse=function(e){var r=e&&e.statusCode?e.statusCode.toString():"";switch(true){case/^1[0-9]{2}$/.test(r):t.emit("progress",e);break;case/^2[0-9]{2}$/.test(r):t.emit("accepted",e);if(t.registrationExpiredTimer!==undefined){clearTimeout(t.registrationExpiredTimer);t.registrationExpiredTimer=undefined}t.unregistered(e);break;default:t.unregistered(e,l.Utils.sipErrorCause(e.statusCode||0))}};this.onRequestTimeout=function(){};this.cseq++;if(this.request){this.request.cseq=this.cseq;this.request.setHeader("cseq",this.cseq+" REGISTER");this.request.extraHeaders=r}this.send()};RegisterContext.prototype.unregistered=function(e,t){this.registered=false;this.emit("unregistered",e||undefined,t||undefined)};RegisterContext.prototype.registrationFailure=function(e,t){this.emit("failed",e||undefined,t||undefined)};RegisterContext.prototype.onTransportDisconnected=function(){this.registeredBefore=this.registered;if(this.registrationTimer!==undefined){clearTimeout(this.registrationTimer);this.registrationTimer=undefined}if(this.registrationExpiredTimer!==undefined){clearTimeout(this.registrationExpiredTimer);this.registrationExpiredTimer=undefined}if(this.registered){this.unregistered(undefined,s.C.causes.CONNECTION_ERROR)}};RegisterContext.prototype.generateContactHeader=function(e){if(e===void 0){e=0}var t=this.contact;if(this.options.regId&&this.options.instanceId){t+=";reg-id="+this.options.regId;t+=';+sip.instance="<urn:uuid:'+this.options.instanceId+'>"'}if(this.options.extraContactHeaderParams){this.options.extraContactHeaderParams.forEach((function(e){t+=";"+e}))}t+=";expires="+e;return t};return RegisterContext}(a.ClientContext);t.RegisterContext=f},15257:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});var i=r(846182);var n=r(130523);var a=r(670603);var s=function(){function RequestSender(e,t){this.type=n.TypeStrings.RequestSender;this.logger=t.getLogger("sip.requestsender");this.ua=t;this.applicant=e;this.method=e.request.method;this.request=e.request;this.credentials=undefined;this.challenged=false;this.staled=false;if(t.status===n.UAStatus.STATUS_USER_CLOSED&&(this.method!==i.C.BYE&&this.method!==i.C.ACK)){this.onTransportError()}}RequestSender.prototype.send=function(){if(!this.ua.transport){throw new Error("No transport to make transaction")}switch(this.method){case"INVITE":this.clientTransaction=new a.InviteClientTransaction(this,this.request,this.ua.transport);break;case"ACK":this.clientTransaction=new a.AckClientTransaction(this,this.request,this.ua.transport);break;default:this.clientTransaction=new a.NonInviteClientTransaction(this,this.request,this.ua.transport)}this.clientTransaction.send();return this.clientTransaction};RequestSender.prototype.onRequestTimeout=function(){this.applicant.onRequestTimeout()};RequestSender.prototype.onTransportError=function(){this.applicant.onTransportError()};RequestSender.prototype.receiveResponse=function(e){var t=e&&e.statusCode?e.statusCode:0;if(t===401||t===407){var r=void 0;var n=void 0;if(t===401){r=e.parseHeader("www-authenticate");n="authorization"}else{r=e.parseHeader("proxy-authenticate");n="proxy-authorization"}if(!r){this.logger.warn(t+" with wrong or missing challenge, cannot authenticate");this.applicant.receiveResponse(e);return}if(!this.challenged||!this.staled&&r.stale===true){if(!this.credentials&&this.ua.configuration.authenticationFactory){this.credentials=this.ua.configuration.authenticationFactory(this.ua)}if(!this.credentials.authenticate(this.request,r)){this.applicant.receiveResponse(e);return}this.challenged=true;if(r.stale){this.staled=true}var a=void 0;if(e.method===i.C.REGISTER){a=this.applicant.cseq+=1}else if(this.request.dialog){a=this.request.dialog.localSeqnum+=1}else{a=(this.request.cseq||0)+1;this.request.cseq=a}this.request.setHeader("cseq",a+" "+this.method);this.request.setHeader(n,this.credentials.toString());this.send()}else{this.applicant.receiveResponse(e)}}else{this.applicant.receiveResponse(e)}};return RequestSender}();t.RequestSender=s},130700:function(e,t,r){"use strict";var i=this&&this.__extends||function(){var extendStatics=function(e,t){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r]};return extendStatics(e,t)};return function(e,t){extendStatics(e,t);function __(){this.constructor=e}e.prototype=t===null?Object.create(t):(__.prototype=t.prototype,new __)}}();Object.defineProperty(t,"__esModule",{value:true});var n=r(846182);var a=r(130523);var s=r(179089);var o=r(669825);var getSupportedHeader=function(e){var t=[];if(e.method===n.C.REGISTER){t.push("path","gruu")}else if(e.method===n.C.INVITE&&(e.ua.contact.pubGruu||e.ua.contact.tempGruu)){t.push("gruu")}if(e.ua.configuration.rel100===n.C.supported.SUPPORTED){t.push("100rel")}if(e.ua.configuration.replaces===n.C.supported.SUPPORTED){t.push("replaces")}t.push("outbound");t=t.concat(e.ua.configuration.extraSupported||[]);var r=e.ua.configuration.hackAllowUnregisteredOptionTags||false;var i={};t=t.filter((function(e){var t=n.C.OPTION_TAGS[e];var a=!i[e];i[e]=true;return(t||r)&&a}));return"Supported: "+t.join(", ")+"\r\n"};var u=function(){function OutgoingRequest(e,t,r,i,n,u){if(i===void 0){i={}}this.type=a.TypeStrings.OutgoingRequest;this.logger=r.getLogger("sip.sipmessage");this.ua=r;this.headers={};this.method=e;this.ruri=t;this.body=u;this.extraHeaders=(n||[]).slice();this.statusCode=i.statusCode;this.reasonPhrase=i.reasonPhrase;if(i.routeSet){this.setHeader("route",i.routeSet)}else if(r.configuration.usePreloadedRoute&&r.transport){this.setHeader("route",r.transport.server.sipUri)}this.setHeader("via","");this.setHeader("max-forwards","70");var c=i.toUri||t;var l=i.toDisplayName||i.toDisplayName===0?'"'+i.toDisplayName+'" ':"";l+="<"+(c.type===a.TypeStrings.URI?c.toRaw():c)+">";l+=i.toTag?";tag="+i.toTag:"";this.to=s.Grammar.nameAddrHeaderParse(l);this.setHeader("to",l);var f=i.fromUri||r.configuration.uri||"";var p;if(i.fromDisplayName||i.fromDisplayName===0){p='"'+i.fromDisplayName+'" '}else if(r.configuration.displayName){p='"'+r.configuration.displayName+'" '}else{p=""}p+="<"+(f.type===a.TypeStrings.URI?f.toRaw():f)+">;tag=";p+=i.fromTag||o.Utils.newTag();this.from=s.Grammar.nameAddrHeaderParse(p);this.setHeader("from",p);this.callId=i.callId||r.configuration.sipjsId+o.Utils.createRandomToken(15);this.setHeader("call-id",this.callId);this.cseq=i.cseq||Math.floor(Math.random()*1e4);this.setHeader("cseq",this.cseq+" "+e)}OutgoingRequest.prototype.setHeader=function(e,t){this.headers[o.Utils.headerize(e)]=t instanceof Array?t:[t]};OutgoingRequest.prototype.getHeader=function(e){var t=this.headers[o.Utils.headerize(e)];if(t){if(t[0]){return t[0]}}else{var r=new RegExp("^\\s*"+e+"\\s*:","i");for(var i=0,n=this.extraHeaders;i<n.length;i++){var a=n[i];if(r.test(a)){return a.substring(a.indexOf(":")+1).trim()}}}return};OutgoingRequest.prototype.cancel=function(e,t){};OutgoingRequest.prototype.getHeaders=function(e){var t=[];var r=this.headers[o.Utils.headerize(e)];if(r){for(var i=0,n=r;i<n.length;i++){var a=n[i];t.push(a)}}else{var s=new RegExp("^\\s*"+e+"\\s*:","i");for(var u=0,c=this.extraHeaders;u<c.length;u++){var l=c[u];if(s.test(l)){t.push(l.substring(l.indexOf(":")+1).trim())}}}return t};OutgoingRequest.prototype.hasHeader=function(e){if(this.headers[o.Utils.headerize(e)]){return true}else{var t=new RegExp("^\\s*"+e+"\\s*:","i");for(var r=0,i=this.extraHeaders;r<i.length;r++){var n=i[r];if(t.test(n)){return true}}}return false};OutgoingRequest.prototype.toString=function(){var e="";e+=this.method+" "+(this.ruri.type===a.TypeStrings.URI?this.ruri.toRaw():this.ruri)+" SIP/2.0\r\n";for(var t in this.headers){if(this.headers[t]){for(var r=0,i=this.headers[t];r<i.length;r++){var n=i[r];e+=t+": "+n+"\r\n"}}}for(var s=0,u=this.extraHeaders;s<u.length;s++){var t=u[s];e+=t.trim()+"\r\n"}e+=getSupportedHeader(this);e+="User-Agent: "+this.ua.configuration.userAgentString+"\r\n";if(this.body){if(typeof this.body==="string"){e+="Content-Length: "+o.Utils.str_utf8_length(this.body)+"\r\n\r\n";e+=this.body}else{if(this.body.body&&this.body.contentType){e+="Content-Type: "+this.body.contentType+"\r\n";e+="Content-Length: "+o.Utils.str_utf8_length(this.body.body)+"\r\n\r\n";e+=this.body.body}else{e+="Content-Length: "+0+"\r\n\r\n"}}}else{e+="Content-Length: "+0+"\r\n\r\n"}return e};return OutgoingRequest}();t.OutgoingRequest=u;var c=function(){function IncomingMessage(){this.type=a.TypeStrings.IncomingMessage;this.headers={}}IncomingMessage.prototype.addHeader=function(e,t){var r={raw:t};e=o.Utils.headerize(e);if(this.headers[e]){this.headers[e].push(r)}else{this.headers[e]=[r]}};IncomingMessage.prototype.getHeader=function(e){var t=this.headers[o.Utils.headerize(e)];if(t){if(t[0]){return t[0].raw}}else{return}};IncomingMessage.prototype.getHeaders=function(e){var t=this.headers[o.Utils.headerize(e)];var r=[];if(!t){return[]}for(var i=0,n=t;i<n.length;i++){var a=n[i];r.push(a.raw)}return r};IncomingMessage.prototype.hasHeader=function(e){return!!this.headers[o.Utils.headerize(e)]};IncomingMessage.prototype.parseHeader=function(e,t){if(t===void 0){t=0}e=o.Utils.headerize(e);if(!this.headers[e]){return}else if(t>=this.headers[e].length){return}var r=this.headers[e][t];var i=r.raw;if(r.parsed){return r.parsed}var n=s.Grammar.parse(i,e.replace(/-/g,"_"));if(n===-1){this.headers[e].splice(t,1);return}else{r.parsed=n;return n}};IncomingMessage.prototype.s=function(e,t){if(t===void 0){t=0}return this.parseHeader(e,t)};IncomingMessage.prototype.setHeader=function(e,t){this.headers[o.Utils.headerize(e)]=[{raw:t}]};IncomingMessage.prototype.toString=function(){return this.data};return IncomingMessage}();var l=function(e){i(IncomingRequest,e);function IncomingRequest(t){var r=e.call(this)||this;r.type=a.TypeStrings.IncomingRequest;r.logger=t.getLogger("sip.sipmessage");r.ua=t;return r}IncomingRequest.prototype.reply=function(e,t,r,i,a,s){var u=o.Utils.buildStatusLine(e,t);r=(r||[]).slice();if(this.method===n.C.INVITE&&e>100&&e<=200){for(var c=0,l=this.getHeaders("record-route");c<l.length;c++){var f=l[c];u+="Record-Route: "+f+"\r\n"}}for(var p=0,d=this.getHeaders("via");p<d.length;p++){var h=d[p];u+="Via: "+h+"\r\n"}var g=this.getHeader("to")||"";if(!this.toTag&&e>100){g+=";tag="+o.Utils.newTag()}else if(this.toTag&&!this.s("to").hasParam("tag")){g+=";tag="+this.toTag}u+="To: "+g+"\r\n";u+="From: "+this.getHeader("From")+"\r\n";u+="Call-ID: "+this.callId+"\r\n";u+="CSeq: "+this.cseq+" "+this.method+"\r\n";for(var v=0,m=r;v<m.length;v++){var y=m[v];u+=y.trim()+"\r\n"}u+=getSupportedHeader(this);u+="User-Agent: "+this.ua.configuration.userAgentString+"\r\n";if(i){if(typeof i==="string"){u+="Content-Type: application/sdp\r\n";u+="Content-Length: "+o.Utils.str_utf8_length(i)+"\r\n\r\n";u+=i}else{if(i.body&&i.contentType){u+="Content-Type: "+i.contentType+"\r\n";u+="Content-Length: "+o.Utils.str_utf8_length(i.body)+"\r\n\r\n";u+=i.body}else{u+="Content-Length: "+0+"\r\n\r\n"}}}else{u+="Content-Length: "+0+"\r\n\r\n"}if(this.serverTransaction){this.serverTransaction.receiveResponse(e,u).then(a,s)}return u};IncomingRequest.prototype.reply_sl=function(e,t){var r=o.Utils.buildStatusLine(e,t);for(var i=0,n=this.getHeaders("via");i<n.length;i++){var a=n[i];r+="Via: "+a+"\r\n"}var s=this.getHeader("To")||"";if(!this.toTag&&e>100){s+=";tag="+o.Utils.newTag()}else if(this.toTag&&!this.s("to").hasParam("tag")){s+=";tag="+this.toTag}r+="To: "+s+"\r\n";r+="From: "+this.getHeader("From")+"\r\n";r+="Call-ID: "+this.callId+"\r\n";r+="CSeq: "+this.cseq+" "+this.method+"\r\n";r+="User-Agent: "+this.ua.configuration.userAgentString+"\r\n";r+="Content-Length: "+0+"\r\n\r\n";if(this.transport){this.transport.send(r)}};return IncomingRequest}(c);t.IncomingRequest=l;var f=function(e){i(IncomingResponse,e);function IncomingResponse(t){var r=e.call(this)||this;r.type=a.TypeStrings.IncomingResponse;r.logger=t.getLogger("sip.sipmessage");r.headers={};return r}return IncomingResponse}(c);t.IncomingResponse=f},338949:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});var i=r(846182);var n=r(130523);var a=r(669825);var s;(function(e){function reply(e,t,r){var i=a.Utils.buildStatusLine(e);var n=t.getHeaders("via");for(var s=0,o=n;s<o.length;s++){var u=o[s];i+="Via: "+u+"\r\n"}var c=t.getHeader("To")||"";if(!t.toTag){c+=";tag="+a.Utils.newTag()}i+="To: "+c+"\r\n";i+="From: "+t.getHeader("From")+"\r\n";i+="Call-ID: "+t.callId+"\r\n";i+="CSeq: "+t.cseq+" "+t.method+"\r\n";i+="\r\n";r.send(i)}e.reply=reply;function rfc3261_8_2_2_1(e,t,r){if(!e.ruri||e.ruri.scheme!=="sip"){reply(416,e,r);return false}return true}e.rfc3261_8_2_2_1=rfc3261_8_2_2_1;function rfc3261_16_3_4(e,t,r){if(!e.toTag){if(e.callId.substr(0,5)===t.configuration.sipjsId){reply(482,e,r);return false}}return true}e.rfc3261_16_3_4=rfc3261_16_3_4;function rfc3261_18_3_request(e,t,r){var i=a.Utils.str_utf8_length(e.body);var n=e.getHeader("content-length");if(n&&i<Number(n)){reply(400,e,r);return false}return true}e.rfc3261_18_3_request=rfc3261_18_3_request;function rfc3261_8_2_2_2(e,t,r){var n=e.fromTag;var a=e.callId;var s=e.cseq;if(!e.toTag){if(e.method===i.C.INVITE){if(t.transactions.ist[e.viaBranch]){return true}else{for(var o in t.transactions.ist){if(t.transactions.ist.hasOwnProperty(o)){var u=t.transactions.ist[o];if(u.request.fromTag===n&&u.request.callId===a&&u.request.cseq===s){reply(482,e,r);return false}}}}}else{if(t.transactions.nist[e.viaBranch]){return true}else{for(var o in t.transactions.nist){if(t.transactions.nist.hasOwnProperty(o)){var u=t.transactions.nist[o];if(u.request.fromTag===n&&u.request.callId===a&&u.request.cseq===s){reply(482,e,r);return false}}}}}}return true}e.rfc3261_8_2_2_2=rfc3261_8_2_2_2;function rfc3261_8_1_3_3(e,t){if(e.getHeaders("via").length>1){t.getLogger("sip.sanitycheck").warn("More than one Via header field present in the response."+" Dropping the response");return false}return true}e.rfc3261_8_1_3_3=rfc3261_8_1_3_3;function rfc3261_18_1_2(e,t){if(e.via.host!==t.configuration.viaHost||e.via.port!==undefined){t.getLogger("sip.sanitycheck").warn("Via sent-by in the response does not match UA Via host value."+" Dropping the response");return false}return true}e.rfc3261_18_1_2=rfc3261_18_1_2;function rfc3261_18_3_response(e,t){var r=a.Utils.str_utf8_length(e.body);var i=e.getHeader("content-length");if(i&&r<Number(i)){t.getLogger("sip.sanitycheck").warn("Message body length is lower than the value in"+" Content-Length header field. Dropping the response");return false}return true}e.rfc3261_18_3_response=rfc3261_18_3_response;function minimumHeaders(e,t){var r=["from","to","call_id","cseq","via"];for(var i=0,n=r;i<n.length;i++){var a=n[i];if(!e.hasHeader(a)){t.getLogger("sip.sanitycheck").warn("Missing mandatory header field : "+a+". Dropping the response");return false}}return true}e.minimumHeaders=minimumHeaders;function sanityCheck(e,t,r){var i=[rfc3261_8_2_2_1,rfc3261_16_3_4,rfc3261_18_3_request,rfc3261_8_2_2_2];var a=[rfc3261_8_1_3_3,rfc3261_18_1_2,rfc3261_18_3_response];var s=[minimumHeaders];for(var o=0,u=s;o<u.length;o++){var c=u[o];if(!c(e,t,r)){return false}}if(e.type===n.TypeStrings.IncomingRequest){for(var l=0,f=i;l<f.length;l++){var c=f[l];if(!c(e,t,r)){return false}}}else if(e.type===n.TypeStrings.IncomingResponse){for(var p=0,d=a;p<d.length;p++){var c=d[p];if(!c(e,t,r)){return false}}}return true}e.sanityCheck=sanityCheck})(s=t.SanityCheck||(t.SanityCheck={}))},662564:function(e,t,r){"use strict";var i=this&&this.__extends||function(){var extendStatics=function(e,t){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r]};return extendStatics(e,t)};return function(e,t){extendStatics(e,t);function __(){this.constructor=e}e.prototype=t===null?Object.create(t):(__.prototype=t.prototype,new __)}}();Object.defineProperty(t,"__esModule",{value:true});var n=r(850343);var a=r(846182);var s=r(130523);var o=r(179089);var u=r(670603);var c=r(669825);var l=function(e){i(ServerContext,e);function ServerContext(t,r){var i=e.call(this)||this;i.data={};ServerContext.initializer(i,t,r);return i}ServerContext.initializer=function(e,t,r){e.type=s.TypeStrings.ServerContext;e.ua=t;e.logger=t.getLogger("sip.servercontext");e.request=r;if(r.method===a.C.INVITE){e.transaction=new u.InviteServerTransaction(r,t)}else{e.transaction=new u.NonInviteServerTransaction(r,t)}if(r.body){e.body=r.body}if(r.hasHeader("Content-Type")){e.contentType=r.getHeader("Content-Type")}e.method=r.method;e.localIdentity=r.to;e.remoteIdentity=r.from;var i=r.hasHeader("P-Asserted-Identity");if(i){var n=r.getHeader("P-Asserted-Identity");if(n){e.assertedIdentity=o.Grammar.nameAddrHeaderParse(n)}}};ServerContext.prototype.progress=function(e){if(e===void 0){e={}}e.statusCode=e.statusCode||180;e.minCode=100;e.maxCode=199;e.events=["progress"];return this.reply(e)};ServerContext.prototype.accept=function(e){if(e===void 0){e={}}e.statusCode=e.statusCode||200;e.minCode=200;e.maxCode=299;e.events=["accepted"];return this.reply(e)};ServerContext.prototype.reject=function(e){if(e===void 0){e={}}e.statusCode=e.statusCode||480;e.minCode=300;e.maxCode=699;e.events=["rejected","failed"];return this.reply(e)};ServerContext.prototype.reply=function(e){var t=this;if(e===void 0){e={}}var r=e.statusCode||100;var i=e.minCode||100;var n=e.maxCode||699;var a=c.Utils.getReasonPhrase(r,e.reasonPhrase);var s=e.extraHeaders||[];var o=e.body;var u=e.events||[];if(r<i||r>n){throw new TypeError("Invalid statusCode: "+r)}var l=this.request.reply(r,a,s,o);u.forEach((function(e){t.emit(e,l,a)}));return this};ServerContext.prototype.onRequestTimeout=function(){this.emit("failed",undefined,a.C.causes.REQUEST_TIMEOUT)};ServerContext.prototype.onTransportError=function(){this.emit("failed",undefined,a.C.causes.CONNECTION_ERROR)};return ServerContext}(n.EventEmitter);t.ServerContext=l},124555:function(e,t,r){"use strict";var i=this&&this.__extends||function(){var extendStatics=function(e,t){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r]};return extendStatics(e,t)};return function(e,t){extendStatics(e,t);function __(){this.constructor=e}e.prototype=t===null?Object.create(t):(__.prototype=t.prototype,new __)}}();Object.defineProperty(t,"__esModule",{value:true});var n=r(850343);var a=r(513669);var s=r(846182);var o=r(122517);var u=r(130523);var c=r(325840);var l=r(179089);var f=r(15257);var p=r(662564);var d=r(115916);var h=r(130700);var g=r(753316);var v=r(669825);var m=function(e){i(Session,e);function Session(t){var r=e.call(this)||this;r.data={};r.type=u.TypeStrings.Session;if(!t){throw new c.Exceptions.SessionDescriptionHandlerError("A session description handler is required for the session to function")}r.status=Session.C.STATUS_NULL;r.dialog=undefined;r.pendingReinvite=false;r.earlyDialogs={};r.sessionDescriptionHandlerFactory=t;r.hasOffer=false;r.hasAnswer=false;r.timers={ackTimer:undefined,expiresTimer:undefined,invite2xxTimer:undefined,userNoAnswerTimer:undefined,rel1xxTimer:undefined,prackTimer:undefined};r.startTime=undefined;r.endTime=undefined;r.tones=undefined;r.localHold=false;r.earlySdp=undefined;r.rel100=s.C.supported.UNSUPPORTED;r.originalReceiveRequest=r.receiveRequest;return r}Session.prototype.dtmf=function(e,t){var r=this;if(t===void 0){t={}}if(this.status!==u.SessionStatus.STATUS_CONFIRMED&&this.status!==u.SessionStatus.STATUS_WAITING_FOR_ACK){throw new c.Exceptions.InvalidStateError(this.status)}if(!e||!e.toString().match(/^[0-9A-D#*,]+$/i)){throw new TypeError("Invalid tones: "+e)}var sendDTMF=function(){if(r.status===u.SessionStatus.STATUS_TERMINATED||!r.tones||r.tones.length===0){r.tones=undefined;return}var e=r.tones.shift();var i;if(e.tone===","){i=2e3}else{e.on("failed",(function(){r.tones=undefined}));e.send(t);i=e.duration+e.interToneGap}setTimeout(sendDTMF,i)};e=e.toString();var i=this.ua.configuration.dtmfType;if(this.sessionDescriptionHandler&&i===s.C.dtmfType.RTP){var n=this.sessionDescriptionHandler.sendDtmf(e,t);if(!n){this.logger.warn("Attempt to use dtmfType 'RTP' has failed, falling back to INFO packet method");i=s.C.dtmfType.INFO}}if(i===s.C.dtmfType.INFO){var a=[];var o=e.split("");while(o.length>0){a.push(new d.DTMF(this,o.shift(),t))}if(this.tones){this.tones=this.tones.concat(a);return this}this.tones=a;sendDTMF()}return this};Session.prototype.bye=function(e){if(e===void 0){e={}}if(this.status===u.SessionStatus.STATUS_TERMINATED){this.logger.error("Error: Attempted to send BYE in a terminated session.");return this}this.logger.log("terminating Session");var t=e.statusCode;if(t&&(t<200||t>=700)){throw new TypeError("Invalid statusCode: "+t)}e.receiveResponse=function(){};return this.sendRequest(s.C.BYE,e).terminated()};Session.prototype.refer=function(e,t){if(t===void 0){t={}}if(this.status!==u.SessionStatus.STATUS_CONFIRMED){throw new c.Exceptions.InvalidStateError(this.status)}this.referContext=new T(this.ua,this,e,t);this.emit("referRequested",this.referContext);this.referContext.refer(t);return this.referContext};Session.prototype.sendRequest=function(e,t){var r=this;if(t===void 0){t={}}t=t||{};if(!this.dialog){throw new Error("sending request without a dialog")}var i=new h.OutgoingRequest(e,this.dialog.remoteTarget,this.ua,{cseq:t.cseq||(this.dialog.localSeqnum+=1),callId:this.dialog.id.callId,fromUri:this.dialog.localUri,fromTag:this.dialog.id.localTag,ToUri:this.dialog.remoteUri,toTag:this.dialog.id.remoteTag,routeSet:this.dialog.routeSet,statusCode:t.statusCode,reasonPhrase:t.reasonPhrase},t.extraHeaders||[],t.body);new f.RequestSender({request:i,onRequestTimeout:function(){return r.onRequestTimeout()},onTransportError:function(){return r.onTransportError()},receiveResponse:function(e){return(t.receiveResponse||r.receiveNonInviteResponse.bind(r))(e)}},this.ua).send();this.emit(e.toLowerCase(),i);return this};Session.prototype.close=function(){if(this.status===u.SessionStatus.STATUS_TERMINATED){return this}this.logger.log("closing INVITE session "+this.id);if(this.sessionDescriptionHandler){this.sessionDescriptionHandler.close()}for(var e in this.timers){if(this.timers[e]){clearTimeout(this.timers[e])}}if(this.dialog){this.dialog.terminate();delete this.dialog}for(var t in this.earlyDialogs){if(this.earlyDialogs.hasOwnProperty(t)){this.earlyDialogs[t].terminate();delete this.earlyDialogs[t]}}this.status=u.SessionStatus.STATUS_TERMINATED;if(this.ua.transport){this.ua.transport.removeListener("transportError",this.errorListener)}delete this.ua.sessions[this.id];return this};Session.prototype.createDialog=function(e,t,r){if(r===void 0){r=false}var i=e[t==="UAS"?"toTag":"fromTag"];var n=e[t==="UAS"?"fromTag":"toTag"];var a=e.callId+i+n;if(r){if(this.earlyDialogs[a]){return true}else{var u=new o.Dialog(this,e,t,o.Dialog.C.STATUS_EARLY);if(u.error){this.logger.error(u.error);this.failed(e,s.C.causes.INTERNAL_ERROR);return false}else{this.earlyDialogs[a]=u;return true}}}else{var u=this.earlyDialogs[a];if(u){u.update(e,t);this.dialog=u;delete this.earlyDialogs[a];for(var c in this.earlyDialogs){if(this.earlyDialogs.hasOwnProperty(c)){this.earlyDialogs[c].terminate();delete this.earlyDialogs[c]}}return true}var l=new o.Dialog(this,e,t);if(l.error){this.logger.error(l.error);this.failed(e,s.C.causes.INTERNAL_ERROR);return false}else{this.toTag=e.toTag;this.dialog=l;return true}}};Session.prototype.hold=function(e,t){if(e===void 0){e={}}if(t===void 0){t=[]}if(this.status!==u.SessionStatus.STATUS_WAITING_FOR_ACK&&this.status!==u.SessionStatus.STATUS_CONFIRMED){throw new c.Exceptions.InvalidStateError(this.status)}if(this.localHold){this.logger.log("Session is already on hold, cannot put it on hold again");return}e.modifiers=t;if(this.sessionDescriptionHandler){e.modifiers.push(this.sessionDescriptionHandler.holdModifier)}this.localHold=true;this.sendReinvite(e)};Session.prototype.unhold=function(e,t){if(e===void 0){e={}}if(t===void 0){t=[]}if(this.status!==u.SessionStatus.STATUS_WAITING_FOR_ACK&&this.status!==u.SessionStatus.STATUS_CONFIRMED){throw new c.Exceptions.InvalidStateError(this.status)}if(!this.localHold){this.logger.log("Session is not on hold, cannot unhold it");return}e.modifiers=t;this.localHold=false;this.sendReinvite(e)};Session.prototype.reinvite=function(e,t){if(e===void 0){e={}}if(t===void 0){t=[]}e.modifiers=t;return this.sendReinvite(e)};Session.prototype.receiveRequest=function(e){switch(e.method){case s.C.BYE:e.reply(200);if(this.status===u.SessionStatus.STATUS_CONFIRMED){this.emit("bye",e);this.terminated(e,s.C.BYE)}break;case s.C.INVITE:if(this.status===u.SessionStatus.STATUS_CONFIRMED){this.logger.log("re-INVITE received");this.receiveReinvite(e)}break;case s.C.INFO:if(this.status===u.SessionStatus.STATUS_CONFIRMED||this.status===u.SessionStatus.STATUS_WAITING_FOR_ACK){if(this.onInfo){return this.onInfo(e)}var t=e.getHeader("content-type");if(t){if(t.match(/^application\/dtmf-relay/i)){if(e.body){var r=e.body.split("\r\n",2);if(r.length===2){var i=void 0;var n=void 0;var a=/^(Signal\s*?=\s*?)([0-9A-D#*]{1})(\s)?.*/;if(a.test(r[0])){i=r[0].replace(a,"$2")}var o=/^(Duration\s?=\s?)([0-9]{1,4})(\s)?.*/;if(o.test(r[1])){n=parseInt(r[1].replace(o,"$2"),10)}if(i&&n){new d.DTMF(this,i,{duration:n}).init_incoming(e)}}}}else{e.reply(415,undefined,["Accept: application/dtmf-relay"])}}}break;case s.C.REFER:if(this.status===u.SessionStatus.STATUS_CONFIRMED){this.logger.log("REFER received");this.referContext=new b(this.ua,e);if(this.listeners("referRequested").length){this.emit("referRequested",this.referContext)}else{this.logger.log("No referRequested listeners, automatically accepting and following the refer");var c={followRefer:true};if(this.passedOptions){c.inviteOptions=this.passedOptions}this.referContext.accept(c,this.modifiers)}}break;case s.C.NOTIFY:if(this.referContext&&this.referContext.type===u.TypeStrings.ReferClientContext&&e.hasHeader("event")&&/^refer(;.*)?$/.test(e.getHeader("event"))){this.referContext.receiveNotify(e);return}e.reply(200,"OK");this.emit("notify",e);break}};Session.prototype.terminate=function(e){return this};Session.prototype.onTransportError=function(){if(this.status!==u.SessionStatus.STATUS_CONFIRMED&&this.status!==u.SessionStatus.STATUS_TERMINATED){this.failed(undefined,s.C.causes.CONNECTION_ERROR)}};Session.prototype.onRequestTimeout=function(){if(this.status===u.SessionStatus.STATUS_CONFIRMED){this.terminated(undefined,s.C.causes.REQUEST_TIMEOUT)}else if(this.status!==u.SessionStatus.STATUS_TERMINATED){this.failed(undefined,s.C.causes.REQUEST_TIMEOUT);this.terminated(undefined,s.C.causes.REQUEST_TIMEOUT)}};Session.prototype.onDialogError=function(e){if(this.status===u.SessionStatus.STATUS_CONFIRMED){this.terminated(e,s.C.causes.DIALOG_ERROR)}else if(this.status!==u.SessionStatus.STATUS_TERMINATED){this.failed(e,s.C.causes.DIALOG_ERROR);this.terminated(e,s.C.causes.DIALOG_ERROR)}};Session.prototype.receiveReinvite=function(e){var t=this;this.emit("reinvite",this,e);if(e.hasHeader("P-Asserted-Identity")){this.assertedIdentity=l.Grammar.nameAddrHeaderParse(e.getHeader("P-Asserted-Identity"))}var r;if(!this.sessionDescriptionHandler){this.logger.warn("No SessionDescriptionHandler to reinvite");return}if(e.getHeader("Content-Length")==="0"&&!e.getHeader("Content-Type")){r=this.sessionDescriptionHandler.getDescription(this.sessionDescriptionHandlerOptions,this.modifiers)}else if(this.sessionDescriptionHandler.hasDescription(e.getHeader("Content-Type")||"")){r=this.sessionDescriptionHandler.setDescription(e.body,this.sessionDescriptionHandlerOptions,this.modifiers).then(this.sessionDescriptionHandler.getDescription.bind(this.sessionDescriptionHandler,this.sessionDescriptionHandlerOptions,this.modifiers))}else{e.reply(415);this.emit("reinviteFailed",this);return}this.receiveRequest=function(e){if(e.method===s.C.ACK&&t.status===u.SessionStatus.STATUS_WAITING_FOR_ACK){if(t.sessionDescriptionHandler&&t.sessionDescriptionHandler.hasDescription(e.getHeader("Content-Type")||"")){t.hasAnswer=true;t.sessionDescriptionHandler.setDescription(e.body,t.sessionDescriptionHandlerOptions,t.modifiers).then((function(){clearTimeout(t.timers.ackTimer);clearTimeout(t.timers.invite2xxTimer);t.status=u.SessionStatus.STATUS_CONFIRMED;t.emit("confirmed",e)}))}else{clearTimeout(t.timers.ackTimer);clearTimeout(t.timers.invite2xxTimer);t.status=u.SessionStatus.STATUS_CONFIRMED;t.emit("confirmed",e)}}else{t.originalReceiveRequest(e)}};r.catch((function(r){var i;if(r.type===u.TypeStrings.SessionDescriptionHandlerError){i=500}else if(r.type===u.TypeStrings.RenegotiationError){t.emit("renegotiationError",r);t.logger.warn(r.toString());i=488}else{t.logger.error(r);i=488}e.reply(i);t.emit("reinviteFailed",t);throw r})).then((function(r){var i=["Contact: "+t.contact];e.reply(200,undefined,i,r,(function(){t.status=u.SessionStatus.STATUS_WAITING_FOR_ACK;t.setACKTimer();t.emit("reinviteAccepted",t)}))}))};Session.prototype.sendReinvite=function(e){var t=this;if(e===void 0){e={}}if(this.pendingReinvite){this.logger.warn("Reinvite in progress. Please wait until complete, then try again.");return}if(!this.sessionDescriptionHandler){this.logger.warn("No SessionDescriptionHandler, can't reinvite..");return}this.pendingReinvite=true;e.modifiers=e.modifiers||[];var r=(e.extraHeaders||[]).slice();r.push("Contact: "+this.contact);r.push("Allow: "+["ACK","CANCEL","INVITE","MESSAGE","BYE","OPTIONS","INFO","NOTIFY","REFER"].toString());this.sessionDescriptionHandler.getDescription(e.sessionDescriptionHandlerOptions,e.modifiers).then((function(e){t.sendRequest(s.C.INVITE,{extraHeaders:r,body:e,receiveResponse:function(e){return t.receiveReinviteResponse(e)}})})).catch((function(e){if(e.type===u.TypeStrings.RenegotiationError){t.pendingReinvite=false;t.emit("renegotiationError",e);t.logger.warn("Renegotiation Error");t.logger.warn(e.toString());throw e}t.logger.error("sessionDescriptionHandler error");t.logger.error(e);throw e}))};Session.prototype.receiveReinviteResponse=function(e){var t=this;if(this.status===u.SessionStatus.STATUS_TERMINATED){this.logger.error("Received reinvite response, but in STATUS_TERMINATED");return}if(!this.pendingReinvite){this.logger.error("Received reinvite response, but have no pending reinvite");return}var r=e&&e.statusCode?e.statusCode.toString():"";switch(true){case/^1[0-9]{2}$/.test(r):break;case/^2[0-9]{2}$/.test(r):this.status=u.SessionStatus.STATUS_CONFIRMED;this.emit("ack",e.transaction.sendACK());this.pendingReinvite=false;clearTimeout(this.timers.invite2xxTimer);if(!this.sessionDescriptionHandler||!this.sessionDescriptionHandler.hasDescription(e.getHeader("Content-Type")||"")){this.logger.error("2XX response received to re-invite but did not have a description");this.emit("reinviteFailed",this);this.emit("renegotiationError",new c.Exceptions.RenegotiationError("2XX response received to re-invite but did not have a description"));break}this.sessionDescriptionHandler.setDescription(e.body,this.sessionDescriptionHandlerOptions,this.modifiers).catch((function(e){t.logger.error("Could not set the description in 2XX response");t.logger.error(e);t.emit("reinviteFailed",t);t.emit("renegotiationError",e);t.sendRequest(s.C.BYE,{extraHeaders:["Reason: "+v.Utils.getReasonHeaderValue(488,"Not Acceptable Here")]});t.terminated(undefined,s.C.causes.INCOMPATIBLE_SDP);throw e})).then((function(){t.emit("reinviteAccepted",t)}));break;default:this.pendingReinvite=false;this.logger.log("Received a non 1XX or 2XX response to a re-invite");this.emit("reinviteFailed",this);this.emit("renegotiationError",new c.Exceptions.RenegotiationError("Invalid response to a re-invite"))}};Session.prototype.acceptAndTerminate=function(e,t,r){var i=[];if(t){i.push("Reason: "+v.Utils.getReasonHeaderValue(t,r))}if(this.dialog||this.createDialog(e,"UAC")){this.emit("ack",e.transaction.sendACK());this.sendRequest(s.C.BYE,{extraHeaders:i})}return this};Session.prototype.setInvite2xxTimer=function(e,t){var r=this;var i=g.Timers.T1;var invite2xxRetransmission=function(){if(r.status!==u.SessionStatus.STATUS_WAITING_FOR_ACK){return}r.logger.log("no ACK received, attempting to retransmit OK");var n=["Contact: "+r.contact];e.reply(200,undefined,n,t);i=Math.min(i*2,g.Timers.T2);r.timers.invite2xxTimer=setTimeout(invite2xxRetransmission,i)};this.timers.invite2xxTimer=setTimeout(invite2xxRetransmission,i)};Session.prototype.setACKTimer=function(){var e=this;this.timers.ackTimer=setTimeout((function(){if(e.status===u.SessionStatus.STATUS_WAITING_FOR_ACK){e.logger.log("no ACK received for an extended period of time, terminating the call");clearTimeout(e.timers.invite2xxTimer);e.sendRequest(s.C.BYE);e.terminated(undefined,s.C.causes.NO_ACK)}}),g.Timers.TIMER_H)};Session.prototype.failed=function(e,t){if(this.status===u.SessionStatus.STATUS_TERMINATED){return this}this.emit("failed",e,t);return this};Session.prototype.rejected=function(e,t){this.emit("rejected",e,t);return this};Session.prototype.canceled=function(){if(this.sessionDescriptionHandler){this.sessionDescriptionHandler.close()}this.emit("cancel");return this};Session.prototype.accepted=function(e,t){if(!(e instanceof String)){t=v.Utils.getReasonPhrase(e&&e.statusCode||0,t)}this.startTime=new Date;if(this.replacee){this.replacee.emit("replaced",this);this.replacee.terminate()}this.emit("accepted",e,t);return this};Session.prototype.terminated=function(e,t){if(this.status===u.SessionStatus.STATUS_TERMINATED){return this}this.endTime=new Date;this.close();this.emit("terminated",e,t);return this};Session.prototype.connecting=function(e){this.emit("connecting",{request:e});return this};Session.prototype.receiveNonInviteResponse=function(e){};Session.C=u.SessionStatus;return Session}(n.EventEmitter);t.Session=m;var y=function(e){i(InviteServerContext,e);function InviteServerContext(t,r){var i=this;if(!t.configuration.sessionDescriptionHandlerFactory){t.logger.warn("Can't build ISC without SDH Factory");throw new Error("ISC Constructor Failed")}i=e.call(this,t.configuration.sessionDescriptionHandlerFactory)||this;p.ServerContext.initializer(i,t,r);i.type=u.TypeStrings.InviteServerContext;var n=r.parseHeader("Content-Disposition");if(n&&n.type==="render"){i.renderbody=r.body;i.rendertype=r.getHeader("Content-Type")}i.status=u.SessionStatus.STATUS_INVITE_RECEIVED;i.fromTag=r.fromTag;i.id=r.callId+i.fromTag;i.request=r;i.contact=i.ua.contact.toString();i.receiveNonInviteResponse=function(){};i.logger=t.getLogger("sip.inviteservercontext",i.id);i.ua.sessions[i.id]=i;var set100rel=function(e,t){if(r.hasHeader(e)&&r.getHeader(e).toLowerCase().indexOf("100rel")>=0){i.rel100=t}};set100rel("require",s.C.supported.REQUIRED);set100rel("supported",s.C.supported.SUPPORTED);r.toTag=v.Utils.newTag();if(!i.createDialog(r,"UAS",true)){r.reply(500,"Missing Contact header field");return}var a={extraHeaders:["Contact: "+i.contact]};if(i.rel100!==s.C.supported.REQUIRED){i.progress(a)}i.status=u.SessionStatus.STATUS_WAITING_FOR_ANSWER;i.timers.userNoAnswerTimer=setTimeout((function(){r.reply(408);i.failed(r,s.C.causes.NO_ANSWER);i.terminated(r,s.C.causes.NO_ANSWER)}),i.ua.configuration.noAnswerTimeout||60);if(r.hasHeader("expires")){var o=Number(r.getHeader("expires")||0)*1e3;i.timers.expiresTimer=setTimeout((function(){if(i.status===u.SessionStatus.STATUS_WAITING_FOR_ANSWER){r.reply(487);i.failed(r,s.C.causes.EXPIRES);i.terminated(r,s.C.causes.EXPIRES)}}),o)}i.errorListener=i.onTransportError.bind(i);if(t.transport){t.transport.on("transportError",i.errorListener)}return i}InviteServerContext.prototype.reject=function(e){var t=this;if(e===void 0){e={}}if(this.status===u.SessionStatus.STATUS_TERMINATED){throw new c.Exceptions.InvalidStateError(this.status)}this.logger.log("rejecting RTCSession");var r=e.statusCode||480;var i=v.Utils.getReasonPhrase(r,e.reasonPhrase);var n=e.extraHeaders||[];if(r<300||r>699){throw new TypeError("Invalid statusCode: "+r)}var a=this.request.reply(r,i,n,e.body);["rejected","failed"].forEach((function(e){t.emit(e,a,i)}));return this.terminated()};InviteServerContext.prototype.reply=function(e){if(e===void 0){e={}}return this};InviteServerContext.prototype.terminate=function(e){var t=this;if(e===void 0){e={}}var r=(e.extraHeaders||[]).slice();if(this.status===u.SessionStatus.STATUS_WAITING_FOR_ACK&&this.request.serverTransaction&&this.request.serverTransaction.state!==u.TransactionStatus.STATUS_TERMINATED){var i=this.dialog;this.receiveRequest=function(e){if(e.method===s.C.ACK){t.sendRequest(s.C.BYE,{extraHeaders:r});if(t.dialog){t.dialog.terminate()}}};this.request.serverTransaction.on("stateChanged",(function(){if(t.request.serverTransaction&&t.request.serverTransaction.state===u.TransactionStatus.STATUS_TERMINATED&&t.dialog){t.bye();t.dialog.terminate()}}));this.emit("bye",this.request);this.terminated();this.dialog=i;if(this.dialog){this.ua.dialogs[this.dialog.id.toString()]=this.dialog}}else if(this.status===u.SessionStatus.STATUS_CONFIRMED){this.bye(e)}else{this.reject(e)}return this};InviteServerContext.prototype.progress=function(e){var t=this;if(e===void 0){e={}}var r=e.statusCode||180;var i=(e.extraHeaders||[]).slice();if(r<100||r>199){throw new TypeError("Invalid statusCode: "+r)}if(this.status===u.SessionStatus.STATUS_TERMINATED){return this}var do100rel=function(){var r=e.statusCode||183;t.status=u.SessionStatus.STATUS_WAITING_FOR_PRACK;i.push("Contact: "+t.contact);i.push("Require: 100rel");i.push("RSeq: "+Math.floor(Math.random()*1e4));if(!t.sessionDescriptionHandler){t.logger.warn("No SessionDescriptionHandler, can't do 100rel");return}t.sessionDescriptionHandler.getDescription(e.sessionDescriptionHandlerOptions,e.modifiers).then((function(n){if(t.status===u.SessionStatus.STATUS_TERMINATED){return}t.earlySdp=n.body;t[t.hasOffer?"hasAnswer":"hasOffer"]=true;var a=g.Timers.T1;var rel1xxRetransmission=function(){t.request.reply(r,undefined,i,n);a*=2;t.timers.rel1xxTimer=setTimeout(rel1xxRetransmission,a)};t.timers.rel1xxTimer=setTimeout(rel1xxRetransmission,a);t.timers.prackTimer=setTimeout((function(){if(t.status!==u.SessionStatus.STATUS_WAITING_FOR_PRACK){return}t.logger.log("no PRACK received, rejecting the call");clearTimeout(t.timers.rel1xxTimer);t.request.reply(504);t.terminated(undefined,s.C.causes.NO_PRACK)}),g.Timers.T1*64);var o=t.request.reply(r,e.reasonPhrase,i,n);t.emit("progress",o,e.reasonPhrase)}),(function(){t.request.reply(480);t.failed(undefined,s.C.causes.WEBRTC_ERROR);t.terminated(undefined,s.C.causes.WEBRTC_ERROR)}))};var normalReply=function(){var n=t.request.reply(r,e.reasonPhrase,i,e.body);t.emit("progress",n,e.reasonPhrase)};if(e.statusCode!==100&&(this.rel100===s.C.supported.REQUIRED||this.rel100===s.C.supported.SUPPORTED&&e.rel100||this.rel100===s.C.supported.SUPPORTED&&this.ua.configuration.rel100===s.C.supported.REQUIRED)){this.sessionDescriptionHandler=this.setupSessionDescriptionHandler();this.emit("SessionDescriptionHandler-created",this.sessionDescriptionHandler);if(this.sessionDescriptionHandler.hasDescription(this.request.getHeader("Content-Type")||"")){this.hasOffer=true;this.sessionDescriptionHandler.setDescription(this.request.body,e.sessionDescriptionHandlerOptions,e.modifiers).then(do100rel).catch((function(e){t.logger.warn("invalid description");t.logger.warn(e);t.failed(undefined,s.C.causes.WEBRTC_ERROR);t.terminated(undefined,s.C.causes.WEBRTC_ERROR);throw e}))}else{do100rel()}}else{normalReply()}return this};InviteServerContext.prototype.accept=function(e){var t=this;if(e===void 0){e={}}this.onInfo=e.onInfo;var r=(e.extraHeaders||[]).slice();var descriptionCreationSucceeded=function(e){var replySucceeded=function(){t.status=u.SessionStatus.STATUS_WAITING_FOR_ACK;t.setInvite2xxTimer(t.request,e);t.setACKTimer()};var replyFailed=function(){t.failed(undefined,s.C.causes.CONNECTION_ERROR);t.terminated(undefined,s.C.causes.CONNECTION_ERROR)};r.push("Contact: "+t.contact);r.push("Allow: "+["ACK","CANCEL","INVITE","MESSAGE","BYE","OPTIONS","INFO","NOTIFY","REFER"].toString());if(!t.hasOffer){t.hasOffer=true}else{t.hasAnswer=true}var i=t.request.reply(200,undefined,r,e,replySucceeded,replyFailed);if(t.status!==u.SessionStatus.STATUS_TERMINATED){t.accepted(i,v.Utils.getReasonPhrase(200))}};var descriptionCreationFailed=function(e){if(e.type===u.TypeStrings.SessionDescriptionHandlerError){t.logger.log(e.message);if(e.error){t.logger.log(e.error)}}t.request.reply(480);t.failed(undefined,s.C.causes.WEBRTC_ERROR);t.terminated(undefined,s.C.causes.WEBRTC_ERROR);throw e};if(this.status===u.SessionStatus.STATUS_WAITING_FOR_PRACK){this.status=u.SessionStatus.STATUS_ANSWERED_WAITING_FOR_PRACK;return this}else if(this.status===u.SessionStatus.STATUS_WAITING_FOR_ANSWER){this.status=u.SessionStatus.STATUS_ANSWERED}else if(this.status!==u.SessionStatus.STATUS_EARLY_MEDIA){throw new c.Exceptions.InvalidStateError(this.status)}if(!this.createDialog(this.request,"UAS")){this.request.reply(500,"Missing Contact header field");return this}clearTimeout(this.timers.userNoAnswerTimer);if(this.status===u.SessionStatus.STATUS_EARLY_MEDIA){descriptionCreationSucceeded({})}else{this.sessionDescriptionHandler=this.setupSessionDescriptionHandler();this.emit("SessionDescriptionHandler-created",this.sessionDescriptionHandler);if(this.request.getHeader("Content-Length")==="0"&&!this.request.getHeader("Content-Type")){this.sessionDescriptionHandler.getDescription(e.sessionDescriptionHandlerOptions,e.modifiers).catch(descriptionCreationFailed).then(descriptionCreationSucceeded)}else if(this.sessionDescriptionHandler.hasDescription(this.request.getHeader("Content-Type")||"")){this.hasOffer=true;this.sessionDescriptionHandler.setDescription(this.request.body,e.sessionDescriptionHandlerOptions,e.modifiers).then((function(){if(!t.sessionDescriptionHandler){throw new Error("No SDH")}return t.sessionDescriptionHandler.getDescription(e.sessionDescriptionHandlerOptions,e.modifiers)})).catch(descriptionCreationFailed).then(descriptionCreationSucceeded)}else{this.request.reply(415);return this}}return this};InviteServerContext.prototype.receiveRequest=function(e){var t=this;var confirmSession=function(){clearTimeout(t.timers.ackTimer);clearTimeout(t.timers.invite2xxTimer);t.status=u.SessionStatus.STATUS_CONFIRMED;var r=e.getHeader("Content-Disposition");if(r&&r.type==="render"){t.renderbody=e.body;t.rendertype=e.getHeader("Content-Type")}t.emit("confirmed",e)};switch(e.method){case s.C.CANCEL:if(this.status===u.SessionStatus.STATUS_WAITING_FOR_ANSWER||this.status===u.SessionStatus.STATUS_WAITING_FOR_PRACK||this.status===u.SessionStatus.STATUS_ANSWERED_WAITING_FOR_PRACK||this.status===u.SessionStatus.STATUS_EARLY_MEDIA||this.status===u.SessionStatus.STATUS_ANSWERED){this.status=u.SessionStatus.STATUS_CANCELED;this.request.reply(487);this.canceled();this.rejected(e,s.C.causes.CANCELED);this.failed(e,s.C.causes.CANCELED);this.terminated(e,s.C.causes.CANCELED)}break;case s.C.ACK:if(this.status===u.SessionStatus.STATUS_WAITING_FOR_ACK){this.status=u.SessionStatus.STATUS_CONFIRMED;if(this.sessionDescriptionHandler&&this.sessionDescriptionHandler.hasDescription(e.getHeader("Content-Type")||"")){this.hasAnswer=true;this.sessionDescriptionHandler.setDescription(e.body,this.sessionDescriptionHandlerOptions,this.modifiers).catch((function(r){t.logger.warn(r);t.terminate({statusCode:"488",reasonPhrase:"Bad Media Description"});t.failed(e,s.C.causes.BAD_MEDIA_DESCRIPTION);t.terminated(e,s.C.causes.BAD_MEDIA_DESCRIPTION);throw r})).then((function(){return confirmSession()}))}else{confirmSession()}}break;case s.C.PRACK:if(this.status===u.SessionStatus.STATUS_WAITING_FOR_PRACK||this.status===u.SessionStatus.STATUS_ANSWERED_WAITING_FOR_PRACK){if(!this.hasAnswer){this.sessionDescriptionHandler=this.setupSessionDescriptionHandler();this.emit("SessionDescriptionHandler-created",this.sessionDescriptionHandler);if(this.sessionDescriptionHandler.hasDescription(e.getHeader("Content-Type")||"")){this.hasAnswer=true;this.sessionDescriptionHandler.setDescription(e.body,this.sessionDescriptionHandlerOptions,this.modifiers).then((function(){clearTimeout(t.timers.rel1xxTimer);clearTimeout(t.timers.prackTimer);e.reply(200);if(t.status===u.SessionStatus.STATUS_ANSWERED_WAITING_FOR_PRACK){t.status=u.SessionStatus.STATUS_EARLY_MEDIA;t.accept()}t.status=u.SessionStatus.STATUS_EARLY_MEDIA}),(function(r){t.logger.warn(r);t.terminate({statusCode:"488",reasonPhrase:"Bad Media Description"});t.failed(e,s.C.causes.BAD_MEDIA_DESCRIPTION);t.terminated(e,s.C.causes.BAD_MEDIA_DESCRIPTION)}))}else{this.terminate({statusCode:"488",reasonPhrase:"Bad Media Description"});this.failed(e,s.C.causes.BAD_MEDIA_DESCRIPTION);this.terminated(e,s.C.causes.BAD_MEDIA_DESCRIPTION)}}else{clearTimeout(this.timers.rel1xxTimer);clearTimeout(this.timers.prackTimer);e.reply(200);if(this.status===u.SessionStatus.STATUS_ANSWERED_WAITING_FOR_PRACK){this.status=u.SessionStatus.STATUS_EARLY_MEDIA;this.accept()}this.status=u.SessionStatus.STATUS_EARLY_MEDIA}}else if(this.status===u.SessionStatus.STATUS_EARLY_MEDIA){e.reply(200)}break;default:m.prototype.receiveRequest.apply(this,[e]);break}};InviteServerContext.prototype.setupSessionDescriptionHandler=function(){if(this.sessionDescriptionHandler){return this.sessionDescriptionHandler}return this.sessionDescriptionHandlerFactory(this,this.ua.configuration.sessionDescriptionHandlerFactoryOptions)};return InviteServerContext}(m);t.InviteServerContext=y;var S=function(e){i(InviteClientContext,e);function InviteClientContext(t,r,i,n){if(i===void 0){i={}}if(n===void 0){n=[]}var o=this;if(!t.configuration.sessionDescriptionHandlerFactory){t.logger.warn("Can't build ISC without SDH Factory");throw new Error("ICC Constructor Failed")}i.params=i.params||{};var l=i.anonymous||false;var f=v.Utils.newTag();i.params.fromTag=f;var p=t.contact.toString({anonymous:l,outbound:l?!t.contact.temp_gruu:!t.contact.pub_gruu});var d=(i.extraHeaders||[]).slice();if(l&&t.configuration.uri){i.params.from_displayName="Anonymous";i.params.from_uri="sip:anonymous@anonymous.invalid";d.push("P-Preferred-Identity: "+t.configuration.uri.toString());d.push("Privacy: id")}d.push("Contact: "+p);d.push("Allow: "+["ACK","CANCEL","INVITE","MESSAGE","BYE","OPTIONS","INFO","NOTIFY","REFER"].toString());if(t.configuration.rel100===s.C.supported.REQUIRED){d.push("Require: 100rel")}if(t.configuration.replaces===s.C.supported.REQUIRED){d.push("Require: replaces")}i.extraHeaders=d;o=e.call(this,t.configuration.sessionDescriptionHandlerFactory)||this;a.ClientContext.initializer(o,t,s.C.INVITE,r,i);o.type=u.TypeStrings.InviteClientContext;o.passedOptions=i;o.sessionDescriptionHandlerOptions=i.sessionDescriptionHandlerOptions||{};o.modifiers=n;o.inviteWithoutSdp=i.inviteWithoutSdp||false;o.anonymous=i.anonymous||false;o.renderbody=i.renderbody||undefined;o.rendertype=i.rendertype||"text/plain";o.fromTag=f;o.contact=p;if(o.status!==u.SessionStatus.STATUS_NULL){throw new c.Exceptions.InvalidStateError(o.status)}o.isCanceled=false;o.received100=false;o.method=s.C.INVITE;o.logger=t.getLogger("sip.inviteclientcontext");t.applicants[o.toString()]=o;o.id=o.request.callId+o.fromTag;o.onInfo=i.onInfo;o.errorListener=o.onTransportError.bind(o);if(t.transport){t.transport.on("transportError",o.errorListener)}return o}InviteClientContext.prototype.receiveNonInviteResponse=function(e){this.receiveInviteResponse(e)};InviteClientContext.prototype.receiveResponse=function(e){this.receiveInviteResponse(e)};InviteClientContext.prototype.send=function(){var e=new f.RequestSender(this,this.ua);e.send();return this};InviteClientContext.prototype.invite=function(){var e=this;this.ua.sessions[this.id]=this;Promise.resolve().then((function(){if(e.inviteWithoutSdp){e.request.body=e.renderbody;e.status=u.SessionStatus.STATUS_INVITE_SENT;e.send()}else{e.sessionDescriptionHandler=e.sessionDescriptionHandlerFactory(e,e.ua.configuration.sessionDescriptionHandlerFactoryOptions||{});e.emit("SessionDescriptionHandler-created",e.sessionDescriptionHandler);e.sessionDescriptionHandler.getDescription(e.sessionDescriptionHandlerOptions,e.modifiers).then((function(t){if(e.isCanceled||e.status===u.SessionStatus.STATUS_TERMINATED){return}e.hasOffer=true;e.request.body=t;e.status=u.SessionStatus.STATUS_INVITE_SENT;e.send()}),(function(t){if(t.type===u.TypeStrings.SessionDescriptionHandlerError){e.logger.log(t.message);if(t.error){e.logger.log(t.error)}}if(e.status===u.SessionStatus.STATUS_TERMINATED){return}e.failed(undefined,s.C.causes.WEBRTC_ERROR);e.terminated(undefined,s.C.causes.WEBRTC_ERROR)}))}}));return this};InviteClientContext.prototype.receiveInviteResponse=function(e){var t=this;if(this.status===u.SessionStatus.STATUS_TERMINATED||e.method!==s.C.INVITE){return}var r=e.callId+e.fromTag+e.toTag;var i=[];if(this.dialog&&(e.statusCode&&e.statusCode>=200&&e.statusCode<=299)){if(r!==this.dialog.id.toString()){if(!this.createDialog(e,"UAC",true)){return}this.emit("ack",e.transaction.sendACK({body:v.Utils.generateFakeSDP(e.body)}));this.earlyDialogs[r].sendRequest(this,s.C.BYE);if(this.status!==u.SessionStatus.STATUS_CONFIRMED){this.failed(e,s.C.causes.WEBRTC_ERROR);this.terminated(e,s.C.causes.WEBRTC_ERROR)}return}else if(this.status===u.SessionStatus.STATUS_CONFIRMED){this.emit("ack",e.transaction.sendACK());return}else if(!this.hasAnswer){return}}var n=e&&e.statusCode;if(this.dialog&&n&&n<200){var a=e.getHeader("rseq");if(a&&(this.dialog.pracked.indexOf(a)!==-1||Number(this.dialog.pracked[this.dialog.pracked.length-1])>=Number(a)&&this.dialog.pracked.length>0)){return}if(!this.earlyDialogs[r]&&!this.createDialog(e,"UAC",true)){return}if(this.earlyDialogs[r].pracked.indexOf(e.getHeader("rseq"))!==-1||this.earlyDialogs[r].pracked[this.earlyDialogs[r].pracked.length-1]>=Number(a)&&this.earlyDialogs[r].pracked.length>0){return}i.push("RAck: "+e.getHeader("rseq")+" "+e.getHeader("cseq"));this.earlyDialogs[r].pracked.push(e.getHeader("rseq"));this.earlyDialogs[r].sendRequest(this,s.C.PRACK,{extraHeaders:i,body:v.Utils.generateFakeSDP(e.body)});return}if(this.isCanceled){if(n&&n>=100&&n<200){this.request.cancel(this.cancelReason,i);this.canceled()}else if(n&&n>=200&&n<299){this.acceptAndTerminate(e);this.emit("bye",this.request)}else if(n&&n>=300){var o=s.C.REASON_PHRASE[e.statusCode||0]||s.C.causes.CANCELED;this.rejected(e,o);this.failed(e,o);this.terminated(e,o)}return}var c=n?n.toString():"";switch(true){case/^100$/.test(c):this.received100=true;this.emit("progress",e);break;case/^1[0-9]{2}$/.test(c):if(!e.toTag){this.logger.warn("1xx response received without to tag");break}if(e.hasHeader("contact")){if(!this.createDialog(e,"UAC",true)){break}}this.status=u.SessionStatus.STATUS_1XX_RECEIVED;if(e.hasHeader("P-Asserted-Identity")){this.assertedIdentity=l.Grammar.nameAddrHeaderParse(e.getHeader("P-Asserted-Identity"))}if(e.hasHeader("require")&&e.getHeader("require").indexOf("100rel")!==-1){if(this.dialog||!this.earlyDialogs[r]){break}var f=e.getHeader("rseq");if(this.earlyDialogs[r].pracked.indexOf(f)!==-1||this.earlyDialogs[r].pracked[this.earlyDialogs[r].pracked.length-1]>=Number(f)&&this.earlyDialogs[r].pracked.length>0){return}this.sessionDescriptionHandler=this.sessionDescriptionHandlerFactory(this,this.ua.configuration.sessionDescriptionHandlerFactoryOptions||{});this.emit("SessionDescriptionHandler-created",this.sessionDescriptionHandler);if(!this.sessionDescriptionHandler.hasDescription(e.getHeader("Content-Type")||"")){i.push("RAck: "+e.getHeader("rseq")+" "+e.getHeader("cseq"));this.earlyDialogs[r].pracked.push(e.getHeader("rseq"));this.earlyDialogs[r].sendRequest(this,s.C.PRACK,{extraHeaders:i});this.emit("progress",e)}else if(this.hasOffer){if(!this.createDialog(e,"UAC")){break}this.hasAnswer=true;if(this.dialog!==undefined&&f){this.dialog.pracked.push(f)}this.sessionDescriptionHandler.setDescription(e.body,this.sessionDescriptionHandlerOptions,this.modifiers).then((function(){i.push("RAck: "+e.getHeader("rseq")+" "+e.getHeader("cseq"));t.sendRequest(s.C.PRACK,{extraHeaders:i,receiveResponse:function(){}});t.status=u.SessionStatus.STATUS_EARLY_MEDIA;t.emit("progress",e)}),(function(r){t.logger.warn(r);t.acceptAndTerminate(e,488,"Not Acceptable Here");t.failed(e,s.C.causes.BAD_MEDIA_DESCRIPTION)}))}else{var p=this.earlyDialogs[r];p.sessionDescriptionHandler=this.sessionDescriptionHandlerFactory(this,this.ua.configuration.sessionDescriptionHandlerFactoryOptions||{});this.emit("SessionDescriptionHandler-created",p.sessionDescriptionHandler);if(f){p.pracked.push(f)}if(p.sessionDescriptionHandler){p.sessionDescriptionHandler.setDescription(e.body,this.sessionDescriptionHandlerOptions,this.modifiers).then((function(){return p.sessionDescriptionHandler.getDescription(t.sessionDescriptionHandlerOptions,t.modifiers)})).then((function(r){i.push("RAck: "+f+" "+e.getHeader("cseq"));p.sendRequest(t,s.C.PRACK,{extraHeaders:i,body:r});t.status=u.SessionStatus.STATUS_EARLY_MEDIA;t.emit("progress",e)})).catch((function(e){if(f&&e.type===u.TypeStrings.SessionDescriptionHandlerError){p.pracked.push(f);if(t.status===u.SessionStatus.STATUS_TERMINATED){return}t.failed(undefined,s.C.causes.WEBRTC_ERROR);t.terminated(undefined,s.C.causes.WEBRTC_ERROR)}else{if(f){p.pracked.splice(p.pracked.indexOf(f),1)}t.logger.warn("invalid description");t.logger.warn(e)}}))}}}else{this.emit("progress",e)}break;case/^2[0-9]{2}$/.test(c):var d=this.request.cseq+" "+this.request.method;if(d!==e.getHeader("cseq")){break}if(e.hasHeader("P-Asserted-Identity")){this.assertedIdentity=l.Grammar.nameAddrHeaderParse(e.getHeader("P-Asserted-Identity"))}if(this.status===u.SessionStatus.STATUS_EARLY_MEDIA&&this.dialog){this.status=u.SessionStatus.STATUS_CONFIRMED;var h={};if(this.renderbody){i.push("Content-Type: "+this.rendertype);h.extraHeaders=i;h.body=this.renderbody}this.emit("ack",e.transaction.sendACK(h));this.accepted(e);break}if(this.dialog){break}if(!this.hasOffer){if(this.earlyDialogs[r]&&this.earlyDialogs[r].sessionDescriptionHandler){this.hasOffer=true;this.hasAnswer=true;this.sessionDescriptionHandler=this.earlyDialogs[r].sessionDescriptionHandler;if(!this.createDialog(e,"UAC")){break}this.status=u.SessionStatus.STATUS_CONFIRMED;this.emit("ack",e.transaction.sendACK());this.accepted(e)}else{this.sessionDescriptionHandler=this.sessionDescriptionHandlerFactory(this,this.ua.configuration.sessionDescriptionHandlerFactoryOptions||{});this.emit("SessionDescriptionHandler-created",this.sessionDescriptionHandler);if(!this.sessionDescriptionHandler.hasDescription(e.getHeader("Content-Type")||"")){this.acceptAndTerminate(e,400,"Missing session description");this.failed(e,s.C.causes.BAD_MEDIA_DESCRIPTION);break}if(!this.createDialog(e,"UAC")){break}this.hasOffer=true;this.sessionDescriptionHandler.setDescription(e.body,this.sessionDescriptionHandlerOptions,this.modifiers).then((function(){return t.sessionDescriptionHandler.getDescription(t.sessionDescriptionHandlerOptions,t.modifiers)})).then((function(r){if(t.isCanceled||t.status===u.SessionStatus.STATUS_TERMINATED){return}t.status=u.SessionStatus.STATUS_CONFIRMED;t.hasAnswer=true;t.emit("ack",e.transaction.sendACK({body:r}));t.accepted(e)})).catch((function(r){if(r.type===u.TypeStrings.SessionDescriptionHandlerError){t.logger.warn("invalid description");t.logger.warn(r.toString());t.acceptAndTerminate(e,488,"Invalid session description");t.failed(e,s.C.causes.BAD_MEDIA_DESCRIPTION)}}))}}else if(this.hasAnswer){var h={};if(this.renderbody){i.push("Content-Type: "+this.rendertype);h.extraHeaders=i;h.body=this.renderbody}this.emit("ack",e.transaction.sendACK(h))}else{if(!this.sessionDescriptionHandler||!this.sessionDescriptionHandler.hasDescription(e.getHeader("Content-Type")||"")){this.acceptAndTerminate(e,400,"Missing session description");this.failed(e,s.C.causes.BAD_MEDIA_DESCRIPTION);break}if(!this.createDialog(e,"UAC")){break}this.hasAnswer=true;this.sessionDescriptionHandler.setDescription(e.body,this.sessionDescriptionHandlerOptions,this.modifiers).then((function(){var r={};t.status=u.SessionStatus.STATUS_CONFIRMED;if(t.renderbody){i.push("Content-Type: "+t.rendertype);r.extraHeaders=i;r.body=t.renderbody}t.emit("ack",e.transaction.sendACK(r));t.accepted(e)}),(function(r){t.logger.warn(r);t.acceptAndTerminate(e,488,"Not Acceptable Here");t.failed(e,s.C.causes.BAD_MEDIA_DESCRIPTION)}))}break;default:var o=v.Utils.sipErrorCause(n||0);this.rejected(e,o);this.failed(e,o);this.terminated(e,o)}};InviteClientContext.prototype.cancel=function(e){if(e===void 0){e={}}e.extraHeaders=(e.extraHeaders||[]).slice();if(this.isCanceled){throw new c.Exceptions.InvalidStateError(u.SessionStatus.STATUS_CANCELED)}if(this.status===u.SessionStatus.STATUS_TERMINATED||this.status===u.SessionStatus.STATUS_CONFIRMED){throw new c.Exceptions.InvalidStateError(this.status)}this.logger.log("canceling RTCSession");this.isCanceled=true;var t=v.Utils.getCancelReason(e.statusCode,e.reasonPhrase);if(this.status===u.SessionStatus.STATUS_NULL||this.status===u.SessionStatus.STATUS_INVITE_SENT&&!this.received100){this.cancelReason=t}else if(this.status===u.SessionStatus.STATUS_INVITE_SENT||this.status===u.SessionStatus.STATUS_1XX_RECEIVED||this.status===u.SessionStatus.STATUS_EARLY_MEDIA){this.request.cancel(t,e.extraHeaders)}return this.canceled()};InviteClientContext.prototype.terminate=function(e){if(this.status===u.SessionStatus.STATUS_TERMINATED){return this}if(this.status===u.SessionStatus.STATUS_WAITING_FOR_ACK||this.status===u.SessionStatus.STATUS_CONFIRMED){this.bye(e)}else{this.cancel(e)}return this};InviteClientContext.prototype.receiveRequest=function(t){if(t.method===s.C.CANCEL){}if(t.method===s.C.ACK&&this.status===u.SessionStatus.STATUS_WAITING_FOR_ACK){clearTimeout(this.timers.ackTimer);clearTimeout(this.timers.invite2xxTimer);this.status=u.SessionStatus.STATUS_CONFIRMED;this.accepted()}return e.prototype.receiveRequest.call(this,t)};return InviteClientContext}(m);t.InviteClientContext=S;var T=function(e){i(ReferClientContext,e);function ReferClientContext(t,r,i,n){if(n===void 0){n={}}var a=this;if(t===undefined||r===undefined||i===undefined){throw new TypeError("Not enough arguments")}a=e.call(this,t,s.C.REFER,r.remoteIdentity.uri.toString(),n)||this;a.type=u.TypeStrings.ReferClientContext;a.options=n;a.extraHeaders=(a.options.extraHeaders||[]).slice();a.applicant=r;if(!(typeof i==="string")&&(i.type===u.TypeStrings.InviteServerContext||i.type===u.TypeStrings.InviteClientContext)){var o=i.dialog;if(o){a.target='"'+i.remoteIdentity.friendlyName+'" '+"<"+o.remoteTarget.toString()+"?Replaces="+o.id.callId+"%3Bto-tag%3D"+o.id.remoteTag+"%3Bfrom-tag%3D"+o.id.localTag+">"}else{throw new TypeError("Invalid target due to no dialog: "+i)}}else{var c=l.Grammar.parse(i,"Refer_To");a.target=c&&c.uri?c.uri:i;var f=a.ua.normalizeTarget(a.target);if(!f){throw new TypeError("Invalid target: "+i)}a.target=f}if(a.ua){a.extraHeaders.push("Referred-By: <"+a.ua.configuration.uri+">")}a.extraHeaders.push("Contact: "+r.contact);a.extraHeaders.push("Allow: "+["ACK","CANCEL","INVITE","MESSAGE","BYE","OPTIONS","INFO","NOTIFY","REFER"].toString());a.extraHeaders.push("Refer-To: "+a.target);a.errorListener=a.onTransportError.bind(a);if(t.transport){t.transport.on("transportError",a.errorListener)}return a}ReferClientContext.prototype.refer=function(e){var t=this;if(e===void 0){e={}}var r=(this.extraHeaders||[]).slice();if(e.extraHeaders){r.concat(e.extraHeaders)}this.applicant.sendRequest(s.C.REFER,{extraHeaders:this.extraHeaders,receiveResponse:function(r){var i=r&&r.statusCode?r.statusCode.toString():"";if(/^1[0-9]{2}$/.test(i)){t.emit("referRequestProgress",t)}else if(/^2[0-9]{2}$/.test(i)){t.emit("referRequestAccepted",t)}else if(/^[4-6][0-9]{2}$/.test(i)){t.emit("referRequestRejected",t)}if(e.receiveResponse){e.receiveResponse(r)}}});return this};ReferClientContext.prototype.receiveNotify=function(e){var t=e.hasHeader("Content-Type")?e.getHeader("Content-Type"):undefined;if(t&&t.search(/^message\/sipfrag/)!==-1){var r=l.Grammar.parse(e.body,"sipfrag");if(r===-1){e.reply(489,"Bad Event");return}switch(true){case/^1[0-9]{2}$/.test(r.statusCode):this.emit("referProgress",this);break;case/^2[0-9]{2}$/.test(r.statusCode):this.emit("referAccepted",this);if(!this.options.activeAfterTransfer&&this.applicant.terminate){this.applicant.terminate()}break;default:this.emit("referRejected",this);break}e.reply(200);this.emit("notify",e);return}e.reply(489,"Bad Event")};return ReferClientContext}(a.ClientContext);t.ReferClientContext=T;var b=function(e){i(ReferServerContext,e);function ReferServerContext(t,r){var i=e.call(this,t,r)||this;i.type=u.TypeStrings.ReferServerContext;i.ua=t;i.status=u.SessionStatus.STATUS_INVITE_RECEIVED;i.fromTag=r.fromTag;i.id=r.callId+i.fromTag;i.request=r;i.contact=i.ua.contact.toString();i.logger=t.getLogger("sip.referservercontext",i.id);i.cseq=Math.floor(Math.random()*1e4);i.callId=i.request.callId;i.fromUri=i.request.to.uri;i.fromTag=i.request.to.parameters.tag;i.remoteTarget=i.request.headers.Contact[0].parsed.uri;i.toUri=i.request.from.uri;i.toTag=i.request.fromTag;i.routeSet=i.request.getHeaders("record-route");if(!i.request.hasHeader("refer-to")){i.logger.warn("Invalid REFER packet. A refer-to header is required. Rejecting refer.");i.reject();return i}i.referTo=i.request.parseHeader("refer-to");i.referredSession=i.ua.findSession(r);if(i.request.hasHeader("referred-by")){i.referredBy=i.request.getHeader("referred-by")}if(i.referTo.uri.hasHeader("replaces")){i.replaces=i.referTo.uri.getHeader("replaces")}i.errorListener=i.onTransportError.bind(i);if(t.transport){t.transport.on("transportError",i.errorListener)}i.status=u.SessionStatus.STATUS_WAITING_FOR_ANSWER;return i}ReferServerContext.prototype.receiveNonInviteResponse=function(e){};ReferServerContext.prototype.progress=function(){if(this.status!==u.SessionStatus.STATUS_WAITING_FOR_ANSWER){throw new c.Exceptions.InvalidStateError(this.status)}this.request.reply(100)};ReferServerContext.prototype.reject=function(t){if(t===void 0){t={}}if(this.status===u.SessionStatus.STATUS_TERMINATED){throw new c.Exceptions.InvalidStateError(this.status)}this.logger.log("Rejecting refer");this.status=u.SessionStatus.STATUS_TERMINATED;e.prototype.reject.call(this,t);this.emit("referRequestRejected",this)};ReferServerContext.prototype.accept=function(e,t){var r=this;if(e===void 0){e={}}if(this.status===u.SessionStatus.STATUS_WAITING_FOR_ANSWER){this.status=u.SessionStatus.STATUS_ANSWERED}else{throw new c.Exceptions.InvalidStateError(this.status)}this.request.reply(202,"Accepted");this.emit("referRequestAccepted",this);if(e.followRefer){this.logger.log("Accepted refer, attempting to automatically follow it");var i=this.referTo.uri;if(!i.scheme||!i.scheme.match("^sips?$")){this.logger.error("SIP.js can only automatically follow SIP refer target");this.reject();return}var n=e.inviteOptions||{};var a=(n.extraHeaders||[]).slice();if(this.replaces){a.push("Replaces: "+decodeURIComponent(this.replaces))}if(this.referredBy){a.push("Referred-By: "+this.referredBy)}n.extraHeaders=a;i.clearHeaders();this.targetSession=this.ua.invite(i.toString(),n,t);this.emit("referInviteSent",this);if(this.targetSession){this.targetSession.once("progress",(function(e){var t=e.statusCode||100;var i=e.reasonPhrase;r.sendNotify(("SIP/2.0 "+t+" "+i).trim());r.emit("referProgress",r);if(r.referredSession){r.referredSession.emit("referProgress",r)}}));this.targetSession.once("accepted",(function(){r.logger.log("Successfully followed the refer");r.sendNotify("SIP/2.0 200 OK");r.emit("referAccepted",r);if(r.referredSession){r.referredSession.emit("referAccepted",r)}}));var referFailed=function(e){if(r.status===u.SessionStatus.STATUS_TERMINATED){return}r.logger.log("Refer was not successful. Resuming session");if(e&&e.statusCode===429){r.logger.log("Alerting referrer that identity is required.");r.sendNotify("SIP/2.0 429 Provide Referrer Identity");return}r.sendNotify("SIP/2.0 603 Declined");r.status=u.SessionStatus.STATUS_TERMINATED;r.emit("referRejected",r);if(r.referredSession){r.referredSession.emit("referRejected")}};this.targetSession.once("rejected",referFailed);this.targetSession.once("failed",referFailed)}}else{this.logger.log("Accepted refer, but did not automatically follow it");this.sendNotify("SIP/2.0 200 OK");this.emit("referAccepted",this);if(this.referredSession){this.referredSession.emit("referAccepted",this)}}};ReferServerContext.prototype.sendNotify=function(e){if(this.status!==u.SessionStatus.STATUS_ANSWERED){throw new c.Exceptions.InvalidStateError(this.status)}if(l.Grammar.parse(e,"sipfrag")===-1){throw new Error("sipfrag body is required to send notify for refer")}var t=new h.OutgoingRequest(s.C.NOTIFY,this.remoteTarget,this.ua,{cseq:this.cseq+=1,callId:this.callId,fromUri:this.fromUri,fromTag:this.fromTag,toUri:this.toUri,toTag:this.toTag,routeSet:this.routeSet},["Event: refer","Subscription-State: terminated","Content-Type: message/sipfrag"],e);new f.RequestSender({request:t,onRequestTimeout:function(){return},onTransportError:function(){return},receiveResponse:function(){return}},this.ua).send()};return ReferServerContext}(p.ServerContext);t.ReferServerContext=b},115916:function(e,t,r){"use strict";var i=this&&this.__extends||function(){var extendStatics=function(e,t){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r]};return extendStatics(e,t)};return function(e,t){extendStatics(e,t);function __(){this.constructor=e}e.prototype=t===null?Object.create(t):(__.prototype=t.prototype,new __)}}();Object.defineProperty(t,"__esModule",{value:true});var n=r(850343);var a=r(846182);var s=r(130523);var o=r(325840);var u=r(669825);var c=function(e){i(DTMF,e);function DTMF(t,r,i){if(i===void 0){i={}}var n=e.call(this)||this;n.C={MIN_DURATION:70,MAX_DURATION:6e3,DEFAULT_DURATION:100,MIN_INTER_TONE_GAP:50,DEFAULT_INTER_TONE_GAP:500};n.type=s.TypeStrings.DTMF;if(r===undefined){throw new TypeError("Not enough arguments")}n.logger=t.ua.getLogger("sip.invitecontext.dtmf",t.id);n.owner=t;if(typeof r==="string"){r=r.toUpperCase()}else if(typeof r==="number"){r=r.toString()}else{throw new TypeError("Invalid tone: "+r)}if(!r.match(/^[0-9A-D#*]$/)){throw new TypeError("Invalid tone: "+r)}else{n.tone=r}var a=i.duration;var o=i.interToneGap;if(a&&!u.Utils.isDecimal(a)){throw new TypeError("Invalid tone duration: "+a)}else if(!a){a=n.C.DEFAULT_DURATION}else if(a<n.C.MIN_DURATION){n.logger.warn("'duration' value is lower than the minimum allowed, setting it to "+n.C.MIN_DURATION+" milliseconds");a=n.C.MIN_DURATION}else if(a>n.C.MAX_DURATION){n.logger.warn("'duration' value is greater than the maximum allowed, setting it to "+n.C.MAX_DURATION+" milliseconds");a=n.C.MAX_DURATION}else{a=Math.abs(a)}n.duration=a;if(o&&!u.Utils.isDecimal(o)){throw new TypeError("Invalid interToneGap: "+o)}else if(!o){o=n.C.DEFAULT_INTER_TONE_GAP}else if(o<n.C.MIN_INTER_TONE_GAP){n.logger.warn("'interToneGap' value is lower than the minimum allowed, setting it to "+n.C.MIN_INTER_TONE_GAP+" milliseconds");o=n.C.MIN_INTER_TONE_GAP}else{o=Math.abs(o)}n.interToneGap=o;return n}DTMF.prototype.send=function(e){if(e===void 0){e={}}if(this.owner.status!==s.SessionStatus.STATUS_CONFIRMED&&this.owner.status!==s.SessionStatus.STATUS_WAITING_FOR_ACK){throw new o.Exceptions.InvalidStateError(this.owner.status)}var t=e.extraHeaders?e.extraHeaders.slice():[];var r={contentType:"application/dtmf-relay",body:"Signal= "+this.tone+"\r\nDuration= "+this.duration};if(this.owner.dialog){var i=this.owner.dialog.sendRequest(this,a.C.INFO,{extraHeaders:t,body:r});this.owner.emit("dtmf",i,this)}};DTMF.prototype.init_incoming=function(e){e.reply(200);if(!this.tone||!this.duration){this.logger.warn("invalid INFO DTMF received, discarded")}else{this.owner.emit("dtmf",e,this)}};DTMF.prototype.receiveResponse=function(e){var t=e&&e.statusCode?e.statusCode:0;switch(true){case/^1[0-9]{2}$/.test(t.toString()):break;case/^2[0-9]{2}$/.test(t.toString()):this.emit("succeeded",{originator:"remote",response:e});break;default:var r=u.Utils.sipErrorCause(t);this.emit("failed",e,r);break}};DTMF.prototype.onRequestTimeout=function(){this.emit("failed",undefined,a.C.causes.REQUEST_TIMEOUT);this.owner.onRequestTimeout()};DTMF.prototype.onTransportError=function(){this.emit("failed",undefined,a.C.causes.CONNECTION_ERROR);this.owner.onTransportError()};DTMF.prototype.onDialogError=function(e){this.emit("failed",e,a.C.causes.DIALOG_ERROR);this.owner.onDialogError(e)};return DTMF}(n.EventEmitter);t.DTMF=c},453115:function(e,t,r){"use strict";var i=this&&this.__extends||function(){var extendStatics=function(e,t){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r]};return extendStatics(e,t)};return function(e,t){extendStatics(e,t);function __(){this.constructor=e}e.prototype=t===null?Object.create(t):(__.prototype=t.prototype,new __)}}();Object.defineProperty(t,"__esModule",{value:true});var n=r(513669);var a=r(846182);var s=r(122517);var o=r(130523);var u=r(753316);var c=r(669825);var l=function(e){i(Subscription,e);function Subscription(t,r,i,n){if(n===void 0){n={}}var s=this;if(!i){throw new TypeError("Event necessary to create a subscription.")}n.extraHeaders=(n.extraHeaders||[]).slice();var u;if(typeof n.expires!=="number"){t.logger.warn("expires must be a number. Using default of 3600.");u=3600}else{u=n.expires}n.extraHeaders.push("Event: "+i);n.extraHeaders.push("Expires: "+u);n.extraHeaders.push("Contact: "+t.contact.toString());n.extraHeaders.push("Allow: "+["ACK","CANCEL","INVITE","MESSAGE","BYE","OPTIONS","INFO","NOTIFY","REFER"].toString());s=e.call(this,t,a.C.SUBSCRIBE,r,n)||this;s.type=o.TypeStrings.Subscription;s.event=i;s.requestedExpires=u;s.state="init";s.contact=t.contact.toString();s.extraHeaders=n.extraHeaders;s.logger=t.getLogger("sip.subscription");s.expires=u;s.timers={N:undefined,subDuration:undefined};s.errorCodes=[404,405,410,416,480,481,482,483,484,485,489,501,604];return s}Subscription.prototype.subscribe=function(){var e=this;if(this.state==="active"){this.refresh();return this}else if(this.state==="notify_wait"){return this}clearTimeout(this.timers.subDuration);clearTimeout(this.timers.N);this.timers.N=setTimeout((function(){return e.timer_fire()}),u.Timers.TIMER_N);if(this.request&&this.request.from){this.ua.earlySubscriptions[this.request.callId+this.request.from.parameters.tag+this.event]=this}this.send();this.state="notify_wait";return this};Subscription.prototype.refresh=function(){if(this.state==="terminated"||this.state==="pending"||this.state==="notify_wait"||!this.dialog){return}this.dialog.sendRequest(this,a.C.SUBSCRIBE,{extraHeaders:this.extraHeaders,body:this.body})};Subscription.prototype.receiveResponse=function(e){var t=this;var r=e.statusCode?e.statusCode:0;var i=c.Utils.getReasonPhrase(r);if(this.state==="notify_wait"&&r>=300||this.state!=="notify_wait"&&this.errorCodes.indexOf(r)!==-1){this.failed(e,undefined)}else if(/^2[0-9]{2}$/.test(r.toString())){this.emit("accepted",e,i);var n=e.getHeader("Expires");if(n&&Number(n)<=this.requestedExpires){this.expires=Number(n);this.timers.subDuration=setTimeout((function(){return t.refresh()}),Number(n)*900)}else{if(!n){this.logger.warn("Expires header missing in a 200-class response to SUBSCRIBE");this.failed(e,"Expires Header Missing")}else{this.logger.warn("Expires header in a 200-class response to"+" SUBSCRIBE with a higher value than the one in the request");this.failed(e,"Invalid Expires Header")}}}else if(r>300){this.emit("failed",e,i);this.emit("rejected",e,i)}};Subscription.prototype.unsubscribe=function(){var e=this;var t=[];this.state="terminated";t.push("Event: "+this.event);t.push("Expires: 0");t.push("Contact: "+this.contact);t.push("Allow: "+["ACK","CANCEL","INVITE","MESSAGE","BYE","OPTIONS","INFO","NOTIFY","REFER"].toString());this.receiveResponse=function(){};if(this.dialog){this.dialog.sendRequest(this,a.C.SUBSCRIBE,{extraHeaders:t,body:this.body})}clearTimeout(this.timers.subDuration);clearTimeout(this.timers.N);this.timers.N=setTimeout((function(){return e.timer_fire()}),u.Timers.TIMER_N);this.emit("terminated")};Subscription.prototype.receiveRequest=function(e){var t=this;var r;var setExpiresTimeout=function(){if(r.expires){clearTimeout(t.timers.subDuration);r.expires=Math.min(t.expires,Math.max(r.expires,0));t.timers.subDuration=setTimeout((function(){return t.refresh()}),r.expires*900)}};if(!this.matchEvent(e)){e.reply(489);return}if(!this.dialog){if(this.createConfirmedDialog(e,"UAS")){if(this.dialog){this.id=this.dialog.id.toString();if(this.request&&this.request.from){delete this.ua.earlySubscriptions[this.request.callId+this.request.from.parameters.tag+this.event];this.ua.subscriptions[this.id||""]=this}}}}r=e.parseHeader("Subscription-State");e.reply(200);clearTimeout(this.timers.N);this.emit("notify",{request:e});if(this.state==="terminated"){if(r.state==="terminated"){this.terminateDialog();clearTimeout(this.timers.N);clearTimeout(this.timers.subDuration);delete this.ua.subscriptions[this.id||""]}return}switch(r.state){case"active":this.state="active";setExpiresTimeout();break;case"pending":if(this.state==="notify_wait"){setExpiresTimeout()}this.state="pending";break;case"terminated":clearTimeout(this.timers.subDuration);if(r.reason){this.logger.log("terminating subscription with reason "+r.reason);switch(r.reason){case"deactivated":case"timeout":this.subscribe();return;case"probation":case"giveup":if(r.params&&r.params["retry-after"]){this.timers.subDuration=setTimeout((function(){return t.subscribe()}),r.params["retry-after"])}else{this.subscribe()}return;case"rejected":case"noresource":case"invariant":break}}this.close();break}};Subscription.prototype.close=function(){if(this.state==="notify_wait"){this.state="terminated";clearTimeout(this.timers.N);clearTimeout(this.timers.subDuration);this.receiveResponse=function(){};if(this.request&&this.request.from){delete this.ua.earlySubscriptions[this.request.callId+this.request.from.parameters.tag+this.event]}this.emit("terminated")}else if(this.state!=="terminated"){this.unsubscribe()}};Subscription.prototype.onDialogError=function(e){this.failed(e,a.C.causes.DIALOG_ERROR)};Subscription.prototype.timer_fire=function(){if(this.state==="terminated"){this.terminateDialog();clearTimeout(this.timers.N);clearTimeout(this.timers.subDuration);delete this.ua.subscriptions[this.id||""]}else if(this.state==="notify_wait"||this.state==="pending"){this.close()}else{this.refresh()}};Subscription.prototype.createConfirmedDialog=function(e,t){this.terminateDialog();var r=new s.Dialog(this,e,t);if(this.request){r.inviteSeqnum=this.request.cseq;r.localSeqnum=this.request.cseq}if(!r.error){this.dialog=r;return true}else{return false}};Subscription.prototype.terminateDialog=function(){if(this.dialog){delete this.ua.subscriptions[this.id||""];this.dialog.terminate();delete this.dialog}};Subscription.prototype.failed=function(e,t){this.close();this.emit("failed",e,t);this.emit("rejected",e,t);return this};Subscription.prototype.matchEvent=function(e){if(!e.hasHeader("Event")){this.logger.warn("missing Event header");return false}if(!e.hasHeader("Subscription-State")){this.logger.warn("missing Subscription-State header");return false}var t=e.parseHeader("event").event;if(this.event!==t){this.logger.warn("event match failed");e.reply(481,"Event Match Failed");return false}else{return true}};return Subscription}(n.ClientContext);t.Subscription=l},753316:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});var r=500;var i=4e3;var n=5e3;t.Timers={T1:r,T2:i,T4:n,TIMER_B:64*r,TIMER_D:0*r,TIMER_F:64*r,TIMER_H:64*r,TIMER_I:0*r,TIMER_J:0*r,TIMER_K:0*n,TIMER_L:64*r,TIMER_M:64*r,TIMER_N:64*r,PROVISIONAL_RESPONSE_INTERVAL:6e4}},670603:function(e,t,r){"use strict";var i=this&&this.__extends||function(){var extendStatics=function(e,t){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r]};return extendStatics(e,t)};return function(e,t){extendStatics(e,t);function __(){this.constructor=e}e.prototype=t===null?Object.create(t):(__.prototype=t.prototype,new __)}}();Object.defineProperty(t,"__esModule",{value:true});var n=r(850343);var a=r(846182);var s=r(130523);var o=r(130700);var u=r(753316);var c={STATUS_TRYING:1,STATUS_PROCEEDING:2,STATUS_CALLING:3,STATUS_ACCEPTED:4,STATUS_COMPLETED:5,STATUS_TERMINATED:6,STATUS_CONFIRMED:7,NON_INVITE_CLIENT:"nict",NON_INVITE_SERVER:"nist",INVITE_CLIENT:"ict",INVITE_SERVER:"ist"};var buildViaHeader=function(e,t,r){var i="SIP/2.0/"+(e.configuration.hackViaTcp?"TCP":t.server.scheme);i+=" "+e.configuration.viaHost+";branch="+r;if(e.configuration.forceRport){i+=";rport"}return i};var l=function(e){i(NonInviteClientTransaction,e);function NonInviteClientTransaction(t,r,i){var n=e.call(this)||this;n.kind=c.NON_INVITE_CLIENT;n.type=s.TypeStrings.NonInviteClientTransaction;n.transport=i;n.id="z9hG4bK"+Math.floor(Math.random()*1e7);n.requestSender=t;n.request=r;n.logger=t.ua.getLogger("sip.transaction.nict",n.id);var a=buildViaHeader(t.ua,i,n.id);n.request.setHeader("via",a);n.requestSender.ua.newTransaction(n);return n}NonInviteClientTransaction.prototype.stateChanged=function(e){this.state=e;this.emit("stateChanged")};NonInviteClientTransaction.prototype.send=function(){var e=this;this.stateChanged(s.TransactionStatus.STATUS_TRYING);this.F=setTimeout((function(){return e.timer_F()}),u.Timers.TIMER_F);this.transport.send(this.request).catch((function(){return e.onTransportError()}))};NonInviteClientTransaction.prototype.receiveResponse=function(e){var t=this;var r=e.statusCode||0;if(r<200){switch(this.state){case s.TransactionStatus.STATUS_TRYING:case s.TransactionStatus.STATUS_PROCEEDING:this.stateChanged(s.TransactionStatus.STATUS_PROCEEDING);this.requestSender.receiveResponse(e);break}}else{switch(this.state){case s.TransactionStatus.STATUS_TRYING:case s.TransactionStatus.STATUS_PROCEEDING:this.stateChanged(s.TransactionStatus.STATUS_COMPLETED);if(this.F){clearTimeout(this.F)}if(r===408){this.requestSender.onRequestTimeout()}else{this.requestSender.receiveResponse(e)}this.K=setTimeout((function(){return t.timer_K()}),u.Timers.TIMER_K);break;case s.TransactionStatus.STATUS_COMPLETED:break}}};NonInviteClientTransaction.prototype.onTransportError=function(){this.logger.log("transport error occurred, deleting non-INVITE client transaction "+this.id);if(this.F){clearTimeout(this.F);this.F=undefined}if(this.K){clearTimeout(this.K);this.K=undefined}this.stateChanged(s.TransactionStatus.STATUS_TERMINATED);this.requestSender.ua.destroyTransaction(this);this.requestSender.onTransportError()};NonInviteClientTransaction.prototype.timer_F=function(){this.logger.debug("Timer F expired for non-INVITE client transaction "+this.id);this.stateChanged(s.TransactionStatus.STATUS_TERMINATED);this.requestSender.ua.destroyTransaction(this);this.requestSender.onRequestTimeout()};NonInviteClientTransaction.prototype.timer_K=function(){this.stateChanged(s.TransactionStatus.STATUS_TERMINATED);this.requestSender.ua.destroyTransaction(this)};return NonInviteClientTransaction}(n.EventEmitter);t.NonInviteClientTransaction=l;var f=function(e){i(InviteClientTransaction,e);function InviteClientTransaction(t,r,i){var n=e.call(this)||this;n.kind=c.INVITE_CLIENT;n.type=s.TypeStrings.InviteClientTransaction;n.transport=i;n.id="z9hG4bK"+Math.floor(Math.random()*1e7);n.requestSender=t;n.request=r;n.logger=t.ua.getLogger("sip.transaction.ict",n.id);var a=buildViaHeader(t.ua,i,n.id);n.request.setHeader("via",a);n.requestSender.ua.newTransaction(n);n.request.cancel=function(e,t){t=(t||[]).slice();var r="";for(var i=0,a=t;i<a.length;i++){var s=a[i];r+=s.trim()+"\r\n"}n.cancelRequest(n,e,r)};return n}InviteClientTransaction.prototype.stateChanged=function(e){this.state=e;this.emit("stateChanged")};InviteClientTransaction.prototype.send=function(){var e=this;this.stateChanged(s.TransactionStatus.STATUS_CALLING);this.B=setTimeout((function(){return e.timer_B()}),u.Timers.TIMER_B);this.transport.send(this.request).catch((function(){return e.onTransportError()}))};InviteClientTransaction.prototype.receiveResponse=function(e){var t=this;var r=e.statusCode||0;e.transaction=this;if(this.response&&this.response.statusCode===e.statusCode&&this.response.cseq===e.cseq){this.logger.debug("ICT Received a retransmission for cseq: "+e.cseq);if(this.ackSender){this.ackSender.send()}return}this.response=e;if(r>=100&&r<=199){switch(this.state){case s.TransactionStatus.STATUS_CALLING:this.stateChanged(s.TransactionStatus.STATUS_PROCEEDING);this.requestSender.receiveResponse(e);if(this.cancel){this.transport.send(this.cancel)}break;case s.TransactionStatus.STATUS_PROCEEDING:this.requestSender.receiveResponse(e);break}}else if(r>=200&&r<=299){switch(this.state){case s.TransactionStatus.STATUS_CALLING:case s.TransactionStatus.STATUS_PROCEEDING:this.stateChanged(s.TransactionStatus.STATUS_ACCEPTED);this.M=setTimeout((function(){return t.timer_M()}),u.Timers.TIMER_M);this.requestSender.receiveResponse(e);break;case c.STATUS_ACCEPTED:this.requestSender.receiveResponse(e);break}}else if(r>=300&&r<=699){switch(this.state){case s.TransactionStatus.STATUS_CALLING:case s.TransactionStatus.STATUS_PROCEEDING:this.stateChanged(s.TransactionStatus.STATUS_COMPLETED);this.sendACK();this.requestSender.receiveResponse(e);break;case s.TransactionStatus.STATUS_COMPLETED:this.sendACK();break}}};InviteClientTransaction.prototype.sendACK=function(e){var t=this;if(e===void 0){e={}}var r;if(this.response&&this.response.getHeader("contact")){r=this.response.parseHeader("contact").uri}else{r=this.request.ruri}if(this.response){var i=new o.OutgoingRequest("ACK",r.toString(),this.request.ua,{cseq:this.response.cseq,callId:this.response.callId,fromUri:this.response.from.uri,fromTag:this.response.fromTag,toUri:this.response.to.uri,toTag:this.response.toTag,routeSet:this.response.getHeaders("record-route").reverse()},e.extraHeaders||[],e.body);if(!i.ua.transport){throw new Error("No transport to make transaction")}this.ackSender=new p({onTransportError:this.requestSender.applicant?this.requestSender.applicant.onTransportError.bind(this.requestSender.applicant):function(){t.logger.warn("ACK Request had a transport error")},ua:i.ua},i,i.ua.transport);this.ackSender.send();return i}};InviteClientTransaction.prototype.onTransportError=function(){this.logger.log("transport error occurred, deleting INVITE client transaction "+this.id);if(this.B){clearTimeout(this.B);this.B=undefined}if(this.D){clearTimeout(this.D);this.D=undefined}if(this.M){clearTimeout(this.M);this.M=undefined}this.stateChanged(s.TransactionStatus.STATUS_TERMINATED);this.requestSender.ua.destroyTransaction(this);if(this.state!==s.TransactionStatus.STATUS_ACCEPTED){this.requestSender.onTransportError()}};InviteClientTransaction.prototype.timer_M=function(){this.logger.debug("Timer M expired for INVITE client transaction "+this.id);if(this.state===s.TransactionStatus.STATUS_ACCEPTED){if(this.B){clearTimeout(this.B);this.B=undefined}this.stateChanged(s.TransactionStatus.STATUS_TERMINATED);this.requestSender.ua.destroyTransaction(this)}};InviteClientTransaction.prototype.timer_B=function(){this.logger.debug("Timer B expired for INVITE client transaction "+this.id);if(this.state===s.TransactionStatus.STATUS_CALLING){this.stateChanged(s.TransactionStatus.STATUS_TERMINATED);this.requestSender.ua.destroyTransaction(this);this.requestSender.onRequestTimeout()}};InviteClientTransaction.prototype.timer_D=function(){this.logger.debug("Timer D expired for INVITE client transaction "+this.id);if(this.B){clearTimeout(this.B);this.B=undefined}this.stateChanged(s.TransactionStatus.STATUS_TERMINATED);this.requestSender.ua.destroyTransaction(this)};InviteClientTransaction.prototype.cancelRequest=function(e,t,r){var i=e.request;this.cancel=a.C.CANCEL+" "+i.ruri+" SIP/2.0\r\n";this.cancel+="Via: "+i.headers.Via.toString()+"\r\n";if(this.request.headers.Route){this.cancel+="Route: "+i.headers.Route.toString()+"\r\n"}this.cancel+="To: "+i.headers.To.toString()+"\r\n";this.cancel+="From: "+i.headers.From.toString()+"\r\n";this.cancel+="Call-ID: "+i.headers["Call-ID"].toString()+"\r\n";this.cancel+="Max-Forwards: "+70+"\r\n";this.cancel+="CSeq: "+i.headers.CSeq.toString().split(" ")[0]+" CANCEL\r\n";if(t){this.cancel+="Reason: "+t+"\r\n"}if(r){this.cancel+=r}this.cancel+="Content-Length: 0\r\n\r\n";if(this.state===s.TransactionStatus.STATUS_PROCEEDING){this.transport.send(this.cancel)}};return InviteClientTransaction}(n.EventEmitter);t.InviteClientTransaction=f;var p=function(e){i(AckClientTransaction,e);function AckClientTransaction(t,r,i){var n=e.call(this)||this;n.type=s.TypeStrings.AckClientTransaction;n.transport=i;n.id="z9hG4bK"+Math.floor(Math.random()*1e7);n.requestSender=t;n.request=r;n.logger=t.ua.getLogger("sip.transaction.nict",n.id);var a=buildViaHeader(t.ua,i,n.id);n.request.setHeader("via",a);return n}AckClientTransaction.prototype.send=function(){var e=this;this.transport.send(this.request).catch((function(){e.logger.log("transport error occurred, for an ACK client transaction "+e.id);e.requestSender.onTransportError()}))};return AckClientTransaction}(n.EventEmitter);t.AckClientTransaction=p;var d=function(e){i(NonInviteServerTransaction,e);function NonInviteServerTransaction(t,r){var i=e.call(this)||this;i.kind=c.NON_INVITE_SERVER;i.type=s.TypeStrings.NonInviteServerTransaction;i.id=t.viaBranch;i.request=t;i.transport=r.transport;i.ua=r;i.lastResponse="";i.transportError=false;t.serverTransaction=i;i.logger=r.getLogger("sip.transaction.nist",i.id);i.state=s.TransactionStatus.STATUS_TRYING;r.newTransaction(i);return i}NonInviteServerTransaction.prototype.stateChanged=function(e){this.state=e;this.emit("stateChanged")};NonInviteServerTransaction.prototype.receiveResponse=function(e,t){var r=this;return new Promise((function(i,n){if(e===100){switch(r.state){case s.TransactionStatus.STATUS_TRYING:r.stateChanged(c.STATUS_PROCEEDING);if(r.transport){r.transport.send(t).catch((function(){return r.onTransportError()}))}break;case s.TransactionStatus.STATUS_PROCEEDING:r.lastResponse=t;if(r.transport){r.transport.send(t).then(i).catch((function(){r.onTransportError();n()}))}break}}else if(e>=200&&e<=699){switch(r.state){case s.TransactionStatus.STATUS_TRYING:case s.TransactionStatus.STATUS_PROCEEDING:r.stateChanged(c.STATUS_COMPLETED);r.lastResponse=t;r.J=setTimeout((function(){r.logger.debug("Timer J expired for non-INVITE server transaction "+r.id);r.stateChanged(c.STATUS_TERMINATED);r.ua.destroyTransaction(r)}),u.Timers.TIMER_J);if(r.transport){r.transport.send(t).then(i).catch((function(){r.onTransportError();n()}))}break;case s.TransactionStatus.STATUS_COMPLETED:break}}}))};NonInviteServerTransaction.prototype.onTransportError=function(){if(!this.transportError){this.transportError=true;this.logger.log("transport error occurred, deleting non-INVITE server transaction "+this.id);if(this.J){clearTimeout(this.J);this.J=undefined}this.stateChanged(c.STATUS_TERMINATED);this.ua.destroyTransaction(this)}};return NonInviteServerTransaction}(n.EventEmitter);t.NonInviteServerTransaction=d;var h=function(e){i(InviteServerTransaction,e);function InviteServerTransaction(t,r){var i=e.call(this)||this;i.kind=c.INVITE_SERVER;i.type=s.TypeStrings.InviteServerTransaction;i.id=t.viaBranch;i.request=t;i.transport=r.transport;i.ua=r;i.lastResponse="";i.transportError=false;t.serverTransaction=i;i.logger=r.getLogger("sip.transaction.ist",i.id);i.state=s.TransactionStatus.STATUS_PROCEEDING;r.newTransaction(i);t.reply(100);return i}InviteServerTransaction.prototype.stateChanged=function(e){this.state=e;this.emit("stateChanged")};InviteServerTransaction.prototype.timer_I=function(){this.stateChanged(s.TransactionStatus.STATUS_TERMINATED);this.ua.destroyTransaction(this)};InviteServerTransaction.prototype.receiveResponse=function(e,t){var r=this;return new Promise((function(i,n){if(e>=100&&e<=199&&r.state===s.TransactionStatus.STATUS_PROCEEDING){if(r.transport){r.transport.send(t).catch((function(){return r.onTransportError()}))}r.lastResponse=t;if(e>100){if(r.resendProvisionalTimer===undefined){r.resendProvisionalTimer=setInterval((function(){if(r.transport){r.transport.send(t).catch((function(){return r.onTransportError()}))}}),u.Timers.PROVISIONAL_RESPONSE_INTERVAL)}}}else if(e>=200&&e<=299){switch(r.state){case s.TransactionStatus.STATUS_PROCEEDING:r.stateChanged(c.STATUS_ACCEPTED);r.lastResponse=t;r.L=setTimeout((function(){return r.timer_L()}),u.Timers.TIMER_L);if(r.resendProvisionalTimer!==undefined){clearInterval(r.resendProvisionalTimer);r.resendProvisionalTimer=undefined}case s.TransactionStatus.STATUS_ACCEPTED:if(r.transport){r.transport.send(t).then(i).catch((function(e){r.logger.error(e);r.onTransportError();n()}))}break}}else if(e>=300&&e<=699){switch(r.state){case s.TransactionStatus.STATUS_PROCEEDING:if(r.resendProvisionalTimer!==undefined){clearInterval(r.resendProvisionalTimer);r.resendProvisionalTimer=undefined}if(r.transport){r.transport.send(t).then((function(){r.stateChanged(s.TransactionStatus.STATUS_COMPLETED);r.H=setTimeout((function(){return r.timer_H()}),u.Timers.TIMER_H);i()})).catch((function(e){r.logger.error(e);r.onTransportError();n()}))}break}}}))};InviteServerTransaction.prototype.timer_H=function(){this.logger.debug("Timer H expired for INVITE server transaction "+this.id);if(this.state===s.TransactionStatus.STATUS_COMPLETED){this.logger.warn("transactions: ACK for INVITE server transaction was never received, call will be terminated")}this.stateChanged(s.TransactionStatus.STATUS_TERMINATED);this.ua.destroyTransaction(this)};InviteServerTransaction.prototype.timer_L=function(){this.logger.debug("Timer L expired for INVITE server transaction "+this.id);if(this.state===s.TransactionStatus.STATUS_ACCEPTED){this.stateChanged(s.TransactionStatus.STATUS_TERMINATED);this.ua.destroyTransaction(this)}};InviteServerTransaction.prototype.onTransportError=function(){if(!this.transportError){this.transportError=true;this.logger.log("transport error occurred, deleting INVITE server transaction "+this.id);if(this.resendProvisionalTimer!==undefined){clearInterval(this.resendProvisionalTimer);this.resendProvisionalTimer=undefined}if(this.L){clearTimeout(this.L);this.L=undefined}if(this.H){clearTimeout(this.H);this.H=undefined}if(this.I){clearTimeout(this.I);this.I=undefined}this.stateChanged(s.TransactionStatus.STATUS_TERMINATED);this.ua.destroyTransaction(this)}};return InviteServerTransaction}(n.EventEmitter);t.InviteServerTransaction=h;function checkTransaction(e,t){var r=e.transactions.ist[t.viaBranch];switch(t.method){case a.C.INVITE:if(r){switch(r.state){case s.TransactionStatus.STATUS_PROCEEDING:if(r.transport){r.transport.send(r.lastResponse)}break;case s.TransactionStatus.STATUS_ACCEPTED:break}return true}break;case a.C.ACK:if(r){if(r.state===s.TransactionStatus.STATUS_ACCEPTED){return false}else if(r.state===s.TransactionStatus.STATUS_COMPLETED){r.stateChanged(s.TransactionStatus.STATUS_CONFIRMED);r.I=setTimeout(r.timer_I.bind(r),u.Timers.TIMER_I);return true}}else{return false}break;case a.C.CANCEL:if(r){t.reply_sl(200);if(r.state===s.TransactionStatus.STATUS_PROCEEDING){return false}else{return true}}else{t.reply_sl(481);return true}default:var i=e.transactions.nist[t.viaBranch];if(i){switch(i.state){case s.TransactionStatus.STATUS_TRYING:break;case s.TransactionStatus.STATUS_PROCEEDING:case s.TransactionStatus.STATUS_COMPLETED:if(i.transport){i.transport.send(i.lastResponse)}break}return true}break}return false}t.checkTransaction=checkTransaction},38187:function(e,t,r){"use strict";var i=this&&this.__extends||function(){var extendStatics=function(e,t){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r]};return extendStatics(e,t)};return function(e,t){extendStatics(e,t);function __(){this.constructor=e}e.prototype=t===null?Object.create(t):(__.prototype=t.prototype,new __)}}();Object.defineProperty(t,"__esModule",{value:true});var n=r(850343);var a=r(130523);var s=function(e){i(Transport,e);function Transport(t,r){var i=e.call(this)||this;i.type=a.TypeStrings.Transport;i.logger=t;return i}Transport.prototype.connect=function(e){var t=this;if(e===void 0){e={}}return this.connectPromise(e).then((function(e){if(!e.overrideEvent){t.emit("connected")}}))};Transport.prototype.send=function(e,t){var r=this;if(t===void 0){t={}}return this.sendPromise(e).then((function(e){if(!e.overrideEvent){r.emit("messageSent",e.msg)}}))};Transport.prototype.disconnect=function(e){var t=this;if(e===void 0){e={}}return this.disconnectPromise(e).then((function(e){if(!e.overrideEvent){t.emit("disconnected")}}))};Transport.prototype.afterConnected=function(e){if(this.isConnected()){e()}else{this.once("connected",e)}};Transport.prototype.waitForConnected=function(){var e=this;console.warn("DEPRECATION WARNING Transport.waitForConnected(): use afterConnected() instead");return new Promise((function(t){e.afterConnected(t)}))};return Transport}(n.EventEmitter);t.Transport=s},318082:function(e,t,r){"use strict";var i=this&&this.__extends||function(){var extendStatics=function(e,t){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r]};return extendStatics(e,t)};return function(e,t){extendStatics(e,t);function __(){this.constructor=e}e.prototype=t===null?Object.create(t):(__.prototype=t.prototype,new __)}}();Object.defineProperty(t,"__esModule",{value:true});var n=r(850343);var a=r(513669);var s=r(846182);var o=r(670109);var u=r(130523);var c=r(325840);var l=r(179089);var f=r(47102);var p=r(890106);var d=r(60816);var h=r(70266);var g=r(338949);var v=r(662564);var m=r(124555);var y=r(453115);var S=r(670603);var T=r(822049);var b=r(669825);var _=r(166578);var C=r(534356);var A=r.g.window||r.g;var E=function(e){i(UA,e);function UA(t){var r=e.call(this)||this;r.type=u.TypeStrings.UA;r.log=new f.LoggerFactory;r.logger=r.getLogger("sip.ua");r.cache={credentials:{}};r.configuration={};r.dialogs={};r.applicants={};r.data={};r.sessions={};r.subscriptions={};r.earlySubscriptions={};r.publishers={};r.status=u.UAStatus.STATUS_INIT;r.transactions={nist:{},nict:{},ist:{},ict:{}};if(t===undefined){t={}}else if(typeof t==="string"||t instanceof String){t={uri:t}}if(t.log){if(t.log.hasOwnProperty("builtinEnabled")){r.log.builtinEnabled=t.log.builtinEnabled}if(t.log.hasOwnProperty("level")){r.log.level=t.log.level}if(t.log.hasOwnProperty("connector")){r.log.connector=t.log.connector}}try{r.loadConfig(t)}catch(e){r.status=u.UAStatus.STATUS_NOT_READY;r.error=UA.C.CONFIGURATION_ERROR;throw e}r.registerContext=new h.RegisterContext(r,t.registerOptions);r.registerContext.on("failed",r.emit.bind(r,"registrationFailed"));r.registerContext.on("registered",r.emit.bind(r,"registered"));r.registerContext.on("unregistered",r.emit.bind(r,"unregistered"));if(r.configuration.autostart){r.start()}return r}Object.defineProperty(UA.prototype,"transactionsCount",{get:function(){var e=0;for(var t=0,r=["nist","nict","ist","ict"];t<r.length;t++){var i=r[t];e+=Object.keys(this.transactions[i]).length}return e},enumerable:true,configurable:true});Object.defineProperty(UA.prototype,"nictTransactionsCount",{get:function(){return Object.keys(this.transactions.nict).length},enumerable:true,configurable:true});Object.defineProperty(UA.prototype,"nistTransactionsCount",{get:function(){return Object.keys(this.transactions.nist).length},enumerable:true,configurable:true});Object.defineProperty(UA.prototype,"ictTransactionsCount",{get:function(){return Object.keys(this.transactions.ict).length},enumerable:true,configurable:true});Object.defineProperty(UA.prototype,"istTransactionsCount",{get:function(){return Object.keys(this.transactions.ist).length},enumerable:true,configurable:true});UA.prototype.register=function(e){if(e===void 0){e={}}if(e.register){this.configuration.register=true}this.registerContext.register(e);return this};UA.prototype.unregister=function(e){var t=this;this.configuration.register=false;if(this.transport){this.transport.afterConnected((function(){t.registerContext.unregister(e)}))}return this};UA.prototype.isRegistered=function(){return this.registerContext.registered};UA.prototype.invite=function(e,t,r){var i=this;var n=new m.InviteClientContext(this,e,t,r);if(this.transport){this.transport.afterConnected((function(){n.invite();i.emit("inviteSent",n)}))}return n};UA.prototype.subscribe=function(e,t,r){var i=new y.Subscription(this,e,t,r);if(this.transport){this.transport.afterConnected((function(){return i.subscribe()}))}return i};UA.prototype.publish=function(e,t,r,i){var n=new d.PublishContext(this,e,t,i);if(this.transport){this.transport.afterConnected((function(){n.publish(r)}))}return n};UA.prototype.message=function(e,t,r){if(r===void 0){r={}}if(t===undefined){throw new TypeError("Not enough arguments")}r.contentType=r.contentType||"text/plain";r.body=t;return this.request(s.C.MESSAGE,e,r)};UA.prototype.request=function(e,t,r){var i=new a.ClientContext(this,e,t,r);if(this.transport){this.transport.afterConnected((function(){return i.send()}))}return i};UA.prototype.stop=function(){var e=this;this.logger.log("user requested closure...");if(this.status===u.UAStatus.STATUS_USER_CLOSED){this.logger.warn("UA already closed");return this}this.logger.log("closing registerContext");this.registerContext.close();for(var t in this.sessions){if(this.sessions[t]){this.logger.log("closing session "+t);this.sessions[t].terminate()}}for(var i in this.subscriptions){if(this.subscriptions[i]){this.logger.log("unsubscribing from subscription "+i);this.subscriptions[i].close()}}for(var n in this.earlySubscriptions){if(this.earlySubscriptions[n]){this.logger.log("unsubscribing from early subscription "+n);this.earlySubscriptions[n].close()}}for(var a in this.publishers){if(this.publishers[a]){this.logger.log("unpublish "+a);this.publishers[a].close()}}for(var s in this.applicants){if(this.applicants[s]){this.applicants[s].close()}}this.status=u.UAStatus.STATUS_USER_CLOSED;if(this.nistTransactionsCount===0&&this.nictTransactionsCount===0&&this.transport){this.transport.disconnect()}else{var transactionsListener_1=function(){if(e.nistTransactionsCount===0&&e.nictTransactionsCount===0){e.removeListener("transactionDestroyed",transactionsListener_1);if(e.transport){e.transport.disconnect()}}};this.on("transactionDestroyed",transactionsListener_1)}if(typeof A.removeEventListener==="function"){if(!(r.g.chrome&&r.g.chrome.app&&r.g.chrome.app.runtime)){A.removeEventListener("unload",this.environListener)}}return this};UA.prototype.start=function(){var e=this;this.logger.log("user requested startup...");if(this.status===u.UAStatus.STATUS_INIT){this.status=u.UAStatus.STATUS_STARTING;if(!this.configuration.transportConstructor){throw new c.Exceptions.TransportError("Transport constructor not set")}this.transport=new this.configuration.transportConstructor(this.getLogger("sip.transport"),this.configuration.transportOptions);this.setTransportListeners();this.emit("transportCreated",this.transport);this.transport.connect()}else if(this.status===u.UAStatus.STATUS_USER_CLOSED){this.logger.log("resuming");this.status=u.UAStatus.STATUS_READY;if(this.transport){this.transport.connect()}}else if(this.status===u.UAStatus.STATUS_STARTING){this.logger.log("UA is in STARTING status, not opening new connection")}else if(this.status===u.UAStatus.STATUS_READY){this.logger.log("UA is in READY status, not resuming")}else{this.logger.error("Connection is down. Auto-Recovery system is trying to connect")}if(this.configuration.autostop&&typeof A.addEventListener==="function"){if(!(r.g.chrome&&r.g.chrome.app&&r.g.chrome.app.runtime)){this.environListener=this.stop;A.addEventListener("unload",(function(){return e.environListener()}))}}return this};UA.prototype.normalizeTarget=function(e){return b.Utils.normalizeTarget(e,this.configuration.hostportParams)};UA.prototype.getLogger=function(e,t){return this.log.getLogger(e,t)};UA.prototype.newTransaction=function(e){this.transactions[e.kind][e.id]=e;this.emit("newTransaction",{transaction:e})};UA.prototype.destroyTransaction=function(e){delete this.transactions[e.kind][e.id];this.emit("transactionDestroyed",{transaction:e})};UA.prototype.findSession=function(e){return this.sessions[e.callId+e.fromTag]||this.sessions[e.callId+e.toTag]||undefined};UA.prototype.saveCredentials=function(e){this.cache.credentials[e.realm]=this.cache.credentials[e.realm]||{};this.cache.credentials[e.realm][e.uri]=e;return this};UA.prototype.getCredentials=function(e){var t=e.ruri.type===u.TypeStrings.URI?e.ruri.host:"";if(t&&this.cache.credentials[t]&&this.cache.credentials[t][e.ruri.toString()]){var r=this.cache.credentials[t][e.ruri.toString()];r.method=e.method;return r}};UA.prototype.onTransportError=function(){if(this.status===u.UAStatus.STATUS_USER_CLOSED){return}if(!this.error||this.error!==UA.C.NETWORK_ERROR){this.status=u.UAStatus.STATUS_NOT_READY;this.error=UA.C.NETWORK_ERROR}};UA.prototype.setTransportListeners=function(){var e=this;if(this.transport){this.transport.on("connected",(function(){return e.onTransportConnected()}));this.transport.on("message",(function(t){return e.onTransportReceiveMsg(t)}));this.transport.on("transportError",(function(){return e.onTransportError()}))}};UA.prototype.onTransportConnected=function(){var e=this;if(this.configuration.register){Promise.resolve().then((function(){return e.registerContext.register()}))}};UA.prototype.onTransportReceiveMsg=function(e){var t=p.Parser.parseMessage(e,this);if(this.status===u.UAStatus.STATUS_USER_CLOSED&&t&&t.type===u.TypeStrings.IncomingRequest){this.logger.warn("UA received message when status = USER_CLOSED - aborting");return}if(t&&this.transport&&g.SanityCheck.sanityCheck(t,this,this.transport)){if(t.type===u.TypeStrings.IncomingRequest){t.transport=this.transport;this.receiveRequest(t)}else if(t.type===u.TypeStrings.IncomingResponse){switch(t.method){case s.C.INVITE:var r=this.transactions.ict[t.viaBranch];if(r){r.receiveResponse(t)}break;case s.C.ACK:break;default:var i=this.transactions.nict[t.viaBranch];if(i){i.receiveResponse(t)}break}}}};UA.prototype.receiveRequest=function(e){var ruriMatches=function(t){return!!t&&!!e.ruri&&t.user===e.ruri.user};if(this.configuration.uri.type===u.TypeStrings.URI&&!(ruriMatches(this.configuration.uri)||this.contact&&(ruriMatches(this.contact.uri)||ruriMatches(this.contact.pubGruu)||ruriMatches(this.contact.tempGruu)))){this.logger.warn("Request-URI does not point to us");if(e.method!==s.C.ACK){e.reply_sl(404)}return}if(!!e.ruri&&e.ruri.scheme===s.C.SIPS){e.reply_sl(416);return}if(this.checkTransaction(e)){return}var t=e.method;var r;if(t===s.C.OPTIONS){var i=new S.NonInviteServerTransaction(e,this);e.reply(200,undefined,["Allow: "+UA.C.ALLOWED_METHODS.toString(),"Accept: "+UA.C.ACCEPTED_BODY_TYPES.toString()])}else if(t===s.C.MESSAGE){r=new v.ServerContext(this,e);r.body=e.body;r.contentType=e.getHeader("Content-Type")||"text/plain";e.reply(200,undefined);this.emit("message",r)}else if(t!==s.C.INVITE&&t!==s.C.ACK){r=new v.ServerContext(this,e)}if(!e.toTag){switch(t){case s.C.INVITE:var n=this.configuration.replaces!==s.C.supported.UNSUPPORTED&&e.parseHeader("replaces");var a=void 0;if(n){a=this.dialogs[n.callId+n.replacesToTag+n.replacesFromTag];if(!a){e.reply_sl(481,undefined);return}else if(!(a.owner.type===u.TypeStrings.Subscription)&&a.owner.status===u.SessionStatus.STATUS_TERMINATED){e.reply_sl(603,undefined);return}else if(a.state===u.DialogStatus.STATUS_CONFIRMED&&n.earlyOnly){e.reply_sl(486,undefined);return}}var o=new m.InviteServerContext(this,e);if(a&&!(a.owner.type===u.TypeStrings.Subscription)){o.replacee=a&&a.owner}this.emit("invite",o);break;case s.C.BYE:e.reply(481);break;case s.C.CANCEL:var c=this.findSession(e);if(c){c.receiveRequest(e)}else{this.logger.warn("received CANCEL request for a non existent session")}break;case s.C.ACK:break;case s.C.NOTIFY:if(this.configuration.allowLegacyNotifications&&this.listeners("notify").length>0){e.reply(200,undefined);this.emit("notify",{request:e})}else{e.reply(481,"Subscription does not exist")}break;case s.C.REFER:this.logger.log("Received an out of dialog refer");if(this.configuration.allowOutOfDialogRefers){this.logger.log("Allow out of dialog refers is enabled on the UA");var l=new m.ReferServerContext(this,e);if(this.listeners("outOfDialogReferRequested").length){this.emit("outOfDialogReferRequested",l)}else{this.logger.log("No outOfDialogReferRequest listeners,"+" automatically accepting and following the out of dialog refer");l.accept({followRefer:true})}break}e.reply(405);break;default:e.reply(405);break}}else{var f=this.findDialog(e);if(f){if(t===s.C.INVITE){var p=new S.InviteServerTransaction(e,this)}f.receiveRequest(e)}else if(t===s.C.NOTIFY){var c=this.findSession(e);var d=this.findEarlySubscription(e);if(c){c.receiveRequest(e)}else if(d){d.receiveRequest(e)}else{this.logger.warn("received NOTIFY request for a non existent session or subscription");e.reply(481,"Subscription does not exist")}}else{if(t!==s.C.ACK){e.reply(481)}}}};UA.prototype.checkTransaction=function(e){return S.checkTransaction(this,e)};UA.prototype.findDialog=function(e){return this.dialogs[e.callId+e.fromTag+e.toTag]||this.dialogs[e.callId+e.toTag+e.fromTag]||undefined};UA.prototype.findEarlySubscription=function(e){return this.earlySubscriptions[e.callId+e.toTag+e.getHeader("event")]||undefined};UA.prototype.checkAuthenticationFactory=function(e){if(!(e instanceof Function)){return}if(!e.initialize){e.initialize=function(){return Promise.resolve()}}return e};UA.prototype.loadConfig=function(e){var t=this;var r={viaHost:b.Utils.createRandomToken(12)+".invalid",uri:new T.URI("sip","anonymous."+b.Utils.createRandomToken(6),"anonymous.invalid",undefined,undefined),custom:{},displayName:"",password:undefined,register:true,registerOptions:{},transportConstructor:C.Transport,transportOptions:{},userAgentString:s.C.USER_AGENT,noAnswerTimeout:60,hackViaTcp:false,hackIpInContact:false,hackWssInTransport:false,hackAllowUnregisteredOptionTags:false,sessionDescriptionHandlerFactoryOptions:{constraints:{},peerConnectionOptions:{}},extraSupported:[],contactName:b.Utils.createRandomToken(8),contactTransport:"ws",forceRport:false,autostart:true,autostop:true,rel100:s.C.supported.UNSUPPORTED,dtmfType:s.C.dtmfType.INFO,replaces:s.C.supported.UNSUPPORTED,sessionDescriptionHandlerFactory:_.SessionDescriptionHandler.defaultFactory,authenticationFactory:this.checkAuthenticationFactory((function(e){return new o.DigestAuthentication(e)})),allowLegacyNotifications:false,allowOutOfDialogRefers:false};var i=this.getConfigurationCheck();for(var n in i.mandatory){if(!e.hasOwnProperty(n)){throw new c.Exceptions.ConfigurationError(n)}else{var a=e[n];var u=i.mandatory[n](a);if(u!==undefined){r[n]=u}else{throw new c.Exceptions.ConfigurationError(n,a)}}}for(var n in i.optional){if(e.hasOwnProperty(n)){var a=e[n];if(a instanceof Array&&a.length===0||(a===null||a===""||a===undefined)||typeof a==="number"&&isNaN(a)){continue}var u=i.optional[n](a);if(u!==undefined){r[n]=u}else{throw new c.Exceptions.ConfigurationError(n,a)}}}if(r.displayName===0){r.displayName="0"}r.sipjsId=b.Utils.createRandomToken(5);var l=r.uri.clone();l.user=undefined;r.hostportParams=l.toRaw().replace(/^sip:/i,"");if(!r.authorizationUser){r.authorizationUser=r.uri.user}r.noAnswerTimeout=r.noAnswerTimeout*1e3;if(r.hackIpInContact){if(typeof r.hackIpInContact==="boolean"){var f=1;var p=254;var d=Math.floor(Math.random()*(p-f+1)+f);r.viaHost="192.0.2."+d}else if(typeof r.hackIpInContact==="string"){r.viaHost=r.hackIpInContact}}if(r.hackWssInTransport){r.contactTransport="wss"}this.contact={pubGruu:undefined,tempGruu:undefined,uri:new T.URI("sip",r.contactName,r.viaHost,undefined,{transport:r.contactTransport}),toString:function(e){if(e===void 0){e={}}var i=e.anonymous||false;var n=e.outbound||false;var a="<";if(i){a+=(t.contact.tempGruu||"sip:anonymous@anonymous.invalid;transport="+r.contactTransport).toString()}else{a+=(t.contact.pubGruu||t.contact.uri).toString()}if(n){a+=";ob"}a+=">";return a}};var h={};for(var n in r){if(r.hasOwnProperty(n)){h[n]=r[n]}}Object.assign(this.configuration,h);this.logger.log("configuration parameters after validation:");for(var n in r){if(r.hasOwnProperty(n)){switch(n){case"uri":case"sessionDescriptionHandlerFactory":this.logger.log("\xb7 "+n+": "+r[n]);break;case"password":this.logger.log("\xb7 "+n+": "+"NOT SHOWN");break;case"transportConstructor":this.logger.log("\xb7 "+n+": "+r[n].name);break;default:this.logger.log("\xb7 "+n+": "+JSON.stringify(r[n]))}}}return};UA.prototype.getConfigurationCheck=function(){return{mandatory:{},optional:{uri:function(e){if(!/^sip:/i.test(e)){e=s.C.SIP+":"+e}var t=l.Grammar.URIParse(e);if(!t||!t.user){return}else{return t}},transportConstructor:function(e){if(e instanceof Function){return e}},transportOptions:function(e){if(typeof e==="object"){return e}},authorizationUser:function(e){if(l.Grammar.parse('"'+e+'"',"quoted_string")===-1){return}else{return e}},displayName:function(e){if(l.Grammar.parse('"'+e+'"',"displayName")===-1){return}else{return e}},dtmfType:function(e){switch(e){case s.C.dtmfType.RTP:return s.C.dtmfType.RTP;case s.C.dtmfType.INFO:default:return s.C.dtmfType.INFO}},hackViaTcp:function(e){if(typeof e==="boolean"){return e}},hackIpInContact:function(e){if(typeof e==="boolean"){return e}else if(typeof e==="string"&&l.Grammar.parse(e,"host")!==-1){return e}},hackWssInTransport:function(e){if(typeof e==="boolean"){return e}},hackAllowUnregisteredOptionTags:function(e){if(typeof e==="boolean"){return e}},contactTransport:function(e){if(typeof e==="string"){return e}},extraSupported:function(e){if(!(e instanceof Array)){return}for(var t=0,r=e;t<r.length;t++){var i=r[t];if(typeof i!=="string"){return}}return e},forceRport:function(e){if(typeof e==="boolean"){return e}},noAnswerTimeout:function(e){if(b.Utils.isDecimal(e)){var t=Number(e);if(t>0){return t}}},password:function(e){return String(e)},rel100:function(e){if(e===s.C.supported.REQUIRED){return s.C.supported.REQUIRED}else if(e===s.C.supported.SUPPORTED){return s.C.supported.SUPPORTED}else{return s.C.supported.UNSUPPORTED}},replaces:function(e){if(e===s.C.supported.REQUIRED){return s.C.supported.REQUIRED}else if(e===s.C.supported.SUPPORTED){return s.C.supported.SUPPORTED}else{return s.C.supported.UNSUPPORTED}},register:function(e){if(typeof e==="boolean"){return e}},registerOptions:function(e){if(typeof e==="object"){return e}},userAgentString:function(e){if(typeof e==="string"){return e}},autostart:function(e){if(typeof e==="boolean"){return e}},autostop:function(e){if(typeof e==="boolean"){return e}},sessionDescriptionHandlerFactory:function(e){if(e instanceof Function){return e}},sessionDescriptionHandlerFactoryOptions:function(e){if(typeof e==="object"){return e}},authenticationFactory:this.checkAuthenticationFactory,allowLegacyNotifications:function(e){if(typeof e==="boolean"){return e}},custom:function(e){if(typeof e==="object"){return e}},contactName:function(e){if(typeof e==="string"){return e}}}}};UA.C={STATUS_INIT:0,STATUS_STARTING:1,STATUS_READY:2,STATUS_USER_CLOSED:3,STATUS_NOT_READY:4,CONFIGURATION_ERROR:1,NETWORK_ERROR:2,ALLOWED_METHODS:["ACK","CANCEL","INVITE","MESSAGE","BYE","OPTIONS","INFO","NOTIFY","REFER"],ACCEPTED_BODY_TYPES:["application/sdp","application/dtmf-relay"],MAX_FORWARDS:70,TAG_LENGTH:10};return UA}(n.EventEmitter);t.UA=E},822049:function(e,t,r){"use strict";var i=this&&this.__extends||function(){var extendStatics=function(e,t){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r]};return extendStatics(e,t)};return function(e,t){extendStatics(e,t);function __(){this.constructor=e}e.prototype=t===null?Object.create(t):(__.prototype=t.prototype,new __)}}();Object.defineProperty(t,"__esModule",{value:true});var n=r(846182);var a=r(130523);var s=function(){function Parameters(e){this.parameters={};this.type=a.TypeStrings.Parameters;for(var t in e){if(e.hasOwnProperty(t)){this.setParam(t,e[t])}}}Parameters.prototype.setParam=function(e,t){if(e){this.parameters[e.toLowerCase()]=typeof t==="undefined"||t===null?null:t.toString()}};Parameters.prototype.getParam=function(e){if(e){return this.parameters[e.toLowerCase()]}};Parameters.prototype.hasParam=function(e){if(e){return!!this.parameters.hasOwnProperty(e.toLowerCase())}return false};Parameters.prototype.deleteParam=function(e){e=e.toLowerCase();if(this.parameters.hasOwnProperty(e)){var t=this.parameters[e];delete this.parameters[e];return t}};Parameters.prototype.clearParams=function(){this.parameters={}};return Parameters}();t.Parameters=s;var o=function(e){i(URI,e);function URI(t,r,i,s,o,u){var c=e.call(this,o)||this;c.headers={};c.type=a.TypeStrings.URI;if(!i){throw new TypeError('missing or invalid "host" parameter')}t=t||n.C.SIP;for(var l in u){if(u.hasOwnProperty(l)){c.setHeader(l,u[l])}}c.raw={scheme:t,user:r,host:i,port:s};c.normal={scheme:t.toLowerCase(),user:r,host:i.toLowerCase(),port:s};return c}Object.defineProperty(URI.prototype,"_normal",{get:function(){return this.normal},enumerable:true,configurable:true});Object.defineProperty(URI.prototype,"_raw",{get:function(){return this.raw},enumerable:true,configurable:true});Object.defineProperty(URI.prototype,"scheme",{get:function(){return this.normal.scheme},set:function(e){this.raw.scheme=e;this.normal.scheme=e.toLowerCase()},enumerable:true,configurable:true});Object.defineProperty(URI.prototype,"user",{get:function(){return this.normal.user},set:function(e){this.normal.user=this.raw.user=e},enumerable:true,configurable:true});Object.defineProperty(URI.prototype,"host",{get:function(){return this.normal.host},set:function(e){this.raw.host=e;this.normal.host=e.toLowerCase()},enumerable:true,configurable:true});Object.defineProperty(URI.prototype,"aor",{get:function(){return this.normal.user+"@"+this.normal.host},enumerable:true,configurable:true});Object.defineProperty(URI.prototype,"port",{get:function(){return this.normal.port},set:function(e){this.normal.port=this.raw.port=e===0?e:e},enumerable:true,configurable:true});URI.prototype.setHeader=function(e,t){this.headers[this.headerize(e)]=t instanceof Array?t:[t]};URI.prototype.getHeader=function(e){if(e){return this.headers[this.headerize(e)]}};URI.prototype.hasHeader=function(e){return!!e&&!!this.headers.hasOwnProperty(this.headerize(e))};URI.prototype.deleteHeader=function(e){e=this.headerize(e);if(this.headers.hasOwnProperty(e)){var t=this.headers[e];delete this.headers[e];return t}};URI.prototype.clearHeaders=function(){this.headers={}};URI.prototype.clone=function(){return new URI(this._raw.scheme,this._raw.user||"",this._raw.host,this._raw.port,JSON.parse(JSON.stringify(this.parameters)),JSON.parse(JSON.stringify(this.headers)))};URI.prototype.toRaw=function(){return this._toString(this._raw)};URI.prototype.toString=function(){return this._toString(this._normal)};URI.prototype._toString=function(e){var t=e.scheme+":";if(!e.scheme.toLowerCase().match("^sips?$")){t+="//"}if(e.user){t+=this.escapeUser(e.user)+"@"}t+=e.host;if(e.port||e.port===0){t+=":"+e.port}for(var r in this.parameters){if(this.parameters.hasOwnProperty(r)){t+=";"+r;if(this.parameters[r]!==null){t+="="+this.parameters[r]}}}var i=[];for(var n in this.headers){if(this.headers.hasOwnProperty(n)){for(var a in this.headers[n]){if(this.headers[n].hasOwnProperty(a)){i.push(n+"="+this.headers[n][a])}}}}if(i.length>0){t+="?"+i.join("&")}return t};URI.prototype.escapeUser=function(e){return encodeURIComponent(decodeURIComponent(e)).replace(/%3A/gi,":").replace(/%2B/gi,"+").replace(/%3F/gi,"?").replace(/%2F/gi,"/")};URI.prototype.headerize=function(e){var t={"Call-Id":"Call-ID",Cseq:"CSeq","Min-Se":"Min-SE",Rack:"RAck",Rseq:"RSeq","Www-Authenticate":"WWW-Authenticate"};var r=e.toLowerCase().replace(/_/g,"-").split("-");var i=r.length;var n="";for(var a=0;a<i;a++){if(a!==0){n+="-"}n+=r[a].charAt(0).toUpperCase()+r[a].substring(1)}if(t[n]){n=t[n]}return n};return URI}(s);t.URI=o},669825:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});var i=r(846182);var n=r(130523);var a=r(179089);var s;(function(e){function defer(){var e={};e.promise=new Promise((function(t,r){e.resolve=t;e.reject=r}));return e}e.defer=defer;function reducePromises(e,t){return e.reduce((function(e,t){e=e.then(t);return e}),Promise.resolve(t))}e.reducePromises=reducePromises;function str_utf8_length(e){return encodeURIComponent(e).replace(/%[A-F\d]{2}/g,"U").length}e.str_utf8_length=str_utf8_length;function generateFakeSDP(e){if(!e){return}var t=e.indexOf("o=");var r=e.indexOf("\r\n",t);return"v=0\r\n"+e.slice(t,r)+"\r\ns=-\r\nt=0 0\r\nc=IN IP4 0.0.0.0"}e.generateFakeSDP=generateFakeSDP;function isDecimal(e){var t=parseInt(e,10);return!isNaN(t)&&parseFloat(e)===t}e.isDecimal=isDecimal;function createRandomToken(e,t){if(t===void 0){t=32}var r="";for(var i=0;i<e;i++){var n=Math.floor(Math.random()*t);r+=n.toString(t)}return r}e.createRandomToken=createRandomToken;function newTag(){return e.createRandomToken(10)}e.newTag=newTag;function newUUID(){var e="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=Math.floor(Math.random()*16);var r=e==="x"?t:t%4+8;return r.toString(16)}));return e}e.newUUID=newUUID;function normalizeTarget(t,r){if(!t){return}else if(t.type===n.TypeStrings.URI){return t}else if(typeof t==="string"){var s=t.split("@");var o=void 0;var u=void 0;switch(s.length){case 1:if(!r){return}o=t;u=r;break;case 2:o=s[0];u=s[1];break;default:o=s.slice(0,s.length-1).join("@");u=s[s.length-1]}o=o.replace(/^(sips?|tel):/i,"");if(/^[\-\.\(\)]*\+?[0-9\-\.\(\)]+$/.test(o)){o=o.replace(/[\-\.\(\)]/g,"")}t=i.C.SIP+":"+e.escapeUser(o)+"@"+u;return a.Grammar.URIParse(t)}else{return}}e.normalizeTarget=normalizeTarget;function escapeUser(e){return encodeURIComponent(decodeURIComponent(e)).replace(/%3A/gi,":").replace(/%2B/gi,"+").replace(/%3F/gi,"?").replace(/%2F/gi,"/")}e.escapeUser=escapeUser;function headerize(e){var t={"Call-Id":"Call-ID",Cseq:"CSeq","Min-Se":"Min-SE",Rack:"RAck",Rseq:"RSeq","Www-Authenticate":"WWW-Authenticate"};var r=e.toLowerCase().replace(/_/g,"-").split("-");var i=r.length;var n="";for(var a=0;a<i;a++){if(a!==0){n+="-"}n+=r[a].charAt(0).toUpperCase()+r[a].substring(1)}if(t[n]){n=t[n]}return n}e.headerize=headerize;function sipErrorCause(e){for(var t in i.C.SIP_ERROR_CAUSES){if(i.C.SIP_ERROR_CAUSES[t].indexOf(e)!==-1){return i.C.causes[t]}}return i.C.causes.SIP_FAILURE_CODE}e.sipErrorCause=sipErrorCause;function getReasonPhrase(e,t){return t||i.C.REASON_PHRASE[e]||""}e.getReasonPhrase=getReasonPhrase;function getReasonHeaderValue(t,r){r=e.getReasonPhrase(t,r);return"SIP;cause="+t+';text="'+r+'"'}e.getReasonHeaderValue=getReasonHeaderValue;function getCancelReason(t,r){if(t&&t<200||t>699){throw new TypeError("Invalid statusCode: "+t)}else if(t){return e.getReasonHeaderValue(t,r)}}e.getCancelReason=getCancelReason;function buildStatusLine(t,r){if(!t||(t<100||t>699)){throw new TypeError("Invalid statusCode: "+t)}else if(r&&typeof r!=="string"&&!(r instanceof String)){throw new TypeError("Invalid reason: "+r)}r=e.getReasonPhrase(t,r);return"SIP/2.0 "+t+" "+r+"\r\n"}e.buildStatusLine=buildStatusLine})(s=t.Utils||(t.Utils={}))},450745:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});var stripPayload=function(e,t){var r=[];var i=e.split(/\r\n/);var n;for(var a=0;a<i.length;){var s=i[a];if(/^m=(?:audio|video)/.test(s)){n={index:a,stripped:[]};r.push(n)}else if(n){var o=/^a=rtpmap:(\d+) ([^/]+)\//.exec(s);if(o&&t===o[2]){i.splice(a,1);n.stripped.push(o[1]);continue}}a++}for(var u=0,c=r;u<c.length;u++){var l=c[u];var f=i[l.index].split(" ");for(var p=3;p<f.length;){if(l.stripped.indexOf(f[p])!==-1){f.splice(p,1);continue}p++}i[l.index]=f.join(" ")}return i.join("\r\n")};var stripMediaDescription=function(e,t){var r=new RegExp("m="+t+".*$","gm");var i=new RegExp("^a=group:.*$","gm");if(r.test(e)){var n;e=e.split(/^m=/gm).filter((function(e){if(e.substr(0,t.length)===t){n=e.match(/^a=mid:.*$/gm);if(n){var r=n[0].match(/:.+$/g);if(r){n=r[0].substr(1)}}return false}return true})).join("m=");var a=e.match(i);if(a&&a.length===1){var s=a[0];var o=new RegExp(" *"+n+"[^ ]*","g");s=s.replace(o,"");e=e.split(i).join(s)}}return e};function stripTcpCandidates(e){e.sdp=(e.sdp||"").replace(/^a=candidate:\d+ \d+ tcp .*?\r\n/gim,"");return Promise.resolve(e)}t.stripTcpCandidates=stripTcpCandidates;function stripTelephoneEvent(e){e.sdp=stripPayload(e.sdp||"","telephone-event");return Promise.resolve(e)}t.stripTelephoneEvent=stripTelephoneEvent;function cleanJitsiSdpImageattr(e){e.sdp=(e.sdp||"").replace(/^(a=imageattr:.*?)(x|y)=\[0-/gm,"$1$2=[1:");return Promise.resolve(e)}t.cleanJitsiSdpImageattr=cleanJitsiSdpImageattr;function stripG722(e){e.sdp=stripPayload(e.sdp||"","G722");return Promise.resolve(e)}t.stripG722=stripG722;function stripRtpPayload(e){return function(t){t.sdp=stripPayload(t.sdp||"",e);return Promise.resolve(t)}}t.stripRtpPayload=stripRtpPayload;function stripVideo(e){e.sdp=stripMediaDescription(e.sdp||"","video");return Promise.resolve(e)}t.stripVideo=stripVideo;function addMidLines(e){var t=e.sdp||"";if(t.search(/^a=mid.*$/gm)===-1){var r=t.match(/^m=.*$/gm);var i=t.split(/^m=.*$/gm);if(r){r.forEach((function(e,t){r[t]=e+"\na=mid:"+t}))}i.forEach((function(e,t){if(r&&r[t]){i[t]=e+r[t]}}));t=i.join("");e.sdp=t}return Promise.resolve(e)}t.addMidLines=addMidLines},166578:function(e,t,r){"use strict";var i=this&&this.__extends||function(){var extendStatics=function(e,t){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r]};return extendStatics(e,t)};return function(e,t){extendStatics(e,t);function __(){this.constructor=e}e.prototype=t===null?Object.create(t):(__.prototype=t.prototype,new __)}}();Object.defineProperty(t,"__esModule",{value:true});var n=r(850343);var a=r(130523);var s=r(325840);var o=r(669825);var u=r(450745);var c=r(730550);var l=function(e){i(SessionDescriptionHandler,e);function SessionDescriptionHandler(t,i,n){var s=e.call(this)||this;s.type=a.TypeStrings.SessionDescriptionHandler;s.options=n||{};s.logger=t;s.observer=i;s.dtmfSender=undefined;s.shouldAcquireMedia=true;s.CONTENT_TYPE="application/sdp";s.C={DIRECTION:{NULL:null,SENDRECV:"sendrecv",SENDONLY:"sendonly",RECVONLY:"recvonly",INACTIVE:"inactive"}};s.logger.log("SessionDescriptionHandlerOptions: "+JSON.stringify(s.options));s.direction=s.C.DIRECTION.NULL;s.modifiers=s.options.modifiers||[];if(!Array.isArray(s.modifiers)){s.modifiers=[s.modifiers]}var o=r.g.window||r.g;s.WebRTC={MediaStream:o.MediaStream,getUserMedia:o.navigator.mediaDevices.getUserMedia.bind(o.navigator.mediaDevices),RTCPeerConnection:o.RTCPeerConnection};s.iceGatheringTimeout=false;s.initPeerConnection(s.options.peerConnectionOptions);s.constraints=s.checkAndDefaultConstraints(s.options.constraints);return s}SessionDescriptionHandler.defaultFactory=function(e,t){var r=e.ua.getLogger("sip.invitecontext.sessionDescriptionHandler",e.id);var i=new c.SessionDescriptionHandlerObserver(e,t);return new SessionDescriptionHandler(r,i,t)};SessionDescriptionHandler.prototype.close=function(){this.logger.log("closing PeerConnection");if(this.peerConnection&&this.peerConnection.signalingState!=="closed"){if(this.peerConnection.getSenders){this.peerConnection.getSenders().forEach((function(e){if(e.track){e.track.stop()}}))}else{this.logger.warn("Using getLocalStreams which is deprecated");this.peerConnection.getLocalStreams().forEach((function(e){e.getTracks().forEach((function(e){e.stop()}))}))}if(this.peerConnection.getReceivers){this.peerConnection.getReceivers().forEach((function(e){if(e.track){e.track.stop()}}))}else{this.logger.warn("Using getRemoteStreams which is deprecated");this.peerConnection.getRemoteStreams().forEach((function(e){e.getTracks().forEach((function(e){e.stop()}))}))}this.resetIceGatheringComplete();this.peerConnection.close()}};SessionDescriptionHandler.prototype.getDescription=function(e,t){var r=this;if(e===void 0){e={}}if(t===void 0){t=[]}if(e.peerConnectionOptions){this.initPeerConnection(e.peerConnectionOptions)}var i=Object.assign({},this.constraints,e.constraints);i=this.checkAndDefaultConstraints(i);if(JSON.stringify(i)!==JSON.stringify(this.constraints)){this.constraints=i;this.shouldAcquireMedia=true}if(!Array.isArray(t)){t=[t]}t=t.concat(this.modifiers);return Promise.resolve().then((function(){if(r.shouldAcquireMedia){return r.acquire(r.constraints).then((function(){r.shouldAcquireMedia=false}))}})).then((function(){return r.createOfferOrAnswer(e.RTCOfferOptions,t)})).then((function(e){r.emit("getDescription",e);return{body:e.sdp,contentType:r.CONTENT_TYPE}}))};SessionDescriptionHandler.prototype.hasDescription=function(e){return e===this.CONTENT_TYPE};SessionDescriptionHandler.prototype.holdModifier=function(e){if(!e.sdp){return Promise.resolve(e)}if(!/a=(sendrecv|sendonly|recvonly|inactive)/.test(e.sdp)){e.sdp=e.sdp.replace(/(m=[^\r]*\r\n)/g,"$1a=sendonly\r\n")}else{e.sdp=e.sdp.replace(/a=sendrecv\r\n/g,"a=sendonly\r\n");e.sdp=e.sdp.replace(/a=recvonly\r\n/g,"a=inactive\r\n")}return Promise.resolve(e)};SessionDescriptionHandler.prototype.setDescription=function(e,t,r){var i=this;if(t===void 0){t={}}if(r===void 0){r=[]}if(t.peerConnectionOptions){this.initPeerConnection(t.peerConnectionOptions)}if(!Array.isArray(r)){r=[r]}r=r.concat(this.modifiers);var n={type:this.hasOffer("local")?"answer":"offer",sdp:e};return Promise.resolve().then((function(){if(i.shouldAcquireMedia&&i.options.alwaysAcquireMediaFirst){return i.acquire(i.constraints).then((function(){i.shouldAcquireMedia=false}))}})).then((function(){return o.Utils.reducePromises(r,n)})).catch((function(e){if(e.type===a.TypeStrings.SessionDescriptionHandlerError){throw e}var t=new s.Exceptions.SessionDescriptionHandlerError("setDescription",e,"The modifiers did not resolve successfully");i.logger.error(t.message);i.emit("peerConnection-setRemoteDescriptionFailed",t);throw t})).then((function(e){i.emit("setDescription",e);return i.peerConnection.setRemoteDescription(e)})).catch((function(n){if(n.type===a.TypeStrings.SessionDescriptionHandlerError){throw n}if(/^m=video.+$/gm.test(e)&&!t.disableAudioFallback){t.disableAudioFallback=true;return i.setDescription(e,t,[u.stripVideo].concat(r))}var o=new s.Exceptions.SessionDescriptionHandlerError("setDescription",n);if(o.error){i.logger.error(o.error)}i.emit("peerConnection-setRemoteDescriptionFailed",o);throw o})).then((function(){if(i.peerConnection.getReceivers){i.emit("setRemoteDescription",i.peerConnection.getReceivers())}else{i.emit("setRemoteDescription",i.peerConnection.getRemoteStreams())}i.emit("confirmed",i)}))};SessionDescriptionHandler.prototype.sendDtmf=function(e,t){if(t===void 0){t={}}if(!this.dtmfSender&&this.hasBrowserGetSenderSupport()){var r=this.peerConnection.getSenders();if(r.length>0){this.dtmfSender=r[0].dtmf}}if(!this.dtmfSender&&this.hasBrowserTrackSupport()){var i=this.peerConnection.getLocalStreams();if(i.length>0){var n=i[0].getAudioTracks();if(n.length>0){this.dtmfSender=this.peerConnection.createDTMFSender(n[0])}}}if(!this.dtmfSender){return false}try{this.dtmfSender.insertDTMF(e,t.duration,t.interToneGap)}catch(e){if(e.type==="InvalidStateError"||e.type==="InvalidCharacterError"){this.logger.error(e);return false}else{throw e}}this.logger.log("DTMF sent via RTP: "+e.toString());return true};SessionDescriptionHandler.prototype.getDirection=function(){return this.direction};SessionDescriptionHandler.prototype.createOfferOrAnswer=function(e,t){var r=this;if(e===void 0){e={}}if(t===void 0){t=[]}var i=this.hasOffer("remote")?"createAnswer":"createOffer";var n=this.peerConnection;this.logger.log(i);return n[i](e).catch((function(e){if(e.type===a.TypeStrings.SessionDescriptionHandlerError){throw e}var t=new s.Exceptions.SessionDescriptionHandlerError("createOfferOrAnswer",e,"peerConnection-"+i+"Failed");r.emit("peerConnection-"+i+"Failed",t);throw t})).then((function(e){return o.Utils.reducePromises(t,r.createRTCSessionDescriptionInit(e))})).then((function(e){r.resetIceGatheringComplete();r.logger.log("Setting local sdp.");r.logger.log("sdp is "+e.sdp||0);return n.setLocalDescription(e)})).catch((function(e){if(e.type===a.TypeStrings.SessionDescriptionHandlerError){throw e}var t=new s.Exceptions.SessionDescriptionHandlerError("createOfferOrAnswer",e,"peerConnection-SetLocalDescriptionFailed");r.emit("peerConnection-SetLocalDescriptionFailed",t);throw t})).then((function(){return r.waitForIceGatheringComplete()})).then((function(){var e=r.createRTCSessionDescriptionInit(r.peerConnection.localDescription);return o.Utils.reducePromises(t,e)})).then((function(e){r.setDirection(e.sdp||"");return e})).catch((function(e){if(e.type===a.TypeStrings.SessionDescriptionHandlerError){throw e}var t=new s.Exceptions.SessionDescriptionHandlerError("createOfferOrAnswer",e);r.logger.error(t.toString());throw t}))};SessionDescriptionHandler.prototype.createRTCSessionDescriptionInit=function(e){return{type:e.type,sdp:e.sdp}};SessionDescriptionHandler.prototype.addDefaultIceCheckingTimeout=function(e){if(e.iceCheckingTimeout===undefined){e.iceCheckingTimeout=5e3}return e};SessionDescriptionHandler.prototype.addDefaultIceServers=function(e){if(!e.iceServers){e.iceServers=[{urls:"stun:stun.l.google.com:19302"}]}return e};SessionDescriptionHandler.prototype.checkAndDefaultConstraints=function(e){var t={audio:true,video:!this.options.alwaysAcquireMediaFirst};e=e||t;if(Object.keys(e).length===0&&e.constructor===Object){return t}return e};SessionDescriptionHandler.prototype.hasBrowserTrackSupport=function(){return Boolean(this.peerConnection.addTrack)};SessionDescriptionHandler.prototype.hasBrowserGetSenderSupport=function(){return Boolean(this.peerConnection.getSenders)};SessionDescriptionHandler.prototype.initPeerConnection=function(e){var t=this;if(e===void 0){e={}}e=this.addDefaultIceCheckingTimeout(e);e.rtcConfiguration=e.rtcConfiguration||{};e.rtcConfiguration=this.addDefaultIceServers(e.rtcConfiguration);this.logger.log("initPeerConnection");if(this.peerConnection){this.logger.log("Already have a peer connection for this session. Tearing down.");this.resetIceGatheringComplete();this.peerConnection.close()}this.peerConnection=new this.WebRTC.RTCPeerConnection(e.rtcConfiguration);this.logger.log("New peer connection created");if("ontrack"in this.peerConnection){this.peerConnection.addEventListener("track",(function(e){t.logger.log("track added");t.observer.trackAdded();t.emit("addTrack",e)}))}else{this.logger.warn("Using onaddstream which is deprecated");this.peerConnection.onaddstream=function(e){t.logger.log("stream added");t.emit("addStream",e)}}this.peerConnection.onicecandidate=function(e){t.emit("iceCandidate",e);if(e.candidate){t.logger.log("ICE candidate received: "+(e.candidate.candidate===null?null:e.candidate.candidate.trim()))}else if(e.candidate===null){t.logger.log("ICE candidate gathering complete");t.triggerIceGatheringComplete()}};this.peerConnection.onicegatheringstatechange=function(){t.logger.log("RTCIceGatheringState changed: "+t.peerConnection.iceGatheringState);switch(t.peerConnection.iceGatheringState){case"gathering":t.emit("iceGathering",t);if(!t.iceGatheringTimer&&e.iceCheckingTimeout){t.iceGatheringTimeout=false;t.iceGatheringTimer=setTimeout((function(){t.logger.log("RTCIceChecking Timeout Triggered after "+e.iceCheckingTimeout+" milliseconds");t.iceGatheringTimeout=true;t.triggerIceGatheringComplete()}),e.iceCheckingTimeout)}break;case"complete":t.triggerIceGatheringComplete();break}};this.peerConnection.oniceconnectionstatechange=function(){var e;switch(t.peerConnection.iceConnectionState){case"new":e="iceConnection";break;case"checking":e="iceConnectionChecking";break;case"connected":e="iceConnectionConnected";break;case"completed":e="iceConnectionCompleted";break;case"failed":e="iceConnectionFailed";break;case"disconnected":e="iceConnectionDisconnected";break;case"closed":e="iceConnectionClosed";break;default:t.logger.warn("Unknown iceConnection state: "+t.peerConnection.iceConnectionState);return}t.logger.log("ICE Connection State changed to "+e);t.emit(e,t)}};SessionDescriptionHandler.prototype.acquire=function(e){var t=this;e=this.checkAndDefaultConstraints(e);return new Promise((function(r,i){t.logger.log("acquiring local media");t.emit("userMediaRequest",e);if(e.audio||e.video){t.WebRTC.getUserMedia(e).then((function(e){t.observer.trackAdded();t.emit("userMedia",e);r(e)})).catch((function(e){t.emit("userMediaFailed",e);i(e)}))}else{r([])}})).catch((function(e){if(e.type===a.TypeStrings.SessionDescriptionHandlerError){throw e}var r=new s.Exceptions.SessionDescriptionHandlerError("acquire",e,"unable to acquire streams");t.logger.error(r.message);if(r.error){t.logger.error(r.error)}throw r})).then((function(e){t.logger.log("acquired local media streams");try{if(t.peerConnection.removeTrack){t.peerConnection.getSenders().forEach((function(e){t.peerConnection.removeTrack(e)}))}return e}catch(e){return Promise.reject(e)}})).catch((function(e){if(e.type===a.TypeStrings.SessionDescriptionHandlerError){throw e}var r=new s.Exceptions.SessionDescriptionHandlerError("acquire",e,"error removing streams");t.logger.error(r.message);if(r.error){t.logger.error(r.error)}throw r})).then((function(e){try{e=[].concat(e);e.forEach((function(e){if(t.peerConnection.addTrack){e.getTracks().forEach((function(r){t.peerConnection.addTrack(r,e)}))}else{t.peerConnection.addStream(e)}}))}catch(e){return Promise.reject(e)}return Promise.resolve()})).catch((function(e){if(e.type===a.TypeStrings.SessionDescriptionHandlerError){throw e}var r=new s.Exceptions.SessionDescriptionHandlerError("acquire",e,"error adding stream");t.logger.error(r.message);if(r.error){t.logger.error(r.error)}throw r}))};SessionDescriptionHandler.prototype.hasOffer=function(e){var t="have-"+e+"-offer";return this.peerConnection.signalingState===t};SessionDescriptionHandler.prototype.isIceGatheringComplete=function(){return this.peerConnection.iceGatheringState==="complete"||this.iceGatheringTimeout};SessionDescriptionHandler.prototype.resetIceGatheringComplete=function(){this.iceGatheringTimeout=false;this.logger.log("resetIceGatheringComplete");if(this.iceGatheringTimer){clearTimeout(this.iceGatheringTimer);this.iceGatheringTimer=undefined}if(this.iceGatheringDeferred){this.iceGatheringDeferred.reject();this.iceGatheringDeferred=undefined}};SessionDescriptionHandler.prototype.setDirection=function(e){var t=e.match(/a=(sendrecv|sendonly|recvonly|inactive)/);if(t===null){this.direction=this.C.DIRECTION.NULL;this.observer.directionChanged();return}var r=t[1];switch(r){case this.C.DIRECTION.SENDRECV:case this.C.DIRECTION.SENDONLY:case this.C.DIRECTION.RECVONLY:case this.C.DIRECTION.INACTIVE:this.direction=r;break;default:this.direction=this.C.DIRECTION.NULL;break}this.observer.directionChanged()};SessionDescriptionHandler.prototype.triggerIceGatheringComplete=function(){if(this.isIceGatheringComplete()){this.emit("iceGatheringComplete",this);if(this.iceGatheringTimer){clearTimeout(this.iceGatheringTimer);this.iceGatheringTimer=undefined}if(this.iceGatheringDeferred){this.iceGatheringDeferred.resolve();this.iceGatheringDeferred=undefined}}};SessionDescriptionHandler.prototype.waitForIceGatheringComplete=function(){this.logger.log("waitForIceGatheringComplete");if(this.isIceGatheringComplete()){this.logger.log("ICE is already complete. Return resolved.");return Promise.resolve()}else if(!this.iceGatheringDeferred){this.iceGatheringDeferred=o.Utils.defer()}this.logger.log("ICE is not complete. Returning promise");return this.iceGatheringDeferred?this.iceGatheringDeferred.promise:Promise.resolve()};return SessionDescriptionHandler}(n.EventEmitter);t.SessionDescriptionHandler=l},730550:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});var i=r(130523);var n=function(){function SessionDescriptionHandlerObserver(e,t){this.type=i.TypeStrings.SessionDescriptionHandlerObserver;this.session=e;this.options=t}SessionDescriptionHandlerObserver.prototype.trackAdded=function(){this.session.emit("trackAdded")};SessionDescriptionHandlerObserver.prototype.directionChanged=function(){this.session.emit("directionChanged")};return SessionDescriptionHandlerObserver}();t.SessionDescriptionHandlerObserver=n},706211:function(e,t,r){"use strict";var i=this&&this.__extends||function(){var extendStatics=function(e,t){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r]};return extendStatics(e,t)};return function(e,t){extendStatics(e,t);function __(){this.constructor=e}e.prototype=t===null?Object.create(t):(__.prototype=t.prototype,new __)}}();Object.defineProperty(t,"__esModule",{value:true});var n=r(850343);var a=r(318082);var s=r(450745);var o;(function(e){e[e["STATUS_NULL"]=0]="STATUS_NULL";e[e["STATUS_NEW"]=1]="STATUS_NEW";e[e["STATUS_CONNECTING"]=2]="STATUS_CONNECTING";e[e["STATUS_CONNECTED"]=3]="STATUS_CONNECTED";e[e["STATUS_COMPLETED"]=4]="STATUS_COMPLETED"})(o=t.SimpleStatus||(t.SimpleStatus={}));var u=function(e){i(Simple,e);function Simple(t){var i=e.call(this)||this;if(t.media.remote.video){i.video=true}else{i.video=false}if(t.media.remote.audio){i.audio=true}else{i.audio=false}if(!i.audio&&!i.video){throw new Error("At least one remote audio or video element is required for Simple.")}i.options=t;var n=r.g.navigator.userAgent.toLowerCase();var u=false;var c=false;if(n.indexOf("safari")>-1&&n.indexOf("chrome")<0){u=true}else if(n.indexOf("firefox")>-1&&n.indexOf("chrome")<0){c=true}var l={};if(u){l.modifiers=[s.stripG722]}if(c){l.alwaysAcquireMediaFirst=true}if(!i.options.ua.uri){i.anonymous=true}else{i.anonymous=false}i.ua=new a.UA({uri:i.options.ua.uri,authorizationUser:i.options.ua.authorizationUser,password:i.options.ua.password,displayName:i.options.ua.displayName,userAgentString:i.options.ua.userAgentString,register:true,sessionDescriptionHandlerFactoryOptions:l,transportOptions:{traceSip:i.options.ua.traceSip,wsServers:i.options.ua.wsServers}});i.state=o.STATUS_NULL;i.logger=i.ua.getLogger("sip.simple");i.ua.on("registered",(function(){i.emit("registered",i.ua)}));i.ua.on("unregistered",(function(){i.emit("unregistered",i.ua)}));i.ua.on("failed",(function(){i.emit("unregistered",i.ua)}));i.ua.on("invite",(function(e){if(i.state!==o.STATUS_NULL&&i.state!==o.STATUS_COMPLETED){i.logger.warn("Rejecting incoming call. Simple only supports 1 call at a time");e.reject();return}i.session=e;i.setupSession();i.emit("ringing",i.session)}));i.ua.on("message",(function(e){i.emit("message",e)}));return i}Simple.prototype.call=function(e){if(!this.ua||!this.checkRegistration()){this.logger.warn("A registered UA is required for calling");return}if(this.state!==o.STATUS_NULL&&this.state!==o.STATUS_COMPLETED){this.logger.warn("Cannot make more than a single call with Simple");return}if(this.options.media.remote.audio){this.options.media.remote.audio.autoplay=true}if(this.options.media.remote.video){this.options.media.remote.video.autoplay=true}if(this.options.media.local&&this.options.media.local.video){this.options.media.local.video.autoplay=true;this.options.media.local.video.volume=0}this.session=this.ua.invite(e,{sessionDescriptionHandlerOptions:{constraints:{audio:this.audio,video:this.video}}});this.setupSession();return this.session};Simple.prototype.answer=function(){if(this.state!==o.STATUS_NEW&&this.state!==o.STATUS_CONNECTING){this.logger.warn("No call to answer");return}if(this.options.media.remote.audio){this.options.media.remote.audio.autoplay=true}if(this.options.media.remote.video){this.options.media.remote.video.autoplay=true}return this.session.accept({sessionDescriptionHandlerOptions:{constraints:{audio:this.audio,video:this.video}}})};Simple.prototype.reject=function(){if(this.state!==o.STATUS_NEW&&this.state!==o.STATUS_CONNECTING){this.logger.warn("Call is already answered");return}return this.session.reject()};Simple.prototype.hangup=function(){if(this.state!==o.STATUS_CONNECTED&&this.state!==o.STATUS_CONNECTING&&this.state!==o.STATUS_NEW){this.logger.warn("No active call to hang up on");return}if(this.state!==o.STATUS_CONNECTED){return this.session.cancel()}else if(this.session){return this.session.bye()}};Simple.prototype.hold=function(){if(this.state!==o.STATUS_CONNECTED||!this.session||this.session.localHold){this.logger.warn("Cannot put call on hold");return}this.mute();this.logger.log("Placing session on hold");return this.session.hold()};Simple.prototype.unhold=function(){if(this.state!==o.STATUS_CONNECTED||!this.session||!this.session.localHold){this.logger.warn("Cannot unhold a call that is not on hold");return}this.unmute();this.logger.log("Placing call off hold");return this.session.unhold()};Simple.prototype.mute=function(){if(this.state!==o.STATUS_CONNECTED){this.logger.warn("An acitve call is required to mute audio");return}this.logger.log("Muting Audio");this.toggleMute(true);this.emit("mute",this)};Simple.prototype.unmute=function(){if(this.state!==o.STATUS_CONNECTED){this.logger.warn("An active call is required to unmute audio");return}this.logger.log("Unmuting Audio");this.toggleMute(false);this.emit("unmute",this)};Simple.prototype.sendDTMF=function(e){if(this.state!==o.STATUS_CONNECTED||!this.session){this.logger.warn("An active call is required to send a DTMF tone");return}this.logger.log("Sending DTMF tone: "+e);this.session.dtmf(e)};Simple.prototype.message=function(e,t){if(!this.ua||!this.checkRegistration()){this.logger.warn("A registered UA is required to send a message");return}if(!e||!t){this.logger.warn("A destination and message are required to send a message");return}this.ua.message(e,t)};Simple.prototype.checkRegistration=function(){return this.anonymous||this.ua&&this.ua.isRegistered()};Simple.prototype.setupRemoteMedia=function(){var e=this;if(!this.session){this.logger.warn("No session to set remote media on");return}var t=this.session.sessionDescriptionHandler.peerConnection;var i;if(t.getReceivers){i=new r.g.window.MediaStream;t.getReceivers().forEach((function(e){var t=e.track;if(t){i.addTrack(t)}}))}else{i=t.getRemoteStreams()[0]}if(this.video){this.options.media.remote.video.srcObject=i;this.options.media.remote.video.play().catch((function(){e.logger.log("play was rejected")}))}else if(this.audio){this.options.media.remote.audio.srcObject=i;this.options.media.remote.audio.play().catch((function(){e.logger.log("play was rejected")}))}};Simple.prototype.setupLocalMedia=function(){if(!this.session){this.logger.warn("No session to set local media on");return}if(this.video&&this.options.media.local&&this.options.media.local.video){var e=this.session.sessionDescriptionHandler.peerConnection;var t;if(e.getSenders){t=new r.g.window.MediaStream;e.getSenders().forEach((function(e){var r=e.track;if(r&&r.kind==="video"){t.addTrack(r)}}))}else{t=e.getLocalStreams()[0]}this.options.media.local.video.srcObject=t;this.options.media.local.video.volume=0;this.options.media.local.video.play()}};Simple.prototype.cleanupMedia=function(){if(this.video){this.options.media.remote.video.srcObject=null;this.options.media.remote.video.pause();if(this.options.media.local&&this.options.media.local.video){this.options.media.local.video.srcObject=null;this.options.media.local.video.pause()}}if(this.audio){this.options.media.remote.audio.srcObject=null;this.options.media.remote.audio.pause()}};Simple.prototype.setupSession=function(){var e=this;if(!this.session){this.logger.warn("No session to set up");return}this.state=o.STATUS_NEW;this.emit("new",this.session);this.session.on("progress",(function(){return e.onProgress()}));this.session.on("accepted",(function(){return e.onAccepted()}));this.session.on("rejected",(function(){return e.onEnded()}));this.session.on("failed",(function(){return e.onFailed()}));this.session.on("terminated",(function(){return e.onEnded()}))};Simple.prototype.destroyMedia=function(){if(this.session&&this.session.sessionDescriptionHandler){this.session.sessionDescriptionHandler.close()}};Simple.prototype.toggleMute=function(e){if(!this.session){this.logger.warn("No session to toggle mute");return}var t=this.session.sessionDescriptionHandler.peerConnection;if(t.getSenders){t.getSenders().forEach((function(t){if(t.track){t.track.enabled=!e}}))}else{t.getLocalStreams().forEach((function(t){t.getAudioTracks().forEach((function(t){t.enabled=!e}));t.getVideoTracks().forEach((function(t){t.enabled=!e}))}))}};Simple.prototype.onAccepted=function(){var e=this;if(!this.session){this.logger.warn("No session for accepting");return}this.state=o.STATUS_CONNECTED;this.emit("connected",this.session);this.setupLocalMedia();this.setupRemoteMedia();if(this.session.sessionDescriptionHandler){this.session.sessionDescriptionHandler.on("addTrack",(function(){e.logger.log("A track has been added, triggering new remoteMedia setup");e.setupRemoteMedia()}));this.session.sessionDescriptionHandler.on("addStream",(function(){e.logger.log("A stream has been added, trigger new remoteMedia setup");e.setupRemoteMedia()}))}this.session.on("dtmf",(function(t,r){e.emit("dtmf",r.tone)}));this.session.on("bye",(function(){return e.onEnded()}))};Simple.prototype.onProgress=function(){this.state=o.STATUS_CONNECTING;this.emit("connecting",this.session)};Simple.prototype.onFailed=function(){this.onEnded()};Simple.prototype.onEnded=function(){this.state=o.STATUS_COMPLETED;this.emit("ended",this.session);this.cleanupMedia()};Simple.C=o;return Simple}(n.EventEmitter);t.Simple=u},534356:function(e,t,r){"use strict";var i=this&&this.__extends||function(){var extendStatics=function(e,t){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r]};return extendStatics(e,t)};return function(e,t){extendStatics(e,t);function __(){this.constructor=e}e.prototype=t===null?Object.create(t):(__.prototype=t.prototype,new __)}}();Object.defineProperty(t,"__esModule",{value:true});var n=r(130523);var a=r(325840);var s=r(179089);var o=r(38187);var u=r(669825);var c;(function(e){e[e["STATUS_CONNECTING"]=0]="STATUS_CONNECTING";e[e["STATUS_OPEN"]=1]="STATUS_OPEN";e[e["STATUS_CLOSING"]=2]="STATUS_CLOSING";e[e["STATUS_CLOSED"]=3]="STATUS_CLOSED"})(c=t.TransportStatus||(t.TransportStatus={}));var computeKeepAliveTimeout=function(e){var t=e*.8;return 1e3*(Math.random()*(e-t)+t)};var l=function(e){i(Transport,e);function Transport(t,i){if(i===void 0){i={}}var a=e.call(this,t,i)||this;a.WebSocket=(r.g.window||r.g).WebSocket;a.type=n.TypeStrings.Transport;a.reconnectionAttempts=0;a.status=c.STATUS_CONNECTING;a.configuration={};a.loadConfig(i);return a}Transport.prototype.isConnected=function(){return this.status===c.STATUS_OPEN};Transport.prototype.sendPromise=function(e,t){if(t===void 0){t={}}if(!this.statusAssert(c.STATUS_OPEN,t.force)){this.onError("unable to send message - WebSocket not open");return Promise.reject()}var r=e.toString();if(this.ws){if(this.configuration.traceSip===true){this.logger.log("sending WebSocket message:\n\n"+r+"\n")}this.ws.send(r);return Promise.resolve({msg:r})}else{this.onError("unable to send message - WebSocket does not exist");return Promise.reject()}};Transport.prototype.disconnectPromise=function(e){var t=this;if(e===void 0){e={}}if(this.disconnectionPromise){return this.disconnectionPromise}e.code=e.code||1e3;if(!this.statusTransition(c.STATUS_CLOSING,e.force)){if(this.status===c.STATUS_CLOSED){return Promise.resolve({overrideEvent:true})}else if(this.connectionPromise){return this.connectionPromise.then((function(){return Promise.reject("The websocket did not disconnect")})).catch((function(){return Promise.resolve({overrideEvent:true})}))}else{return Promise.reject("The websocket did not disconnect")}}this.emit("disconnecting");this.disconnectionPromise=new Promise((function(r,i){t.disconnectDeferredResolve=r;if(t.reconnectTimer){clearTimeout(t.reconnectTimer);t.reconnectTimer=undefined}if(t.ws){t.stopSendingKeepAlives();t.logger.log("closing WebSocket "+t.server.wsUri);t.ws.close(e.code,e.reason)}else{i("Attempted to disconnect but the websocket doesn't exist")}}));return this.disconnectionPromise};Transport.prototype.connectPromise=function(e){var t=this;if(e===void 0){e={}}if(this.status===c.STATUS_CLOSING&&!e.force){return Promise.reject("WebSocket "+this.server.wsUri+" is closing")}if(this.connectionPromise){return this.connectionPromise}this.server=this.server||this.getNextWsServer(e.force);this.connectionPromise=new Promise((function(r,i){if((t.status===c.STATUS_OPEN||t.status===c.STATUS_CLOSING)&&!e.force){t.logger.warn("WebSocket "+t.server.wsUri+" is already connected");i("Failed status check - attempted to open a connection but already open/closing");return}t.connectDeferredResolve=r;t.status=c.STATUS_CONNECTING;t.emit("connecting");t.logger.log("connecting to WebSocket "+t.server.wsUri);t.disposeWs();try{t.ws=new WebSocket(t.server.wsUri,"sip")}catch(e){t.ws=null;t.status=c.STATUS_CLOSED;t.onError("error connecting to WebSocket "+t.server.wsUri+":"+e);i("Failed to create a websocket");return}if(!t.ws){i("Unexpected instance websocket not set");return}t.connectionTimeout=setTimeout((function(){t.statusTransition(c.STATUS_CLOSED);t.logger.warn("took too long to connect - exceeded time set in configuration.connectionTimeout: "+t.configuration.connectionTimeout+"s");t.emit("disconnected",{code:1e3});t.connectionPromise=undefined;i("Connection timeout")}),t.configuration.connectionTimeout*1e3);t.boundOnOpen=t.onOpen.bind(t);t.boundOnMessage=t.onMessage.bind(t);t.boundOnClose=t.onClose.bind(t);t.boundOnError=t.onWebsocketError.bind(t);t.ws.addEventListener("open",t.boundOnOpen);t.ws.addEventListener("message",t.boundOnMessage);t.ws.addEventListener("close",t.boundOnClose);t.ws.addEventListener("error",t.boundOnError)}));return this.connectionPromise};Transport.prototype.onMessage=function(e){var t=e.data;var r;if(/^(\r\n)+$/.test(t)){this.clearKeepAliveTimeout();if(this.configuration.traceSip===true){this.logger.log("received WebSocket message with CRLF Keep Alive response")}return}else if(!t){this.logger.warn("received empty message, message discarded");return}else if(typeof t!=="string"){try{r=String.fromCharCode.apply(null,new Uint8Array(t))}catch(e){this.logger.warn("received WebSocket binary message failed to be converted into string, message discarded");return}if(this.configuration.traceSip===true){this.logger.log("received WebSocket binary message:\n\n"+t+"\n")}}else{if(this.configuration.traceSip===true){this.logger.log("received WebSocket text message:\n\n"+t+"\n")}r=t}this.emit("message",r)};Transport.prototype.onOpen=function(){if(this.status===c.STATUS_CLOSED){var e=this.ws;this.disposeWs();e.close(1e3);return}this.status=c.STATUS_OPEN;this.emit("connected");if(this.connectionTimeout){clearTimeout(this.connectionTimeout);this.connectionTimeout=undefined}this.logger.log("WebSocket "+this.server.wsUri+" connected");if(this.reconnectTimer!==undefined){clearTimeout(this.reconnectTimer);this.reconnectTimer=undefined}this.reconnectionAttempts=0;this.disconnectionPromise=undefined;this.disconnectDeferredResolve=undefined;this.startSendingKeepAlives();if(this.connectDeferredResolve){this.connectDeferredResolve({overrideEvent:true})}else{this.logger.warn("Unexpected websocket.onOpen with no connectDeferredResolve")}};Transport.prototype.onClose=function(e){this.logger.log("WebSocket disconnected (code: "+e.code+(e.reason?"| reason: "+e.reason:"")+")");if(this.status!==c.STATUS_CLOSING){this.logger.warn("WebSocket closed without SIP.js requesting it");this.emit("transportError")}this.stopSendingKeepAlives();if(this.connectionTimeout){clearTimeout(this.connectionTimeout)}this.connectionTimeout=undefined;this.connectionPromise=undefined;this.connectDeferredResolve=undefined;if(this.disconnectDeferredResolve){this.disconnectDeferredResolve({overrideEvent:true});this.statusTransition(c.STATUS_CLOSED);this.disconnectDeferredResolve=undefined;return}this.status=c.STATUS_CLOSED;this.emit("disconnected",{code:e.code,reason:e.reason});this.reconnect()};Transport.prototype.disposeWs=function(){if(this.ws){this.ws.removeEventListener("open",this.boundOnOpen);this.ws.removeEventListener("message",this.boundOnMessage);this.ws.removeEventListener("close",this.boundOnClose);this.ws.removeEventListener("error",this.boundOnError);this.ws=undefined}};Transport.prototype.onError=function(e){this.logger.warn("Transport error: "+e);this.emit("transportError")};Transport.prototype.onWebsocketError=function(){this.onError("The Websocket had an error")};Transport.prototype.reconnect=function(){var e=this;if(this.reconnectionAttempts>0){this.logger.log("Reconnection attempt "+this.reconnectionAttempts+" failed")}if(this.noAvailableServers()){this.logger.warn("no available ws servers left - going to closed state");this.status=c.STATUS_CLOSED;this.emit("closed");this.resetServerErrorStatus();return}if(this.isConnected()){this.logger.warn("attempted to reconnect while connected - forcing disconnect");this.disconnect({force:true})}this.reconnectionAttempts+=1;if(this.reconnectionAttempts>this.configuration.maxReconnectionAttempts){this.logger.warn("maximum reconnection attempts for WebSocket "+this.server.wsUri);this.logger.log("transport "+this.server.wsUri+" failed | connection state set to 'error'");this.server.isError=true;this.emit("transportError");this.server=this.getNextWsServer();this.reconnectionAttempts=0;this.reconnect()}else{this.logger.log("trying to reconnect to WebSocket "+this.server.wsUri+" (reconnection attempt "+this.reconnectionAttempts+")");this.reconnectTimer=setTimeout((function(){e.connect();e.reconnectTimer=undefined}),this.reconnectionAttempts===1?0:this.configuration.reconnectionTimeout*1e3)}};Transport.prototype.resetServerErrorStatus=function(){for(var e=0,t=this.configuration.wsServers;e<t.length;e++){var r=t[e];r.isError=false}};Transport.prototype.getNextWsServer=function(e){if(e===void 0){e=false}if(this.noAvailableServers()){this.logger.warn("attempted to get next ws server but there are no available ws servers left");return}var t=[];for(var r=0,i=this.configuration.wsServers;r<i.length;r++){var n=i[r];if(n.isError&&!e){continue}else if(t.length===0){t.push(n)}else if(n.weight>t[0].weight){t=[n]}else if(n.weight===t[0].weight){t.push(n)}}var a=Math.floor(Math.random()*t.length);return t[a]};Transport.prototype.noAvailableServers=function(){for(var e=0,t=this.configuration.wsServers;e<t.length;e++){var r=t[e];if(!r.isError){return false}}return true};Transport.prototype.sendKeepAlive=function(){var e=this;if(this.keepAliveDebounceTimeout){return}this.keepAliveDebounceTimeout=setTimeout((function(){e.emit("keepAliveDebounceTimeout");e.clearKeepAliveTimeout()}),this.configuration.keepAliveDebounce*1e3);return this.send("\r\n\r\n")};Transport.prototype.clearKeepAliveTimeout=function(){if(this.keepAliveDebounceTimeout){clearTimeout(this.keepAliveDebounceTimeout)}this.keepAliveDebounceTimeout=undefined};Transport.prototype.startSendingKeepAlives=function(){var e=this;if(this.configuration.keepAliveInterval&&!this.keepAliveInterval){this.keepAliveInterval=setInterval((function(){e.sendKeepAlive();e.startSendingKeepAlives()}),computeKeepAliveTimeout(this.configuration.keepAliveInterval))}};Transport.prototype.stopSendingKeepAlives=function(){if(this.keepAliveInterval){clearInterval(this.keepAliveInterval)}if(this.keepAliveDebounceTimeout){clearTimeout(this.keepAliveDebounceTimeout)}this.keepAliveInterval=undefined;this.keepAliveDebounceTimeout=undefined};Transport.prototype.statusAssert=function(e,t){if(e===this.status){return true}else{if(t){this.logger.warn("Attempted to assert "+Object.keys(c)[this.status]+" as "+Object.keys(c)[e]+"- continuing with option: 'force'");return true}else{this.logger.warn("Tried to assert "+Object.keys(c)[e]+" but is currently "+Object.keys(c)[this.status]);return false}}};Transport.prototype.statusTransition=function(e,t){if(t===void 0){t=false}this.logger.log("Attempting to transition status from "+Object.keys(c)[this.status]+" to "+Object.keys(c)[e]);if(e===c.STATUS_CONNECTING&&this.statusAssert(c.STATUS_CLOSED,t)||e===c.STATUS_OPEN&&this.statusAssert(c.STATUS_CONNECTING,t)||e===c.STATUS_CLOSING&&this.statusAssert(c.STATUS_OPEN,t)||e===c.STATUS_CLOSED){this.status=e;return true}else{this.logger.warn("Status transition failed - result: no-op - reason:"+" either gave an nonexistent status or attempted illegal transition");return false}};Transport.prototype.loadConfig=function(e){var t={wsServers:[{scheme:"WSS",sipUri:"<sip:edge.sip.onsip.com;transport=ws;lr>",weight:0,wsUri:"wss://edge.sip.onsip.com",isError:false}],connectionTimeout:5,maxReconnectionAttempts:3,reconnectionTimeout:4,keepAliveInterval:0,keepAliveDebounce:10,traceSip:false};var r=this.getConfigurationCheck();for(var i in r.mandatory){if(!e.hasOwnProperty(i)){throw new a.Exceptions.ConfigurationError(i)}else{var n=e[i];var s=r.mandatory[i](n);if(s!==undefined){t[i]=s}else{throw new a.Exceptions.ConfigurationError(i,n)}}}for(var i in r.optional){if(e.hasOwnProperty(i)){var n=e[i];if(n instanceof Array&&n.length===0||(n===null||n===""||n===undefined)||typeof n==="number"&&isNaN(n)){continue}var s=r.optional[i](n);if(s!==undefined){t[i]=s}else{throw new a.Exceptions.ConfigurationError(i,n)}}}var o={};for(var i in t){if(t.hasOwnProperty(i)){o[i]={value:t[i]}}}Object.defineProperties(this.configuration,o);this.logger.log("configuration parameters after validation:");for(var i in t){if(t.hasOwnProperty(i)){this.logger.log("\xb7 "+i+": "+JSON.stringify(t[i]))}}return};Transport.prototype.getConfigurationCheck=function(){return{mandatory:{},optional:{wsServers:function(e){if(typeof e==="string"){e=[{wsUri:e}]}else if(e instanceof Array){for(var t=0;t<e.length;t++){if(typeof e[t]==="string"){e[t]={wsUri:e[t]}}}}else{return}if(e.length===0){return false}for(var r=0,i=e;r<i.length;r++){var n=i[r];if(!n.wsUri){return}if(n.weight&&!Number(n.weight)){return}var a=s.Grammar.parse(n.wsUri,"absoluteURI");if(a===-1){return}else if(["wss","ws","udp"].indexOf(a.scheme)<0){return}else{n.sipUri="<sip:"+a.host+(a.port?":"+a.port:"")+";transport="+a.scheme.replace(/^wss$/i,"ws")+";lr>";if(!n.weight){n.weight=0}n.isError=false;n.scheme=a.scheme.toUpperCase()}}return e},keepAliveInterval:function(e){if(u.Utils.isDecimal(e)){var t=Number(e);if(t>0){return t}}},keepAliveDebounce:function(e){if(u.Utils.isDecimal(e)){var t=Number(e);if(t>0){return t}}},traceSip:function(e){if(typeof e==="boolean"){return e}},connectionTimeout:function(e){if(u.Utils.isDecimal(e)){var t=Number(e);if(t>0){return t}}},maxReconnectionAttempts:function(e){if(u.Utils.isDecimal(e)){var t=Number(e);if(t>=0){return t}}},reconnectionTimeout:function(e){if(u.Utils.isDecimal(e)){var t=Number(e);if(t>0){return t}}}}}};Transport.C=c;return Transport}(o.Transport);t.Transport=l},579283:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});var i=r(450745);t.Modifiers=i;var n=r(706211);t.Simple=n.Simple;var a=r(166578);t.SessionDescriptionHandler=a.SessionDescriptionHandler;var s=r(534356);t.Transport=s.Transport},654700:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});var i=r(513669);t.ClientContext=i.ClientContext;var n=r(846182);t.C=n.C;var a=r(122517);t.Dialog=a.Dialog;var s=r(670109);t.DigestAuthentication=s.DigestAuthentication;var o=r(130523);t.DialogStatus=o.DialogStatus;t.SessionStatus=o.SessionStatus;t.TransactionStatus=o.TransactionStatus;t.TypeStrings=o.TypeStrings;t.UAStatus=o.UAStatus;var u=r(325840);t.Exceptions=u.Exceptions;var c=r(179089);t.Grammar=c.Grammar;var l=r(47102);t.LoggerFactory=l.LoggerFactory;var f=r(444881);t.NameAddrHeader=f.NameAddrHeader;var p=r(890106);t.Parser=p.Parser;var d=r(60816);t.PublishContext=d.PublishContext;var h=r(70266);t.RegisterContext=h.RegisterContext;var g=r(15257);t.RequestSender=g.RequestSender;var v=r(338949);var m=v.SanityCheck.sanityCheck;t.sanityCheck=m;var y=r(662564);t.ServerContext=y.ServerContext;var S=r(124555);t.InviteClientContext=S.InviteClientContext;t.InviteServerContext=S.InviteServerContext;t.ReferClientContext=S.ReferClientContext;t.ReferServerContext=S.ReferServerContext;t.Session=S.Session;var T=r(130700);t.IncomingRequest=T.IncomingRequest;t.IncomingResponse=T.IncomingResponse;t.OutgoingRequest=T.OutgoingRequest;var b=r(453115);t.Subscription=b.Subscription;var _=r(753316);t.Timers=_.Timers;var C=r(670603);var A={AckClientTransaction:C.AckClientTransaction,checkTransaction:C.checkTransaction,InviteClientTransaction:C.InviteClientTransaction,InviteServerTransaction:C.InviteServerTransaction,NonInviteClientTransaction:C.NonInviteClientTransaction,NonInviteServerTransaction:C.NonInviteServerTransaction};t.Transactions=A;var E=r(38187);t.Transport=E.Transport;var I=r(318082);t.UA=I.UA;var R=r(822049);t.URI=R.URI;var w=r(669825);t.Utils=w.Utils;var $=r(579283);t.Web=$;var x=r(861508);var O=x.title;t.name=O;var D=x.version;t.version=D},586131:(e,t,r)=>{var i=r(378470),n=r(221098);var a=i(n,"DataView");e.exports=a},782475:(e,t,r)=>{var i=r(690967),n=r(215265),a=r(840478),s=r(245030),o=r(134364);function Hash(e){var t=-1,r=e==null?0:e.length;this.clear();while(++t<r){var i=e[t];this.set(i[0],i[1])}}Hash.prototype.clear=i;Hash.prototype["delete"]=n;Hash.prototype.get=a;Hash.prototype.has=s;Hash.prototype.set=o;e.exports=Hash},364191:(e,t,r)=>{var i=r(261081),n=r(284897),a=r(320610),s=r(252906),o=r(428515);function ListCache(e){var t=-1,r=e==null?0:e.length;this.clear();while(++t<r){var i=e[t];this.set(i[0],i[1])}}ListCache.prototype.clear=i;ListCache.prototype["delete"]=n;ListCache.prototype.get=a;ListCache.prototype.has=s;ListCache.prototype.set=o;e.exports=ListCache},618138:(e,t,r)=>{var i=r(378470),n=r(221098);var a=i(n,"Map");e.exports=a},802677:(e,t,r)=>{var i=r(129982),n=r(981637),a=r(350027),s=r(443782),o=r(998504);function MapCache(e){var t=-1,r=e==null?0:e.length;this.clear();while(++t<r){var i=e[t];this.set(i[0],i[1])}}MapCache.prototype.clear=i;MapCache.prototype["delete"]=n;MapCache.prototype.get=a;MapCache.prototype.has=s;MapCache.prototype.set=o;e.exports=MapCache},557592:(e,t,r)=>{var i=r(378470),n=r(221098);var a=i(n,"Promise");e.exports=a},702828:(e,t,r)=>{var i=r(378470),n=r(221098);var a=i(n,"Set");e.exports=a},552431:(e,t,r)=>{var i=r(802677),n=r(88300),a=r(156005);function SetCache(e){var t=-1,r=e==null?0:e.length;this.__data__=new i;while(++t<r){this.add(e[t])}}SetCache.prototype.add=SetCache.prototype.push=n;SetCache.prototype.has=a;e.exports=SetCache},706507:(e,t,r)=>{var i=r(364191),n=r(443286),a=r(388146),s=r(166571),o=r(750391),u=r(934874);function Stack(e){var t=this.__data__=new i(e);this.size=t.size}Stack.prototype.clear=n;Stack.prototype["delete"]=a;Stack.prototype.get=s;Stack.prototype.has=o;Stack.prototype.set=u;e.exports=Stack},175349:(e,t,r)=>{var i=r(221098);var n=i.Symbol;e.exports=n},574271:(e,t,r)=>{var i=r(221098);var n=i.Uint8Array;e.exports=n},976173:(e,t,r)=>{var i=r(378470),n=r(221098);var a=i(n,"WeakMap");e.exports=a},204353:e=>{function arrayFilter(e,t){var r=-1,i=e==null?0:e.length,n=0,a=[];while(++r<i){var s=e[r];if(t(s,r,e)){a[n++]=s}}return a}e.exports=arrayFilter},425322:(e,t,r)=>{var i=r(112359),n=r(671935),a=r(570809),s=r(690175),o=r(776262),u=r(296812);var c=Object.prototype;var l=c.hasOwnProperty;function arrayLikeKeys(e,t){var r=a(e),c=!r&&n(e),f=!r&&!c&&s(e),p=!r&&!c&&!f&&u(e),d=r||c||f||p,h=d?i(e.length,String):[],g=h.length;for(var v in e){if((t||l.call(e,v))&&!(d&&(v=="length"||f&&(v=="offset"||v=="parent")||p&&(v=="buffer"||v=="byteLength"||v=="byteOffset")||o(v,g)))){h.push(v)}}return h}e.exports=arrayLikeKeys},377345:e=>{function arrayPush(e,t){var r=-1,i=t.length,n=e.length;while(++r<i){e[n+r]=t[r]}return e}e.exports=arrayPush},401629:e=>{function arraySome(e,t){var r=-1,i=e==null?0:e.length;while(++r<i){if(t(e[r],r,e)){return true}}return false}e.exports=arraySome},651477:(e,t,r)=>{var i=r(626428);function assocIndexOf(e,t){var r=e.length;while(r--){if(i(e[r][0],t)){return r}}return-1}e.exports=assocIndexOf},977812:(e,t,r)=>{var i=r(377345),n=r(570809);function baseGetAllKeys(e,t,r){var a=t(e);return n(e)?a:i(a,r(e))}e.exports=baseGetAllKeys},106106:(e,t,r)=>{var i=r(175349),n=r(635871),a=r(680982);var s="[object Null]",o="[object Undefined]";var u=i?i.toStringTag:undefined;function baseGetTag(e){if(e==null){return e===undefined?o:s}return u&&u in Object(e)?n(e):a(e)}e.exports=baseGetTag},350619:(e,t,r)=>{var i=r(106106),n=r(106272);var a="[object Arguments]";function baseIsArguments(e){return n(e)&&i(e)==a}e.exports=baseIsArguments},194702:(e,t,r)=>{var i=r(962399),n=r(106272);function baseIsEqual(e,t,r,a,s){if(e===t){return true}if(e==null||t==null||!n(e)&&!n(t)){return e!==e&&t!==t}return i(e,t,r,a,baseIsEqual,s)}e.exports=baseIsEqual},962399:(e,t,r)=>{var i=r(706507),n=r(172894),a=r(728844),s=r(827964),o=r(788264),u=r(570809),c=r(690175),l=r(296812);var f=1;var p="[object Arguments]",d="[object Array]",h="[object Object]";var g=Object.prototype;var v=g.hasOwnProperty;function baseIsEqualDeep(e,t,r,g,m,y){var S=u(e),T=u(t),b=S?d:o(e),_=T?d:o(t);b=b==p?h:b;_=_==p?h:_;var C=b==h,A=_==h,E=b==_;if(E&&c(e)){if(!c(t)){return false}S=true;C=false}if(E&&!C){y||(y=new i);return S||l(e)?n(e,t,r,g,m,y):a(e,t,b,r,g,m,y)}if(!(r&f)){var I=C&&v.call(e,"__wrapped__"),R=A&&v.call(t,"__wrapped__");if(I||R){var w=I?e.value():e,$=R?t.value():t;y||(y=new i);return m(w,$,r,g,y)}}if(!E){return false}y||(y=new i);return s(e,t,r,g,m,y)}e.exports=baseIsEqualDeep},324479:(e,t,r)=>{var i=r(163429),n=r(154499),a=r(136947),s=r(203531);var o=/[\\^$.*+?()[\]{}|]/g;var u=/^\[object .+?Constructor\]$/;var c=Function.prototype,l=Object.prototype;var f=c.toString;var p=l.hasOwnProperty;var d=RegExp("^"+f.call(p).replace(o,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function baseIsNative(e){if(!a(e)||n(e)){return false}var t=i(e)?d:u;return t.test(s(e))}e.exports=baseIsNative},343294:(e,t,r)=>{var i=r(106106),n=r(537036),a=r(106272);var s="[object Arguments]",o="[object Array]",u="[object Boolean]",c="[object Date]",l="[object Error]",f="[object Function]",p="[object Map]",d="[object Number]",h="[object Object]",g="[object RegExp]",v="[object Set]",m="[object String]",y="[object WeakMap]";var S="[object ArrayBuffer]",T="[object DataView]",b="[object Float32Array]",_="[object Float64Array]",C="[object Int8Array]",A="[object Int16Array]",E="[object Int32Array]",I="[object Uint8Array]",R="[object Uint8ClampedArray]",w="[object Uint16Array]",$="[object Uint32Array]";var x={};x[b]=x[_]=x[C]=x[A]=x[E]=x[I]=x[R]=x[w]=x[$]=true;x[s]=x[o]=x[S]=x[u]=x[T]=x[c]=x[l]=x[f]=x[p]=x[d]=x[h]=x[g]=x[v]=x[m]=x[y]=false;function baseIsTypedArray(e){return a(e)&&n(e.length)&&!!x[i(e)]}e.exports=baseIsTypedArray},295288:(e,t,r)=>{var i=r(727876),n=r(343689);var a=Object.prototype;var s=a.hasOwnProperty;function baseKeys(e){if(!i(e)){return n(e)}var t=[];for(var r in Object(e)){if(s.call(e,r)&&r!="constructor"){t.push(r)}}return t}e.exports=baseKeys},112359:e=>{function baseTimes(e,t){var r=-1,i=Array(e);while(++r<e){i[r]=t(r)}return i}e.exports=baseTimes},561972:e=>{function baseUnary(e){return function(t){return e(t)}}e.exports=baseUnary},20886:e=>{function cacheHas(e,t){return e.has(t)}e.exports=cacheHas},354672:(e,t,r)=>{var i=r(221098);var n=i["__core-js_shared__"];e.exports=n},172894:(e,t,r)=>{var i=r(552431),n=r(401629),a=r(20886);var s=1,o=2;function equalArrays(e,t,r,u,c,l){var f=r&s,p=e.length,d=t.length;if(p!=d&&!(f&&d>p)){return false}var h=l.get(e);if(h&&l.get(t)){return h==t}var g=-1,v=true,m=r&o?new i:undefined;l.set(e,t);l.set(t,e);while(++g<p){var y=e[g],S=t[g];if(u){var T=f?u(S,y,g,t,e,l):u(y,S,g,e,t,l)}if(T!==undefined){if(T){continue}v=false;break}if(m){if(!n(t,(function(e,t){if(!a(m,t)&&(y===e||c(y,e,r,u,l))){return m.push(t)}}))){v=false;break}}else if(!(y===S||c(y,S,r,u,l))){v=false;break}}l["delete"](e);l["delete"](t);return v}e.exports=equalArrays},728844:(e,t,r)=>{var i=r(175349),n=r(574271),a=r(626428),s=r(172894),o=r(877955),u=r(85709);var c=1,l=2;var f="[object Boolean]",p="[object Date]",d="[object Error]",h="[object Map]",g="[object Number]",v="[object RegExp]",m="[object Set]",y="[object String]",S="[object Symbol]";var T="[object ArrayBuffer]",b="[object DataView]";var _=i?i.prototype:undefined,C=_?_.valueOf:undefined;function equalByTag(e,t,r,i,_,A,E){switch(r){case b:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset){return false}e=e.buffer;t=t.buffer;case T:if(e.byteLength!=t.byteLength||!A(new n(e),new n(t))){return false}return true;case f:case p:case g:return a(+e,+t);case d:return e.name==t.name&&e.message==t.message;case v:case y:return e==t+"";case h:var I=o;case m:var R=i&c;I||(I=u);if(e.size!=t.size&&!R){return false}var w=E.get(e);if(w){return w==t}i|=l;E.set(e,t);var $=s(I(e),I(t),i,_,A,E);E["delete"](e);return $;case S:if(C){return C.call(e)==C.call(t)}}return false}e.exports=equalByTag},827964:(e,t,r)=>{var i=r(397293);var n=1;var a=Object.prototype;var s=a.hasOwnProperty;function equalObjects(e,t,r,a,o,u){var c=r&n,l=i(e),f=l.length,p=i(t),d=p.length;if(f!=d&&!c){return false}var h=f;while(h--){var g=l[h];if(!(c?g in t:s.call(t,g))){return false}}var v=u.get(e);if(v&&u.get(t)){return v==t}var m=true;u.set(e,t);u.set(t,e);var y=c;while(++h<f){g=l[h];var S=e[g],T=t[g];if(a){var b=c?a(T,S,g,t,e,u):a(S,T,g,e,t,u)}if(!(b===undefined?S===T||o(S,T,r,a,u):b)){m=false;break}y||(y=g=="constructor")}if(m&&!y){var _=e.constructor,C=t.constructor;if(_!=C&&("constructor"in e&&"constructor"in t)&&!(typeof _=="function"&&_ instanceof _&&typeof C=="function"&&C instanceof C)){m=false}}u["delete"](e);u["delete"](t);return m}e.exports=equalObjects},204132:(e,t,r)=>{var i=typeof r.g=="object"&&r.g&&r.g.Object===Object&&r.g;e.exports=i},397293:(e,t,r)=>{var i=r(977812),n=r(47287),a=r(475593);function getAllKeys(e){return i(e,a,n)}e.exports=getAllKeys},607857:(e,t,r)=>{var i=r(245047);function getMapData(e,t){var r=e.__data__;return i(t)?r[typeof t=="string"?"string":"hash"]:r.map}e.exports=getMapData},378470:(e,t,r)=>{var i=r(324479),n=r(522155);function getNative(e,t){var r=n(e,t);return i(r)?r:undefined}e.exports=getNative},635871:(e,t,r)=>{var i=r(175349);var n=Object.prototype;var a=n.hasOwnProperty;var s=n.toString;var o=i?i.toStringTag:undefined;function getRawTag(e){var t=a.call(e,o),r=e[o];try{e[o]=undefined;var i=true}catch(e){}var n=s.call(e);if(i){if(t){e[o]=r}else{delete e[o]}}return n}e.exports=getRawTag},47287:(e,t,r)=>{var i=r(204353),n=r(152871);var a=Object.prototype;var s=a.propertyIsEnumerable;var o=Object.getOwnPropertySymbols;var u=!o?n:function(e){if(e==null){return[]}e=Object(e);return i(o(e),(function(t){return s.call(e,t)}))};e.exports=u},788264:(e,t,r)=>{var i=r(586131),n=r(618138),a=r(557592),s=r(702828),o=r(976173),u=r(106106),c=r(203531);var l="[object Map]",f="[object Object]",p="[object Promise]",d="[object Set]",h="[object WeakMap]";var g="[object DataView]";var v=c(i),m=c(n),y=c(a),S=c(s),T=c(o);var b=u;if(i&&b(new i(new ArrayBuffer(1)))!=g||n&&b(new n)!=l||a&&b(a.resolve())!=p||s&&b(new s)!=d||o&&b(new o)!=h){b=function(e){var t=u(e),r=t==f?e.constructor:undefined,i=r?c(r):"";if(i){switch(i){case v:return g;case m:return l;case y:return p;case S:return d;case T:return h}}return t}}e.exports=b},522155:e=>{function getValue(e,t){return e==null?undefined:e[t]}e.exports=getValue},690967:(e,t,r)=>{var i=r(108772);function hashClear(){this.__data__=i?i(null):{};this.size=0}e.exports=hashClear},215265:e=>{function hashDelete(e){var t=this.has(e)&&delete this.__data__[e];this.size-=t?1:0;return t}e.exports=hashDelete},840478:(e,t,r)=>{var i=r(108772);var n="__lodash_hash_undefined__";var a=Object.prototype;var s=a.hasOwnProperty;function hashGet(e){var t=this.__data__;if(i){var r=t[e];return r===n?undefined:r}return s.call(t,e)?t[e]:undefined}e.exports=hashGet},245030:(e,t,r)=>{var i=r(108772);var n=Object.prototype;var a=n.hasOwnProperty;function hashHas(e){var t=this.__data__;return i?t[e]!==undefined:a.call(t,e)}e.exports=hashHas},134364:(e,t,r)=>{var i=r(108772);var n="__lodash_hash_undefined__";function hashSet(e,t){var r=this.__data__;this.size+=this.has(e)?0:1;r[e]=i&&t===undefined?n:t;return this}e.exports=hashSet},776262:e=>{var t=9007199254740991;var r=/^(?:0|[1-9]\d*)$/;function isIndex(e,i){var n=typeof e;i=i==null?t:i;return!!i&&(n=="number"||n!="symbol"&&r.test(e))&&(e>-1&&e%1==0&&e<i)}e.exports=isIndex},245047:e=>{function isKeyable(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}e.exports=isKeyable},154499:(e,t,r)=>{var i=r(354672);var n=function(){var e=/[^.]+$/.exec(i&&i.keys&&i.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function isMasked(e){return!!n&&n in e}e.exports=isMasked},727876:e=>{var t=Object.prototype;function isPrototype(e){var r=e&&e.constructor,i=typeof r=="function"&&r.prototype||t;return e===i}e.exports=isPrototype},261081:e=>{function listCacheClear(){this.__data__=[];this.size=0}e.exports=listCacheClear},284897:(e,t,r)=>{var i=r(651477);var n=Array.prototype;var a=n.splice;function listCacheDelete(e){var t=this.__data__,r=i(t,e);if(r<0){return false}var n=t.length-1;if(r==n){t.pop()}else{a.call(t,r,1)}--this.size;return true}e.exports=listCacheDelete},320610:(e,t,r)=>{var i=r(651477);function listCacheGet(e){var t=this.__data__,r=i(t,e);return r<0?undefined:t[r][1]}e.exports=listCacheGet},252906:(e,t,r)=>{var i=r(651477);function listCacheHas(e){return i(this.__data__,e)>-1}e.exports=listCacheHas},428515:(e,t,r)=>{var i=r(651477);function listCacheSet(e,t){var r=this.__data__,n=i(r,e);if(n<0){++this.size;r.push([e,t])}else{r[n][1]=t}return this}e.exports=listCacheSet},129982:(e,t,r)=>{var i=r(782475),n=r(364191),a=r(618138);function mapCacheClear(){this.size=0;this.__data__={hash:new i,map:new(a||n),string:new i}}e.exports=mapCacheClear},981637:(e,t,r)=>{var i=r(607857);function mapCacheDelete(e){var t=i(this,e)["delete"](e);this.size-=t?1:0;return t}e.exports=mapCacheDelete},350027:(e,t,r)=>{var i=r(607857);function mapCacheGet(e){return i(this,e).get(e)}e.exports=mapCacheGet},443782:(e,t,r)=>{var i=r(607857);function mapCacheHas(e){return i(this,e).has(e)}e.exports=mapCacheHas},998504:(e,t,r)=>{var i=r(607857);function mapCacheSet(e,t){var r=i(this,e),n=r.size;r.set(e,t);this.size+=r.size==n?0:1;return this}e.exports=mapCacheSet},877955:e=>{function mapToArray(e){var t=-1,r=Array(e.size);e.forEach((function(e,i){r[++t]=[i,e]}));return r}e.exports=mapToArray},108772:(e,t,r)=>{var i=r(378470);var n=i(Object,"create");e.exports=n},343689:(e,t,r)=>{var i=r(533598);var n=i(Object.keys,Object);e.exports=n},423601:(e,t,r)=>{e=r.nmd(e);var i=r(204132);var n=true&&t&&!t.nodeType&&t;var a=n&&"object"=="object"&&e&&!e.nodeType&&e;var s=a&&a.exports===n;var o=s&&i.process;var u=function(){try{var e=a&&a.require&&a.require("util").types;if(e){return e}return o&&o.binding&&o.binding("util")}catch(e){}}();e.exports=u},680982:e=>{var t=Object.prototype;var r=t.toString;function objectToString(e){return r.call(e)}e.exports=objectToString},533598:e=>{function overArg(e,t){return function(r){return e(t(r))}}e.exports=overArg},221098:(e,t,r)=>{var i=r(204132);var n=typeof self=="object"&&self&&self.Object===Object&&self;var a=i||n||Function("return this")();e.exports=a},88300:e=>{var t="__lodash_hash_undefined__";function setCacheAdd(e){this.__data__.set(e,t);return this}e.exports=setCacheAdd},156005:e=>{function setCacheHas(e){return this.__data__.has(e)}e.exports=setCacheHas},85709:e=>{function setToArray(e){var t=-1,r=Array(e.size);e.forEach((function(e){r[++t]=e}));return r}e.exports=setToArray},443286:(e,t,r)=>{var i=r(364191);function stackClear(){this.__data__=new i;this.size=0}e.exports=stackClear},388146:e=>{function stackDelete(e){var t=this.__data__,r=t["delete"](e);this.size=t.size;return r}e.exports=stackDelete},166571:e=>{function stackGet(e){return this.__data__.get(e)}e.exports=stackGet},750391:e=>{function stackHas(e){return this.__data__.has(e)}e.exports=stackHas},934874:(e,t,r)=>{var i=r(364191),n=r(618138),a=r(802677);var s=200;function stackSet(e,t){var r=this.__data__;if(r instanceof i){var o=r.__data__;if(!n||o.length<s-1){o.push([e,t]);this.size=++r.size;return this}r=this.__data__=new a(o)}r.set(e,t);this.size=r.size;return this}e.exports=stackSet},203531:e=>{var t=Function.prototype;var r=t.toString;function toSource(e){if(e!=null){try{return r.call(e)}catch(e){}try{return e+""}catch(e){}}return""}e.exports=toSource},626428:e=>{function eq(e,t){return e===t||e!==e&&t!==t}e.exports=eq},671935:(e,t,r)=>{var i=r(350619),n=r(106272);var a=Object.prototype;var s=a.hasOwnProperty;var o=a.propertyIsEnumerable;var u=i(function(){return arguments}())?i:function(e){return n(e)&&s.call(e,"callee")&&!o.call(e,"callee")};e.exports=u},570809:e=>{var t=Array.isArray;e.exports=t},744212:(e,t,r)=>{var i=r(163429),n=r(537036);function isArrayLike(e){return e!=null&&n(e.length)&&!i(e)}e.exports=isArrayLike},690175:(e,t,r)=>{e=r.nmd(e);var i=r(221098),n=r(716912);var a=true&&t&&!t.nodeType&&t;var s=a&&"object"=="object"&&e&&!e.nodeType&&e;var o=s&&s.exports===a;var u=o?i.Buffer:undefined;var c=u?u.isBuffer:undefined;var l=c||n;e.exports=l},738954:(e,t,r)=>{var i=r(194702);function isEqual(e,t){return i(e,t)}e.exports=isEqual},163429:(e,t,r)=>{var i=r(106106),n=r(136947);var a="[object AsyncFunction]",s="[object Function]",o="[object GeneratorFunction]",u="[object Proxy]";function isFunction(e){if(!n(e)){return false}var t=i(e);return t==s||t==o||t==a||t==u}e.exports=isFunction},537036:e=>{var t=9007199254740991;function isLength(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=t}e.exports=isLength},136947:e=>{function isObject(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}e.exports=isObject},106272:e=>{function isObjectLike(e){return e!=null&&typeof e=="object"}e.exports=isObjectLike},296812:(e,t,r)=>{var i=r(343294),n=r(561972),a=r(423601);var s=a&&a.isTypedArray;var o=s?n(s):i;e.exports=o},475593:(e,t,r)=>{var i=r(425322),n=r(295288),a=r(744212);function keys(e){return a(e)?i(e):n(e)}e.exports=keys},271170:function(e,t,r){e=r.nmd(e);var i;(function(){var n;var a="4.17.15";var s=200;var o="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",u="Expected a function";var c="__lodash_hash_undefined__";var l=500;var f="__lodash_placeholder__";var p=1,d=2,h=4;var g=1,v=2;var m=1,y=2,S=4,T=8,b=16,_=32,C=64,A=128,E=256,I=512;var R=30,w="...";var $=800,x=16;var O=1,D=2,k=3;var N=1/0,U=9007199254740991,L=17976931348623157e292,P=0/0;var M=4294967295,H=M-1,q=M>>>1;var j=[["ary",A],["bind",m],["bindKey",y],["curry",T],["curryRight",b],["flip",I],["partial",_],["partialRight",C],["rearg",E]];var F="[object Arguments]",B="[object Array]",W="[object AsyncFunction]",G="[object Boolean]",z="[object Date]",K="[object DOMException]",V="[object Error]",Y="[object Function]",Q="[object GeneratorFunction]",J="[object Map]",X="[object Number]",Z="[object Null]",ee="[object Object]",te="[object Promise]",re="[object Proxy]",ie="[object RegExp]",ne="[object Set]",ae="[object String]",se="[object Symbol]",oe="[object Undefined]",ue="[object WeakMap]",ce="[object WeakSet]";var le="[object ArrayBuffer]",fe="[object DataView]",pe="[object Float32Array]",de="[object Float64Array]",he="[object Int8Array]",ge="[object Int16Array]",ve="[object Int32Array]",me="[object Uint8Array]",ye="[object Uint8ClampedArray]",Se="[object Uint16Array]",Te="[object Uint32Array]";var be=/\b__p \+= '';/g,_e=/\b(__p \+=) '' \+/g,Ce=/(__e\(.*?\)|\b__t\)) \+\n'';/g;var Ae=/&(?:amp|lt|gt|quot|#39);/g,Ee=/[&<>"']/g,Ie=RegExp(Ae.source),Re=RegExp(Ee.source);var we=/<%-([\s\S]+?)%>/g,$e=/<%([\s\S]+?)%>/g,xe=/<%=([\s\S]+?)%>/g;var Oe=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,De=/^\w*$/,ke=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g;var Ne=/[\\^$.*+?()[\]{}|]/g,Ue=RegExp(Ne.source);var Le=/^\s+|\s+$/g,Pe=/^\s+/,Me=/\s+$/;var He=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,qe=/\{\n\/\* \[wrapped with (.+)\] \*/,je=/,? & /;var Fe=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g;var Be=/\\(\\)?/g;var We=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g;var Ge=/\w*$/;var ze=/^[-+]0x[0-9a-f]+$/i;var Ke=/^0b[01]+$/i;var Ve=/^\[object .+?Constructor\]$/;var Ye=/^0o[0-7]+$/i;var Qe=/^(?:0|[1-9]\d*)$/;var Je=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g;var Xe=/($^)/;var Ze=/['\n\r\u2028\u2029\\]/g;var et="\\ud800-\\udfff",tt="\\u0300-\\u036f",rt="\\ufe20-\\ufe2f",it="\\u20d0-\\u20ff",nt=tt+rt+it,at="\\u2700-\\u27bf",st="a-z\\xdf-\\xf6\\xf8-\\xff",ot="\\xac\\xb1\\xd7\\xf7",ut="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",ct="\\u2000-\\u206f",lt=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",ft="A-Z\\xc0-\\xd6\\xd8-\\xde",pt="\\ufe0e\\ufe0f",dt=ot+ut+ct+lt;var ht="['\u2019]",gt="["+et+"]",vt="["+dt+"]",mt="["+nt+"]",yt="\\d+",St="["+at+"]",Tt="["+st+"]",bt="[^"+et+dt+yt+at+st+ft+"]",_t="\\ud83c[\\udffb-\\udfff]",Ct="(?:"+mt+"|"+_t+")",At="[^"+et+"]",Et="(?:\\ud83c[\\udde6-\\uddff]){2}",It="[\\ud800-\\udbff][\\udc00-\\udfff]",Rt="["+ft+"]",wt="\\u200d";var $t="(?:"+Tt+"|"+bt+")",xt="(?:"+Rt+"|"+bt+")",Ot="(?:"+ht+"(?:d|ll|m|re|s|t|ve))?",Dt="(?:"+ht+"(?:D|LL|M|RE|S|T|VE))?",kt=Ct+"?",Nt="["+pt+"]?",Ut="(?:"+wt+"(?:"+[At,Et,It].join("|")+")"+Nt+kt+")*",Lt="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Pt="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",Mt=Nt+kt+Ut,Ht="(?:"+[St,Et,It].join("|")+")"+Mt,qt="(?:"+[At+mt+"?",mt,Et,It,gt].join("|")+")";var jt=RegExp(ht,"g");var Ft=RegExp(mt,"g");var Bt=RegExp(_t+"(?="+_t+")|"+qt+Mt,"g");var Wt=RegExp([Rt+"?"+Tt+"+"+Ot+"(?="+[vt,Rt,"$"].join("|")+")",xt+"+"+Dt+"(?="+[vt,Rt+$t,"$"].join("|")+")",Rt+"?"+$t+"+"+Ot,Rt+"+"+Dt,Pt,Lt,yt,Ht].join("|"),"g");var Gt=RegExp("["+wt+et+nt+pt+"]");var zt=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/;var Kt=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"];var Vt=-1;var Yt={};Yt[pe]=Yt[de]=Yt[he]=Yt[ge]=Yt[ve]=Yt[me]=Yt[ye]=Yt[Se]=Yt[Te]=true;Yt[F]=Yt[B]=Yt[le]=Yt[G]=Yt[fe]=Yt[z]=Yt[V]=Yt[Y]=Yt[J]=Yt[X]=Yt[ee]=Yt[ie]=Yt[ne]=Yt[ae]=Yt[ue]=false;var Qt={};Qt[F]=Qt[B]=Qt[le]=Qt[fe]=Qt[G]=Qt[z]=Qt[pe]=Qt[de]=Qt[he]=Qt[ge]=Qt[ve]=Qt[J]=Qt[X]=Qt[ee]=Qt[ie]=Qt[ne]=Qt[ae]=Qt[se]=Qt[me]=Qt[ye]=Qt[Se]=Qt[Te]=true;Qt[V]=Qt[Y]=Qt[ue]=false;var Jt={\u00c0:"A",\u00c1:"A",\u00c2:"A",\u00c3:"A",\u00c4:"A",\u00c5:"A",\u00e0:"a",\u00e1:"a",\u00e2:"a",\u00e3:"a",\u00e4:"a",\u00e5:"a",\u00c7:"C",\u00e7:"c",\u00d0:"D",\u00f0:"d",\u00c8:"E",\u00c9:"E",\u00ca:"E",\u00cb:"E",\u00e8:"e",\u00e9:"e",\u00ea:"e",\u00eb:"e",\u00cc:"I",\u00cd:"I",\u00ce:"I",\u00cf:"I",\u00ec:"i",\u00ed:"i",\u00ee:"i",\u00ef:"i",\u00d1:"N",\u00f1:"n",\u00d2:"O",\u00d3:"O",\u00d4:"O",\u00d5:"O",\u00d6:"O",\u00d8:"O",\u00f2:"o",\u00f3:"o",\u00f4:"o",\u00f5:"o",\u00f6:"o",\u00f8:"o",\u00d9:"U",\u00da:"U",\u00db:"U",\u00dc:"U",\u00f9:"u",\u00fa:"u",\u00fb:"u",\u00fc:"u",\u00dd:"Y",\u00fd:"y",\u00ff:"y",\u00c6:"Ae",\u00e6:"ae",\u00de:"Th",\u00fe:"th",\u00df:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010a:"C",\u010c:"C",\u0107:"c",\u0109:"c",\u010b:"c",\u010d:"c",\u010e:"D",\u0110:"D",\u010f:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011a:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011b:"e",\u011c:"G",\u011e:"G",\u0120:"G",\u0122:"G",\u011d:"g",\u011f:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012a:"I",\u012c:"I",\u012e:"I",\u0130:"I",\u0129:"i",\u012b:"i",\u012d:"i",\u012f:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013b:"L",\u013d:"L",\u013f:"L",\u0141:"L",\u013a:"l",\u013c:"l",\u013e:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014a:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014b:"n",\u014c:"O",\u014e:"O",\u0150:"O",\u014d:"o",\u014f:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015a:"S",\u015c:"S",\u015e:"S",\u0160:"S",\u015b:"s",\u015d:"s",\u015f:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016a:"U",\u016c:"U",\u016e:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016b:"u",\u016d:"u",\u016f:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017b:"Z",\u017d:"Z",\u017a:"z",\u017c:"z",\u017e:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017f:"s"};var Xt={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};var Zt={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"};var er={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"};var tr=parseFloat,rr=parseInt;var ir=typeof r.g=="object"&&r.g&&r.g.Object===Object&&r.g;var nr=typeof self=="object"&&self&&self.Object===Object&&self;var ar=ir||nr||Function("return this")();var sr=true&&t&&!t.nodeType&&t;var or=sr&&"object"=="object"&&e&&!e.nodeType&&e;var ur=or&&or.exports===sr;var cr=ur&&ir.process;var lr=function(){try{var e=or&&or.require&&or.require("util").types;if(e){return e}return cr&&cr.binding&&cr.binding("util")}catch(e){}}();var fr=lr&&lr.isArrayBuffer,pr=lr&&lr.isDate,dr=lr&&lr.isMap,hr=lr&&lr.isRegExp,gr=lr&&lr.isSet,vr=lr&&lr.isTypedArray;function apply(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}function arrayAggregator(e,t,r,i){var n=-1,a=e==null?0:e.length;while(++n<a){var s=e[n];t(i,s,r(s),e)}return i}function arrayEach(e,t){var r=-1,i=e==null?0:e.length;while(++r<i){if(t(e[r],r,e)===false){break}}return e}function arrayEachRight(e,t){var r=e==null?0:e.length;while(r--){if(t(e[r],r,e)===false){break}}return e}function arrayEvery(e,t){var r=-1,i=e==null?0:e.length;while(++r<i){if(!t(e[r],r,e)){return false}}return true}function arrayFilter(e,t){var r=-1,i=e==null?0:e.length,n=0,a=[];while(++r<i){var s=e[r];if(t(s,r,e)){a[n++]=s}}return a}function arrayIncludes(e,t){var r=e==null?0:e.length;return!!r&&baseIndexOf(e,t,0)>-1}function arrayIncludesWith(e,t,r){var i=-1,n=e==null?0:e.length;while(++i<n){if(r(t,e[i])){return true}}return false}function arrayMap(e,t){var r=-1,i=e==null?0:e.length,n=Array(i);while(++r<i){n[r]=t(e[r],r,e)}return n}function arrayPush(e,t){var r=-1,i=t.length,n=e.length;while(++r<i){e[n+r]=t[r]}return e}function arrayReduce(e,t,r,i){var n=-1,a=e==null?0:e.length;if(i&&a){r=e[++n]}while(++n<a){r=t(r,e[n],n,e)}return r}function arrayReduceRight(e,t,r,i){var n=e==null?0:e.length;if(i&&n){r=e[--n]}while(n--){r=t(r,e[n],n,e)}return r}function arraySome(e,t){var r=-1,i=e==null?0:e.length;while(++r<i){if(t(e[r],r,e)){return true}}return false}var mr=baseProperty("length");function asciiToArray(e){return e.split("")}function asciiWords(e){return e.match(Fe)||[]}function baseFindKey(e,t,r){var i;r(e,(function(e,r,n){if(t(e,r,n)){i=r;return false}}));return i}function baseFindIndex(e,t,r,i){var n=e.length,a=r+(i?1:-1);while(i?a--:++a<n){if(t(e[a],a,e)){return a}}return-1}function baseIndexOf(e,t,r){return t===t?strictIndexOf(e,t,r):baseFindIndex(e,baseIsNaN,r)}function baseIndexOfWith(e,t,r,i){var n=r-1,a=e.length;while(++n<a){if(i(e[n],t)){return n}}return-1}function baseIsNaN(e){return e!==e}function baseMean(e,t){var r=e==null?0:e.length;return r?baseSum(e,t)/r:P}function baseProperty(e){return function(t){return t==null?n:t[e]}}function basePropertyOf(e){return function(t){return e==null?n:e[t]}}function baseReduce(e,t,r,i,n){n(e,(function(e,n,a){r=i?(i=false,e):t(r,e,n,a)}));return r}function baseSortBy(e,t){var r=e.length;e.sort(t);while(r--){e[r]=e[r].value}return e}function baseSum(e,t){var r,i=-1,a=e.length;while(++i<a){var s=t(e[i]);if(s!==n){r=r===n?s:r+s}}return r}function baseTimes(e,t){var r=-1,i=Array(e);while(++r<e){i[r]=t(r)}return i}function baseToPairs(e,t){return arrayMap(t,(function(t){return[t,e[t]]}))}function baseUnary(e){return function(t){return e(t)}}function baseValues(e,t){return arrayMap(t,(function(t){return e[t]}))}function cacheHas(e,t){return e.has(t)}function charsStartIndex(e,t){var r=-1,i=e.length;while(++r<i&&baseIndexOf(t,e[r],0)>-1){}return r}function charsEndIndex(e,t){var r=e.length;while(r--&&baseIndexOf(t,e[r],0)>-1){}return r}function countHolders(e,t){var r=e.length,i=0;while(r--){if(e[r]===t){++i}}return i}var yr=basePropertyOf(Jt);var Sr=basePropertyOf(Xt);function escapeStringChar(e){return"\\"+er[e]}function getValue(e,t){return e==null?n:e[t]}function hasUnicode(e){return Gt.test(e)}function hasUnicodeWord(e){return zt.test(e)}function iteratorToArray(e){var t,r=[];while(!(t=e.next()).done){r.push(t.value)}return r}function mapToArray(e){var t=-1,r=Array(e.size);e.forEach((function(e,i){r[++t]=[i,e]}));return r}function overArg(e,t){return function(r){return e(t(r))}}function replaceHolders(e,t){var r=-1,i=e.length,n=0,a=[];while(++r<i){var s=e[r];if(s===t||s===f){e[r]=f;a[n++]=r}}return a}function setToArray(e){var t=-1,r=Array(e.size);e.forEach((function(e){r[++t]=e}));return r}function setToPairs(e){var t=-1,r=Array(e.size);e.forEach((function(e){r[++t]=[e,e]}));return r}function strictIndexOf(e,t,r){var i=r-1,n=e.length;while(++i<n){if(e[i]===t){return i}}return-1}function strictLastIndexOf(e,t,r){var i=r+1;while(i--){if(e[i]===t){return i}}return i}function stringSize(e){return hasUnicode(e)?unicodeSize(e):mr(e)}function stringToArray(e){return hasUnicode(e)?unicodeToArray(e):asciiToArray(e)}var Tr=basePropertyOf(Zt);function unicodeSize(e){var t=Bt.lastIndex=0;while(Bt.test(e)){++t}return t}function unicodeToArray(e){return e.match(Bt)||[]}function unicodeWords(e){return e.match(Wt)||[]}var br=function runInContext(e){e=e==null?ar:_r.defaults(ar.Object(),e,_r.pick(ar,Kt));var t=e.Array,r=e.Date,i=e.Error,Fe=e.Function,et=e.Math,tt=e.Object,rt=e.RegExp,it=e.String,nt=e.TypeError;var at=t.prototype,st=Fe.prototype,ot=tt.prototype;var ut=e["__core-js_shared__"];var ct=st.toString;var lt=ot.hasOwnProperty;var ft=0;var pt=function(){var e=/[^.]+$/.exec(ut&&ut.keys&&ut.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();var dt=ot.toString;var ht=ct.call(tt);var gt=ar._;var vt=rt("^"+ct.call(lt).replace(Ne,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");var mt=ur?e.Buffer:n,yt=e.Symbol,St=e.Uint8Array,Tt=mt?mt.allocUnsafe:n,bt=overArg(tt.getPrototypeOf,tt),_t=tt.create,Ct=ot.propertyIsEnumerable,At=at.splice,Et=yt?yt.isConcatSpreadable:n,It=yt?yt.iterator:n,Rt=yt?yt.toStringTag:n;var wt=function(){try{var e=getNative(tt,"defineProperty");e({},"",{});return e}catch(e){}}();var $t=e.clearTimeout!==ar.clearTimeout&&e.clearTimeout,xt=r&&r.now!==ar.Date.now&&r.now,Ot=e.setTimeout!==ar.setTimeout&&e.setTimeout;var Dt=et.ceil,kt=et.floor,Nt=tt.getOwnPropertySymbols,Ut=mt?mt.isBuffer:n,Lt=e.isFinite,Pt=at.join,Mt=overArg(tt.keys,tt),Ht=et.max,qt=et.min,Bt=r.now,Wt=e.parseInt,Gt=et.random,zt=at.reverse;var Jt=getNative(e,"DataView"),Xt=getNative(e,"Map"),Zt=getNative(e,"Promise"),er=getNative(e,"Set"),ir=getNative(e,"WeakMap"),nr=getNative(tt,"create");var sr=ir&&new ir;var or={};var cr=toSource(Jt),lr=toSource(Xt),mr=toSource(Zt),br=toSource(er),Cr=toSource(ir);var Ar=yt?yt.prototype:n,Er=Ar?Ar.valueOf:n,Ir=Ar?Ar.toString:n;function lodash(e){if(isObjectLike(e)&&!xi(e)&&!(e instanceof LazyWrapper)){if(e instanceof LodashWrapper){return e}if(lt.call(e,"__wrapped__")){return wrapperClone(e)}}return new LodashWrapper(e)}var Rr=function(){function object(){}return function(e){if(!isObject(e)){return{}}if(_t){return _t(e)}object.prototype=e;var t=new object;object.prototype=n;return t}}();function baseLodash(){}function LodashWrapper(e,t){this.__wrapped__=e;this.__actions__=[];this.__chain__=!!t;this.__index__=0;this.__values__=n}lodash.templateSettings={escape:we,evaluate:$e,interpolate:xe,variable:"",imports:{_:lodash}};lodash.prototype=baseLodash.prototype;lodash.prototype.constructor=lodash;LodashWrapper.prototype=Rr(baseLodash.prototype);LodashWrapper.prototype.constructor=LodashWrapper;function LazyWrapper(e){this.__wrapped__=e;this.__actions__=[];this.__dir__=1;this.__filtered__=false;this.__iteratees__=[];this.__takeCount__=M;this.__views__=[]}function lazyClone(){var e=new LazyWrapper(this.__wrapped__);e.__actions__=copyArray(this.__actions__);e.__dir__=this.__dir__;e.__filtered__=this.__filtered__;e.__iteratees__=copyArray(this.__iteratees__);e.__takeCount__=this.__takeCount__;e.__views__=copyArray(this.__views__);return e}function lazyReverse(){if(this.__filtered__){var e=new LazyWrapper(this);e.__dir__=-1;e.__filtered__=true}else{e=this.clone();e.__dir__*=-1}return e}function lazyValue(){var e=this.__wrapped__.value(),t=this.__dir__,r=xi(e),i=t<0,n=r?e.length:0,a=getView(0,n,this.__views__),s=a.start,o=a.end,u=o-s,c=i?o:s-1,l=this.__iteratees__,f=l.length,p=0,d=qt(u,this.__takeCount__);if(!r||!i&&n==u&&d==u){return baseWrapperValue(e,this.__actions__)}var h=[];e:while(u--&&p<d){c+=t;var g=-1,v=e[c];while(++g<f){var m=l[g],y=m.iteratee,S=m.type,T=y(v);if(S==D){v=T}else if(!T){if(S==O){continue e}else{break e}}}h[p++]=v}return h}LazyWrapper.prototype=Rr(baseLodash.prototype);LazyWrapper.prototype.constructor=LazyWrapper;function Hash(e){var t=-1,r=e==null?0:e.length;this.clear();while(++t<r){var i=e[t];this.set(i[0],i[1])}}function hashClear(){this.__data__=nr?nr(null):{};this.size=0}function hashDelete(e){var t=this.has(e)&&delete this.__data__[e];this.size-=t?1:0;return t}function hashGet(e){var t=this.__data__;if(nr){var r=t[e];return r===c?n:r}return lt.call(t,e)?t[e]:n}function hashHas(e){var t=this.__data__;return nr?t[e]!==n:lt.call(t,e)}function hashSet(e,t){var r=this.__data__;this.size+=this.has(e)?0:1;r[e]=nr&&t===n?c:t;return this}Hash.prototype.clear=hashClear;Hash.prototype["delete"]=hashDelete;Hash.prototype.get=hashGet;Hash.prototype.has=hashHas;Hash.prototype.set=hashSet;function ListCache(e){var t=-1,r=e==null?0:e.length;this.clear();while(++t<r){var i=e[t];this.set(i[0],i[1])}}function listCacheClear(){this.__data__=[];this.size=0}function listCacheDelete(e){var t=this.__data__,r=assocIndexOf(t,e);if(r<0){return false}var i=t.length-1;if(r==i){t.pop()}else{At.call(t,r,1)}--this.size;return true}function listCacheGet(e){var t=this.__data__,r=assocIndexOf(t,e);return r<0?n:t[r][1]}function listCacheHas(e){return assocIndexOf(this.__data__,e)>-1}function listCacheSet(e,t){var r=this.__data__,i=assocIndexOf(r,e);if(i<0){++this.size;r.push([e,t])}else{r[i][1]=t}return this}ListCache.prototype.clear=listCacheClear;ListCache.prototype["delete"]=listCacheDelete;ListCache.prototype.get=listCacheGet;ListCache.prototype.has=listCacheHas;ListCache.prototype.set=listCacheSet;function MapCache(e){var t=-1,r=e==null?0:e.length;this.clear();while(++t<r){var i=e[t];this.set(i[0],i[1])}}function mapCacheClear(){this.size=0;this.__data__={hash:new Hash,map:new(Xt||ListCache),string:new Hash}}function mapCacheDelete(e){var t=getMapData(this,e)["delete"](e);this.size-=t?1:0;return t}function mapCacheGet(e){return getMapData(this,e).get(e)}function mapCacheHas(e){return getMapData(this,e).has(e)}function mapCacheSet(e,t){var r=getMapData(this,e),i=r.size;r.set(e,t);this.size+=r.size==i?0:1;return this}MapCache.prototype.clear=mapCacheClear;MapCache.prototype["delete"]=mapCacheDelete;MapCache.prototype.get=mapCacheGet;MapCache.prototype.has=mapCacheHas;MapCache.prototype.set=mapCacheSet;function SetCache(e){var t=-1,r=e==null?0:e.length;this.__data__=new MapCache;while(++t<r){this.add(e[t])}}function setCacheAdd(e){this.__data__.set(e,c);return this}function setCacheHas(e){return this.__data__.has(e)}SetCache.prototype.add=SetCache.prototype.push=setCacheAdd;SetCache.prototype.has=setCacheHas;function Stack(e){var t=this.__data__=new ListCache(e);this.size=t.size}function stackClear(){this.__data__=new ListCache;this.size=0}function stackDelete(e){var t=this.__data__,r=t["delete"](e);this.size=t.size;return r}function stackGet(e){return this.__data__.get(e)}function stackHas(e){return this.__data__.has(e)}function stackSet(e,t){var r=this.__data__;if(r instanceof ListCache){var i=r.__data__;if(!Xt||i.length<s-1){i.push([e,t]);this.size=++r.size;return this}r=this.__data__=new MapCache(i)}r.set(e,t);this.size=r.size;return this}Stack.prototype.clear=stackClear;Stack.prototype["delete"]=stackDelete;Stack.prototype.get=stackGet;Stack.prototype.has=stackHas;Stack.prototype.set=stackSet;function arrayLikeKeys(e,t){var r=xi(e),i=!r&&$i(e),n=!r&&!i&&Di(e),a=!r&&!i&&!n&&Pi(e),s=r||i||n||a,o=s?baseTimes(e.length,it):[],u=o.length;for(var c in e){if((t||lt.call(e,c))&&!(s&&(c=="length"||n&&(c=="offset"||c=="parent")||a&&(c=="buffer"||c=="byteLength"||c=="byteOffset")||isIndex(c,u)))){o.push(c)}}return o}function arraySample(e){var t=e.length;return t?e[baseRandom(0,t-1)]:n}function arraySampleSize(e,t){return shuffleSelf(copyArray(e),baseClamp(t,0,e.length))}function arrayShuffle(e){return shuffleSelf(copyArray(e))}function assignMergeValue(e,t,r){if(r!==n&&!eq(e[t],r)||r===n&&!(t in e)){baseAssignValue(e,t,r)}}function assignValue(e,t,r){var i=e[t];if(!(lt.call(e,t)&&eq(i,r))||r===n&&!(t in e)){baseAssignValue(e,t,r)}}function assocIndexOf(e,t){var r=e.length;while(r--){if(eq(e[r][0],t)){return r}}return-1}function baseAggregator(e,t,r,i){wr(e,(function(e,n,a){t(i,e,r(e),a)}));return i}function baseAssign(e,t){return e&&copyObject(t,keys(t),e)}function baseAssignIn(e,t){return e&&copyObject(t,keysIn(t),e)}function baseAssignValue(e,t,r){if(t=="__proto__"&&wt){wt(e,t,{configurable:true,enumerable:true,value:r,writable:true})}else{e[t]=r}}function baseAt(e,r){var i=-1,a=r.length,s=t(a),o=e==null;while(++i<a){s[i]=o?n:get(e,r[i])}return s}function baseClamp(e,t,r){if(e===e){if(r!==n){e=e<=r?e:r}if(t!==n){e=e>=t?e:t}}return e}function baseClone(e,t,r,i,a,s){var o,u=t&p,c=t&d,l=t&h;if(r){o=a?r(e,i,a,s):r(e)}if(o!==n){return o}if(!isObject(e)){return e}var f=xi(e);if(f){o=initCloneArray(e);if(!u){return copyArray(e,o)}}else{var g=qr(e),v=g==Y||g==Q;if(Di(e)){return cloneBuffer(e,u)}if(g==ee||g==F||v&&!a){o=c||v?{}:initCloneObject(e);if(!u){return c?copySymbolsIn(e,baseAssignIn(o,e)):copySymbols(e,baseAssign(o,e))}}else{if(!Qt[g]){return a?e:{}}o=initCloneByTag(e,g,u)}}s||(s=new Stack);var m=s.get(e);if(m){return m}s.set(e,o);if(Li(e)){e.forEach((function(i){o.add(baseClone(i,t,r,i,e,s))}))}else if(Ni(e)){e.forEach((function(i,n){o.set(n,baseClone(i,t,r,n,e,s))}))}var y=l?c?getAllKeysIn:getAllKeys:c?keysIn:keys;var S=f?n:y(e);arrayEach(S||e,(function(i,n){if(S){n=i;i=e[n]}assignValue(o,n,baseClone(i,t,r,n,e,s))}));return o}function baseConforms(e){var t=keys(e);return function(r){return baseConformsTo(r,e,t)}}function baseConformsTo(e,t,r){var i=r.length;if(e==null){return!i}e=tt(e);while(i--){var a=r[i],s=t[a],o=e[a];if(o===n&&!(a in e)||!s(o)){return false}}return true}function baseDelay(e,t,r){if(typeof e!="function"){throw new nt(u)}return Br((function(){e.apply(n,r)}),t)}function baseDifference(e,t,r,i){var n=-1,a=arrayIncludes,o=true,u=e.length,c=[],l=t.length;if(!u){return c}if(r){t=arrayMap(t,baseUnary(r))}if(i){a=arrayIncludesWith;o=false}else if(t.length>=s){a=cacheHas;o=false;t=new SetCache(t)}e:while(++n<u){var f=e[n],p=r==null?f:r(f);f=i||f!==0?f:0;if(o&&p===p){var d=l;while(d--){if(t[d]===p){continue e}}c.push(f)}else if(!a(t,p,i)){c.push(f)}}return c}var wr=createBaseEach(baseForOwn);var $r=createBaseEach(baseForOwnRight,true);function baseEvery(e,t){var r=true;wr(e,(function(e,i,n){r=!!t(e,i,n);return r}));return r}function baseExtremum(e,t,r){var i=-1,a=e.length;while(++i<a){var s=e[i],o=t(s);if(o!=null&&(u===n?o===o&&!isSymbol(o):r(o,u))){var u=o,c=s}}return c}function baseFill(e,t,r,i){var a=e.length;r=toInteger(r);if(r<0){r=-r>a?0:a+r}i=i===n||i>a?a:toInteger(i);if(i<0){i+=a}i=r>i?0:toLength(i);while(r<i){e[r++]=t}return e}function baseFilter(e,t){var r=[];wr(e,(function(e,i,n){if(t(e,i,n)){r.push(e)}}));return r}function baseFlatten(e,t,r,i,n){var a=-1,s=e.length;r||(r=isFlattenable);n||(n=[]);while(++a<s){var o=e[a];if(t>0&&r(o)){if(t>1){baseFlatten(o,t-1,r,i,n)}else{arrayPush(n,o)}}else if(!i){n[n.length]=o}}return n}var xr=createBaseFor();var Or=createBaseFor(true);function baseForOwn(e,t){return e&&xr(e,t,keys)}function baseForOwnRight(e,t){return e&&Or(e,t,keys)}function baseFunctions(e,t){return arrayFilter(t,(function(t){return isFunction(e[t])}))}function baseGet(e,t){t=castPath(t,e);var r=0,i=t.length;while(e!=null&&r<i){e=e[toKey(t[r++])]}return r&&r==i?e:n}function baseGetAllKeys(e,t,r){var i=t(e);return xi(e)?i:arrayPush(i,r(e))}function baseGetTag(e){if(e==null){return e===n?oe:Z}return Rt&&Rt in tt(e)?getRawTag(e):objectToString(e)}function baseGt(e,t){return e>t}function baseHas(e,t){return e!=null&&lt.call(e,t)}function baseHasIn(e,t){return e!=null&&t in tt(e)}function baseInRange(e,t,r){return e>=qt(t,r)&&e<Ht(t,r)}function baseIntersection(e,r,i){var a=i?arrayIncludesWith:arrayIncludes,s=e[0].length,o=e.length,u=o,c=t(o),l=Infinity,f=[];while(u--){var p=e[u];if(u&&r){p=arrayMap(p,baseUnary(r))}l=qt(p.length,l);c[u]=!i&&(r||s>=120&&p.length>=120)?new SetCache(u&&p):n}p=e[0];var d=-1,h=c[0];e:while(++d<s&&f.length<l){var g=p[d],v=r?r(g):g;g=i||g!==0?g:0;if(!(h?cacheHas(h,v):a(f,v,i))){u=o;while(--u){var m=c[u];if(!(m?cacheHas(m,v):a(e[u],v,i))){continue e}}if(h){h.push(v)}f.push(g)}}return f}function baseInverter(e,t,r,i){baseForOwn(e,(function(e,n,a){t(i,r(e),n,a)}));return i}function baseInvoke(e,t,r){t=castPath(t,e);e=parent(e,t);var i=e==null?e:e[toKey(last(t))];return i==null?n:apply(i,e,r)}function baseIsArguments(e){return isObjectLike(e)&&baseGetTag(e)==F}function baseIsArrayBuffer(e){return isObjectLike(e)&&baseGetTag(e)==le}function baseIsDate(e){return isObjectLike(e)&&baseGetTag(e)==z}function baseIsEqual(e,t,r,i,n){if(e===t){return true}if(e==null||t==null||!isObjectLike(e)&&!isObjectLike(t)){return e!==e&&t!==t}return baseIsEqualDeep(e,t,r,i,baseIsEqual,n)}function baseIsEqualDeep(e,t,r,i,n,a){var s=xi(e),o=xi(t),u=s?B:qr(e),c=o?B:qr(t);u=u==F?ee:u;c=c==F?ee:c;var l=u==ee,f=c==ee,p=u==c;if(p&&Di(e)){if(!Di(t)){return false}s=true;l=false}if(p&&!l){a||(a=new Stack);return s||Pi(e)?equalArrays(e,t,r,i,n,a):equalByTag(e,t,u,r,i,n,a)}if(!(r&g)){var d=l&&lt.call(e,"__wrapped__"),h=f&&lt.call(t,"__wrapped__");if(d||h){var v=d?e.value():e,m=h?t.value():t;a||(a=new Stack);return n(v,m,r,i,a)}}if(!p){return false}a||(a=new Stack);return equalObjects(e,t,r,i,n,a)}function baseIsMap(e){return isObjectLike(e)&&qr(e)==J}function baseIsMatch(e,t,r,i){var a=r.length,s=a,o=!i;if(e==null){return!s}e=tt(e);while(a--){var u=r[a];if(o&&u[2]?u[1]!==e[u[0]]:!(u[0]in e)){return false}}while(++a<s){u=r[a];var c=u[0],l=e[c],f=u[1];if(o&&u[2]){if(l===n&&!(c in e)){return false}}else{var p=new Stack;if(i){var d=i(l,f,c,e,t,p)}if(!(d===n?baseIsEqual(f,l,g|v,i,p):d)){return false}}}return true}function baseIsNative(e){if(!isObject(e)||isMasked(e)){return false}var t=isFunction(e)?vt:Ve;return t.test(toSource(e))}function baseIsRegExp(e){return isObjectLike(e)&&baseGetTag(e)==ie}function baseIsSet(e){return isObjectLike(e)&&qr(e)==ne}function baseIsTypedArray(e){return isObjectLike(e)&&isLength(e.length)&&!!Yt[baseGetTag(e)]}function baseIteratee(e){if(typeof e=="function"){return e}if(e==null){return identity}if(typeof e=="object"){return xi(e)?baseMatchesProperty(e[0],e[1]):baseMatches(e)}return property(e)}function baseKeys(e){if(!isPrototype(e)){return Mt(e)}var t=[];for(var r in tt(e)){if(lt.call(e,r)&&r!="constructor"){t.push(r)}}return t}function baseKeysIn(e){if(!isObject(e)){return nativeKeysIn(e)}var t=isPrototype(e),r=[];for(var i in e){if(!(i=="constructor"&&(t||!lt.call(e,i)))){r.push(i)}}return r}function baseLt(e,t){return e<t}function baseMap(e,r){var i=-1,n=isArrayLike(e)?t(e.length):[];wr(e,(function(e,t,a){n[++i]=r(e,t,a)}));return n}function baseMatches(e){var t=getMatchData(e);if(t.length==1&&t[0][2]){return matchesStrictComparable(t[0][0],t[0][1])}return function(r){return r===e||baseIsMatch(r,e,t)}}function baseMatchesProperty(e,t){if(isKey(e)&&isStrictComparable(t)){return matchesStrictComparable(toKey(e),t)}return function(r){var i=get(r,e);return i===n&&i===t?hasIn(r,e):baseIsEqual(t,i,g|v)}}function baseMerge(e,t,r,i,a){if(e===t){return}xr(t,(function(s,o){a||(a=new Stack);if(isObject(s)){baseMergeDeep(e,t,o,r,baseMerge,i,a)}else{var u=i?i(safeGet(e,o),s,o+"",e,t,a):n;if(u===n){u=s}assignMergeValue(e,o,u)}}),keysIn)}function baseMergeDeep(e,t,r,i,a,s,o){var u=safeGet(e,r),c=safeGet(t,r),l=o.get(c);if(l){assignMergeValue(e,r,l);return}var f=s?s(u,c,r+"",e,t,o):n;var p=f===n;if(p){var d=xi(c),h=!d&&Di(c),g=!d&&!h&&Pi(c);f=c;if(d||h||g){if(xi(u)){f=u}else if(isArrayLikeObject(u)){f=copyArray(u)}else if(h){p=false;f=cloneBuffer(c,true)}else if(g){p=false;f=cloneTypedArray(c,true)}else{f=[]}}else if(isPlainObject(c)||$i(c)){f=u;if($i(u)){f=toPlainObject(u)}else if(!isObject(u)||isFunction(u)){f=initCloneObject(c)}}else{p=false}}if(p){o.set(c,f);a(f,c,i,s,o);o["delete"](c)}assignMergeValue(e,r,f)}function baseNth(e,t){var r=e.length;if(!r){return}t+=t<0?r:0;return isIndex(t,r)?e[t]:n}function baseOrderBy(e,t,r){var i=-1;t=arrayMap(t.length?t:[identity],baseUnary(getIteratee()));var n=baseMap(e,(function(e,r,n){var a=arrayMap(t,(function(t){return t(e)}));return{criteria:a,index:++i,value:e}}));return baseSortBy(n,(function(e,t){return compareMultiple(e,t,r)}))}function basePick(e,t){return basePickBy(e,t,(function(t,r){return hasIn(e,r)}))}function basePickBy(e,t,r){var i=-1,n=t.length,a={};while(++i<n){var s=t[i],o=baseGet(e,s);if(r(o,s)){baseSet(a,castPath(s,e),o)}}return a}function basePropertyDeep(e){return function(t){return baseGet(t,e)}}function basePullAll(e,t,r,i){var n=i?baseIndexOfWith:baseIndexOf,a=-1,s=t.length,o=e;if(e===t){t=copyArray(t)}if(r){o=arrayMap(e,baseUnary(r))}while(++a<s){var u=0,c=t[a],l=r?r(c):c;while((u=n(o,l,u,i))>-1){if(o!==e){At.call(o,u,1)}At.call(e,u,1)}}return e}function basePullAt(e,t){var r=e?t.length:0,i=r-1;while(r--){var n=t[r];if(r==i||n!==a){var a=n;if(isIndex(n)){At.call(e,n,1)}else{baseUnset(e,n)}}}return e}function baseRandom(e,t){return e+kt(Gt()*(t-e+1))}function baseRange(e,r,i,n){var a=-1,s=Ht(Dt((r-e)/(i||1)),0),o=t(s);while(s--){o[n?s:++a]=e;e+=i}return o}function baseRepeat(e,t){var r="";if(!e||t<1||t>U){return r}do{if(t%2){r+=e}t=kt(t/2);if(t){e+=e}}while(t);return r}function baseRest(e,t){return Wr(overRest(e,t,identity),e+"")}function baseSample(e){return arraySample(values(e))}function baseSampleSize(e,t){var r=values(e);return shuffleSelf(r,baseClamp(t,0,r.length))}function baseSet(e,t,r,i){if(!isObject(e)){return e}t=castPath(t,e);var a=-1,s=t.length,o=s-1,u=e;while(u!=null&&++a<s){var c=toKey(t[a]),l=r;if(a!=o){var f=u[c];l=i?i(f,c,u):n;if(l===n){l=isObject(f)?f:isIndex(t[a+1])?[]:{}}}assignValue(u,c,l);u=u[c]}return e}var Dr=!sr?identity:function(e,t){sr.set(e,t);return e};var kr=!wt?identity:function(e,t){return wt(e,"toString",{configurable:true,enumerable:false,value:constant(t),writable:true})};function baseShuffle(e){return shuffleSelf(values(e))}function baseSlice(e,r,i){var n=-1,a=e.length;if(r<0){r=-r>a?0:a+r}i=i>a?a:i;if(i<0){i+=a}a=r>i?0:i-r>>>0;r>>>=0;var s=t(a);while(++n<a){s[n]=e[n+r]}return s}function baseSome(e,t){var r;wr(e,(function(e,i,n){r=t(e,i,n);return!r}));return!!r}function baseSortedIndex(e,t,r){var i=0,n=e==null?i:e.length;if(typeof t=="number"&&t===t&&n<=q){while(i<n){var a=i+n>>>1,s=e[a];if(s!==null&&!isSymbol(s)&&(r?s<=t:s<t)){i=a+1}else{n=a}}return n}return baseSortedIndexBy(e,t,identity,r)}function baseSortedIndexBy(e,t,r,i){t=r(t);var a=0,s=e==null?0:e.length,o=t!==t,u=t===null,c=isSymbol(t),l=t===n;while(a<s){var f=kt((a+s)/2),p=r(e[f]),d=p!==n,h=p===null,g=p===p,v=isSymbol(p);if(o){var m=i||g}else if(l){m=g&&(i||d)}else if(u){m=g&&d&&(i||!h)}else if(c){m=g&&d&&!h&&(i||!v)}else if(h||v){m=false}else{m=i?p<=t:p<t}if(m){a=f+1}else{s=f}}return qt(s,H)}function baseSortedUniq(e,t){var r=-1,i=e.length,n=0,a=[];while(++r<i){var s=e[r],o=t?t(s):s;if(!r||!eq(o,u)){var u=o;a[n++]=s===0?0:s}}return a}function baseToNumber(e){if(typeof e=="number"){return e}if(isSymbol(e)){return P}return+e}function baseToString(e){if(typeof e=="string"){return e}if(xi(e)){return arrayMap(e,baseToString)+""}if(isSymbol(e)){return Ir?Ir.call(e):""}var t=e+"";return t=="0"&&1/e==-N?"-0":t}function baseUniq(e,t,r){var i=-1,n=arrayIncludes,a=e.length,o=true,u=[],c=u;if(r){o=false;n=arrayIncludesWith}else if(a>=s){var l=t?null:Lr(e);if(l){return setToArray(l)}o=false;n=cacheHas;c=new SetCache}else{c=t?[]:u}e:while(++i<a){var f=e[i],p=t?t(f):f;f=r||f!==0?f:0;if(o&&p===p){var d=c.length;while(d--){if(c[d]===p){continue e}}if(t){c.push(p)}u.push(f)}else if(!n(c,p,r)){if(c!==u){c.push(p)}u.push(f)}}return u}function baseUnset(e,t){t=castPath(t,e);e=parent(e,t);return e==null||delete e[toKey(last(t))]}function baseUpdate(e,t,r,i){return baseSet(e,t,r(baseGet(e,t)),i)}function baseWhile(e,t,r,i){var n=e.length,a=i?n:-1;while((i?a--:++a<n)&&t(e[a],a,e)){}return r?baseSlice(e,i?0:a,i?a+1:n):baseSlice(e,i?a+1:0,i?n:a)}function baseWrapperValue(e,t){var r=e;if(r instanceof LazyWrapper){r=r.value()}return arrayReduce(t,(function(e,t){return t.func.apply(t.thisArg,arrayPush([e],t.args))}),r)}function baseXor(e,r,i){var n=e.length;if(n<2){return n?baseUniq(e[0]):[]}var a=-1,s=t(n);while(++a<n){var o=e[a],u=-1;while(++u<n){if(u!=a){s[a]=baseDifference(s[a]||o,e[u],r,i)}}}return baseUniq(baseFlatten(s,1),r,i)}function baseZipObject(e,t,r){var i=-1,a=e.length,s=t.length,o={};while(++i<a){var u=i<s?t[i]:n;r(o,e[i],u)}return o}function castArrayLikeObject(e){return isArrayLikeObject(e)?e:[]}function castFunction(e){return typeof e=="function"?e:identity}function castPath(e,t){if(xi(e)){return e}return isKey(e,t)?[e]:Gr(toString(e))}var Nr=baseRest;function castSlice(e,t,r){var i=e.length;r=r===n?i:r;return!t&&r>=i?e:baseSlice(e,t,r)}var Ur=$t||function(e){return ar.clearTimeout(e)};function cloneBuffer(e,t){if(t){return e.slice()}var r=e.length,i=Tt?Tt(r):new e.constructor(r);e.copy(i);return i}function cloneArrayBuffer(e){var t=new e.constructor(e.byteLength);new St(t).set(new St(e));return t}function cloneDataView(e,t){var r=t?cloneArrayBuffer(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.byteLength)}function cloneRegExp(e){var t=new e.constructor(e.source,Ge.exec(e));t.lastIndex=e.lastIndex;return t}function cloneSymbol(e){return Er?tt(Er.call(e)):{}}function cloneTypedArray(e,t){var r=t?cloneArrayBuffer(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.length)}function compareAscending(e,t){if(e!==t){var r=e!==n,i=e===null,a=e===e,s=isSymbol(e);var o=t!==n,u=t===null,c=t===t,l=isSymbol(t);if(!u&&!l&&!s&&e>t||s&&o&&c&&!u&&!l||i&&o&&c||!r&&c||!a){return 1}if(!i&&!s&&!l&&e<t||l&&r&&a&&!i&&!s||u&&r&&a||!o&&a||!c){return-1}}return 0}function compareMultiple(e,t,r){var i=-1,n=e.criteria,a=t.criteria,s=n.length,o=r.length;while(++i<s){var u=compareAscending(n[i],a[i]);if(u){if(i>=o){return u}var c=r[i];return u*(c=="desc"?-1:1)}}return e.index-t.index}function composeArgs(e,r,i,n){var a=-1,s=e.length,o=i.length,u=-1,c=r.length,l=Ht(s-o,0),f=t(c+l),p=!n;while(++u<c){f[u]=r[u]}while(++a<o){if(p||a<s){f[i[a]]=e[a]}}while(l--){f[u++]=e[a++]}return f}function composeArgsRight(e,r,i,n){var a=-1,s=e.length,o=-1,u=i.length,c=-1,l=r.length,f=Ht(s-u,0),p=t(f+l),d=!n;while(++a<f){p[a]=e[a]}var h=a;while(++c<l){p[h+c]=r[c]}while(++o<u){if(d||a<s){p[h+i[o]]=e[a++]}}return p}function copyArray(e,r){var i=-1,n=e.length;r||(r=t(n));while(++i<n){r[i]=e[i]}return r}function copyObject(e,t,r,i){var a=!r;r||(r={});var s=-1,o=t.length;while(++s<o){var u=t[s];var c=i?i(r[u],e[u],u,r,e):n;if(c===n){c=e[u]}if(a){baseAssignValue(r,u,c)}else{assignValue(r,u,c)}}return r}function copySymbols(e,t){return copyObject(e,Mr(e),t)}function copySymbolsIn(e,t){return copyObject(e,Hr(e),t)}function createAggregator(e,t){return function(r,i){var n=xi(r)?arrayAggregator:baseAggregator,a=t?t():{};return n(r,e,getIteratee(i,2),a)}}function createAssigner(e){return baseRest((function(t,r){var i=-1,a=r.length,s=a>1?r[a-1]:n,o=a>2?r[2]:n;s=e.length>3&&typeof s=="function"?(a--,s):n;if(o&&isIterateeCall(r[0],r[1],o)){s=a<3?n:s;a=1}t=tt(t);while(++i<a){var u=r[i];if(u){e(t,u,i,s)}}return t}))}function createBaseEach(e,t){return function(r,i){if(r==null){return r}if(!isArrayLike(r)){return e(r,i)}var n=r.length,a=t?n:-1,s=tt(r);while(t?a--:++a<n){if(i(s[a],a,s)===false){break}}return r}}function createBaseFor(e){return function(t,r,i){var n=-1,a=tt(t),s=i(t),o=s.length;while(o--){var u=s[e?o:++n];if(r(a[u],u,a)===false){break}}return t}}function createBind(e,t,r){var i=t&m,n=createCtor(e);function wrapper(){var t=this&&this!==ar&&this instanceof wrapper?n:e;return t.apply(i?r:this,arguments)}return wrapper}function createCaseFirst(e){return function(t){t=toString(t);var r=hasUnicode(t)?stringToArray(t):n;var i=r?r[0]:t.charAt(0);var a=r?castSlice(r,1).join(""):t.slice(1);return i[e]()+a}}function createCompounder(e){return function(t){return arrayReduce(words(deburr(t).replace(jt,"")),e,"")}}function createCtor(e){return function(){var t=arguments;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var r=Rr(e.prototype),i=e.apply(r,t);return isObject(i)?i:r}}function createCurry(e,r,i){var a=createCtor(e);function wrapper(){var s=arguments.length,o=t(s),u=s,c=getHolder(wrapper);while(u--){o[u]=arguments[u]}var l=s<3&&o[0]!==c&&o[s-1]!==c?[]:replaceHolders(o,c);s-=l.length;if(s<i){return createRecurry(e,r,createHybrid,wrapper.placeholder,n,o,l,n,n,i-s)}var f=this&&this!==ar&&this instanceof wrapper?a:e;return apply(f,this,o)}return wrapper}function createFind(e){return function(t,r,i){var a=tt(t);if(!isArrayLike(t)){var s=getIteratee(r,3);t=keys(t);r=function(e){return s(a[e],e,a)}}var o=e(t,r,i);return o>-1?a[s?t[o]:o]:n}}function createFlow(e){return flatRest((function(t){var r=t.length,i=r,a=LodashWrapper.prototype.thru;if(e){t.reverse()}while(i--){var s=t[i];if(typeof s!="function"){throw new nt(u)}if(a&&!o&&getFuncName(s)=="wrapper"){var o=new LodashWrapper([],true)}}i=o?i:r;while(++i<r){s=t[i];var c=getFuncName(s),l=c=="wrapper"?Pr(s):n;if(l&&isLaziable(l[0])&&l[1]==(A|T|_|E)&&!l[4].length&&l[9]==1){o=o[getFuncName(l[0])].apply(o,l[3])}else{o=s.length==1&&isLaziable(s)?o[c]():o.thru(s)}}return function(){var e=arguments,i=e[0];if(o&&e.length==1&&xi(i)){return o.plant(i).value()}var n=0,a=r?t[n].apply(this,e):i;while(++n<r){a=t[n].call(this,a)}return a}}))}function createHybrid(e,r,i,a,s,o,u,c,l,f){var p=r&A,d=r&m,h=r&y,g=r&(T|b),v=r&I,S=h?n:createCtor(e);function wrapper(){var n=arguments.length,m=t(n),y=n;while(y--){m[y]=arguments[y]}if(g){var T=getHolder(wrapper),b=countHolders(m,T)}if(a){m=composeArgs(m,a,s,g)}if(o){m=composeArgsRight(m,o,u,g)}n-=b;if(g&&n<f){var _=replaceHolders(m,T);return createRecurry(e,r,createHybrid,wrapper.placeholder,i,m,_,c,l,f-n)}var C=d?i:this,A=h?C[e]:e;n=m.length;if(c){m=reorder(m,c)}else if(v&&n>1){m.reverse()}if(p&&l<n){m.length=l}if(this&&this!==ar&&this instanceof wrapper){A=S||createCtor(A)}return A.apply(C,m)}return wrapper}function createInverter(e,t){return function(r,i){return baseInverter(r,e,t(i),{})}}function createMathOperation(e,t){return function(r,i){var a;if(r===n&&i===n){return t}if(r!==n){a=r}if(i!==n){if(a===n){return i}if(typeof r=="string"||typeof i=="string"){r=baseToString(r);i=baseToString(i)}else{r=baseToNumber(r);i=baseToNumber(i)}a=e(r,i)}return a}}function createOver(e){return flatRest((function(t){t=arrayMap(t,baseUnary(getIteratee()));return baseRest((function(r){var i=this;return e(t,(function(e){return apply(e,i,r)}))}))}))}function createPadding(e,t){t=t===n?" ":baseToString(t);var r=t.length;if(r<2){return r?baseRepeat(t,e):t}var i=baseRepeat(t,Dt(e/stringSize(t)));return hasUnicode(t)?castSlice(stringToArray(i),0,e).join(""):i.slice(0,e)}function createPartial(e,r,i,n){var a=r&m,s=createCtor(e);function wrapper(){var r=-1,o=arguments.length,u=-1,c=n.length,l=t(c+o),f=this&&this!==ar&&this instanceof wrapper?s:e;while(++u<c){l[u]=n[u]}while(o--){l[u++]=arguments[++r]}return apply(f,a?i:this,l)}return wrapper}function createRange(e){return function(t,r,i){if(i&&typeof i!="number"&&isIterateeCall(t,r,i)){r=i=n}t=toFinite(t);if(r===n){r=t;t=0}else{r=toFinite(r)}i=i===n?t<r?1:-1:toFinite(i);return baseRange(t,r,i,e)}}function createRelationalOperation(e){return function(t,r){if(!(typeof t=="string"&&typeof r=="string")){t=toNumber(t);r=toNumber(r)}return e(t,r)}}function createRecurry(e,t,r,i,a,s,o,u,c,l){var f=t&T,p=f?o:n,d=f?n:o,h=f?s:n,g=f?n:s;t|=f?_:C;t&=~(f?C:_);if(!(t&S)){t&=~(m|y)}var v=[e,t,a,h,p,g,d,u,c,l];var b=r.apply(n,v);if(isLaziable(e)){Fr(b,v)}b.placeholder=i;return setWrapToString(b,e,t)}function createRound(e){var t=et[e];return function(e,r){e=toNumber(e);r=r==null?0:qt(toInteger(r),292);if(r&&Lt(e)){var i=(toString(e)+"e").split("e"),n=t(i[0]+"e"+(+i[1]+r));i=(toString(n)+"e").split("e");return+(i[0]+"e"+(+i[1]-r))}return t(e)}}var Lr=!(er&&1/setToArray(new er([,-0]))[1]==N)?noop:function(e){return new er(e)};function createToPairs(e){return function(t){var r=qr(t);if(r==J){return mapToArray(t)}if(r==ne){return setToPairs(t)}return baseToPairs(t,e(t))}}function createWrap(e,t,r,i,a,s,o,c){var l=t&y;if(!l&&typeof e!="function"){throw new nt(u)}var f=i?i.length:0;if(!f){t&=~(_|C);i=a=n}o=o===n?o:Ht(toInteger(o),0);c=c===n?c:toInteger(c);f-=a?a.length:0;if(t&C){var p=i,d=a;i=a=n}var h=l?n:Pr(e);var g=[e,t,r,i,a,p,d,s,o,c];if(h){mergeData(g,h)}e=g[0];t=g[1];r=g[2];i=g[3];a=g[4];c=g[9]=g[9]===n?l?0:e.length:Ht(g[9]-f,0);if(!c&&t&(T|b)){t&=~(T|b)}if(!t||t==m){var v=createBind(e,t,r)}else if(t==T||t==b){v=createCurry(e,t,c)}else if((t==_||t==(m|_))&&!a.length){v=createPartial(e,t,r,i)}else{v=createHybrid.apply(n,g)}var S=h?Dr:Fr;return setWrapToString(S(v,g),e,t)}function customDefaultsAssignIn(e,t,r,i){if(e===n||eq(e,ot[r])&&!lt.call(i,r)){return t}return e}function customDefaultsMerge(e,t,r,i,a,s){if(isObject(e)&&isObject(t)){s.set(t,e);baseMerge(e,t,n,customDefaultsMerge,s);s["delete"](t)}return e}function customOmitClone(e){return isPlainObject(e)?n:e}function equalArrays(e,t,r,i,a,s){var o=r&g,u=e.length,c=t.length;if(u!=c&&!(o&&c>u)){return false}var l=s.get(e);if(l&&s.get(t)){return l==t}var f=-1,p=true,d=r&v?new SetCache:n;s.set(e,t);s.set(t,e);while(++f<u){var h=e[f],m=t[f];if(i){var y=o?i(m,h,f,t,e,s):i(h,m,f,e,t,s)}if(y!==n){if(y){continue}p=false;break}if(d){if(!arraySome(t,(function(e,t){if(!cacheHas(d,t)&&(h===e||a(h,e,r,i,s))){return d.push(t)}}))){p=false;break}}else if(!(h===m||a(h,m,r,i,s))){p=false;break}}s["delete"](e);s["delete"](t);return p}function equalByTag(e,t,r,i,n,a,s){switch(r){case fe:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset){return false}e=e.buffer;t=t.buffer;case le:if(e.byteLength!=t.byteLength||!a(new St(e),new St(t))){return false}return true;case G:case z:case X:return eq(+e,+t);case V:return e.name==t.name&&e.message==t.message;case ie:case ae:return e==t+"";case J:var o=mapToArray;case ne:var u=i&g;o||(o=setToArray);if(e.size!=t.size&&!u){return false}var c=s.get(e);if(c){return c==t}i|=v;s.set(e,t);var l=equalArrays(o(e),o(t),i,n,a,s);s["delete"](e);return l;case se:if(Er){return Er.call(e)==Er.call(t)}}return false}function equalObjects(e,t,r,i,a,s){var o=r&g,u=getAllKeys(e),c=u.length,l=getAllKeys(t),f=l.length;if(c!=f&&!o){return false}var p=c;while(p--){var d=u[p];if(!(o?d in t:lt.call(t,d))){return false}}var h=s.get(e);if(h&&s.get(t)){return h==t}var v=true;s.set(e,t);s.set(t,e);var m=o;while(++p<c){d=u[p];var y=e[d],S=t[d];if(i){var T=o?i(S,y,d,t,e,s):i(y,S,d,e,t,s)}if(!(T===n?y===S||a(y,S,r,i,s):T)){v=false;break}m||(m=d=="constructor")}if(v&&!m){var b=e.constructor,_=t.constructor;if(b!=_&&("constructor"in e&&"constructor"in t)&&!(typeof b=="function"&&b instanceof b&&typeof _=="function"&&_ instanceof _)){v=false}}s["delete"](e);s["delete"](t);return v}function flatRest(e){return Wr(overRest(e,n,flatten),e+"")}function getAllKeys(e){return baseGetAllKeys(e,keys,Mr)}function getAllKeysIn(e){return baseGetAllKeys(e,keysIn,Hr)}var Pr=!sr?noop:function(e){return sr.get(e)};function getFuncName(e){var t=e.name+"",r=or[t],i=lt.call(or,t)?r.length:0;while(i--){var n=r[i],a=n.func;if(a==null||a==e){return n.name}}return t}function getHolder(e){var t=lt.call(lodash,"placeholder")?lodash:e;return t.placeholder}function getIteratee(){var e=lodash.iteratee||iteratee;e=e===iteratee?baseIteratee:e;return arguments.length?e(arguments[0],arguments[1]):e}function getMapData(e,t){var r=e.__data__;return isKeyable(t)?r[typeof t=="string"?"string":"hash"]:r.map}function getMatchData(e){var t=keys(e),r=t.length;while(r--){var i=t[r],n=e[i];t[r]=[i,n,isStrictComparable(n)]}return t}function getNative(e,t){var r=getValue(e,t);return baseIsNative(r)?r:n}function getRawTag(e){var t=lt.call(e,Rt),r=e[Rt];try{e[Rt]=n;var i=true}catch(e){}var a=dt.call(e);if(i){if(t){e[Rt]=r}else{delete e[Rt]}}return a}var Mr=!Nt?stubArray:function(e){if(e==null){return[]}e=tt(e);return arrayFilter(Nt(e),(function(t){return Ct.call(e,t)}))};var Hr=!Nt?stubArray:function(e){var t=[];while(e){arrayPush(t,Mr(e));e=bt(e)}return t};var qr=baseGetTag;if(Jt&&qr(new Jt(new ArrayBuffer(1)))!=fe||Xt&&qr(new Xt)!=J||Zt&&qr(Zt.resolve())!=te||er&&qr(new er)!=ne||ir&&qr(new ir)!=ue){qr=function(e){var t=baseGetTag(e),r=t==ee?e.constructor:n,i=r?toSource(r):"";if(i){switch(i){case cr:return fe;case lr:return J;case mr:return te;case br:return ne;case Cr:return ue}}return t}}function getView(e,t,r){var i=-1,n=r.length;while(++i<n){var a=r[i],s=a.size;switch(a.type){case"drop":e+=s;break;case"dropRight":t-=s;break;case"take":t=qt(t,e+s);break;case"takeRight":e=Ht(e,t-s);break}}return{start:e,end:t}}function getWrapDetails(e){var t=e.match(qe);return t?t[1].split(je):[]}function hasPath(e,t,r){t=castPath(t,e);var i=-1,n=t.length,a=false;while(++i<n){var s=toKey(t[i]);if(!(a=e!=null&&r(e,s))){break}e=e[s]}if(a||++i!=n){return a}n=e==null?0:e.length;return!!n&&isLength(n)&&isIndex(s,n)&&(xi(e)||$i(e))}function initCloneArray(e){var t=e.length,r=new e.constructor(t);if(t&&typeof e[0]=="string"&&lt.call(e,"index")){r.index=e.index;r.input=e.input}return r}function initCloneObject(e){return typeof e.constructor=="function"&&!isPrototype(e)?Rr(bt(e)):{}}function initCloneByTag(e,t,r){var i=e.constructor;switch(t){case le:return cloneArrayBuffer(e);case G:case z:return new i(+e);case fe:return cloneDataView(e,r);case pe:case de:case he:case ge:case ve:case me:case ye:case Se:case Te:return cloneTypedArray(e,r);case J:return new i;case X:case ae:return new i(e);case ie:return cloneRegExp(e);case ne:return new i;case se:return cloneSymbol(e)}}function insertWrapDetails(e,t){var r=t.length;if(!r){return e}var i=r-1;t[i]=(r>1?"& ":"")+t[i];t=t.join(r>2?", ":" ");return e.replace(He,"{\n/* [wrapped with "+t+"] */\n")}function isFlattenable(e){return xi(e)||$i(e)||!!(Et&&e&&e[Et])}function isIndex(e,t){var r=typeof e;t=t==null?U:t;return!!t&&(r=="number"||r!="symbol"&&Qe.test(e))&&(e>-1&&e%1==0&&e<t)}function isIterateeCall(e,t,r){if(!isObject(r)){return false}var i=typeof t;if(i=="number"?isArrayLike(r)&&isIndex(t,r.length):i=="string"&&t in r){return eq(r[t],e)}return false}function isKey(e,t){if(xi(e)){return false}var r=typeof e;if(r=="number"||r=="symbol"||r=="boolean"||e==null||isSymbol(e)){return true}return De.test(e)||!Oe.test(e)||t!=null&&e in tt(t)}function isKeyable(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}function isLaziable(e){var t=getFuncName(e),r=lodash[t];if(typeof r!="function"||!(t in LazyWrapper.prototype)){return false}if(e===r){return true}var i=Pr(r);return!!i&&e===i[0]}function isMasked(e){return!!pt&&pt in e}var jr=ut?isFunction:stubFalse;function isPrototype(e){var t=e&&e.constructor,r=typeof t=="function"&&t.prototype||ot;return e===r}function isStrictComparable(e){return e===e&&!isObject(e)}function matchesStrictComparable(e,t){return function(r){if(r==null){return false}return r[e]===t&&(t!==n||e in tt(r))}}function memoizeCapped(e){var t=memoize(e,(function(e){if(r.size===l){r.clear()}return e}));var r=t.cache;return t}function mergeData(e,t){var r=e[1],i=t[1],n=r|i,a=n<(m|y|A);var s=i==A&&r==T||i==A&&r==E&&e[7].length<=t[8]||i==(A|E)&&t[7].length<=t[8]&&r==T;if(!(a||s)){return e}if(i&m){e[2]=t[2];n|=r&m?0:S}var o=t[3];if(o){var u=e[3];e[3]=u?composeArgs(u,o,t[4]):o;e[4]=u?replaceHolders(e[3],f):t[4]}o=t[5];if(o){u=e[5];e[5]=u?composeArgsRight(u,o,t[6]):o;e[6]=u?replaceHolders(e[5],f):t[6]}o=t[7];if(o){e[7]=o}if(i&A){e[8]=e[8]==null?t[8]:qt(e[8],t[8])}if(e[9]==null){e[9]=t[9]}e[0]=t[0];e[1]=n;return e}function nativeKeysIn(e){var t=[];if(e!=null){for(var r in tt(e)){t.push(r)}}return t}function objectToString(e){return dt.call(e)}function overRest(e,r,i){r=Ht(r===n?e.length-1:r,0);return function(){var n=arguments,a=-1,s=Ht(n.length-r,0),o=t(s);while(++a<s){o[a]=n[r+a]}a=-1;var u=t(r+1);while(++a<r){u[a]=n[a]}u[r]=i(o);return apply(e,this,u)}}function parent(e,t){return t.length<2?e:baseGet(e,baseSlice(t,0,-1))}function reorder(e,t){var r=e.length,i=qt(t.length,r),a=copyArray(e);while(i--){var s=t[i];e[i]=isIndex(s,r)?a[s]:n}return e}function safeGet(e,t){if(t==="constructor"&&typeof e[t]==="function"){return}if(t=="__proto__"){return}return e[t]}var Fr=shortOut(Dr);var Br=Ot||function(e,t){return ar.setTimeout(e,t)};var Wr=shortOut(kr);function setWrapToString(e,t,r){var i=t+"";return Wr(e,insertWrapDetails(i,updateWrapDetails(getWrapDetails(i),r)))}function shortOut(e){var t=0,r=0;return function(){var i=Bt(),a=x-(i-r);r=i;if(a>0){if(++t>=$){return arguments[0]}}else{t=0}return e.apply(n,arguments)}}function shuffleSelf(e,t){var r=-1,i=e.length,a=i-1;t=t===n?i:t;while(++r<t){var s=baseRandom(r,a),o=e[s];e[s]=e[r];e[r]=o}e.length=t;return e}var Gr=memoizeCapped((function(e){var t=[];if(e.charCodeAt(0)===46){t.push("")}e.replace(ke,(function(e,r,i,n){t.push(i?n.replace(Be,"$1"):r||e)}));return t}));function toKey(e){if(typeof e=="string"||isSymbol(e)){return e}var t=e+"";return t=="0"&&1/e==-N?"-0":t}function toSource(e){if(e!=null){try{return ct.call(e)}catch(e){}try{return e+""}catch(e){}}return""}function updateWrapDetails(e,t){arrayEach(j,(function(r){var i="_."+r[0];if(t&r[1]&&!arrayIncludes(e,i)){e.push(i)}}));return e.sort()}function wrapperClone(e){if(e instanceof LazyWrapper){return e.clone()}var t=new LodashWrapper(e.__wrapped__,e.__chain__);t.__actions__=copyArray(e.__actions__);t.__index__=e.__index__;t.__values__=e.__values__;return t}function chunk(e,r,i){if(i?isIterateeCall(e,r,i):r===n){r=1}else{r=Ht(toInteger(r),0)}var a=e==null?0:e.length;if(!a||r<1){return[]}var s=0,o=0,u=t(Dt(a/r));while(s<a){u[o++]=baseSlice(e,s,s+=r)}return u}function compact(e){var t=-1,r=e==null?0:e.length,i=0,n=[];while(++t<r){var a=e[t];if(a){n[i++]=a}}return n}function concat(){var e=arguments.length;if(!e){return[]}var r=t(e-1),i=arguments[0],n=e;while(n--){r[n-1]=arguments[n]}return arrayPush(xi(i)?copyArray(i):[i],baseFlatten(r,1))}var zr=baseRest((function(e,t){return isArrayLikeObject(e)?baseDifference(e,baseFlatten(t,1,isArrayLikeObject,true)):[]}));var Kr=baseRest((function(e,t){var r=last(t);if(isArrayLikeObject(r)){r=n}return isArrayLikeObject(e)?baseDifference(e,baseFlatten(t,1,isArrayLikeObject,true),getIteratee(r,2)):[]}));var Vr=baseRest((function(e,t){var r=last(t);if(isArrayLikeObject(r)){r=n}return isArrayLikeObject(e)?baseDifference(e,baseFlatten(t,1,isArrayLikeObject,true),n,r):[]}));function drop(e,t,r){var i=e==null?0:e.length;if(!i){return[]}t=r||t===n?1:toInteger(t);return baseSlice(e,t<0?0:t,i)}function dropRight(e,t,r){var i=e==null?0:e.length;if(!i){return[]}t=r||t===n?1:toInteger(t);t=i-t;return baseSlice(e,0,t<0?0:t)}function dropRightWhile(e,t){return e&&e.length?baseWhile(e,getIteratee(t,3),true,true):[]}function dropWhile(e,t){return e&&e.length?baseWhile(e,getIteratee(t,3),true):[]}function fill(e,t,r,i){var n=e==null?0:e.length;if(!n){return[]}if(r&&typeof r!="number"&&isIterateeCall(e,t,r)){r=0;i=n}return baseFill(e,t,r,i)}function findIndex(e,t,r){var i=e==null?0:e.length;if(!i){return-1}var n=r==null?0:toInteger(r);if(n<0){n=Ht(i+n,0)}return baseFindIndex(e,getIteratee(t,3),n)}function findLastIndex(e,t,r){var i=e==null?0:e.length;if(!i){return-1}var a=i-1;if(r!==n){a=toInteger(r);a=r<0?Ht(i+a,0):qt(a,i-1)}return baseFindIndex(e,getIteratee(t,3),a,true)}function flatten(e){var t=e==null?0:e.length;return t?baseFlatten(e,1):[]}function flattenDeep(e){var t=e==null?0:e.length;return t?baseFlatten(e,N):[]}function flattenDepth(e,t){var r=e==null?0:e.length;if(!r){return[]}t=t===n?1:toInteger(t);return baseFlatten(e,t)}function fromPairs(e){var t=-1,r=e==null?0:e.length,i={};while(++t<r){var n=e[t];i[n[0]]=n[1]}return i}function head(e){return e&&e.length?e[0]:n}function indexOf(e,t,r){var i=e==null?0:e.length;if(!i){return-1}var n=r==null?0:toInteger(r);if(n<0){n=Ht(i+n,0)}return baseIndexOf(e,t,n)}function initial(e){var t=e==null?0:e.length;return t?baseSlice(e,0,-1):[]}var Yr=baseRest((function(e){var t=arrayMap(e,castArrayLikeObject);return t.length&&t[0]===e[0]?baseIntersection(t):[]}));var Qr=baseRest((function(e){var t=last(e),r=arrayMap(e,castArrayLikeObject);if(t===last(r)){t=n}else{r.pop()}return r.length&&r[0]===e[0]?baseIntersection(r,getIteratee(t,2)):[]}));var Jr=baseRest((function(e){var t=last(e),r=arrayMap(e,castArrayLikeObject);t=typeof t=="function"?t:n;if(t){r.pop()}return r.length&&r[0]===e[0]?baseIntersection(r,n,t):[]}));function join(e,t){return e==null?"":Pt.call(e,t)}function last(e){var t=e==null?0:e.length;return t?e[t-1]:n}function lastIndexOf(e,t,r){var i=e==null?0:e.length;if(!i){return-1}var a=i;if(r!==n){a=toInteger(r);a=a<0?Ht(i+a,0):qt(a,i-1)}return t===t?strictLastIndexOf(e,t,a):baseFindIndex(e,baseIsNaN,a,true)}function nth(e,t){return e&&e.length?baseNth(e,toInteger(t)):n}var Xr=baseRest(pullAll);function pullAll(e,t){return e&&e.length&&t&&t.length?basePullAll(e,t):e}function pullAllBy(e,t,r){return e&&e.length&&t&&t.length?basePullAll(e,t,getIteratee(r,2)):e}function pullAllWith(e,t,r){return e&&e.length&&t&&t.length?basePullAll(e,t,n,r):e}var Zr=flatRest((function(e,t){var r=e==null?0:e.length,i=baseAt(e,t);basePullAt(e,arrayMap(t,(function(e){return isIndex(e,r)?+e:e})).sort(compareAscending));return i}));function remove(e,t){var r=[];if(!(e&&e.length)){return r}var i=-1,n=[],a=e.length;t=getIteratee(t,3);while(++i<a){var s=e[i];if(t(s,i,e)){r.push(s);n.push(i)}}basePullAt(e,n);return r}function reverse(e){return e==null?e:zt.call(e)}function slice(e,t,r){var i=e==null?0:e.length;if(!i){return[]}if(r&&typeof r!="number"&&isIterateeCall(e,t,r)){t=0;r=i}else{t=t==null?0:toInteger(t);r=r===n?i:toInteger(r)}return baseSlice(e,t,r)}function sortedIndex(e,t){return baseSortedIndex(e,t)}function sortedIndexBy(e,t,r){return baseSortedIndexBy(e,t,getIteratee(r,2))}function sortedIndexOf(e,t){var r=e==null?0:e.length;if(r){var i=baseSortedIndex(e,t);if(i<r&&eq(e[i],t)){return i}}return-1}function sortedLastIndex(e,t){return baseSortedIndex(e,t,true)}function sortedLastIndexBy(e,t,r){return baseSortedIndexBy(e,t,getIteratee(r,2),true)}function sortedLastIndexOf(e,t){var r=e==null?0:e.length;if(r){var i=baseSortedIndex(e,t,true)-1;if(eq(e[i],t)){return i}}return-1}function sortedUniq(e){return e&&e.length?baseSortedUniq(e):[]}function sortedUniqBy(e,t){return e&&e.length?baseSortedUniq(e,getIteratee(t,2)):[]}function tail(e){var t=e==null?0:e.length;return t?baseSlice(e,1,t):[]}function take(e,t,r){if(!(e&&e.length)){return[]}t=r||t===n?1:toInteger(t);return baseSlice(e,0,t<0?0:t)}function takeRight(e,t,r){var i=e==null?0:e.length;if(!i){return[]}t=r||t===n?1:toInteger(t);t=i-t;return baseSlice(e,t<0?0:t,i)}function takeRightWhile(e,t){return e&&e.length?baseWhile(e,getIteratee(t,3),false,true):[]}function takeWhile(e,t){return e&&e.length?baseWhile(e,getIteratee(t,3)):[]}var ei=baseRest((function(e){return baseUniq(baseFlatten(e,1,isArrayLikeObject,true))}));var ti=baseRest((function(e){var t=last(e);if(isArrayLikeObject(t)){t=n}return baseUniq(baseFlatten(e,1,isArrayLikeObject,true),getIteratee(t,2))}));var ri=baseRest((function(e){var t=last(e);t=typeof t=="function"?t:n;return baseUniq(baseFlatten(e,1,isArrayLikeObject,true),n,t)}));function uniq(e){return e&&e.length?baseUniq(e):[]}function uniqBy(e,t){return e&&e.length?baseUniq(e,getIteratee(t,2)):[]}function uniqWith(e,t){t=typeof t=="function"?t:n;return e&&e.length?baseUniq(e,n,t):[]}function unzip(e){if(!(e&&e.length)){return[]}var t=0;e=arrayFilter(e,(function(e){if(isArrayLikeObject(e)){t=Ht(e.length,t);return true}}));return baseTimes(t,(function(t){return arrayMap(e,baseProperty(t))}))}function unzipWith(e,t){if(!(e&&e.length)){return[]}var r=unzip(e);if(t==null){return r}return arrayMap(r,(function(e){return apply(t,n,e)}))}var ii=baseRest((function(e,t){return isArrayLikeObject(e)?baseDifference(e,t):[]}));var ni=baseRest((function(e){return baseXor(arrayFilter(e,isArrayLikeObject))}));var ai=baseRest((function(e){var t=last(e);if(isArrayLikeObject(t)){t=n}return baseXor(arrayFilter(e,isArrayLikeObject),getIteratee(t,2))}));var si=baseRest((function(e){var t=last(e);t=typeof t=="function"?t:n;return baseXor(arrayFilter(e,isArrayLikeObject),n,t)}));var oi=baseRest(unzip);function zipObject(e,t){return baseZipObject(e||[],t||[],assignValue)}function zipObjectDeep(e,t){return baseZipObject(e||[],t||[],baseSet)}var ui=baseRest((function(e){var t=e.length,r=t>1?e[t-1]:n;r=typeof r=="function"?(e.pop(),r):n;return unzipWith(e,r)}));function chain(e){var t=lodash(e);t.__chain__=true;return t}function tap(e,t){t(e);return e}function thru(e,t){return t(e)}var ci=flatRest((function(e){var t=e.length,r=t?e[0]:0,i=this.__wrapped__,interceptor=function(t){return baseAt(t,e)};if(t>1||this.__actions__.length||!(i instanceof LazyWrapper)||!isIndex(r)){return this.thru(interceptor)}i=i.slice(r,+r+(t?1:0));i.__actions__.push({func:thru,args:[interceptor],thisArg:n});return new LodashWrapper(i,this.__chain__).thru((function(e){if(t&&!e.length){e.push(n)}return e}))}));function wrapperChain(){return chain(this)}function wrapperCommit(){return new LodashWrapper(this.value(),this.__chain__)}function wrapperNext(){if(this.__values__===n){this.__values__=toArray(this.value())}var e=this.__index__>=this.__values__.length,t=e?n:this.__values__[this.__index__++];return{done:e,value:t}}function wrapperToIterator(){return this}function wrapperPlant(e){var t,r=this;while(r instanceof baseLodash){var i=wrapperClone(r);i.__index__=0;i.__values__=n;if(t){a.__wrapped__=i}else{t=i}var a=i;r=r.__wrapped__}a.__wrapped__=e;return t}function wrapperReverse(){var e=this.__wrapped__;if(e instanceof LazyWrapper){var t=e;if(this.__actions__.length){t=new LazyWrapper(this)}t=t.reverse();t.__actions__.push({func:thru,args:[reverse],thisArg:n});return new LodashWrapper(t,this.__chain__)}return this.thru(reverse)}function wrapperValue(){return baseWrapperValue(this.__wrapped__,this.__actions__)}var li=createAggregator((function(e,t,r){if(lt.call(e,r)){++e[r]}else{baseAssignValue(e,r,1)}}));function every(e,t,r){var i=xi(e)?arrayEvery:baseEvery;if(r&&isIterateeCall(e,t,r)){t=n}return i(e,getIteratee(t,3))}function filter(e,t){var r=xi(e)?arrayFilter:baseFilter;return r(e,getIteratee(t,3))}var fi=createFind(findIndex);var pi=createFind(findLastIndex);function flatMap(e,t){return baseFlatten(map(e,t),1)}function flatMapDeep(e,t){return baseFlatten(map(e,t),N)}function flatMapDepth(e,t,r){r=r===n?1:toInteger(r);return baseFlatten(map(e,t),r)}function forEach(e,t){var r=xi(e)?arrayEach:wr;return r(e,getIteratee(t,3))}function forEachRight(e,t){var r=xi(e)?arrayEachRight:$r;return r(e,getIteratee(t,3))}var di=createAggregator((function(e,t,r){if(lt.call(e,r)){e[r].push(t)}else{baseAssignValue(e,r,[t])}}));function includes(e,t,r,i){e=isArrayLike(e)?e:values(e);r=r&&!i?toInteger(r):0;var n=e.length;if(r<0){r=Ht(n+r,0)}return isString(e)?r<=n&&e.indexOf(t,r)>-1:!!n&&baseIndexOf(e,t,r)>-1}var hi=baseRest((function(e,r,i){var n=-1,a=typeof r=="function",s=isArrayLike(e)?t(e.length):[];wr(e,(function(e){s[++n]=a?apply(r,e,i):baseInvoke(e,r,i)}));return s}));var gi=createAggregator((function(e,t,r){baseAssignValue(e,r,t)}));function map(e,t){var r=xi(e)?arrayMap:baseMap;return r(e,getIteratee(t,3))}function orderBy(e,t,r,i){if(e==null){return[]}if(!xi(t)){t=t==null?[]:[t]}r=i?n:r;if(!xi(r)){r=r==null?[]:[r]}return baseOrderBy(e,t,r)}var vi=createAggregator((function(e,t,r){e[r?0:1].push(t)}),(function(){return[[],[]]}));function reduce(e,t,r){var i=xi(e)?arrayReduce:baseReduce,n=arguments.length<3;return i(e,getIteratee(t,4),r,n,wr)}function reduceRight(e,t,r){var i=xi(e)?arrayReduceRight:baseReduce,n=arguments.length<3;return i(e,getIteratee(t,4),r,n,$r)}function reject(e,t){var r=xi(e)?arrayFilter:baseFilter;return r(e,negate(getIteratee(t,3)))}function sample(e){var t=xi(e)?arraySample:baseSample;return t(e)}function sampleSize(e,t,r){if(r?isIterateeCall(e,t,r):t===n){t=1}else{t=toInteger(t)}var i=xi(e)?arraySampleSize:baseSampleSize;return i(e,t)}function shuffle(e){var t=xi(e)?arrayShuffle:baseShuffle;return t(e)}function size(e){if(e==null){return 0}if(isArrayLike(e)){return isString(e)?stringSize(e):e.length}var t=qr(e);if(t==J||t==ne){return e.size}return baseKeys(e).length}function some(e,t,r){var i=xi(e)?arraySome:baseSome;if(r&&isIterateeCall(e,t,r)){t=n}return i(e,getIteratee(t,3))}var mi=baseRest((function(e,t){if(e==null){return[]}var r=t.length;if(r>1&&isIterateeCall(e,t[0],t[1])){t=[]}else if(r>2&&isIterateeCall(t[0],t[1],t[2])){t=[t[0]]}return baseOrderBy(e,baseFlatten(t,1),[])}));var yi=xt||function(){return ar.Date.now()};function after(e,t){if(typeof t!="function"){throw new nt(u)}e=toInteger(e);return function(){if(--e<1){return t.apply(this,arguments)}}}function ary(e,t,r){t=r?n:t;t=e&&t==null?e.length:t;return createWrap(e,A,n,n,n,n,t)}function before(e,t){var r;if(typeof t!="function"){throw new nt(u)}e=toInteger(e);return function(){if(--e>0){r=t.apply(this,arguments)}if(e<=1){t=n}return r}}var Si=baseRest((function(e,t,r){var i=m;if(r.length){var n=replaceHolders(r,getHolder(Si));i|=_}return createWrap(e,i,t,r,n)}));var Ti=baseRest((function(e,t,r){var i=m|y;if(r.length){var n=replaceHolders(r,getHolder(Ti));i|=_}return createWrap(t,i,e,r,n)}));function curry(e,t,r){t=r?n:t;var i=createWrap(e,T,n,n,n,n,n,t);i.placeholder=curry.placeholder;return i}function curryRight(e,t,r){t=r?n:t;var i=createWrap(e,b,n,n,n,n,n,t);i.placeholder=curryRight.placeholder;return i}function debounce(e,t,r){var i,a,s,o,c,l,f=0,p=false,d=false,h=true;if(typeof e!="function"){throw new nt(u)}t=toNumber(t)||0;if(isObject(r)){p=!!r.leading;d="maxWait"in r;s=d?Ht(toNumber(r.maxWait)||0,t):s;h="trailing"in r?!!r.trailing:h}function invokeFunc(t){var r=i,s=a;i=a=n;f=t;o=e.apply(s,r);return o}function leadingEdge(e){f=e;c=Br(timerExpired,t);return p?invokeFunc(e):o}function remainingWait(e){var r=e-l,i=e-f,n=t-r;return d?qt(n,s-i):n}function shouldInvoke(e){var r=e-l,i=e-f;return l===n||r>=t||r<0||d&&i>=s}function timerExpired(){var e=yi();if(shouldInvoke(e)){return trailingEdge(e)}c=Br(timerExpired,remainingWait(e))}function trailingEdge(e){c=n;if(h&&i){return invokeFunc(e)}i=a=n;return o}function cancel(){if(c!==n){Ur(c)}f=0;i=l=a=c=n}function flush(){return c===n?o:trailingEdge(yi())}function debounced(){var e=yi(),r=shouldInvoke(e);i=arguments;a=this;l=e;if(r){if(c===n){return leadingEdge(l)}if(d){Ur(c);c=Br(timerExpired,t);return invokeFunc(l)}}if(c===n){c=Br(timerExpired,t)}return o}debounced.cancel=cancel;debounced.flush=flush;return debounced}var bi=baseRest((function(e,t){return baseDelay(e,1,t)}));var _i=baseRest((function(e,t,r){return baseDelay(e,toNumber(t)||0,r)}));function flip(e){return createWrap(e,I)}function memoize(e,t){if(typeof e!="function"||t!=null&&typeof t!="function"){throw new nt(u)}var memoized=function(){var r=arguments,i=t?t.apply(this,r):r[0],n=memoized.cache;if(n.has(i)){return n.get(i)}var a=e.apply(this,r);memoized.cache=n.set(i,a)||n;return a};memoized.cache=new(memoize.Cache||MapCache);return memoized}memoize.Cache=MapCache;function negate(e){if(typeof e!="function"){throw new nt(u)}return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}}function once(e){return before(2,e)}var Ci=Nr((function(e,t){t=t.length==1&&xi(t[0])?arrayMap(t[0],baseUnary(getIteratee())):arrayMap(baseFlatten(t,1),baseUnary(getIteratee()));var r=t.length;return baseRest((function(i){var n=-1,a=qt(i.length,r);while(++n<a){i[n]=t[n].call(this,i[n])}return apply(e,this,i)}))}));var Ai=baseRest((function(e,t){var r=replaceHolders(t,getHolder(Ai));return createWrap(e,_,n,t,r)}));var Ei=baseRest((function(e,t){var r=replaceHolders(t,getHolder(Ei));return createWrap(e,C,n,t,r)}));var Ii=flatRest((function(e,t){return createWrap(e,E,n,n,n,t)}));function rest(e,t){if(typeof e!="function"){throw new nt(u)}t=t===n?t:toInteger(t);return baseRest(e,t)}function spread(e,t){if(typeof e!="function"){throw new nt(u)}t=t==null?0:Ht(toInteger(t),0);return baseRest((function(r){var i=r[t],n=castSlice(r,0,t);if(i){arrayPush(n,i)}return apply(e,this,n)}))}function throttle(e,t,r){var i=true,n=true;if(typeof e!="function"){throw new nt(u)}if(isObject(r)){i="leading"in r?!!r.leading:i;n="trailing"in r?!!r.trailing:n}return debounce(e,t,{leading:i,maxWait:t,trailing:n})}function unary(e){return ary(e,1)}function wrap(e,t){return Ai(castFunction(t),e)}function castArray(){if(!arguments.length){return[]}var e=arguments[0];return xi(e)?e:[e]}function clone(e){return baseClone(e,h)}function cloneWith(e,t){t=typeof t=="function"?t:n;return baseClone(e,h,t)}function cloneDeep(e){return baseClone(e,p|h)}function cloneDeepWith(e,t){t=typeof t=="function"?t:n;return baseClone(e,p|h,t)}function conformsTo(e,t){return t==null||baseConformsTo(e,t,keys(t))}function eq(e,t){return e===t||e!==e&&t!==t}var Ri=createRelationalOperation(baseGt);var wi=createRelationalOperation((function(e,t){return e>=t}));var $i=baseIsArguments(function(){return arguments}())?baseIsArguments:function(e){return isObjectLike(e)&&lt.call(e,"callee")&&!Ct.call(e,"callee")};var xi=t.isArray;var Oi=fr?baseUnary(fr):baseIsArrayBuffer;function isArrayLike(e){return e!=null&&isLength(e.length)&&!isFunction(e)}function isArrayLikeObject(e){return isObjectLike(e)&&isArrayLike(e)}function isBoolean(e){return e===true||e===false||isObjectLike(e)&&baseGetTag(e)==G}var Di=Ut||stubFalse;var ki=pr?baseUnary(pr):baseIsDate;function isElement(e){return isObjectLike(e)&&e.nodeType===1&&!isPlainObject(e)}function isEmpty(e){if(e==null){return true}if(isArrayLike(e)&&(xi(e)||typeof e=="string"||typeof e.splice=="function"||Di(e)||Pi(e)||$i(e))){return!e.length}var t=qr(e);if(t==J||t==ne){return!e.size}if(isPrototype(e)){return!baseKeys(e).length}for(var r in e){if(lt.call(e,r)){return false}}return true}function isEqual(e,t){return baseIsEqual(e,t)}function isEqualWith(e,t,r){r=typeof r=="function"?r:n;var i=r?r(e,t):n;return i===n?baseIsEqual(e,t,n,r):!!i}function isError(e){if(!isObjectLike(e)){return false}var t=baseGetTag(e);return t==V||t==K||typeof e.message=="string"&&typeof e.name=="string"&&!isPlainObject(e)}function isFinite(e){return typeof e=="number"&&Lt(e)}function isFunction(e){if(!isObject(e)){return false}var t=baseGetTag(e);return t==Y||t==Q||t==W||t==re}function isInteger(e){return typeof e=="number"&&e==toInteger(e)}function isLength(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=U}function isObject(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}function isObjectLike(e){return e!=null&&typeof e=="object"}var Ni=dr?baseUnary(dr):baseIsMap;function isMatch(e,t){return e===t||baseIsMatch(e,t,getMatchData(t))}function isMatchWith(e,t,r){r=typeof r=="function"?r:n;return baseIsMatch(e,t,getMatchData(t),r)}function isNaN(e){return isNumber(e)&&e!=+e}function isNative(e){if(jr(e)){throw new i(o)}return baseIsNative(e)}function isNull(e){return e===null}function isNil(e){return e==null}function isNumber(e){return typeof e=="number"||isObjectLike(e)&&baseGetTag(e)==X}function isPlainObject(e){if(!isObjectLike(e)||baseGetTag(e)!=ee){return false}var t=bt(e);if(t===null){return true}var r=lt.call(t,"constructor")&&t.constructor;return typeof r=="function"&&r instanceof r&&ct.call(r)==ht}var Ui=hr?baseUnary(hr):baseIsRegExp;function isSafeInteger(e){return isInteger(e)&&e>=-U&&e<=U}var Li=gr?baseUnary(gr):baseIsSet;function isString(e){return typeof e=="string"||!xi(e)&&isObjectLike(e)&&baseGetTag(e)==ae}function isSymbol(e){return typeof e=="symbol"||isObjectLike(e)&&baseGetTag(e)==se}var Pi=vr?baseUnary(vr):baseIsTypedArray;function isUndefined(e){return e===n}function isWeakMap(e){return isObjectLike(e)&&qr(e)==ue}function isWeakSet(e){return isObjectLike(e)&&baseGetTag(e)==ce}var Mi=createRelationalOperation(baseLt);var Hi=createRelationalOperation((function(e,t){return e<=t}));function toArray(e){if(!e){return[]}if(isArrayLike(e)){return isString(e)?stringToArray(e):copyArray(e)}if(It&&e[It]){return iteratorToArray(e[It]())}var t=qr(e),r=t==J?mapToArray:t==ne?setToArray:values;return r(e)}function toFinite(e){if(!e){return e===0?e:0}e=toNumber(e);if(e===N||e===-N){var t=e<0?-1:1;return t*L}return e===e?e:0}function toInteger(e){var t=toFinite(e),r=t%1;return t===t?r?t-r:t:0}function toLength(e){return e?baseClamp(toInteger(e),0,M):0}function toNumber(e){if(typeof e=="number"){return e}if(isSymbol(e)){return P}if(isObject(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=isObject(t)?t+"":t}if(typeof e!="string"){return e===0?e:+e}e=e.replace(Le,"");var r=Ke.test(e);return r||Ye.test(e)?rr(e.slice(2),r?2:8):ze.test(e)?P:+e}function toPlainObject(e){return copyObject(e,keysIn(e))}function toSafeInteger(e){return e?baseClamp(toInteger(e),-U,U):e===0?e:0}function toString(e){return e==null?"":baseToString(e)}var qi=createAssigner((function(e,t){if(isPrototype(t)||isArrayLike(t)){copyObject(t,keys(t),e);return}for(var r in t){if(lt.call(t,r)){assignValue(e,r,t[r])}}}));var ji=createAssigner((function(e,t){copyObject(t,keysIn(t),e)}));var Fi=createAssigner((function(e,t,r,i){copyObject(t,keysIn(t),e,i)}));var Bi=createAssigner((function(e,t,r,i){copyObject(t,keys(t),e,i)}));var Wi=flatRest(baseAt);function create(e,t){var r=Rr(e);return t==null?r:baseAssign(r,t)}var Gi=baseRest((function(e,t){e=tt(e);var r=-1;var i=t.length;var a=i>2?t[2]:n;if(a&&isIterateeCall(t[0],t[1],a)){i=1}while(++r<i){var s=t[r];var o=keysIn(s);var u=-1;var c=o.length;while(++u<c){var l=o[u];var f=e[l];if(f===n||eq(f,ot[l])&&!lt.call(e,l)){e[l]=s[l]}}}return e}));var zi=baseRest((function(e){e.push(n,customDefaultsMerge);return apply(Ji,n,e)}));function findKey(e,t){return baseFindKey(e,getIteratee(t,3),baseForOwn)}function findLastKey(e,t){return baseFindKey(e,getIteratee(t,3),baseForOwnRight)}function forIn(e,t){return e==null?e:xr(e,getIteratee(t,3),keysIn)}function forInRight(e,t){return e==null?e:Or(e,getIteratee(t,3),keysIn)}function forOwn(e,t){return e&&baseForOwn(e,getIteratee(t,3))}function forOwnRight(e,t){return e&&baseForOwnRight(e,getIteratee(t,3))}function functions(e){return e==null?[]:baseFunctions(e,keys(e))}function functionsIn(e){return e==null?[]:baseFunctions(e,keysIn(e))}function get(e,t,r){var i=e==null?n:baseGet(e,t);return i===n?r:i}function has(e,t){return e!=null&&hasPath(e,t,baseHas)}function hasIn(e,t){return e!=null&&hasPath(e,t,baseHasIn)}var Ki=createInverter((function(e,t,r){if(t!=null&&typeof t.toString!="function"){t=dt.call(t)}e[t]=r}),constant(identity));var Vi=createInverter((function(e,t,r){if(t!=null&&typeof t.toString!="function"){t=dt.call(t)}if(lt.call(e,t)){e[t].push(r)}else{e[t]=[r]}}),getIteratee);var Yi=baseRest(baseInvoke);function keys(e){return isArrayLike(e)?arrayLikeKeys(e):baseKeys(e)}function keysIn(e){return isArrayLike(e)?arrayLikeKeys(e,true):baseKeysIn(e)}function mapKeys(e,t){var r={};t=getIteratee(t,3);baseForOwn(e,(function(e,i,n){baseAssignValue(r,t(e,i,n),e)}));return r}function mapValues(e,t){var r={};t=getIteratee(t,3);baseForOwn(e,(function(e,i,n){baseAssignValue(r,i,t(e,i,n))}));return r}var Qi=createAssigner((function(e,t,r){baseMerge(e,t,r)}));var Ji=createAssigner((function(e,t,r,i){baseMerge(e,t,r,i)}));var Xi=flatRest((function(e,t){var r={};if(e==null){return r}var i=false;t=arrayMap(t,(function(t){t=castPath(t,e);i||(i=t.length>1);return t}));copyObject(e,getAllKeysIn(e),r);if(i){r=baseClone(r,p|d|h,customOmitClone)}var n=t.length;while(n--){baseUnset(r,t[n])}return r}));function omitBy(e,t){return pickBy(e,negate(getIteratee(t)))}var Zi=flatRest((function(e,t){return e==null?{}:basePick(e,t)}));function pickBy(e,t){if(e==null){return{}}var r=arrayMap(getAllKeysIn(e),(function(e){return[e]}));t=getIteratee(t);return basePickBy(e,r,(function(e,r){return t(e,r[0])}))}function result(e,t,r){t=castPath(t,e);var i=-1,a=t.length;if(!a){a=1;e=n}while(++i<a){var s=e==null?n:e[toKey(t[i])];if(s===n){i=a;s=r}e=isFunction(s)?s.call(e):s}return e}function set(e,t,r){return e==null?e:baseSet(e,t,r)}function setWith(e,t,r,i){i=typeof i=="function"?i:n;return e==null?e:baseSet(e,t,r,i)}var en=createToPairs(keys);var tn=createToPairs(keysIn);function transform(e,t,r){var i=xi(e),n=i||Di(e)||Pi(e);t=getIteratee(t,4);if(r==null){var a=e&&e.constructor;if(n){r=i?new a:[]}else if(isObject(e)){r=isFunction(a)?Rr(bt(e)):{}}else{r={}}}(n?arrayEach:baseForOwn)(e,(function(e,i,n){return t(r,e,i,n)}));return r}function unset(e,t){return e==null?true:baseUnset(e,t)}function update(e,t,r){return e==null?e:baseUpdate(e,t,castFunction(r))}function updateWith(e,t,r,i){i=typeof i=="function"?i:n;return e==null?e:baseUpdate(e,t,castFunction(r),i)}function values(e){return e==null?[]:baseValues(e,keys(e))}function valuesIn(e){return e==null?[]:baseValues(e,keysIn(e))}function clamp(e,t,r){if(r===n){r=t;t=n}if(r!==n){r=toNumber(r);r=r===r?r:0}if(t!==n){t=toNumber(t);t=t===t?t:0}return baseClamp(toNumber(e),t,r)}function inRange(e,t,r){t=toFinite(t);if(r===n){r=t;t=0}else{r=toFinite(r)}e=toNumber(e);return baseInRange(e,t,r)}function random(e,t,r){if(r&&typeof r!="boolean"&&isIterateeCall(e,t,r)){t=r=n}if(r===n){if(typeof t=="boolean"){r=t;t=n}else if(typeof e=="boolean"){r=e;e=n}}if(e===n&&t===n){e=0;t=1}else{e=toFinite(e);if(t===n){t=e;e=0}else{t=toFinite(t)}}if(e>t){var i=e;e=t;t=i}if(r||e%1||t%1){var a=Gt();return qt(e+a*(t-e+tr("1e-"+((a+"").length-1))),t)}return baseRandom(e,t)}var rn=createCompounder((function(e,t,r){t=t.toLowerCase();return e+(r?capitalize(t):t)}));function capitalize(e){return ln(toString(e).toLowerCase())}function deburr(e){e=toString(e);return e&&e.replace(Je,yr).replace(Ft,"")}function endsWith(e,t,r){e=toString(e);t=baseToString(t);var i=e.length;r=r===n?i:baseClamp(toInteger(r),0,i);var a=r;r-=t.length;return r>=0&&e.slice(r,a)==t}function escape(e){e=toString(e);return e&&Re.test(e)?e.replace(Ee,Sr):e}function escapeRegExp(e){e=toString(e);return e&&Ue.test(e)?e.replace(Ne,"\\$&"):e}var nn=createCompounder((function(e,t,r){return e+(r?"-":"")+t.toLowerCase()}));var an=createCompounder((function(e,t,r){return e+(r?" ":"")+t.toLowerCase()}));var sn=createCaseFirst("toLowerCase");function pad(e,t,r){e=toString(e);t=toInteger(t);var i=t?stringSize(e):0;if(!t||i>=t){return e}var n=(t-i)/2;return createPadding(kt(n),r)+e+createPadding(Dt(n),r)}function padEnd(e,t,r){e=toString(e);t=toInteger(t);var i=t?stringSize(e):0;return t&&i<t?e+createPadding(t-i,r):e}function padStart(e,t,r){e=toString(e);t=toInteger(t);var i=t?stringSize(e):0;return t&&i<t?createPadding(t-i,r)+e:e}function parseInt(e,t,r){if(r||t==null){t=0}else if(t){t=+t}return Wt(toString(e).replace(Pe,""),t||0)}function repeat(e,t,r){if(r?isIterateeCall(e,t,r):t===n){t=1}else{t=toInteger(t)}return baseRepeat(toString(e),t)}function replace(){var e=arguments,t=toString(e[0]);return e.length<3?t:t.replace(e[1],e[2])}var on=createCompounder((function(e,t,r){return e+(r?"_":"")+t.toLowerCase()}));function split(e,t,r){if(r&&typeof r!="number"&&isIterateeCall(e,t,r)){t=r=n}r=r===n?M:r>>>0;if(!r){return[]}e=toString(e);if(e&&(typeof t=="string"||t!=null&&!Ui(t))){t=baseToString(t);if(!t&&hasUnicode(e)){return castSlice(stringToArray(e),0,r)}}return e.split(t,r)}var un=createCompounder((function(e,t,r){return e+(r?" ":"")+ln(t)}));function startsWith(e,t,r){e=toString(e);r=r==null?0:baseClamp(toInteger(r),0,e.length);t=baseToString(t);return e.slice(r,r+t.length)==t}function template(e,t,r){var i=lodash.templateSettings;if(r&&isIterateeCall(e,t,r)){t=n}e=toString(e);t=Fi({},t,i,customDefaultsAssignIn);var a=Fi({},t.imports,i.imports,customDefaultsAssignIn),s=keys(a),o=baseValues(a,s);var u,c,l=0,f=t.interpolate||Xe,p="__p += '";var d=rt((t.escape||Xe).source+"|"+f.source+"|"+(f===xe?We:Xe).source+"|"+(t.evaluate||Xe).source+"|$","g");var h="//# sourceURL="+(lt.call(t,"sourceURL")?(t.sourceURL+"").replace(/[\r\n]/g," "):"lodash.templateSources["+ ++Vt+"]")+"\n";e.replace(d,(function(t,r,i,n,a,s){i||(i=n);p+=e.slice(l,s).replace(Ze,escapeStringChar);if(r){u=true;p+="' +\n__e("+r+") +\n'"}if(a){c=true;p+="';\n"+a+";\n__p += '"}if(i){p+="' +\n((__t = ("+i+")) == null ? '' : __t) +\n'"}l=s+t.length;return t}));p+="';\n";var g=lt.call(t,"variable")&&t.variable;if(!g){p="with (obj) {\n"+p+"\n}\n"}p=(c?p.replace(be,""):p).replace(_e,"$1").replace(Ce,"$1;");p="function("+(g||"obj")+") {\n"+(g?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(u?", __e = _.escape":"")+(c?", __j = Array.prototype.join;\n"+"function print() { __p += __j.call(arguments, '') }\n":";\n")+p+"return __p\n}";var v=fn((function(){return Fe(s,h+"return "+p).apply(n,o)}));v.source=p;if(isError(v)){throw v}return v}function toLower(e){return toString(e).toLowerCase()}function toUpper(e){return toString(e).toUpperCase()}function trim(e,t,r){e=toString(e);if(e&&(r||t===n)){return e.replace(Le,"")}if(!e||!(t=baseToString(t))){return e}var i=stringToArray(e),a=stringToArray(t),s=charsStartIndex(i,a),o=charsEndIndex(i,a)+1;return castSlice(i,s,o).join("")}function trimEnd(e,t,r){e=toString(e);if(e&&(r||t===n)){return e.replace(Me,"")}if(!e||!(t=baseToString(t))){return e}var i=stringToArray(e),a=charsEndIndex(i,stringToArray(t))+1;return castSlice(i,0,a).join("")}function trimStart(e,t,r){e=toString(e);if(e&&(r||t===n)){return e.replace(Pe,"")}if(!e||!(t=baseToString(t))){return e}var i=stringToArray(e),a=charsStartIndex(i,stringToArray(t));return castSlice(i,a).join("")}function truncate(e,t){var r=R,i=w;if(isObject(t)){var a="separator"in t?t.separator:a;r="length"in t?toInteger(t.length):r;i="omission"in t?baseToString(t.omission):i}e=toString(e);var s=e.length;if(hasUnicode(e)){var o=stringToArray(e);s=o.length}if(r>=s){return e}var u=r-stringSize(i);if(u<1){return i}var c=o?castSlice(o,0,u).join(""):e.slice(0,u);if(a===n){return c+i}if(o){u+=c.length-u}if(Ui(a)){if(e.slice(u).search(a)){var l,f=c;if(!a.global){a=rt(a.source,toString(Ge.exec(a))+"g")}a.lastIndex=0;while(l=a.exec(f)){var p=l.index}c=c.slice(0,p===n?u:p)}}else if(e.indexOf(baseToString(a),u)!=u){var d=c.lastIndexOf(a);if(d>-1){c=c.slice(0,d)}}return c+i}function unescape(e){e=toString(e);return e&&Ie.test(e)?e.replace(Ae,Tr):e}var cn=createCompounder((function(e,t,r){return e+(r?" ":"")+t.toUpperCase()}));var ln=createCaseFirst("toUpperCase");function words(e,t,r){e=toString(e);t=r?n:t;if(t===n){return hasUnicodeWord(e)?unicodeWords(e):asciiWords(e)}return e.match(t)||[]}var fn=baseRest((function(e,t){try{return apply(e,n,t)}catch(e){return isError(e)?e:new i(e)}}));var pn=flatRest((function(e,t){arrayEach(t,(function(t){t=toKey(t);baseAssignValue(e,t,Si(e[t],e))}));return e}));function cond(e){var t=e==null?0:e.length,r=getIteratee();e=!t?[]:arrayMap(e,(function(e){if(typeof e[1]!="function"){throw new nt(u)}return[r(e[0]),e[1]]}));return baseRest((function(r){var i=-1;while(++i<t){var n=e[i];if(apply(n[0],this,r)){return apply(n[1],this,r)}}}))}function conforms(e){return baseConforms(baseClone(e,p))}function constant(e){return function(){return e}}function defaultTo(e,t){return e==null||e!==e?t:e}var dn=createFlow();var hn=createFlow(true);function identity(e){return e}function iteratee(e){return baseIteratee(typeof e=="function"?e:baseClone(e,p))}function matches(e){return baseMatches(baseClone(e,p))}function matchesProperty(e,t){return baseMatchesProperty(e,baseClone(t,p))}var gn=baseRest((function(e,t){return function(r){return baseInvoke(r,e,t)}}));var vn=baseRest((function(e,t){return function(r){return baseInvoke(e,r,t)}}));function mixin(e,t,r){var i=keys(t),n=baseFunctions(t,i);if(r==null&&!(isObject(t)&&(n.length||!i.length))){r=t;t=e;e=this;n=baseFunctions(t,keys(t))}var a=!(isObject(r)&&"chain"in r)||!!r.chain,s=isFunction(e);arrayEach(n,(function(r){var i=t[r];e[r]=i;if(s){e.prototype[r]=function(){var t=this.__chain__;if(a||t){var r=e(this.__wrapped__),n=r.__actions__=copyArray(this.__actions__);n.push({func:i,args:arguments,thisArg:e});r.__chain__=t;return r}return i.apply(e,arrayPush([this.value()],arguments))}}}));return e}function noConflict(){if(ar._===this){ar._=gt}return this}function noop(){}function nthArg(e){e=toInteger(e);return baseRest((function(t){return baseNth(t,e)}))}var mn=createOver(arrayMap);var yn=createOver(arrayEvery);var Sn=createOver(arraySome);function property(e){return isKey(e)?baseProperty(toKey(e)):basePropertyDeep(e)}function propertyOf(e){return function(t){return e==null?n:baseGet(e,t)}}var Tn=createRange();var bn=createRange(true);function stubArray(){return[]}function stubFalse(){return false}function stubObject(){return{}}function stubString(){return""}function stubTrue(){return true}function times(e,t){e=toInteger(e);if(e<1||e>U){return[]}var r=M,i=qt(e,M);t=getIteratee(t);e-=M;var n=baseTimes(i,t);while(++r<e){t(r)}return n}function toPath(e){if(xi(e)){return arrayMap(e,toKey)}return isSymbol(e)?[e]:copyArray(Gr(toString(e)))}function uniqueId(e){var t=++ft;return toString(e)+t}var _n=createMathOperation((function(e,t){return e+t}),0);var Cn=createRound("ceil");var An=createMathOperation((function(e,t){return e/t}),1);var En=createRound("floor");function max(e){return e&&e.length?baseExtremum(e,identity,baseGt):n}function maxBy(e,t){return e&&e.length?baseExtremum(e,getIteratee(t,2),baseGt):n}function mean(e){return baseMean(e,identity)}function meanBy(e,t){return baseMean(e,getIteratee(t,2))}function min(e){return e&&e.length?baseExtremum(e,identity,baseLt):n}function minBy(e,t){return e&&e.length?baseExtremum(e,getIteratee(t,2),baseLt):n}var In=createMathOperation((function(e,t){return e*t}),1);var Rn=createRound("round");var wn=createMathOperation((function(e,t){return e-t}),0);function sum(e){return e&&e.length?baseSum(e,identity):0}function sumBy(e,t){return e&&e.length?baseSum(e,getIteratee(t,2)):0}lodash.after=after;lodash.ary=ary;lodash.assign=qi;lodash.assignIn=ji;lodash.assignInWith=Fi;lodash.assignWith=Bi;lodash.at=Wi;lodash.before=before;lodash.bind=Si;lodash.bindAll=pn;lodash.bindKey=Ti;lodash.castArray=castArray;lodash.chain=chain;lodash.chunk=chunk;lodash.compact=compact;lodash.concat=concat;lodash.cond=cond;lodash.conforms=conforms;lodash.constant=constant;lodash.countBy=li;lodash.create=create;lodash.curry=curry;lodash.curryRight=curryRight;lodash.debounce=debounce;lodash.defaults=Gi;lodash.defaultsDeep=zi;lodash.defer=bi;lodash.delay=_i;lodash.difference=zr;lodash.differenceBy=Kr;lodash.differenceWith=Vr;lodash.drop=drop;lodash.dropRight=dropRight;lodash.dropRightWhile=dropRightWhile;lodash.dropWhile=dropWhile;lodash.fill=fill;lodash.filter=filter;lodash.flatMap=flatMap;lodash.flatMapDeep=flatMapDeep;lodash.flatMapDepth=flatMapDepth;lodash.flatten=flatten;lodash.flattenDeep=flattenDeep;lodash.flattenDepth=flattenDepth;lodash.flip=flip;lodash.flow=dn;lodash.flowRight=hn;lodash.fromPairs=fromPairs;lodash.functions=functions;lodash.functionsIn=functionsIn;lodash.groupBy=di;lodash.initial=initial;lodash.intersection=Yr;lodash.intersectionBy=Qr;lodash.intersectionWith=Jr;lodash.invert=Ki;lodash.invertBy=Vi;lodash.invokeMap=hi;lodash.iteratee=iteratee;lodash.keyBy=gi;lodash.keys=keys;lodash.keysIn=keysIn;lodash.map=map;lodash.mapKeys=mapKeys;lodash.mapValues=mapValues;lodash.matches=matches;lodash.matchesProperty=matchesProperty;lodash.memoize=memoize;lodash.merge=Qi;lodash.mergeWith=Ji;lodash.method=gn;lodash.methodOf=vn;lodash.mixin=mixin;lodash.negate=negate;lodash.nthArg=nthArg;lodash.omit=Xi;lodash.omitBy=omitBy;lodash.once=once;lodash.orderBy=orderBy;lodash.over=mn;lodash.overArgs=Ci;lodash.overEvery=yn;lodash.overSome=Sn;lodash.partial=Ai;lodash.partialRight=Ei;lodash.partition=vi;lodash.pick=Zi;lodash.pickBy=pickBy;lodash.property=property;lodash.propertyOf=propertyOf;lodash.pull=Xr;lodash.pullAll=pullAll;lodash.pullAllBy=pullAllBy;lodash.pullAllWith=pullAllWith;lodash.pullAt=Zr;lodash.range=Tn;lodash.rangeRight=bn;lodash.rearg=Ii;lodash.reject=reject;lodash.remove=remove;lodash.rest=rest;lodash.reverse=reverse;lodash.sampleSize=sampleSize;lodash.set=set;lodash.setWith=setWith;lodash.shuffle=shuffle;lodash.slice=slice;lodash.sortBy=mi;lodash.sortedUniq=sortedUniq;lodash.sortedUniqBy=sortedUniqBy;lodash.split=split;lodash.spread=spread;lodash.tail=tail;lodash.take=take;lodash.takeRight=takeRight;lodash.takeRightWhile=takeRightWhile;lodash.takeWhile=takeWhile;lodash.tap=tap;lodash.throttle=throttle;lodash.thru=thru;lodash.toArray=toArray;lodash.toPairs=en;lodash.toPairsIn=tn;lodash.toPath=toPath;lodash.toPlainObject=toPlainObject;lodash.transform=transform;lodash.unary=unary;lodash.union=ei;lodash.unionBy=ti;lodash.unionWith=ri;lodash.uniq=uniq;lodash.uniqBy=uniqBy;lodash.uniqWith=uniqWith;lodash.unset=unset;lodash.unzip=unzip;lodash.unzipWith=unzipWith;lodash.update=update;lodash.updateWith=updateWith;lodash.values=values;lodash.valuesIn=valuesIn;lodash.without=ii;lodash.words=words;lodash.wrap=wrap;lodash.xor=ni;lodash.xorBy=ai;lodash.xorWith=si;lodash.zip=oi;lodash.zipObject=zipObject;lodash.zipObjectDeep=zipObjectDeep;lodash.zipWith=ui;lodash.entries=en;lodash.entriesIn=tn;lodash.extend=ji;lodash.extendWith=Fi;mixin(lodash,lodash);lodash.add=_n;lodash.attempt=fn;lodash.camelCase=rn;lodash.capitalize=capitalize;lodash.ceil=Cn;lodash.clamp=clamp;lodash.clone=clone;lodash.cloneDeep=cloneDeep;lodash.cloneDeepWith=cloneDeepWith;lodash.cloneWith=cloneWith;lodash.conformsTo=conformsTo;lodash.deburr=deburr;lodash.defaultTo=defaultTo;lodash.divide=An;lodash.endsWith=endsWith;lodash.eq=eq;lodash.escape=escape;lodash.escapeRegExp=escapeRegExp;lodash.every=every;lodash.find=fi;lodash.findIndex=findIndex;lodash.findKey=findKey;lodash.findLast=pi;lodash.findLastIndex=findLastIndex;lodash.findLastKey=findLastKey;lodash.floor=En;lodash.forEach=forEach;lodash.forEachRight=forEachRight;lodash.forIn=forIn;lodash.forInRight=forInRight;lodash.forOwn=forOwn;lodash.forOwnRight=forOwnRight;lodash.get=get;lodash.gt=Ri;lodash.gte=wi;lodash.has=has;lodash.hasIn=hasIn;lodash.head=head;lodash.identity=identity;lodash.includes=includes;lodash.indexOf=indexOf;lodash.inRange=inRange;lodash.invoke=Yi;lodash.isArguments=$i;lodash.isArray=xi;lodash.isArrayBuffer=Oi;lodash.isArrayLike=isArrayLike;lodash.isArrayLikeObject=isArrayLikeObject;lodash.isBoolean=isBoolean;lodash.isBuffer=Di;lodash.isDate=ki;lodash.isElement=isElement;lodash.isEmpty=isEmpty;lodash.isEqual=isEqual;lodash.isEqualWith=isEqualWith;lodash.isError=isError;lodash.isFinite=isFinite;lodash.isFunction=isFunction;lodash.isInteger=isInteger;lodash.isLength=isLength;lodash.isMap=Ni;lodash.isMatch=isMatch;lodash.isMatchWith=isMatchWith;lodash.isNaN=isNaN;lodash.isNative=isNative;lodash.isNil=isNil;lodash.isNull=isNull;lodash.isNumber=isNumber;lodash.isObject=isObject;lodash.isObjectLike=isObjectLike;lodash.isPlainObject=isPlainObject;lodash.isRegExp=Ui;lodash.isSafeInteger=isSafeInteger;lodash.isSet=Li;lodash.isString=isString;lodash.isSymbol=isSymbol;lodash.isTypedArray=Pi;lodash.isUndefined=isUndefined;lodash.isWeakMap=isWeakMap;lodash.isWeakSet=isWeakSet;lodash.join=join;lodash.kebabCase=nn;lodash.last=last;lodash.lastIndexOf=lastIndexOf;lodash.lowerCase=an;lodash.lowerFirst=sn;lodash.lt=Mi;lodash.lte=Hi;lodash.max=max;lodash.maxBy=maxBy;lodash.mean=mean;lodash.meanBy=meanBy;lodash.min=min;lodash.minBy=minBy;lodash.stubArray=stubArray;lodash.stubFalse=stubFalse;lodash.stubObject=stubObject;lodash.stubString=stubString;lodash.stubTrue=stubTrue;lodash.multiply=In;lodash.nth=nth;lodash.noConflict=noConflict;lodash.noop=noop;lodash.now=yi;lodash.pad=pad;lodash.padEnd=padEnd;lodash.padStart=padStart;lodash.parseInt=parseInt;lodash.random=random;lodash.reduce=reduce;lodash.reduceRight=reduceRight;lodash.repeat=repeat;lodash.replace=replace;lodash.result=result;lodash.round=Rn;lodash.runInContext=runInContext;lodash.sample=sample;lodash.size=size;lodash.snakeCase=on;lodash.some=some;lodash.sortedIndex=sortedIndex;lodash.sortedIndexBy=sortedIndexBy;lodash.sortedIndexOf=sortedIndexOf;lodash.sortedLastIndex=sortedLastIndex;lodash.sortedLastIndexBy=sortedLastIndexBy;lodash.sortedLastIndexOf=sortedLastIndexOf;lodash.startCase=un;lodash.startsWith=startsWith;lodash.subtract=wn;lodash.sum=sum;lodash.sumBy=sumBy;lodash.template=template;lodash.times=times;lodash.toFinite=toFinite;lodash.toInteger=toInteger;lodash.toLength=toLength;lodash.toLower=toLower;lodash.toNumber=toNumber;lodash.toSafeInteger=toSafeInteger;lodash.toString=toString;lodash.toUpper=toUpper;lodash.trim=trim;lodash.trimEnd=trimEnd;lodash.trimStart=trimStart;lodash.truncate=truncate;lodash.unescape=unescape;lodash.uniqueId=uniqueId;lodash.upperCase=cn;lodash.upperFirst=ln;lodash.each=forEach;lodash.eachRight=forEachRight;lodash.first=head;mixin(lodash,function(){var e={};baseForOwn(lodash,(function(t,r){if(!lt.call(lodash.prototype,r)){e[r]=t}}));return e}(),{chain:false});lodash.VERSION=a;arrayEach(["bind","bindKey","curry","curryRight","partial","partialRight"],(function(e){lodash[e].placeholder=lodash}));arrayEach(["drop","take"],(function(e,t){LazyWrapper.prototype[e]=function(r){r=r===n?1:Ht(toInteger(r),0);var i=this.__filtered__&&!t?new LazyWrapper(this):this.clone();if(i.__filtered__){i.__takeCount__=qt(r,i.__takeCount__)}else{i.__views__.push({size:qt(r,M),type:e+(i.__dir__<0?"Right":"")})}return i};LazyWrapper.prototype[e+"Right"]=function(t){return this.reverse()[e](t).reverse()}}));arrayEach(["filter","map","takeWhile"],(function(e,t){var r=t+1,i=r==O||r==k;LazyWrapper.prototype[e]=function(e){var t=this.clone();t.__iteratees__.push({iteratee:getIteratee(e,3),type:r});t.__filtered__=t.__filtered__||i;return t}}));arrayEach(["head","last"],(function(e,t){var r="take"+(t?"Right":"");LazyWrapper.prototype[e]=function(){return this[r](1).value()[0]}}));arrayEach(["initial","tail"],(function(e,t){var r="drop"+(t?"":"Right");LazyWrapper.prototype[e]=function(){return this.__filtered__?new LazyWrapper(this):this[r](1)}}));LazyWrapper.prototype.compact=function(){return this.filter(identity)};LazyWrapper.prototype.find=function(e){return this.filter(e).head()};LazyWrapper.prototype.findLast=function(e){return this.reverse().find(e)};LazyWrapper.prototype.invokeMap=baseRest((function(e,t){if(typeof e=="function"){return new LazyWrapper(this)}return this.map((function(r){return baseInvoke(r,e,t)}))}));LazyWrapper.prototype.reject=function(e){return this.filter(negate(getIteratee(e)))};LazyWrapper.prototype.slice=function(e,t){e=toInteger(e);var r=this;if(r.__filtered__&&(e>0||t<0)){return new LazyWrapper(r)}if(e<0){r=r.takeRight(-e)}else if(e){r=r.drop(e)}if(t!==n){t=toInteger(t);r=t<0?r.dropRight(-t):r.take(t-e)}return r};LazyWrapper.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()};LazyWrapper.prototype.toArray=function(){return this.take(M)};baseForOwn(LazyWrapper.prototype,(function(e,t){var r=/^(?:filter|find|map|reject)|While$/.test(t),i=/^(?:head|last)$/.test(t),a=lodash[i?"take"+(t=="last"?"Right":""):t],s=i||/^find/.test(t);if(!a){return}lodash.prototype[t]=function(){var t=this.__wrapped__,o=i?[1]:arguments,u=t instanceof LazyWrapper,c=o[0],l=u||xi(t);var interceptor=function(e){var t=a.apply(lodash,arrayPush([e],o));return i&&f?t[0]:t};if(l&&r&&typeof c=="function"&&c.length!=1){u=l=false}var f=this.__chain__,p=!!this.__actions__.length,d=s&&!f,h=u&&!p;if(!s&&l){t=h?t:new LazyWrapper(this);var g=e.apply(t,o);g.__actions__.push({func:thru,args:[interceptor],thisArg:n});return new LodashWrapper(g,f)}if(d&&h){return e.apply(this,o)}g=this.thru(interceptor);return d?i?g.value()[0]:g.value():g}}));arrayEach(["pop","push","shift","sort","splice","unshift"],(function(e){var t=at[e],r=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",i=/^(?:pop|shift)$/.test(e);lodash.prototype[e]=function(){var e=arguments;if(i&&!this.__chain__){var n=this.value();return t.apply(xi(n)?n:[],e)}return this[r]((function(r){return t.apply(xi(r)?r:[],e)}))}}));baseForOwn(LazyWrapper.prototype,(function(e,t){var r=lodash[t];if(r){var i=r.name+"";if(!lt.call(or,i)){or[i]=[]}or[i].push({name:t,func:r})}}));or[createHybrid(n,y).name]=[{name:"wrapper",func:n}];LazyWrapper.prototype.clone=lazyClone;LazyWrapper.prototype.reverse=lazyReverse;LazyWrapper.prototype.value=lazyValue;lodash.prototype.at=ci;lodash.prototype.chain=wrapperChain;lodash.prototype.commit=wrapperCommit;lodash.prototype.next=wrapperNext;lodash.prototype.plant=wrapperPlant;lodash.prototype.reverse=wrapperReverse;lodash.prototype.toJSON=lodash.prototype.valueOf=lodash.prototype.value=wrapperValue;lodash.prototype.first=lodash.prototype.head;if(It){lodash.prototype[It]=wrapperToIterator}return lodash};var _r=br();if(true){ar._=_r;!(i=function(){return _r}.call(t,r,t,e),i!==n&&(e.exports=i))}else{}}).call(this)},152871:e=>{function stubArray(){return[]}e.exports=stubArray},716912:e=>{function stubFalse(){return false}e.exports=stubFalse},365832:e=>{"use strict";e.exports={i8:"0.8.9"}},861508:e=>{"use strict";e.exports=JSON.parse('{"name":"sip.js","title":"SIP.js","description":"A simple, intuitive, and powerful JavaScript signaling library","version":"0.13.5","license":"MIT","main":"lib/index.js","homepage":"https://sipjs.com","author":"OnSIP <developer@onsip.com> (https://sipjs.com/aboutus/)","contributors":[{"url":"https://github.com/onsip/SIP.js/blob/master/THANKS.md"}],"repository":{"type":"git","url":"https://github.com/onsip/SIP.js.git"},"keywords":["sip","websocket","webrtc","library","javascript"],"dependencies":{"crypto-js":"^3.1.9-1"},"devDependencies":{"@types/node":"^11.9.0","circular-dependency-plugin":"^5.0.2","jasmine-core":"^3.3.0","karma":"^4.0.0","karma-chrome-launcher":"^2.2.0","karma-cli":"^2.0.0","karma-jasmine":"^2.0.1","karma-jasmine-html-reporter":"^1.4.0","karma-mocha-reporter":"^2.2.5","karma-webpack":"^3.0.5","pegjs":"^0.10.0","ts-loader":"^5.3.3","ts-pegjs":"0.2.2","tslint":"^5.12.1","typescript":"^3.3.3","webpack":"^4.29.3","webpack-cli":"^3.2.3"},"engines":{"node":">=8.0"},"scripts":{"prebuild":"tslint -p tsconfig.json -c tslint.json","generate-grammar":"node build/grammarGenerator.js","build-reg-bundle":"webpack --progress --config build/webpack.config.js --env.buildType reg","build-min-bundle":"webpack --progress --config build/webpack.config.js --env.buildType min","build-bundles":"npm run build-reg-bundle && npm run build-min-bundle","build-lib":"tsc","copy-dist-files":"cp dist/sip.js dist/sip-$npm_package_version.js && cp dist/sip.min.js  dist/sip-$npm_package_version.min.js","build":"npm run generate-grammar && npm run build-lib && npm run build-reg-bundle && npm run build-min-bundle && npm run copy-dist-files","browserTest":"sleep 2 && open http://0.0.0.0:9876/debug.html & karma start --reporters kjhtml --no-single-run","commandLineTest":"karma start --reporters mocha --browsers ChromeHeadless --single-run","buildAndTest":"npm run build && npm run commandLineTest","buildAndBrowserTest":"npm run build && npm run browserTest"},"types":"./types"}')}}]);