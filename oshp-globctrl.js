"use strict";var oshpGlobCtrl=oshpApp.controller("oshpGlobCtrl",["$scope","$rootScope","$location","SessionKeeper","$log","$window","$q","$http","ThinNative","Keepalive","ContentService","$modal","Idle","$browser","$filter","$cookies","$routeParams","$timeout",function($scope,$rootScope,$location,SessionKeeper,$log,$window,$q,$http,ThinNative,Keepalive,ContentService,$modal,Idle,$browser,$filter,$cookies,$routeParams,$timeout){$scope.HALOCConfig=HALOCConfig,$scope.OrderHistoryIdpLoginConfig=orderHistoryIdpLoginConfig,$scope.IDPConfig=IDPConfig,$rootScope.authenticateUserWithHALOC=function(){window.location.href=HALOCConfig.HALOCAuthenticationURL+"?appid="+HALOCConfig.appID},$rootScope.redirectToIdpHistory=function(){window.location.href=orderHistoryIdpLoginConfig.OrderhistoryIDPLoginURL},$rootScope.ASLALoggingService=function(appID,eventType,userID,status){var ASLALoggingRequest={AppID:appID,EventType:eventType,LoginId:userID,Result:status};$http({method:"POST",url:ASLAConfig.ASLALoggingUrl,headers:{"Content-Type":"application/json"},data:ASLALoggingRequest}).then(function(){$log.info("ASLA logging has been completed for above user id with status :: "+status)})},-1!==$location.absUrl().indexOf("customerType=SMB")&&($scope.searchforSMB="&customerType=SMB"),$log.log("entering Order Search GlobCtrl");try{$log.log("Making detm disableAutoPageLoad"),DataMappingInterface.disableAutoPageLoad()}catch(e){$log.log("exception in oshp-globctrl.js: before disableAutoPageLoad")}$scope.firstNameRegExp="[A-Za-z][ A-Za-z',.-]*",$scope.lastNameRegExp="[A-Za-z][ A-Za-z',.-]*",$scope.validDataRegExp="[A-Za-z0-9!?',.-][ A-Za-z0-9!?',.-]*",$scope.zipCodeRegExp="^\\d{1,5}(?:[-]?\\d{0,4})?",$scope.zipCodePattern="/^\\d{5}(?:[-]?\\d{4})?$/",$scope.digitsRegExp="[0-9]*",$scope.alphaRegExp="[A-Za-z][A-Za-z ]*",$scope.alphaNumericRegExp="[A-Za-z0-9]*",$scope.txNumberExp="[A-Za-z0-9][A-Za-z0-9_]*";var current=$rootScope.current;$rootScope.$on("$routeChangeSuccess",function(){try{var locationURL=window.location.href;if(console.log("current path :::"+locationURL),locationURL.indexOf("ordertoken")>-1&&($rootScope.isOrderTokenUrl=!0),angular.isDefined(current)&&angular.isDefined(current.orderDetails)&&angular.isDefined(current.orderDetails.orders)&&angular.isDefined(current.orderDetails.orders[0])&&angular.isDefined(current.orderDetails.orders[0].account))var isFirstNetCustomer=current.orderDetails.orders[0].account.firstNetIndicator;var header=document.querySelector("attwc-globalnav-header"),footer=document.querySelector("attwc-globalnav-footer");angular.isDefined(firstNetConstants)&&angular.isDefined(firstNetConstants.firstNetFlag)&&1==firstNetConstants.firstNetFlag&&-1==locationURL.indexOf("/omhub")?(console.log("isOmHubInternalFlow ::: true"),"true"==isFirstNetCustomer&&(header.setAttribute("customer-type","opss-firstnet"),footer.setAttribute("customer-type","opss-firstnet"),header.setAttribute("exclude-core-elements","cart, search, profile, lobcta, banner"),console.log("new GN header parameter is :::"+header.getAttribute("customer-type")),console.log("new GN footer parameter is :::"+footer.getAttribute("customer-type")))):(header.setAttribute("customer-type","consumer"),footer.setAttribute("customer-type","consumer"),console.log("new GN header parameter is :::"+header.getAttribute("customer-type")),console.log("new GN footer parameter is :::"+footer.getAttribute("customer-type")),header.setAttribute("exclude-core-elements",""))}catch(e){console.log(e)}}),$rootScope.isViewLoading=!1,$rootScope.$on("$routeChangeSuccess",function(){window.scrollTo(0,0),$("html, body").animate({scrollTop:0},200)}),$rootScope.$on("$viewContentLoaded",function(){$("#skipGNnav").attr("tabIndex",-1).on("focus")}),$widgetJquery(document).ready(function(){setTimeout(function(){$('#z1-cart-open[title="Cart"]').attr("tabindex","0")},1e3)}),$rootScope.$on("$routeChangeStart",function(event,next,current){$rootScope.isViewLoading=!0,$rootScope.$broadcast("inProgressStart");var url=$location.absUrl();$rootScope.current&&($rootScope.current.language=-1!=url.indexOf("/es-us/")?"es-US":"en-US")}),$rootScope.$on("$routeChangeSuccess",function(event,current,previous){$rootScope.$broadcast("inProgressEnd"),$rootScope.isViewLoading=!1,$scope.newLocation=$location.path()}),$rootScope.$on("$routeChangeError",function(event,current,previous,rejection){if($rootScope.isViewLoading=!1,$log.log("entering $routeChangeError type:"+rejection.type),rejection&&rejection.code)switch($rootScope.setStatus(rejection),rejection.type){case"OPG_ERROR":$rootScope.replaceView("orderDetails");break;case"OCG_ERROR":$rootScope.replaceView("cancelOrder");break;case"OAG_ERROR":case"ODG_ERROR":$rootScope.replaceView("orderDetails");break;case"DetailFailure":$scope.dtmFormResponseErrorLandingPage(rejection.code,"CMO_Order_Search_Submit"),$rootScope.replaceView("omhub");break;case"OHG_ERROR":$rootScope.replaceView("omhub");break;case"SummaryFailure":$rootScope.dtmFormResponseErrorFromSummaryPage(rejection.code),$rootScope.replaceView("omhub");break;case"MSFailure":default:$rootScope.replaceView("omhub")}else rejection&&rejection.type&&"SummaryFailure"===rejection.type&&$rootScope.replaceView("omhub");$rootScope.$broadcast("inProgressEnd")}),current||(current=$rootScope.current=SessionKeeper.read()),current||((current=$rootScope.current=angular.copy(oshpData.defaults.current)).language=navigator.language||navigator.userLanguage),$rootScope.setView=function(name,from){return $rootScope.current.previousView=from,SessionKeeper.save(),null!=current.ReportingSource&&$location.search("source",current.ReportingSource),$location.path("/checkmyorder/"+name+".rt")},$rootScope.replaceConsentString=function(content,date){var dateOut=new Date(date),concesntDate=$filter("date")(dateOut,"MMMM d, y");return content.replace("[X]",concesntDate)},$rootScope.replaceView=function(name){$rootScope.setView(name).replace()},$rootScope.replaceString=function(content,value){return content.replace("[X]",value)},$rootScope.replaceMultiString=function(content,value1,value2){return content.replace("[X]",value1).replace("[Y]",value2)},$rootScope.replaceCancelItemString=function(content,value){return 1===value?content.concat(" ("+value+" item)"):content.concat(" ("+value+" items)")},$rootScope.replaceCarrierString=function(content,value){return void 0!==value&&null!=value&&""!==value?content.replace("[X]",value):void 0!==content&&null!=content&&""!==content?content.replace("[X]","We"):void 0},$rootScope.replaceTenderString=function(content,value){return void 0!==value&&null!=value&&""!==value?content.replace("[X]",value):content},$rootScope.invokeChat=function(pageId){$log.log("invokeChat MethodCall using pageID : "+pageId),Inq&&"undefined"!=Inq&&null!=Inq&&($log.log("Invoking"),Inq.reinitChat(pageId))},$rootScope.nextView=function(){$rootScope.setView(current.nextView)},$rootScope.setStatus=function(status){$log.info("in set status",status),$rootScope.status=status?angular.copy(status):angular.copy(oshpData.defaults.status),$log.log($rootScope.status)},$rootScope.resetStatusError=function(){$rootScope.status&&($rootScope.status=angular.copy(oshpData.defaults.status))},$rootScope.focusOnError=function(){navigator.userAgent.match(/(Android)/i)&&angular.element(".alert-error").removeAttr("role"),$timeout(function(){var focusElement=angular.element(".alert");focusElement&&(focusElement.attr("tabindex","0"),focusElement.focus())},500)},$rootScope.setNonWLSItemName=function(nonWLSItem,isCease){var nonWLSItemName;if(void 0!=nonWLSItem&&null!=nonWLSItem)return nonWLSItemName="InternetInstallation"===nonWLSItem?$rootScope.content.M_7_70_1_HUB_Order_Summary.OrderSummaryEG.FieldLabels.InternetInstallation.Label:"DTVInstallation"===nonWLSItem?$rootScope.content.M_7_70_1_HUB_Order_Summary.OrderSummaryEG.FieldLabels.DTVInstallation.Label:"UverseTVInstallation"===nonWLSItem?$rootScope.content.M_7_70_1_HUB_Order_Summary.OrderSummaryEG.FieldLabels.UverseTVInstallation.Label:"PhoneInstallation"===nonWLSItem?$rootScope.content.M_7_70_1_HUB_Order_Summary.OrderSummaryEG.FieldLabels.PhoneInstallation.Label:"InternetPlanChange"===nonWLSItem?$rootScope.content.M_7_70_1_HUB_Order_Summary.OrderSummaryEG.FieldLabels.InternetPlanChange.Label:"DTVPlanChange"===nonWLSItem?$rootScope.content.M_7_70_1_HUB_Order_Summary.OrderSummaryEG.FieldLabels.DTVPlanChange.Label:"PhonePlanChange"===nonWLSItem?$rootScope.content.M_7_70_1_HUB_Order_Summary.OrderSummaryEG.FieldLabels.PhonePlanChange.Label:"UverseTVPlanChange"===nonWLSItem?$rootScope.content.M_7_70_1_HUB_Order_Summary.OrderSummaryEG.FieldLabels.UverseTVPlanChange.Label:nonWLSItem.name,isCease&&(nonWLSItemName=nonWLSItemName.replace("installation","")),nonWLSItemName},$rootScope.isMobile=function(){var devName="",screenWidth=$(window).width();return screenWidth<=480?(localStorage.setItem("dtmRWD","Smartphone"),devName="Mbl-"):screenWidth<=768&&screenWidth>480?(localStorage.setItem("dtmRWD","Tablet"),devName="Mbl-"):localStorage.setItem("dtmRWD","Desktop"),localStorage.setItem("dtmRWDFlag","1"),devName},$rootScope.pageHitTrack=function(pageId){var dtmURI=window.location.pathname;$scope.dtmCustomNotification("pageLoad","Page_Load","","","",pageId,dtmURI)},$rootScope.dtmCustomNotification=function(eventAction,eventCode,flag,status,fulldataset,dtmPN,dtmURI){""!==dtmPN&&localStorage.setItem("dtmPN",$rootScope.isMobile()+dtmPN),""!==dtmURI&&localStorage.setItem("dtmURI",dtmURI),""===flag&&""===status&&""===fulldataset?$rootScope.$broadcast("customeventnotification",{eventAction:eventAction,eventCode:eventCode},$scope):""===flag&&""===status?$rootScope.$broadcast("customeventnotification",{eventAction:eventAction,eventCode:$rootScope.isMobile()+eventCode,additionaldata:fulldataset},$scope):""===fulldataset?$rootScope.$broadcast("customeventnotification",{eventAction:eventAction,eventCode:$rootScope.isMobile()+eventCode,successFlag:flag,statusCode:status},$scope):"CMO_Order_Search_Submit"===eventCode&&"Mbl-"===$rootScope.isMobile()?$rootScope.$broadcast("customeventnotification",{eventAction:eventAction,eventCode:eventCode,successFlag:flag,statusCode:status,additionaldata:fulldataset},$scope):$rootScope.$broadcast("customeventnotification",{eventAction:eventAction,eventCode:$rootScope.isMobile()+eventCode,successFlag:flag,statusCode:status,additionaldata:fulldataset},$scope)};var browserCookies=$browser.cookies(),browserId=browserCookies.browserid;if(void 0===browserId){var rand=Math.random();browserId=(browserId="W01"+(new Date).getTime()+rand).replace(".","0"),document.cookie="browserid="+browserId}else browserId=browserCookies.browserid;sessionStorage.setItem("browserid",browserId),$rootScope.setChatVariables=function(orders,OrderStatus,errorType){if(void 0!==ddo&&orders){var portInd="true"===orders.portOrder?"YES":"NO",clientOrderNum=orders.orderNumber,CTN=void 0!==orders.ctn?orders.ctn:"",UserName="";void 0!==orders.fName&&void 0!==orders.lName?UserName=orders.fName+" "+orders.lName:void 0!==orders.fName?UserName=orders.fName:void 0!==orders.lName&&(UserName=orders.lName);var makemodel="",imei="",sim="",ItemStatus=[],consentReqErrorType=[],eosOrderDetails="",accountNumber="",installType="",estimatedshipDate="",accountType="";if(null!=orders.account&&void 0!=orders.account&&(accountNumber=orders.account.accountNumber,accountType=orders.account.accountType),eosOrderDetails=accountNumber+"~"+orders.orderNumber,void 0!==orders.wirelessLines&&void 0!==orders.wirelessLines.length&&orders.wirelessLines.length>0&&("DOO"==orders.wirelessLines[0].fullfillmentMethod?installType="DOO":"PDO"==orders.wirelessLines[0].fullfillmentMethod&&(installType="PDO"),null!=orders.wirelessLines[0].estimatedShipDate&&void 0!=orders.wirelessLines[0].estimatedShipDate&&(estimatedshipDate=orders.wirelessLines[0].estimatedShipDate)),eosOrderDetails=eosOrderDetails+"~"+estimatedshipDate+"~"+OrderStatus+"~~~"+installType+"~~"+accountType+"~"+orders.orderDate,void 0!==orders.wirelessLines&&void 0!==orders.wirelessLines.length&&orders.wirelessLines.length>0){for(var i in orders.wirelessLines)if(void 0!==orders.wirelessLines[i]&&"false"===orders.wirelessLines[i].isItemShipped){name=orders.wirelessLines[i].productName;i===orders.wirelessLines.length-1?makemodel+=name:makemodel=makemodel+"|"+name,ItemStatus[i]=orders.wirelessLines[i].productName+" ~ "+orders.wirelessLines[i].productStatus,"true"===orders.wirelessLines[i].isConsentRequired&&void 0!==orders.wirelessLines[i].consentRequiredByDate&&(consentReqErrorType[i]=$rootScope.replaceConsentString($rootScope.content.M_7_70_4_HUB_Order_Details.PageLevelItems.FieldLabels.NewEstimatedShipDateMessage.Label,orders.wirelessLines[i].consentRequiredByDate))}}else void 0!==orders.wirelessLines&&"false"===orders.wirelessLines.isItemShipped&&(ItemStatus[0]=orders.wirelessLines.name+" ~ "+OrderStatus,"true"===orders.wirelessLines.isConsentRequired&&void 0!==orders.wirelessLines.consentRequiredByDate&&(consentReqErrorType[0]=$rootScope.replaceConsentString($rootScope.content.M_7_70_4_HUB_Order_Details.PageLevelItems.FieldLabels.NewEstimatedShipDateMessage.Label,orders.wirelessLines.consentRequiredByDate)));var items=[],equipTypeSelected=[];if(void 0!==orders.wirelessLines&&void 0!==orders.wirelessLines.length&&orders.wirelessLines.length>0){for(var i in orders.wirelessLines)"true"===orders.wirelessLines[i].isItemShipped&&(ItemStatus[i]=orders.wirelessLines[i].productName+" ~ "+orders.wirelessLines[i].productStatus);for(var i in orders.wirelessLines)if("true"===orders.wirelessLines[i].isItemShipped){var name=orders.wirelessLines[i].productName;0===i?("DEVICE"===orders.wirelessLines[i].itemCategory?(equipTypeSelected[i]="DEVICE="+orders.wirelessLines[i].itemSerialNumber+"; Make&Model="+name,imei+=orders.wirelessLines[i].itemSerialNumber):"SIM"===orders.wirelessLines[i].itemCategory&&(equipTypeSelected[i]="SIM="+orders.wirelessLines[i].itemSerialNumber+"; Make&Model="+name,sim+=orders.wirelessLines[i].itemSerialNumber),makemodel+=name):("DEVICE"===orders.wirelessLines[i].itemCategory?(equipTypeSelected[i]="DEVICE="+orders.wirelessLines[i].itemSerialNumber+"; Make&Model="+name,""!==imei?imei=imei+"|"+orders.wirelessLines[i].itemSerialNumber:imei+=orders.wirelessLines[i].itemSerialNumber):"SIM"===orders.wirelessLines[i].itemCategory&&(equipTypeSelected[i]="SIM="+orders.wirelessLines[i].itemSerialNumber+"; Make&Model="+name,""!==sim?sim=sim+"|"+orders.wirelessLines[i].itemSerialNumber:sim+=orders.wirelessLines[i].itemSerialNumber),makemodel=makemodel+"|"+name);itemEquipType="{itemEquipType:"+equipTypeSelected[i]+"}";items[i]=itemEquipType}}else if(void 0!==orders.wirelessLines&&"true"===orders.wirelessLines[i].isItemShipped){ItemStatus[0]=orders.wirelessLines.productName+" ~ "+OrderStatus,"SIM"===orders.wirelessLines.itemCategory?(equipTypeSelected[0]="SIM="+orders.wirelessLines.itemSerialNumber+"; Make&Model="+orders.wirelessLines.productName,sim=orders.wirelessLines.itemSerialNumber):"DEVICE"===orders.wirelessLines.itemCategory&&(equipTypeSelected[0]="DEVICE="+orders.wirelessLines.itemSerialNumber+"; Make&Model="+orders.wirelessLines.productName,imei=orders.wirelessLines.itemSerialNumber),makemodel=orders.wirelessLines.productName;var itemEquipType="{itemEquipType:"+equipTypeSelected[0]+"}";items[0]=itemEquipType}var errtyp="",updatePaymentRequired="N";void 0!==orders.updatePaymentReq&&"true"===orders.updatePaymentReq&&(void 0!==$rootScope.status&&void 0!==$rootScope.status.type&&"PMTUPDT"===$rootScope.status.type||(errtyp=$rootScope.content.M_7_70_4_3_Update_Payment.PageLevelItems.FieldLabels.UpdatePaymentInformationMessage.Label,updatePaymentRequired="Y"));var acceptNewShipDate="N";if(void 0!==consentReqErrorType&&""!==consentReqErrorType)for(var i in consentReqErrorType)if(void 0!==consentReqErrorType[i]){""!==errtyp&&(errtyp+=","),errtyp+=consentReqErrorType[i],acceptNewShipDate="Y";break}ddo.setVar("user.tech.language",localStorage.getItem("dtmLanguage")),ddo.setVar("chat.equipTypeSelected",equipTypeSelected),ddo.setVar("page.attributes.makemodel",makemodel),ddo.setVar("page.attributes.imei",imei),ddo.setVar("page.attributes.sim",sim),void 0!==orders.orderProductType&&null!=orders.orderProductType&&""!==orders.orderProductType?ddo.setVar("page.attributes.productType",orders.orderProductType):ddo.setVar("page.attributes.productType","");var pageID="",fulfillMethod="",sameDayFulfillCo="",instalType="";"ENJOY"==orders.orderType||"SAMEDAY"==orders.orderType?(pageID="CMO Order Status Details Pg",fulfillMethod="Same Day",sameDayFulfillCo="Enjoy","DOO"==orders.wirelessLines[0].fullfillmentMethod?instalType="Drop Off Only":"PDO"==orders.wirelessLines[0].fullfillmentMethod&&(instalType="Premium Drop Off")):"BOPIS"!==orders.orderType&&"C2S"!==orders.orderType?(pageID="CMO Order Status Details Pg",fulfillMethod="Direct"):(pageID="CMO C2S Order Status Details Pg",fulfillMethod="Store");var source="";if(void 0!==current.appSource&&null!=current.appSource&&(source=current.appSource),""===errorType){ddo.setVar("events.errorType",errtyp);var fullList={eosIdType:"Order Number",eosSearchId:current.OrderID,eosSearchLob:"Wireless",dtvInd:"N",eosOriginSource:source,updatePaymentRequired:updatePaymentRequired,statusMessage:errtyp,eosOrderDetails:eosOrderDetails,cartFulfillMethod:fulfillMethod,acceptNewShipDate:acceptNewShipDate,sameDayFulfillCo:sameDayFulfillCo,installType:instalType},displayMessage=$rootScope.displayMessageIndicator();""!==displayMessage&&(fullList.displayedMessage=displayMessage),"false"===current.orderDetails.OmniOrder?fullList.orderTrackFlag="Y":fullList.orderTrackFlag="N",$scope.systemEvent("CMO_System_Order_Mgmt_Details_Display","1","0",fullList,pageID)}else{var erorCode="",errorMessage="";void 0!==errorType&&""!==errorType&&(erorCode=errorType.split(":")[0],errorMessage=errorType.split(":")[1]);fullList={eosIdType:"Order Number",eosSearchId:current.OrderID,eosSearchLob:"Wireless",dtvInd:"N",eosOriginSource:source,statusMessage:errorMessage,eosOrderDetails:eosOrderDetails,updatePaymentRequired:updatePaymentRequired,cartFulfillMethod:fulfillMethod,acceptNewShipDate:acceptNewShipDate,sameDayFulfillCo:sameDayFulfillCo,installType:instalType};""===erorCode?$scope.systemEvent("CMO_System_Order_Mgmt_Details_Display","1","0",fullList,pageID):$scope.systemEvent("CMO_System_Order_Mgmt_Details_Display","0",erorCode,fullList,pageID)}ddo.setVar("event.orderId",clientOrderNum),ddo.setVar("user.account.ctn",CTN),ddo.setVar("user.attributes.customerName",UserName),ddo.setVar("chat.ItemStatus",ItemStatus),ddo.setVar("chat.portingNoInd",portInd)}},$rootScope.setcancelPgChatVariables=function(orders,OrderStatus,errorType){if(void 0!==ddo&&orders){var portInd="true"===orders.portOrder?"YES":"NO",clientOrderNum=orders.orderNumber,CTN=void 0!==orders.ctn?orders.ctn:"",UserName="";void 0!==orders.fName&&void 0!==orders.lName?UserName=orders.fName+" "+orders.lName:void 0!==orders.fName?UserName=orders.fName:void 0!==orders.lName&&(UserName=orders.lName);var ItemStatus=[],makemodel="",imei="",sim="",consentReqErrorType=[];if(void 0!==orders.wirelessLines&&void 0!==orders.wirelessLines.length&&orders.wirelessLines.length>0){for(var i in orders.wirelessLines)if(void 0!==orders.wirelessLines[i]&&"false"===orders.wirelessLines[i].isItemShipped){ItemStatus[i]=orders.wirelessLines[i].productName+" ~ "+orders.wirelessLines[i].productStatus;name=orders.wirelessLines[i].productName;i===orders.wirelessLines.length-1?makemodel+=name:makemodel=makemodel+name+"|","true"===orders.wirelessLines[i].isConsentRequired&&void 0!==orders.wirelessLines[i].consentRequiredByDate&&(consentReqErrorType[i]=$rootScope.replaceConsentString($rootScope.content.M_7_70_4_HUB_Order_Details.PageLevelItems.FieldLabels.NewEstimatedShipDateMessage.Label,orders.wirelessLines[i].consentRequiredByDate))}}else void 0!==orders.wirelessLines&&(ItemStatus[0]=orders.wirelessLines.productName+" ~ "+OrderStatus,"true"===orders.wirelessLines.isConsentRequired&&void 0!==orders.wirelessLines.consentRequiredByDate&&(consentReqErrorType[0]=$rootScope.replaceConsentString($rootScope.content.M_7_70_4_HUB_Order_Details.PageLevelItems.FieldLabels.NewEstimatedShipDateMessage.Label,orders.wirelessLines.consentRequiredByDate)));var items=[],equipTypeSelected=[];if(void 0!==orders.wirelessLines&&void 0!==orders.wirelessLines.length&&orders.wirelessLines.length>0){for(var i in orders.wirelessLines)"true"===orders.wirelessLines[i].isItemShipped&&(ItemStatus[i]=orders.wirelessLines[i].productName+" ~ "+orders.wirelessLines[i].productStatus);for(var i in orders.wirelessLines)if("true"===orders.wirelessLines[i].isItemShipped){var name=orders.wirelessLines[i].name;0===i?("DEVICE"===orders.wirelessLines[i].itemCategory?(equipTypeSelected[i]="DEVICE="+orders.wirelessLines[i].itemSerialNumber+"; Make&Model="+name,imei+=orders.wirelessLines[i].itemSerialNumber):"SIM"===orders.wirelessLines[i].itemCategory&&(equipTypeSelected[i]="SIM="+orders.wirelessLines[i].itemSerialNumber+"; Make&Model="+name,sim+=orders.wirelessLines[i].itemSerialNumber),makemodel+=name):("DEVICE"===orders.wirelessLines[i].itemCategory?(""!==imei?imei=imei+"|"+orders.wirelessLines[i].itemSerialNumber:imei+=orders.wirelessLines[i].itemSerialNumber,equipTypeSelected[i]="DEVICE="+orders.wirelessLines[i].itemSerialNumber+"; Make&Model="+name):"SIM"===orders.wirelessLines[i].itemCategory&&(""!==sim?sim=sim+"|"+orders.wirelessLines[i].itemSerialNumber:sim+=orders.wirelessLines[i].itemSerialNumber,equipTypeSelected[i]="SIM="+orders.wirelessLines[i].itemSerialNumber+"; Make&Model="+name),makemodel=makemodel+"|"+name);itemEquipType="{itemEquipType:"+equipTypeSelected[i]+"}";items[i]=itemEquipType}}else if(void 0!==orders.wirelessLines){ItemStatus[0]=orders.wirelessLines.productName+" ~ "+OrderStatus,"SIM"===orders.wirelessLines.itemCategory?(equipTypeSelected[0]="SIM="+orders.wirelessLines.itemSerialNumber+"; Make&Model="+orders.wirelessLines.productName,sim=orders.wirelessLines.itemSerialNumber):"DEVICE"===orders.wirelessLines[i].itemCategory&&(equipTypeSelected[0]="DEVICE="+orders.wirelessLines.itemSerialNumber+"; Make&Model="+orders.wirelessLines.productName,imei+=orders.wirelessLines[i].itemSerialNumber),makemodel+=orders.wirelessLines.productName;var itemEquipType="{itemEquipType:"+equipTypeSelected[0]+"}";items[0]=itemEquipType}var errtyp="";if(void 0!==orders.updatePaymentReq&&"true"===orders.updatePaymentReq&&(errtyp=$rootScope.content.M_7_70_4_3_Update_Payment.PageLevelItems.FieldLabels.UpdatePaymentInformationMessage.Label),void 0!==consentReqErrorType&&""!==consentReqErrorType)for(var i in consentReqErrorType)if(void 0!==consentReqErrorType[i]){""!==errtyp&&(errtyp+=","),errtyp+=consentReqErrorType[i];break}ddo.setVar("user.tech.language",localStorage.getItem("dtmLanguage")),ddo.setVar("chat.equipTypeSelected",equipTypeSelected),ddo.setVar("page.attributes.makemodel",makemodel),ddo.setVar("page.attributes.imei",imei),ddo.setVar("page.attributes.sim",sim),""===errorType?ddo.setVar("events.errorType",errtyp):ddo.setVar("events.errorType",errorType),ddo.setVar("events.orderId",clientOrderNum),ddo.setVar("user.account.ctn",CTN),ddo.setVar("user.attributes.customerName",UserName),ddo.setVar("chat.ItemStatus",ItemStatus),ddo.setVar("chat.portingNoInd",portInd)}},$rootScope.getCount=function(my_object,my_criteria){var count=0;return my_object.filter(function(obj){Object.keys(my_criteria).every(function(c){return obj[c]===my_criteria[c]&&(count+=1),count})}),count},$rootScope.find_in_object=function(my_object,my_criteria){if(void 0!==my_object)return my_object.filter(function(obj){return Object.keys(my_criteria).every(function(c){return obj[c].toUpperCase()===my_criteria[c].toUpperCase()})})},$rootScope.prepareOrderStatusJson=function(oStatusObj){var count=0,stats="";stats+="[";for(var status_array=JSON.stringify(oStatusObj).replace(/{/g,"").replace(/},/g,":").replace(/"Label":/g,"").replace(/,"Description"/g,"").replace(/}/g,"").split(":"),i=0;i<status_array.length;i++)0==count?(stats+='{"status":'+status_array[i]+",",count++):1==count?(stats+='"value":'+status_array[i]+",",count++):2==count&&(stats+='"desc":'+status_array[i],i==status_array.length-1?stats+="}":stats+="},",count=0);return stats+="]",JSON.parse(stats)},$rootScope.getBOPISStatus=function(obj,wirelessOrderObj,stst){$scope.oStatus=null,$scope.oStatusDesc=null,$scope.oChannelMssg=null,$scope.oStatusKey=null;var content=obj,filtered_json="";if((!$scope.oStatus||void 0===$scope.oStatus||content&&void 0!==content)&&null!=(filtered_json=$scope.find_in_object(content.WirelessBopisStatus,{status:stst}))&&void 0!==filtered_json&&filtered_json.length>0){var finalStatus=$scope.find_in_object(wirelessOrderObj,{status:filtered_json[0].value});finalStatus&&void 0!==finalStatus&&""!==finalStatus&&finalStatus.length>0&&($scope.oStatus=finalStatus[0].value,$log.info("getStatus--",$scope.oStatus),$scope.oStatusDesc=finalStatus[0].desc,void 0!==filtered_json[0].message&&""!==filtered_json[0].message&&($scope.oChannelMssg=filtered_json[0].message),$scope.oStatusKey=finalStatus[0].status)}return $scope.oStatus},$rootScope.getUniversalStatus=function(wirelessOrderObj,stst,ststKey,liability){if($scope.oStatus=stst,$scope.oStatusDesc=null,$scope.oChannelMssg=null,$scope.oStatusKey=ststKey,!$scope.oStatusDesc||void 0===$scope.oStatusDesc){var finalStatus=$scope.find_in_object(wirelessOrderObj,{status:ststKey});if("CRU"===liability)channelMssg=$scope.find_in_object(wirelessOrderObj,{status:ststKey+"_CRU_MSG"});else var channelMssg=$scope.find_in_object(wirelessOrderObj,{status:ststKey+"_CONS_MSG"});finalStatus&&void 0!==finalStatus&&""!==finalStatus&&finalStatus.length>0&&($scope.oStatus=stst,$log.info("getStatus--",$scope.oStatus),$scope.oStatusDesc=finalStatus[0].desc,void 0!==channelMssg&&""!==channelMssg&&channelMssg.length>0&&($scope.oChannelMssg=channelMssg[0].value),$scope.oStatusKey=ststKey)}return $scope.oStatus},$rootScope.getStatus=function(obj,wirelessOrderObj,stst){$scope.oStatus=null,$scope.oStatusDesc=null,$scope.oChannelMssg=null,$scope.oStatusKey=null;var content=obj,filtered_json="";if((!$scope.oStatus||void 0===$scope.oStatus||content&&void 0!==content)&&(void 0!==(filtered_json=$scope.find_in_object(content.wirelessOrderTrackOrderInternalStatus,{status:stst}))&&0===filtered_json.length&&(filtered_json=$scope.find_in_object(content.wirelessOrder,{status:stst})),null!=filtered_json&&void 0!==filtered_json&&filtered_json.length>0)){var finalStatus=$scope.find_in_object(wirelessOrderObj,{status:filtered_json[0].value});finalStatus&&void 0!==finalStatus&&""!==finalStatus&&finalStatus.length>0&&($scope.oStatus=finalStatus[0].value,$log.info("getStatus--",$scope.oStatus),$scope.oStatusDesc=finalStatus[0].desc,void 0!==filtered_json[0].message&&""!==filtered_json[0].message&&($scope.oChannelMssg=filtered_json[0].message),$scope.oStatusKey=finalStatus[0].status)}return $scope.oStatus},$rootScope.getItemStatus=function(obj,wirelessItemObj,stst){$scope.iStatus=null,$scope.iStatusDesc=null,$scope.iStatusKey=null;var content=obj,filtered_json="";if(!$scope.iStatus&&void 0===$scope.iStatus&&content&&void 0!==content&&(void 0!==(filtered_json=$scope.find_in_object(content.wirelessOrderTrackOrderInternalItemOrderMapping,{status:stst}))&&0===filtered_json.length&&(filtered_json=$scope.find_in_object(content.wirelessOrderItem,{status:stst})),null!=filtered_json&&void 0!==filtered_json&&""!==filtered_json&&filtered_json.length>0)){var finalStatus=$scope.find_in_object(wirelessItemObj,{status:filtered_json[0].value});finalStatus&&void 0!==finalStatus&&""!==finalStatus&&finalStatus.length>0&&($scope.iStatus=finalStatus[0].value,$log.info("getItemStatus--",$scope.iStatus),$scope.iStatusDesc=finalStatus[0].desc,$scope.iStatusKey=finalStatus[0].status)}return $scope.iStatus},$rootScope.getUniversalItemStatus=function(wirelessItemObj,stst,ststKey){$scope.iStatus=stst,$scope.iStatusDesc=null,$scope.iStatusKey=ststKey;var finalStatus=$scope.find_in_object(wirelessItemObj,{status:ststKey});return finalStatus&&void 0!==finalStatus&&""!==finalStatus&&finalStatus.length>0&&($scope.iStatus=finalStatus[0].value,$log.info("getItemStatus--",$scope.iStatus),$scope.iStatusDesc=finalStatus[0].desc,$scope.iStatusKey=ststKey),$scope.iStatus},$rootScope.getNonWLSStatus=function(uverseItemObj,stst){$scope.iStatus=stst,$scope.iStatusDesc=null;var finalStatus=$scope.find_in_object(uverseItemObj,{status:stst});finalStatus&&void 0!==finalStatus&&""!==finalStatus&&finalStatus.length>0&&($scope.iStatus=finalStatus[0].value,$log.info("getNonWLSStatus--",$scope.iStatus));var canceledStatusArray=["Canceled","Canceled_Status","CANCELLED","CA","DC","TC","RE","CA_Status","DC_Status","TC_Status","RE_Status"];return-1!==["COMPLETED","DO","Complete","DO_Status","Complete_Status","COMPLETED_Status","CT_Status","DO_DO_Status"].indexOf(stst)?$scope.iStatusKey="COMPLETE":-1!==canceledStatusArray.indexOf(stst)?$scope.iStatusKey="CANCELED":$scope.iStatusKey=stst,$scope.iStatus},$rootScope.getDTNVServiceStatusDesc=function(dtvNowSrvcStatus,ststKey){$scope.iStatusDesc=null;var dtvNowSrvcObj=$scope.find_in_object(dtvNowSrvcStatus,{status:ststKey});return dtvNowSrvcObj&&void 0!=dtvNowSrvcObj&&""!==dtvNowSrvcObj&&dtvNowSrvcObj.length>0&&($scope.iStatusDesc=dtvNowSrvcObj[0].message),$scope.iStatusDesc},$rootScope.isNativeApp=function(){return ThinNative.check()},$rootScope.started=!1,$rootScope.closeModals=function(){$scope.timedout&&($("#session-time-out-modal").modal("hide"),$rootScope.timedout=null)},$rootScope.$on("IdleStart",function(){}),$rootScope.$on("IdleEnd",function(){$rootScope.closeModals()}),$rootScope.$on("IdleTimeout",function(){$rootScope.closeModals(),$("#session-time-out-modal").modal({show:!0,backdrop:"static",keyboard:!1})}),$rootScope.start=function(){$rootScope.closeModals(),Idle.watch(),$rootScope.started=!0},$rootScope.stop=function(){$rootScope.closeModals(),Idle.unwatch(),$rootScope.started=!1},$rootScope.viewlandingPage=function(){$scope.setStatus({code:null,type:null,message:null}),$rootScope.stop(),void 0!==current.orderDetails&&null!=current.orderDetails&&(current.orderDetails={}),$scope.setView("omhub")},$rootScope.getErrorMessage=function(data){return data.Result.Messages[0].EnglishLongMessage},$rootScope.setPageContent=function(){var orderContent=[];if(void 0===$rootScope.content)if(localStorage.getItem("content"))orderContent=JSON.parse(localStorage.getItem("content")),$rootScope.content=orderContent;else ContentService.preloadContent({pageIds:"Footer_Elements,M_7_70_0_HUB_Check_Order_Status,M_7_70_4_1_HUB_Order_Detail_Termination,M_7_70_4_HUB_Order_Details,M_7_70_7_HUB_Order_Details_Enjoy,M_7_70_4_3_Update_Payment,M_7_70_8_Cancellation_Landing,M_7_70_1_HUB_Order_Summary,M_7_70_6_HUB_Order_Details_DTVN,M_7_70_5_App_Marketplace_Order_Details,StatusMapping,Common_Order_Management,Common_AppMarket_Order_Details",customerType:oshpData.customerType,language:$rootScope.language},oshpData.useStubsContent).then(function(result){$rootScope.content=result,localStorage.setItem("content",JSON.stringify(result))})};var myCookies;try{var gnsessCookieStr=$cookies.GNSESS;myCookies=angular.fromJson(gnsessCookieStr);var tAuthNState=$cookies.tAuthNState;if(void 0!==myCookies&&null!=myCookies&&void 0!==tAuthNState&&null!=tAuthNState&&"true"===tAuthNState){if(void 0!==myCookies.UG&&myCookies.UG.length>0&&(myCookies.UG[0]="Auth"),void 0!==myCookies.FN&&null!=myCookies.FN&&""!==myCookies.FN||(myCookies.FN="",void 0!==sessionStorage.getItem("firstName")&&null!=sessionStorage.getItem("firstName")&&(myCookies.FN=sessionStorage.getItem("firstName"))),sessionStorage)try{sessionStorage.setItem("isUserAuthenticated","true")}catch(e){$log.error(e)}var gnessJson_newStr=angular.toJson(myCookies);document.cookie="GNSESS="+gnessJson_newStr+"; domain=.att.com; path=/"}}catch(e){$log.error("Error occurred while accessing GNSESS cookie"+e)}$rootScope.lang=angular.isUndefined(myCookies)?navigator.language||navigator.browserLanguage:myCookies.LOCALE,$log.log("Language:"+$rootScope.lang),$rootScope.toggleLang=function(event){angular.isUndefined(GE5P)||(GE5P.changeLanguage(event),$rootScope.lang=angular.isUndefined(myCookies)?GE5P.ge5p_localLanguage:myCookies.LOCALE)},current.language=$rootScope.lang,localStorage.setItem("userLang",current.language),$rootScope.dtmFormResponseErrorLandingPage=function(errorCode,event){var orderNo="";void 0!==current.OrderID&&(orderNo=current.OrderID);var fulldataList={eosIdType:"Order Number",eosSearchId:orderNo,eosSearchLob:"Wireless",dtvInd:"N",eosOriginSource:current.appSource};void 0!==errorCode&&null!=errorCode&&""!==errorCode&&$scope.dtmCustomNotification("formResponse",event,"0",errorCode,fulldataList,"","")},$rootScope.dtmFormResponseErrorFromSummaryPage=function(errorCode){if(void 0!==current.authUser&&"true"===current.authUser){$rootScope.pageLoadEvent("CMO Order Management HUB Pg","CMO_AUTH","");var eventCode="";eventCode="true"===sessionStorage.getItem("withoutSearch")?"CMO_Customer_Login_withoutSearch_Submit":"CMO_Customer_Login_withSearch_Submit",sessionStorage.removeItem("withoutSearch");var statusCode=errorCode,fulldataList={eosSearchId:sessionStorage.getItem("userName"),eosIdType:"Access ID",eosOriginSource:"att.com"};void 0!==errorCode&&null!=errorCode||(fulldataList.statusMessage="We're sorry please try again at a later time."),void 0!==$rootScope.omHubSlidAssAcc&&null!=$rootScope.omHubSlidAssAcc&&void 0!==$rootScope.omHubSlidAssAcc.slidAssocAccts&&null!=$rootScope.omHubSlidAssAcc.slidAssocAccts&&ddo.setVar("user.account.slidAssocAccts",$rootScope.omHubSlidAssAcc.slidAssocAccts),$scope.dtmCustomNotification("formResponse",eventCode,"0",statusCode,fulldataList,"","")}},$rootScope.isSpanishLang=function(){return"en_US"!==localStorage.getItem("userLang")&&"en-US"!==localStorage.getItem("userLang")},$rootScope.pageLoad=function(pageID){$timeout(function(){$rootScope.dtmCustomNotification("pageLoad","Page_Load","","","",pageID,window.location.pathname)},1e3)},$rootScope.systemEvent=function(event,flag,status,fulldataLst,pageID){$timeout(function(){$scope.dtmCustomNotification("systemEvent",event,flag,status,fulldataLst,pageID,window.location.pathname)},3e3)},$rootScope.splitDate=function(date){var dateArray=date.split("To"),dateFrom=$filter("date")($scope.formatDate(dateArray[0]),"MMMM d, y"),dateTo=$filter("date")($scope.formatDate(dateArray[1]),"MMMM d, y");return dateFrom===dateTo&&(dateArray[1]=void 0),void 0!==dateArray[1]?dateFrom+" - "+dateTo:dateFrom},$rootScope.isLessThanOrEqualToCurrentDate=function(date){try{var currentDate=$filter("date")(new Date,"MMMM d, y");if(void 0!=date&&null!=date){var dateArray=date.split("To"),dateFrom=$filter("date")($scope.formatDate(dateArray[0]),"MMMM d, y"),dateTo=$filter("date")($scope.formatDate(dateArray[1]),"MMMM d, y");if(void 0!=dateArray[0]&&(Date.parse(dateFrom)==Date.parse(currentDate)||Date.parse(dateFrom)<Date.parse(currentDate))&&void 0==dateArray[1])return!0;if(void 0!=dateArray[1]&&(Date.parse(dateTo)==Date.parse(currentDate)||Date.parse(dateTo)<Date.parse(currentDate)))return!0}return!1}catch(e){$log.error("Error occurred while comparing the date with current date"+e)}},$rootScope.formatDate=null,$rootScope.formatDate=function(date){var dateOut=new Date(date);return void 0!==dateOut&&"Invalid Date"==dateOut?date:dateOut},$rootScope.removeHypen=function(appointmentDate){return void 0!==appointmentDate&&"Pending"===appointmentDate?"Pending":"-"},$rootScope.pageLoadEvent=function(friendlyPageName,flowCode,zipCode){if(void 0!==ddo){ddo.setVar("page.location.url",window.location.pathname),ddo.setVar("page.pageInfo.friendlyPageName",friendlyPageName),ddo.setVar("page.pageInfo.flowCode",flowCode),"English"==$rootScope.language?ddo.setVar("page.pageInfo.language","EN"):"Spanish"===$rootScope.language&&ddo.setVar("page.pageInfo.language","ES"),ddo.setVar("page.pageInfo.lineOfBusiness","General");var screenWidth=$(window).width();screenWidth<=480?ddo.setVar("page.pageInfo.language","Smartphone"):screenWidth<=768&&screenWidth>480?ddo.setVar("page.pageInfo.language","Tablet"):ddo.setVar("page.pageInfo.language","Desktop"),ddo.setVar("page.pageInfo.responsiveWebDesignFlag","1"),null!=zipCode&&""!==zipCode&&ddo.setVar("page.pageInfo.zipCode",zipCode),ddo.setVar("page.category.pageFunction","Support"),ddo.setVar("page.category.pageOwnership","Consumer"),ddo.setVar("page.category.applicationName","Support OPSS - OMH"),ddo.setVar("page.pageInfo.referralFlow","")}},$rootScope.setTsnrRequest=function(inputUrl,source){var extOrderProductType="",extOrderNumber="",extZipCode="";if(-1!==inputUrl.indexOf("productType=wireless")&&(extOrderProductType="wireless"),-1!==inputUrl.indexOf("productType=wlsdtv")&&(extOrderProductType="wlsdtv"),-1!==inputUrl.indexOf("productType=uvdtv")&&(extOrderProductType="uvdtv"),-1!==inputUrl.indexOf("orderno=")){var splitUrl=inputUrl.split("&");for(i=0;i<splitUrl.length&&(""==extOrderNumber||""==extZipCode);i++){if(-1!==splitUrl[i].indexOf("orderno")){var orderKeyVal=splitUrl[i].split("=");""!==orderKeyVal&&(extOrderNumber=orderKeyVal[1])}if(-1!==splitUrl[i].indexOf("zipcode")){var zipKeyVal=splitUrl[i].split("=");""!==zipKeyVal[1]&&(extZipCode=zipKeyVal[1])}}}return{CommonData:oshpData.defaults.CommonData,orderNumber:extOrderNumber,orderProductType:extOrderProductType,zipCode:extZipCode,appId:source,passPhrase:null}},$rootScope.setProcessOSRequest=function(){if(-1!==$location.absUrl().indexOf("processOSRequest")){return"true"}if(sessionStorage)try{sessionStorage.setItem("isUserAuthenticated","true")}catch(e){$log.error(e)}}}]),startCtrl=["$scope","$rootScope","myStatus","$log","OSHPService","$routeParams","$location","ContentService","ReportInterfaceAngular",function($scope,$rootScope,myStatus,$log,OSHPService,$routeParams,$location,ContentService,ReportInterfaceAngular){$log.log("entering start Controller");var current=$rootScope.current;if(current&&(current.appMarketOrderDetails=void 0,current.appMarketOrderReportingData=void 0,current.isLucyFlow=void 0),$rootScope.captchaReq="false",current.pageName=$location.path().split(".")[0],$("#captcha").on("keypress",function(event){var regex=new RegExp("^[a-zA-Z0-9\b]+$"),key=String.fromCharCode(event.charCode?event.charCode:event.which);if(!regex.test(key))return event.preventDefault(),!1}),"/checkmyorder/omhub"===current.pageName||"/es-us/checkmyorder/omhub"===current.pageName?current.footerHide=!0:current.footerHide=!1,-1!==decodeURIComponent($location.absUrl()).indexOf("idpErrorCode=OM142")){console.log("backFrom IDP");statusError={code:"OM142",type:"MSFailure",message:msg=ContentService.getError("OM142")};$scope.setStatus(statusError),current.errmsg=msg}current.orderDetails=myStatus,current.isHandOff=!1;var source="CMO Landing";null!=current.appId?("OSH"===current.appId||"OT"===current.appId||"OCE"===current.appId?source="Email":"EOS"===current.appId?source="EOS Landing":"Premier"===current.appId?source="Premier":"COG"!==current.appId&&"POG"!==current.appId||(source="Backoffice"),$scope.setStatus({code:null,type:null,message:null})):myStatus&&void 0!==myStatus.attUid&&($scope.setStatus({code:null,type:null,message:null}),source="Zone"),current.appSource=source,current.appevent="CMO_System_Order_Mgmt_Hub_Display";var pageID="CMO Order Management HUB Pg",orderNo="";void 0!==$routeParams.onum&&(orderNo=$routeParams.onum,current.OrderID=orderNo),void 0!==$routeParams.source&&(current.ReportingSource=$routeParams.source);var fulldataLst={eosIdType:"Order Number",eosSearchId:orderNo,eosSearchLob:"Wireless",dtvInd:"N",eosOriginSource:current.appSource};if(void 0!==current.authUser&&"true"===current.authUser?ddo.setVar("page.pageInfo.flowCode","CMO_AUTH"):void 0!==ddo&&null!=ddo&&ddo.setVar("page.pageInfo.flowCode","CMO_UNAUTH"),$scope.checkValidParamValue=function(param,start){return void 0===param||null==param?param="":void 0!==start&&null!=start&&param.length>start&&(param=param.substring(start)),param},$scope.submitAppMarketReporting=function(appMarketOrderDetails){var additionalData=angular.copy(oshpData.defaults.additionalData),itemSku="",itemQty="",itemName="",itemOneTimePrice="",itemRecurringPrice="",separator="",orderId="";if(appMarketOrderDetails&&appMarketOrderDetails.listAppMarketProduct&&appMarketOrderDetails.listAppMarketProduct.length>0)for(var i=0;i<appMarketOrderDetails.noOfItems;i++)itemSku=itemSku+separator+$scope.checkValidParamValue(appMarketOrderDetails.listAppMarketProduct[i].itemSku,1),itemQty=itemQty+separator+$scope.checkValidParamValue(appMarketOrderDetails.listAppMarketProduct[i].netLicenseQuantity),itemName="Cancel licenses"===appMarketOrderDetails.orderSubType?itemName+separator+$scope.checkValidParamValue(appMarketOrderDetails.listAppMarketProduct[i].oldProductName):itemName+separator+$scope.checkValidParamValue(appMarketOrderDetails.listAppMarketProduct[i].newProductName),itemOneTimePrice=itemOneTimePrice+separator+$scope.checkValidParamValue(appMarketOrderDetails.listAppMarketProduct[i].oneTimeCharge,1),itemRecurringPrice=itemRecurringPrice+separator+$scope.checkValidParamValue(appMarketOrderDetails.listAppMarketProduct[i].monthlyCharge,1),separator="|";var items={itemSku:"",itemQty:"",itemName:"",itemOneTimePrice:"",itemRecurringPrice:""};return items.itemSku=itemSku,items.itemQty=itemQty,items.itemName=itemName,items.itemOneTimePrice=itemOneTimePrice,items.itemRecurringPrice=itemRecurringPrice,additionalData.items=items,(orderId=appMarketOrderDetails.commonOrderId)&&orderId.length>1&&("94"===orderId.substring(0,2)?additionalData.salesSystem="SAPMP":"42"===orderId.substring(0,2)?additionalData.salesSystem="Phoenix":additionalData.salesSystem="SAPMP"),additionalData["user.account.ctn"]=appMarketOrderDetails.billingWirelessNumber,appMarketOrderDetails&&appMarketOrderDetails.customerType?additionalData["user.account.liabilityType"]=appMarketOrderDetails.customerType:additionalData["user.account.liabilityType"]="CRU",additionalData.eosIdType="Order Number",additionalData.eosSearchId=orderId,additionalData.eosSearchLob="Wireless",additionalData.eosOriginSource=current.appSource,additionalData.orderType=appMarketOrderDetails.orderSubType,additionalData.orderStatus=appMarketOrderDetails.customerOrderStatus,additionalData.eosOrderDetails=appMarketOrderDetails.billingWirelessNumber+"~"+orderId+"~~"+appMarketOrderDetails.customerOrderStatus+"~~~~~Wireless~"+appMarketOrderDetails.orderSubmittedDate,additionalData},1==$rootScope.isOrderTokenUrl&&"invalid"!=$rootScope.SecureZipCodeFlag&&$routeParams.appid&&!SuppressZipModalConfig.AppIds.includes($routeParams.appid.toLowerCase())&&($rootScope.SecureZipCodeFlag="","true"==$rootScope.orderTokenToSummary?$scope.setView("orderSummary"):$scope.setView("orderDetails")),null==myStatus){"OSH"!==current.appId&&($rootScope.pageLoad(pageID),$scope.systemEvent(current.appevent,"0",current.orderDetails.Result.Messages[0].DisplayCode,fulldataLst,pageID));statusError={code:current.orderDetails.Result.Messages[0].DisplayCode,type:"HandoffFailure",message:current.orderDetails.Result.Messages[0].DisplayCode+" : "+$scope.getErrorMessage(current.orderDetails)};$scope.setStatus(statusError),$rootScope.errorHandOff="true",$scope.setView("omhub")}else""===myStatus&&void 0!==$routeParams.onum?($scope.orderid=$routeParams.onum,void 0!=$routeParams.zip&&($scope.orderZip=$routeParams.zip),$rootScope.errorHandOff="true","OSH"!==current.appId&&($rootScope.pageLoad(pageID),$scope.systemEvent(current.appevent,"1","0",fulldataLst,pageID)),$scope.setView("omhub")):""!==myStatus&&"SUCCESS"!==myStatus.Result.Status?("OSH"!==current.appId&&($rootScope.pageLoad(pageID),$scope.systemEvent(current.appevent,"0",current.orderDetails.Result.Messages[0].DisplayCode,fulldataLst,pageID)),$scope.orderid=$routeParams.onum,$scope.orderZip=$routeParams.zip,statusError={code:current.orderDetails.Result.Messages[0].DisplayCode,type:"SLFailure",message:current.orderDetails.Result.Messages[0].DisplayCode+" : "+$scope.getErrorMessage(current.orderDetails)},$scope.setStatus(statusError),$rootScope.errorHandOff="true",$scope.setView("omhub")):""!==myStatus&&"SUCCESS"===myStatus.Result.Status?(current.isHandOff=!0,$location.search({}),current.appevent="CMO_System_Order_Mgmt_Details_Display",myStatus.orders&&myStatus.orders[0]&&myStatus.orders[0].appMarketLine&&"AMP"===myStatus.orders[0].appMarketLine.orderType?(current&&(current.appMarketOrderDetails=myStatus.orders[0]),current.appMarketOrderReportingData=$scope.submitAppMarketReporting(current.appMarketOrderDetails),"Email"===current.appSource?$scope.setView("appOrderDetails","processOSRequest"):$scope.setView("appOrderDetails")):(void 0!==myStatus.orders?$scope.orderListSize=myStatus.orders.length||[myStatus.orders].length:$scope.orderListSize=0,1===$scope.orderListSize?"WIRELESS"===myStatus.orders[0].orderProductType?(console.log("redirect to orderDetails page "),current&&(current.orderDetails=myStatus),$scope.setView("orderDetails")):void 0==myStatus.orders[0].dtvUrl||"DTV"!==myStatus.orders[0].orderProductType&&"DTVNOW"!==myStatus.orders[0].orderProductType&&!0!==myStatus.orders[0].dtvAndDtvNowBundleFlag?"DTVNOW"===myStatus.orders[0].orderProductType?(console.log("redirect to dtvNowOrderDetail page "),current&&(current.dtvOrderDetails=myStatus),current.orderDetails=void 0,$scope.setView("dtvNowOrderDetail")):(console.log("redirect to orderSummary page "),current.summaryPageDetails=myStatus,$scope.setView("orderSummary")):window.location.href=myStatus.orders[0].dtvUrl:(console.log("redirect to orderSummary page "),current.summaryPageDetails=myStatus,$scope.setView("orderSummary")))):"OSH"!=current.appId&&($rootScope.pageLoad(pageID),$scope.systemEvent(current.appevent,"1","0",fulldataLst,pageID));if($scope.setClass=function(){return void 0!==current.authUser&&"true"===current.authUser||void 0!==$rootScope.isAuth&&!0===$rootScope.isAuth},$scope.viewOrderDetail=function(event){ddo.setVar("page.pageInfo.flowCode","CMO_AUTH"),$location.search({}),$rootScope.errorHandOff="true",sessionStorage.setItem("userName",document.getElementById("userName").value),current.preView="omhub",$scope.setStatus({code:null,type:null,message:null}),current.OrderID=this.orderid,current.zipcode=this.orderZip,current.AppExtId=this.extappId,current.passphrase=this.captcha,current.appSource="CMO Landing";var fulldataList={eosIdType:"Order Number",eosSearchId:this.orderid,eosSearchLob:"Wireless",dtvInd:"N",eosOriginSource:current.appSource};event&&void 0!=event.currentTarget&&"loginButton"!=event.currentTarget.id&&(current.appevent="CMO_Order_Search_Submit",$scope.dtmCustomNotification("formSubmit",current.appevent,"-2","-2",fulldataList,"",""),$scope.dtmCustomNotification("formResponse",current.appevent,"0","1",fulldataList,"","")),ddo.setVar("user.login.id",sessionStorage.getItem("userName")),ddo.setVar("user.login.type",""),ddo.setVar("user.login.loginSource","native");var fulldataListvalue={eosIdType:"Access ID",eosSearchId:sessionStorage.getItem("userName"),eosOriginSource:current.appSource},currentUrl="";""!=(currentUrl=window.location.href)&&-1!==currentUrl.indexOf("omhub.rt")?current.appevent="CMO_Customer_Login_withSearch_Submit":current.appevent="CMO_Customer_Login_withoutSearch_Submit",event&&void 0!==event.currentTarget&&"loginButton"===event.currentTarget.id&&$scope.dtmCustomNotification("formSubmit",current.appevent,"1","0",fulldataListvalue,"","")},$scope.viewOrderSummary=function(event){if($location.search({}),$rootScope.errorHandOff="true",current.preView="omhub",$scope.orderIdError="false",$scope.setStatus({code:null,type:null,message:null}),current.OrderID=this.orderid,current.zipcode=this.orderZip,current.passphrase=this.captcha,current.appSource="CMO Landing","undefined"!==sessionStorage.getItem("unAuthRequestRecievedTime")&&null!==sessionStorage.getItem("unAuthRequestRecievedTime")&&"undefined"!==sessionStorage.getItem("OrderID")&&null!==sessionStorage.getItem("OrderID")){var time_now=(new Date).getTime(),requestAlreadyDoneTime=sessionStorage.getItem("unAuthRequestRecievedTime"),requestAlreadyDoneOrderNum=sessionStorage.getItem("OrderID");""!==requestAlreadyDoneTime&&time_now-requestAlreadyDoneTime<6e4&&null!==current.OrderID&&current.orderDetailReq&&requestAlreadyDoneOrderNum===current.OrderID&&$rootScope.viewlandingPage()}sessionStorage.setItem("OrderID",this.orderid);var unAuthRequestRecievedTime=(new Date).getTime();sessionStorage.setItem("unAuthRequestRecievedTime",unAuthRequestRecievedTime),$scope.enableContinue=$scope.enableContinueButton(this.orderid,this.orderZip),!0===$scope.enableContinue&&($scope.orderIdError="true",$("#orderIdError").focus());var fulldataList={eosIdType:"Order Number",eosSearchId:this.orderid,eosSearchLob:"Wireless",dtvInd:"N",eosOriginSource:current.appSource,linkName:$rootScope.content.M_7_70_0_HUB_Check_Order_Status.PageLevelItems.Graphics.Continue.AltText,linkPostion:"Body"};if("submit"!==event.type&&(current.appevent="CMO_Order_Search_Submit",$scope.dtmCustomNotification("formSubmit",current.appevent,"-2","-2",fulldataList,"","")),void 0!==current.authUser&&"true"===current.authUser&&void 0!==this.orderid){var fulldataListvalue={eosIdType:"Order Number",eosSearchId:this.orderid,eosOriginSource:current.appSource};current.appevent="CMO_Order_Search_Submit",$scope.dtmCustomNotification("formSubmit",current.appevent,"-2","-2",fulldataListvalue,"","")}"false"===$scope.orderIdError&&$scope.viewOrderInfo(OSHPService)},$scope.viewOrderInfo=function(OSHPService){$rootScope.isViewLoading=!0;var current=$rootScope.current;if(current)if("OSH"===current.appId?$rootScope.showFooterDiv=!0:$rootScope.showFooterDiv=!1,current.OrderID&&current.zipcode)if(angular.isDefined(BsseWbbOrderConfig)&&angular.isDefined(BsseWbbOrderConfig.bsseWbbOrderFlag)&&1==BsseWbbOrderConfig.bsseWbbOrderFlag&&current.OrderID.indexOf("24-")>-1)$("body").hide(),window.location.href=IDPConfig.IDP_MONOREPO_URL+"details?orderid="+current.OrderID+"&zip="+current.zipcode;else{var orderDetails={CommonData:oshpData.defaults.CommonData,orderNumber:current.OrderID,zipCode:current.zipcode,passPhrase:current.passphrase};current.orderDetailReq=orderDetails,localStorage.setItem("dtmZipCode",current.zipcode);OSHPService.oshpOrderSummaryAPIServices(current,oshpData.useStubs).then(function(data){if($rootScope.isViewLoading=!1,$rootScope.orderDetails=data,void 0!==data&&"SUCCESS"===data.Result.Status)$rootScope.ASLALoggingService(ASLAConfig.AppID_UnAuth,ASLAConfig.EventType_UnAuth,current.orderDetailReq.orderNumber,"SUCCESS"),void 0!==data.orders&&"AMP"==data.orders[0].orderProductType?(ReportInterfaceAngular.setEventTrackResponse("CMO_Order_Search_Submit","0","1"),current&&(current.appMarketOrderDetails=data.orders[0]),current.appMarketOrderReportingData=$scope.submitAppMarketReporting(current.appMarketOrderDetails),$scope.setView("appOrderDetails")):(void 0!==data.orders?$scope.orderListSize=data.orders.length||[data.orders].length:$scope.orderListSize=0,1===$scope.orderListSize?"WIRELESS"===data.orders[0].orderProductType?(console.log("redirect to orderDetails page "),current&&(current.orderDetails=data),$scope.setView("orderDetails")):void 0==data.orders[0].dtvUrl||"DTV"!==data.orders[0].orderProductType&&"DTVNOW"!==data.orders[0].orderProductType&&!0!==data.orders[0].dtvAndDtvNowBundleFlag?"DTVNOW"===data.orders[0].orderProductType?(console.log("redirect to dtvNowOrderDetail page "),current&&(current.dtvOrderDetails=data),current.orderDetails=void 0,$scope.setView("dtvNowOrderDetail")):(console.log("redirect to orderSummary page "),current.summaryPageDetails=data,$scope.setView("orderSummary")):window.location.href=data.orders[0].dtvUrl:(console.log("redirect to orderSummary page "),current.summaryPageDetails=data,$scope.setView("orderSummary")));else{$rootScope.ASLALoggingService(ASLAConfig.AppID_UnAuth,ASLAConfig.EventType_UnAuth,current.orderDetailReq.orderNumber,"FAILURE");var statusError={code:data.Result.Messages.DisplayCode,type:"SLFailure",message:data.Result.Messages.DisplayCode+" : "+$scope.getErrorMessage(data)};$scope.setStatus(statusError),console.log("orders.setStatus: "+JSON.stringify(statusError)),$rootScope.errorType=statusError.message,current.orderDetails={},$scope.dtmFormResponseErrorLandingPage(data.Result.Messages.DisplayCode,current.appevent),$scope.setView("omhub")}},function(error){$rootScope.ASLALoggingService(ASLAConfig.AppID_UnAuth,ASLAConfig.EventType_UnAuth,current.orderDetailReq.orderNumber,"FAILURE");var statusError={code:error.code,type:error.type,message:error.message};if($scope.setStatus(statusError),angular.isDefined(firstNetConstants)&&angular.isDefined(firstNetConstants.firstNetFlag)&&1==firstNetConstants.firstNetFlag&&angular.isDefined(error.code)&&-1!=error.code.indexOf("OM3")){var header=document.querySelector("attwc-globalnav-header"),footer=document.querySelector("attwc-globalnav-footer");header.setAttribute("customer-type","opss-firstnet"),footer.setAttribute("customer-type","opss-firstnet"),header.setAttribute("exclude-core-elements","cart, search, profile, lobcta, banner"),console.log("new GN header parameter is :::"+header.getAttribute("customer-type")),console.log("new GN footer parameter is :::"+footer.getAttribute("customer-type"))}console.log("failure orders.setStatus: "+JSON.stringify(statusError)),$rootScope.errorType=statusError.message,$scope.isCaptchaNeeded(),$rootScope.isViewLoading=!1,$scope.dtmFormResponseErrorLandingPage(error.code,current.appevent)})}else $rootScope.viewlandingPage();else current=$rootScope.current=SessionKeeper.read()},$scope.isCaptchaNeeded=function(){OSHPService.isCaptchaNeeded(current,oshpData.useStubs).then(function(data){"true"===data.isCaptchaNeeded?($rootScope.captchaRequrl="/checkmyorder/services/resources/acceptance/captcha/getImage?app=ophorder&_ts="+(new Date).getTime(),$rootScope.captchaReq="true"):$rootScope.captchaReq="false"},function(data){$log.log("captcha service failed")})},$scope.disableContinue=function(orderid,orderZip,captcha){var orderIDLength=(orderid+"").length,orderZipLength=(orderZip+"").length,orderCaptchaLength=(captcha+"").length;if("true"===$rootScope.captchaReq){if(void 0!==orderid&&void 0!==orderZip&&void 0!==captcha&&5==orderZipLength&&orderIDLength>=1&&orderIDLength<=20&&6==orderCaptchaLength)return!1}else if(void 0!==orderid&&void 0!==orderZip&&5==orderZipLength&&orderIDLength>=1&&orderIDLength<=20)return!1;return!0},"invalid"==$rootScope.SecureZipCodeFlag){var msg=ContentService.getError("OM125"),statusError={code:"OM125",type:"ODG_ERROR",message:"Check your entries and try again. For help, call us at <span class='hidden-phone'>877.782.8870.</span> <a href='tel: 18777828870' class='hidden-desktop hidden-tablet'>877.782.8870.</a>"};$rootScope.setStatus(statusError)}$scope.enableContinueButton=function(orderid,orderZip){var alphaBets=/^[A-Za-z]+$/,specialCharHyphen=/^[-]*$/;return!(18===orderid.length&&specialCharHyphen.test(orderid.substring(2,3))&&!isNaN(orderid.substring(0,2))&&!isNaN(orderid.substring(3,18)))&&(!(orderid.length>=13&&specialCharHyphen.test(orderid.substring(4,5))&&specialCharHyphen.test(orderid.substring(7,8))&&alphaBets.test(orderid.substring(5,7))&&!isNaN(orderid.substring(8)))&&!(10===orderid.length&&!isNaN(orderid)))},$scope.lightBox=function(){$("#light-box-modal").modal({show:!0,backdrop:"static",keyboard:!1}),$(".modal-backdrop.fade").addClass("bgBlack"),setTimeout(function(){$("#lightBoxMsgModalContainer").attr("aria-hidden","false"),$("#light-box-modal").attr("aria-hidden","false"),$("*").blur(),$("#myModalLabel").focus()},1500)},$widgetJquery(document).ready(function(){setTimeout(function(){$widgetJquery.fn.domRegister(),$("#loginButton-lgwgLoginButton").on("click",function(){""!==$("#userName").val()&&""!==$("#password").val()&&(sessionStorage.setItem("userNameForGnsess",document.getElementById("userName").value),$scope.viewOrderDetail(event))})},2e3)}),$rootScope.stop(),$rootScope.disableZipCodeModalSubmit=function(orderZip){var orderZipLength=(orderZip+"").length;return void 0===orderZip||5!=orderZipLength}}];startCtrl.resolve={myStatus:["$rootScope","SessionKeeper","$location","$log","OSHPService","ContentService","$route",function($rootScope,SessionKeeper,$location,$log,OSHPService,ContentService,$route){var inputUrl=decodeURIComponent($location.absUrl());void 0!==inputUrl&&null!==inputUrl&&-1!==inputUrl.indexOf("/checkmyorder/omhub.rt")&&SessionKeeper.clear();var current=$rootScope.current;return current||(current=$rootScope.current=SessionKeeper.read()),current.isValidUser=!1,$log.log("entering StartCtrl of OM Hub Landing Page"),current.appId=null,ContentService.preloadContent({pageIds:"Footer_Elements,M_7_70_0_HUB_Check_Order_Status,M_7_70_4_1_HUB_Order_Detail_Termination,M_7_70_4_HUB_Order_Details,M_7_70_7_HUB_Order_Details_Enjoy,M_7_70_4_3_Update_Payment,M_7_70_8_Cancellation_Landing,M_7_70_1_HUB_Order_Summary,M_7_70_6_HUB_Order_Details_DTVN,M_7_70_5_App_Marketplace_Order_Details,StatusMapping,Common_Order_Management,Common_AppMarket_Order_Details",customerType:oshpData.customerType,language:$rootScope.language},oshpData.useStubsContent).then(function(result){if($rootScope.content=result,localStorage.setItem("content",JSON.stringify(result)),$rootScope.showFooterDiv=!0,void 0!==$rootScope.errorHandOff&&null!=$rootScope.errorHandOff&&""!==$rootScope.errorHandOff&&"true"===$rootScope.errorHandOff)return $rootScope.errorHandOff="false","";if("processOSRequest"===current.previousView)return current.processOSRequest=!0,"";if(current.processOSRequest||void 0===$route.current.params.onum||void 0===$route.current.params.zip||void 0===$route.current.params.appid){if(void 0!==$route.current.params.ordertoken){if($route.current.params.ordertoken.length>0){current.ordertoken=$route.current.params.ordertoken;orderDetails={CommonData:oshpData.defaults.CommonData,ordertoken:$route.current.params.ordertoken.replace(/ /g,"+"),appId:$route.current.params.appid};return current.orderDetailReq=orderDetails,current.appId=$route.current.params.appid,$route.current.params.appid&&SuppressZipModalConfig.AppIds.includes($route.current.params.appid.toLowerCase())?OSHPService.oshpHandOffServices(current,oshpData.useStubs):""}return""}return""}if(void 0!==$route.current.params.context){if($route.current.params.onum.length>0&&$route.current.params.zip.length>0&&$route.current.params.appid.length>0){if($route.current.params.context.length>0){current.isValidUser=!0;var orderDetails={CommonData:oshpData.defaults.CommonData,orderNumber:$route.current.params.onum,zipCode:$route.current.params.zip,appId:$route.current.params.appid,reqContext:$route.current.params.context.replace(/ /g,"+"),wtExtndSource:$route.current.params.wtExtndSource,isCRU:$route.current.params.isCRU?$route.current.params.isCRU:"false"};return current.orderDetailReq=orderDetails,current.appId=$route.current.params.appid,OSHPService.oshpHandOffServices(current,oshpData.useStubs)}return""}return""}return""})}]};