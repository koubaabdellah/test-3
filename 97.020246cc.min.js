(this["webpackChunkapplication"]=this["webpackChunkapplication"]||[]).push([[97],{954083:(e,t,n)=>{"use strict";n.d(t,{$q:()=>i,h8:()=>o,zp:()=>r.zp,hv:()=>u,xf:()=>r.xf});var r=n(982313);var i;(function(e){e["RCV"]="RCV";e["RCM"]="RCM";e["UNKNOWN"]="UNKNOWN"})(i||(i={}));var o;(function(e){e["DEEP_LINK"]="deep link";e["EMBEDDED"]="embedded"})(o||(o={}));var a;(function(e){e["Both"]="both";e["Telephony"]="Phone";e["Voip"]="ComputerAudio"})(a||(a={}));var u;(function(e){e["INSTANT"]="Instant";e["SCHEDULED"]="Scheduled";e["RECURRENCE"]="Recurring";e["SCHEDULED_RECURRING"]="ScheduledRecurring"})(u||(u={}))},756086:(e,t,n)=>{"use strict";n.d(t,{R:()=>u});var r=n(862926);var i=n.n(r);var o=n(932565);var a=undefined&&undefined.__extends||function(){var extendStatics=function(e,t){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)if(t.hasOwnProperty(n))e[n]=t[n]};return extendStatics(e,t)};return function(e,t){extendStatics(e,t);function __(){this.constructor=e}e.prototype=t===null?Object.create(t):(__.prototype=t.prototype,new __)}}();var u=function(e){a(MeetingSdkError,e);function MeetingSdkError(t,n,r){return e.call(this,o.y,t,n,r)||this}return MeetingSdkError}(r.JError)},714266:(e,t,n)=>{"use strict";n.d(t,{nf:()=>r.n,RT:()=>i.R});var r=n(932565);var i=n(756086)},932565:(e,t,n)=>{"use strict";n.d(t,{n:()=>r,y:()=>i});var r={INVALID_TOKEN:"INVALID_TOKEN",INVALID_PERSON:"INVALID_PERSON",INVALID_MEETING_ID:"INVALID_MEETING_ID",INVALID_CONTROLLER:"INVALID_CONTROLLER",INVALID_PERSONAL_MEET_ID:"INVALID_PERSONAL_MEET_ID",INVALID_PERSONAL_ROOM_NAME:"INVALID_PERSONAL_ROOM_NAME",DUPLICATE_PERSONAL_ROOM_NAME:"DUPLICATE_PERSONAL_ROOM_NAME",INVALID_ALTERNATIVE_HOST_SIZE:"INVALID_ALTERNATIVE_HOST_SIZE",INVALID_ALTERNATIVE_HOST:"INVALID_ALTERNATIVE_HOST",NO_MEET_ID:"NO_MEET_ID"};var i="MEET_ERROR"},540097:(e,t,n)=>{"use strict";n.r(t);n.d(t,{RCVModule:()=>Ke});var r=n(461197);var i=n(661117);var o=n(855588);var a=n(253962);var u=n(667489);var s=n(862926);var c=n(298784);var l=n.n(c);var f=n(756086);var d=n(932565);var p=n(231820);var h=n(902114);var v=n(17406);var g=undefined&&undefined.__extends||function(){var extendStatics=function(e,t){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)if(t.hasOwnProperty(n))e[n]=t[n]};return extendStatics(e,t)};return function(e,t){extendStatics(e,t);function __(){this.constructor=e}e.prototype=t===null?Object.create(t):(__.prototype=t.prototype,new __)}}();var _=undefined&&undefined.__awaiter||function(e,t,n,r){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,i){function fulfilled(e){try{step(r.next(e))}catch(e){i(e)}}function rejected(e){try{step(r["throw"](e))}catch(e){i(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((r=r.apply(e,t||[])).next())}))};var C=undefined&&undefined.__generator||function(e,t){var n={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},r,i,o,a;return a={next:verb(0),throw:verb(1),return:verb(2)},typeof Symbol==="function"&&(a[Symbol.iterator]=function(){return this}),a;function verb(e){return function(t){return step([e,t])}}function step(a){if(r)throw new TypeError("Generator is already executing.");while(n)try{if(r=1,i&&(o=a[0]&2?i["return"]:a[0]?i["throw"]||((o=i["return"])&&o.call(i),0):i.next)&&!(o=o.call(i,a[1])).done)return o;if(i=0,o)a=[a[0]&2,o.value];switch(a[0]){case 0:case 1:o=a;break;case 4:n.label++;return{value:a[1],done:false};case 5:n.label++;i=a[1];a=[0];continue;case 7:a=n.ops.pop();n.trys.pop();continue;default:if(!(o=n.trys,o=o.length>0&&o[o.length-1])&&(a[0]===6||a[0]===2)){n=0;continue}if(a[0]===3&&(!o||a[1]>o[0]&&a[1]<o[3])){n.label=a[1];break}if(a[0]===6&&n.label<o[1]){n.label=o[1];o=a;break}if(o&&n.label<o[2]){n.label=o[2];n.ops.push(a);break}if(o[2])n.ops.pop();n.trys.pop();continue}a=t.call(e,n)}catch(e){a=[6,e];i=0}finally{r=o=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:true}}};var y=function(e){g(RCVUserConfig,e);function RCVUserConfig(t){return e.call(this,i.oF,t)||this}RCVUserConfig.prototype.get=function(e,t){if(t===void 0){t=false}var n;return _(this,void 0,void 0,(function(){var r;return C(this,(function(o){switch(o.label){case 0:return[4,this._configService.get(i.oF,e,t)];case 1:if(!((n=o.sent())!==null&&n!==void 0))return[3,2];r=n;return[3,4];case 2:return[4,this._configService.get("rcv",e,t)];case 3:r=o.sent();o.label=4;case 4:return[2,r]}}))}))};RCVUserConfig.prototype.setRCVDelegateUserList=function(e){return _(this,void 0,void 0,(function(){return C(this,(function(t){switch(t.label){case 0:return[4,this.put(v.o.RCV_DELEGATE_USER_LIST,e)];case 1:t.sent();return[2]}}))}))};RCVUserConfig.prototype.getRCVDelegateUserList=function(){return _(this,void 0,void 0,(function(){return C(this,(function(e){switch(e.label){case 0:return[4,this.get(v.o.RCV_DELEGATE_USER_LIST)];case 1:return[2,e.sent()]}}))}))};RCVUserConfig.prototype.setRCVDefaultBridge=function(e){return _(this,void 0,void 0,(function(){return C(this,(function(t){switch(t.label){case 0:return[4,this.put(v.o.RCV_DEFAULT_BRIDGE,e)];case 1:t.sent();return[2]}}))}))};RCVUserConfig.prototype.getRCVDefaultBridge=function(){return _(this,void 0,Promise,(function(){return C(this,(function(e){switch(e.label){case 0:return[4,this.get(v.o.RCV_DEFAULT_BRIDGE)];case 1:return[2,e.sent()]}}))}))};RCVUserConfig.prototype.getRCVPMI=function(){return _(this,void 0,Promise,(function(){var e;return C(this,(function(t){switch(t.label){case 0:return[4,this.getRCVDefaultBridge()];case 1:e=t.sent();if(e&&e.pins){return[2,e.pins.web]}return[2,""]}}))}))};RCVUserConfig.prototype.getBridgeId=function(){return _(this,void 0,void 0,(function(){var e;return C(this,(function(t){switch(t.label){case 0:return[4,this.getRCVDefaultBridge()];case 1:e=t.sent();if(e){return[2,e.id||""]}return[2,""]}}))}))};RCVUserConfig.prototype.isRCVInstantMeet=function(){return _(this,void 0,void 0,(function(){var e,t;return C(this,(function(n){switch(n.label){case 0:return[4,h.gv.getInstance().getRCVPreferences()];case 1:e=n.sent();if(e){t=e.find((function(e){return e.id===v.m.USE_PMI_INSTANT}));if(t){return[2,!!t.value]}}return[2,false]}}))}))};return RCVUserConfig}(u.DBConfig);var E;(function(e){e["START_INSTANT_MEETING"]="start_rcv_instant_meeting";e["START_VIDEO_CALL"]="start_rcv_video_call";e["START_SCREEN_SHARING"]="start_rcv_screen_sharing";e["JOIN_MEETING"]="join_rcv_meeting";e["SCHEDULE_MEETING"]="schedule_rcv_meeting";e["SCHEDULE_MEETING_WITH_MEETING_INFO"]="schedule_rcv_meeting_with_meeting_info"})(E||(E={}));var R=n(529696);var m=n(212616);var I=n(551451);var b=n(982313);var M={FETCH_RCV_DELEGATE_USER_LIST:"MEET.FETCH_RCV_DELEGATE_USER_LIST",FETCH_RCV_DEFAULT_BRIDGES:"MEET.FETCH_RCV_DEFAULT_BRIDGES",FETCH_RCV_PREFERENCE:"MEET.FETCH_RCV_PREFERENCE"};var S={JOIN:"join",SHARE:"share"};var w=107;var O="mas";var V=null&&30*1e3;var A="QUERY_RCV_MEET";var P=null&&10*1e3;var N=null&&2*60*1e3;var T=null&&30*60*1e3;var L="meetingInvite";var D;(function(e){e["hostName"]="hostName";e["meetingId"]="meetingId";e["meetingName"]="meetingName";e["numbers"]="numbers";e["participantCode"]="participantCode";e["maskedPassword"]="maskedPassword";e["dialInPassword"]="dialInPassword";e["password"]="password";e["isE2eeEnabled"]="isE2eeEnabled";e["isSIPAvailable"]="isSIPAvailable";e["entryPoint"]="entryPoint";e["brandName"]="brandName";e["$Brand_Id"]="$Brand_Id";e["$Extension_FormattingLocaleCode"]="$Extension_FormattingLocaleCode";e["$Extension_LanguageLocaleCode"]="$Extension_LanguageLocaleCode"})(D||(D={}));var U="en-US";var B;(function(e){e["en"]="en-US";e["de"]="de-DE";e["zh"]="zh-CN";e["es"]="es-ES";e["fr"]="fr-FR";e["it"]="it-IT";e["pt"]="pt-PT";e["ja"]="ja-JP";e["ko"]="ko-KR";e["nl"]="nl-NL";e["fi"]="fi-FI"})(B||(B={}));var k;(function(e){e[e["en-US"]=0]="en-US";e[e["en-AU"]=1]="en-AU";e[e["en-GB"]=2]="en-GB";e[e["de-DE"]=3]="de-DE";e[e["es-419"]=4]="es-419";e[e["es-ES"]=5]="es-ES";e[e["fr-CA"]=6]="fr-CA";e[e["fr-FR"]=7]="fr-FR";e[e["it-IT"]=8]="it-IT";e[e["pt-BR"]=9]="pt-BR";e[e["ja-JP"]=10]="ja-JP";e[e["zh-CN"]=11]="zh-CN";e[e["zh-TW"]=12]="zh-TW";e[e["zh-HK"]=13]="zh-HK";e[e["ko-KR"]=14]="ko-KR";e[e["nl-NL"]=15]="nl-NL";e[e["pt-PT"]=16]="pt-PT";e[e["fi-FI"]=17]="fi-FI"})(k||(k={}));var j=undefined&&undefined.__assign||function(){j=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i))e[i]=t[i]}return e};return j.apply(this,arguments)};var H=function(){function RCVDataHandler(e,t){this.meetingService=e;this._entityCacheController=t}RCVDataHandler.prototype._getIncomingServiceType=function(){return this.meetingService.meetModule.isEmbedded()?I.h8.EMBEDDED:I.h8.DEEP_LINK};RCVDataHandler.prototype._initEntity=function(e){var t={id:e.id.toString(),provider:I.$q.RCV,service_type:this._getIncomingServiceType(),meeting_id:e.meeting_id,item_id:e.id,meeting_state:I.zp.NOT_STARTED,group_ids:e.group_ids,creator_id:e.creator_id,ignore:false,user_action:I.xf.INIT,type_id:e.type_id};return t};RCVDataHandler.prototype.handleIncomingData=function(e,t){if(b.uT===e.type_id){e=this.transformInviteIntoCall(e)}var n=this._entityCacheController.getSynchronously(e.id.toString());if(!n){n=this._initEntity(e)}n.meeting_id=e.meeting_id;n.meeting_state=e.status;var r=e.participants&&e.participants.find((function(e){return e.glip_id===t}));if(r){var i=r.status;if(i===I.xf.JOIN||i===I.xf.REJECT||i===I.xf.NO_ANSWER){n.user_action=i}}n.details=j({},l().pick(e,["meeting_id","join_url","start_url","rcv_meeting_id","start","start_time","end_time","end"]));return n};RCVDataHandler.prototype.transformInviteIntoCall=function(e){return j(j({},e),{join_url:e.meeting_url,start_url:e.meeting_url,status:I.zp.LIVE})};return RCVDataHandler}();var G=n(638807);var F=n(218932);var x=n(161320);var J=n.n(x);var K=n(470033);var q=n(587040);var W=n(302186);var Y=n(379269);var Q=n(268908);var z=undefined&&undefined.__assign||function(){z=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i))e[i]=t[i]}return e};return z.apply(this,arguments)};var $=undefined&&undefined.__awaiter||function(e,t,n,r){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,i){function fulfilled(e){try{step(r.next(e))}catch(e){i(e)}}function rejected(e){try{step(r["throw"](e))}catch(e){i(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((r=r.apply(e,t||[])).next())}))};var Z=undefined&&undefined.__generator||function(e,t){var n={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},r,i,o,a;return a={next:verb(0),throw:verb(1),return:verb(2)},typeof Symbol==="function"&&(a[Symbol.iterator]=function(){return this}),a;function verb(e){return function(t){return step([e,t])}}function step(a){if(r)throw new TypeError("Generator is already executing.");while(n)try{if(r=1,i&&(o=a[0]&2?i["return"]:a[0]?i["throw"]||((o=i["return"])&&o.call(i),0):i.next)&&!(o=o.call(i,a[1])).done)return o;if(i=0,o)a=[a[0]&2,o.value];switch(a[0]){case 0:case 1:o=a;break;case 4:n.label++;return{value:a[1],done:false};case 5:n.label++;i=a[1];a=[0];continue;case 7:a=n.ops.pop();n.trys.pop();continue;default:if(!(o=n.trys,o=o.length>0&&o[o.length-1])&&(a[0]===6||a[0]===2)){n=0;continue}if(a[0]===3&&(!o||a[1]>o[0]&&a[1]<o[3])){n.label=a[1];break}if(a[0]===6&&n.label<o[1]){n.label=o[1];o=a;break}if(o&&n.label<o[2]){n.label=o[2];n.ops.push(a);break}if(o[2])n.ops.pop();n.trys.pop();continue}a=t.call(e,n)}catch(e){a=[6,e];i=0}finally{r=o=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:true}}};var X=undefined&&undefined.__read||function(e,t){var n=typeof Symbol==="function"&&e[Symbol.iterator];if(!n)return e;var r=n.call(e),i,o=[],a;try{while((t===void 0||t-- >0)&&!(i=r.next()).done)o.push(i.value)}catch(e){a={error:e}}finally{try{if(i&&!i.done&&(n=r["return"]))n.call(r)}finally{if(a)throw a.error}}return o};var ee=function(){function MeetingController(e,t){this.meetingService=e;this._adaptors=new Map;this._windowGroupMap=new Map;this._entityCacheController=t}Object.defineProperty(MeetingController.prototype,"meetingConfig",{get:function(){return this.meetingService.DBConfig},enumerable:true,configurable:true});Object.defineProperty(MeetingController.prototype,"dataHandler",{get:function(){if(!this._dataHandler){this._dataHandler=new H(this.meetingService,this._entityCacheController)}return this._dataHandler},enumerable:true,configurable:true});Object.defineProperty(MeetingController.prototype,"meetModule",{get:function(){return this.meetingService.meetModule},enumerable:true,configurable:true});Object.defineProperty(MeetingController.prototype,"switchOverModule",{get:function(){return(0,u.getModule)(F.oF)},enumerable:true,configurable:true});MeetingController.prototype.scheduleMeeting=function(e,t,n,r){return $(this,void 0,void 0,(function(){var o,c,l,f,d,h;return Z(this,(function(v){switch(v.label){case 0:o=this._getSuitableMeetingController();if(!o)return[3,3];c=R.k.performance();return[4,o.createScheduleMeeting(e)];case 1:l=v.sent();return[4,this._buildInvitation(e,l,t,n,r)];case 2:f=v.sent();d=p.MO.getTime();h={id:d,calendar_url:f,meeting_id:l.meetingId,join_url:l.meetingUrl,meeting_state:a.zp.NOT_STARTED,startTime:J()(e.schedule.startTime).unix(),endTime:typeof e.schedule.durationInMinutes==="number"?J()(e.schedule.startTime).add(e.schedule.durationInMinutes,"minute").unix():undefined};u.notificationCenter.emitEntityUpdate(i.QT.RCV,[h]);c.end({key:E.SCHEDULE_MEETING,level:s.LOG_CONTROL_LEVEL.HIGH});return[2,d];case 3:throw this._getInvalidControllerError()}}))}))};MeetingController.prototype._buildInvitation=function(e,t,n,r,i){return $(this,void 0,void 0,(function(){var o,a,u;return Z(this,(function(s){switch(s.label){case 0:return[4,this._getMeetInvitation(e,t)];case 1:o=s.sent();a={startDate:J()(e.schedule.startTime).valueOf(),endDate:J()(e.schedule.startTime).add(e.schedule.durationInMinutes,"minute").valueOf()};if(!n)return[3,3];return[4,this.meetModule.scheduleCalendarEvent(e.providerId,z(z({},t),a),o,r,i)];case 2:u=s.sent();return[2,u.url];case 3:return[2,o]}}))}))};MeetingController.prototype.scheduleMeetingWithMeetingInfo=function(e){return $(this,void 0,Promise,(function(){var t,n,r,i;return Z(this,(function(o){switch(o.label){case 0:t=this._getSuitableMeetingController();if(!t)return[3,3];n=R.k.performance();return[4,t.createScheduleMeeting(e)];case 1:r=o.sent();return[4,this._getMeetInvitation(e,r)];case 2:i=o.sent();n.end({key:E.SCHEDULE_MEETING_WITH_MEETING_INFO,level:s.LOG_CONTROL_LEVEL.NORMAL});return[2,{meetId:r.meetingId,invitationText:i,meetUrl:r.meetingUrl}];case 3:throw this._getInvalidControllerError()}}))}))};MeetingController.prototype._getMeetInvitation=function(e,t){return $(this,void 0,Promise,(function(){var n,r,i,o,a;return Z(this,(function(s){switch(s.label){case 0:n={notificationId:L,parameters:Object.entries(t).filter((function(e){var t=X(e,2),n=t[0],r=t[1];return D[n]&&r!==undefined})).map((function(e){var t=X(e,2),n=t[0],r=t[1];return{parameterName:n,parameterValue:r}})),plainTextPreferred:true,isolatedMode:true};r=W.Pal.instance.getPlatformUtils().getLanguage();o=(i=n.parameters).push;a={parameterName:D.numbers};return[4,this._getDialInNumbers(e.getI18nCountryName)];case 1:o.apply(i,[(a.parameterValue=s.sent(),a),{parameterName:D.isSIPAvailable,parameterValue:!!(0,u.getCurrentAccount)().context.entitlement.get(K.H3.RCExtensionFeaturesId.RoomConnectorBeta)},{parameterName:D.entryPoint,parameterValue:u.apiConfiguration.getConfig().meetingsConfig.rcv.baseUrl},{parameterName:D.brandName,parameterValue:e.brandName},{parameterName:D.$Brand_Id,parameterValue:(0,q.gT)().userConfig.getBrandId()},{parameterName:D.$Extension_FormattingLocaleCode,parameterValue:B[r]?B[r]:r in k?r:U},{parameterName:D.$Extension_LanguageLocaleCode,parameterValue:B[r]?B[r]:r in k?r:U}]);return[2,m.P.getInvitationByUNS(n)]}}))}))};Object.defineProperty(MeetingController.prototype,"_rcInfoModule",{get:function(){return(0,u.getModule)(Y.oF)},enumerable:true,configurable:true});MeetingController.prototype._getDialInNumbers=function(e){var t,n,r,i;return $(this,void 0,Promise,(function(){var o,a,u,c,l,f,d,p;var v=this;return Z(this,(function(g){switch(g.label){case 0:return[4,(t=this._rcInfoModule)===null||t===void 0?void 0:t.getRCExtensionInfo()];case 1:o=(i=(r=(n=g.sent())===null||n===void 0?void 0:n.regionalSettings)===null||r===void 0?void 0:r.homeCountry)===null||i===void 0?void 0:i.isoCode;a=o!==undefined?o:"";R.k.info("current user isoCode",a);return[4,h.gv.getInstance().getDialInNumbers()];case 2:u=g.sent().phoneNumbers;return[4,(0,s.runInBand)(u.filter((function(e){return e.country.isoCode===a})).map((function(t){return function(){return $(v,void 0,void 0,(function(){var n;return Z(this,(function(r){switch(r.label){case 0:n={};return[4,this.meetModule.getCanonical(t.phoneNumber)];case 1:return[2,(n.number=r.sent(),n.unformattedNumber=t.phoneNumber,n.country=e(a,t.country.name),n.location=t.location,n.default=t.default,n)]}}))}))}})))];case 3:c=g.sent();if(!(c.length===0))return[3,5];l=u.find((function(e){return e.default}));if(!l)return[3,5];d=(f=c).push;p={};return[4,this.meetModule.getCanonical(l.phoneNumber)];case 4:d.apply(f,[(p.number=g.sent(),p.unformattedNumber=l.phoneNumber,p.country=e(a,l.country.name),p.location=l.location,p.default=l.default,p)]);g.label=5;case 5:return[2,c]}}))}))};MeetingController.prototype.getDelegateUserList=function(){return $(this,void 0,void 0,(function(){var e;return Z(this,(function(t){e=this._getSuitableMeetingController();if(e){return[2,e.getDelegateUserList()]}throw this._getInvalidControllerError()}))}))};MeetingController.prototype.requestDelegateUserList=function(){var e=this._getSuitableMeetingController();if(e){return e.requestDelegateUserList()}throw this._getInvalidControllerError()};MeetingController.prototype._isRCVInstantMeet=function(){return $(this,void 0,void 0,(function(){var e,t;return Z(this,(function(n){switch(n.label){case 0:return[4,this.meetingConfig.isRCVInstantMeet()];case 1:e=n.sent();if(!(e===undefined))return[3,5];n.label=2;case 2:n.trys.push([2,4,,5]);return[4,this.meetingService.requestRCVPMISetting()];case 3:n.sent();return[2,this.meetingConfig.isRCVInstantMeet()];case 4:t=n.sent();R.k.warn("Error on requesting RCVPMISetting: ",JSON.stringify(t));return[2,false];case 5:return[2,e]}}))}))};MeetingController.prototype._getPMISetting=function(e){return $(this,void 0,void 0,(function(){var t,n,r;return Z(this,(function(i){switch(i.label){case 0:return[4,this._isRCVInstantMeet()];case 1:t=i.sent();if(!t)return[3,7];i.label=2;case 2:i.trys.push([2,4,,5]);return[4,this.meetingService.requestRCVDefaultBridges()];case 3:i.sent();return[3,5];case 4:n=i.sent();R.k.report("request RCV Default Bridges",n);return[3,5];case 5:return[4,this.meetingConfig.getRCVPMI()];case 6:r=i.sent();return[2,{serviceType:e,usePMI:t,PMI:r}];case 7:return[2,{serviceType:e,usePMI:t}]}}))}))};MeetingController.prototype.startMeeting=function(e){return $(this,void 0,Promise,(function(){var t,n,r,i,o,a,c,l;return Z(this,(function(p){switch(p.label){case 0:R.k.info("Start RCV meeting with ",e);t=this._getSuitableMeetingController();if(!t)return[3,5];n=R.k.performance();r=this._getMeetingServiceType();if(!!e)return[3,3];return[4,this._getPMISetting(r)];case 1:i=p.sent();return[4,t.startInstantMeeting(i)];case 2:o=p.sent();n.end({key:E.START_INSTANT_MEETING,level:s.LOG_CONTROL_LEVEL.HIGH});return[2,o];case 3:return[4,this.meetModule.getCurrentPersonName()];case 4:a=p.sent();if(!a){R.k.report("Can not get current person when Start meet");throw new f.R(d.n.INVALID_PERSON,"Can not get person")}c=(0,u.randomInt)();l=t.startMeeting({groupIds:e,firstName:a.firstName,lastName:a.lastName,email:a.email,service_type:r,windowId:c});n.end({key:E.START_VIDEO_CALL,level:s.LOG_CONTROL_LEVEL.HIGH});this._windowGroupMap.set(c,e[0]);return[2,l];case 5:throw this._getInvalidControllerError()}}))}))};MeetingController.prototype.startMeetingShareScreen=function(e){return $(this,void 0,Promise,(function(){var t,n,r,i,o,a;return Z(this,(function(c){switch(c.label){case 0:t=this._getSuitableMeetingController();if(!t)return[3,2];n=R.k.performance();return[4,this.meetModule.getCurrentPersonName()];case 1:r=c.sent();if(!r){R.k.report("Can not get current person when Start meet Share Screen");throw new f.R(d.n.INVALID_PERSON,"Can not get person")}i=this._getMeetingServiceType();o=(0,u.randomInt)();a=t.startMeetingShareScreen({groupIds:e,firstName:r.firstName,lastName:r.lastName,email:r.email,service_type:i,windowId:o});n.end({key:E.START_SCREEN_SHARING,level:s.LOG_CONTROL_LEVEL.HIGH});this._windowGroupMap.set(o,e[0]);return[2,a];case 2:throw this._getInvalidControllerError()}}))}))};MeetingController.prototype.canStartE2EEMeeting=function(){var e=this._getSuitableMeetingController();if(e){return e.canStartE2EEMeeting()}throw this._getInvalidControllerError()};MeetingController.prototype.answerMeeting=function(e){return $(this,void 0,Promise,(function(){var t,n,r;return Z(this,(function(o){switch(o.label){case 0:t=this._getMeetEntity(e);if(!t)return[3,7];t.user_action=a.xf.JOIN;u.notificationCenter.emitEntityUpdate(i.QT.RCV,[t]);n=this._getSuitableMeetingController(e);if(!n)return[3,2];return[4,n.answerMeeting()];case 1:o.sent();o.label=2;case 2:if(!((t===null||t===void 0?void 0:t.type_id)===b.uT))return[3,7];o.label=3;case 3:o.trys.push([3,6,,7]);if(!(n&&n.ackMeeting))return[3,5];return[4,n.ackMeeting(+e)];case 4:o.sent();o.label=5;case 5:return[3,7];case 6:r=o.sent();R.k.report("Ack meet error",r);return[3,7];case 7:return[2]}}))}))};MeetingController.prototype.joinMeet=function(e){if(e.entityId){return this.joinMeetByEntity(e)}if(e.joinUrl){return this.joinMeetByUrl(e)}if(e.meetId){return this.joinMeetById(e)}R.k.report("Join meet with ENTITY is undefined");throw this._getInvalidControllerError()};MeetingController.prototype.joinMeetingWithScreenShare=function(e){if(e.entityId){return this.joinMeetByEntity(e,S.SHARE)}if(e.joinUrl){return this.joinMeetByUrl(e,S.SHARE)}if(e.meetId){return this.joinMeetById(e,S.SHARE)}R.k.report("Join meet screen share with ENTITY is undefined");throw this._getInvalidControllerError()};MeetingController.prototype.joinMeetByEntity=function(e,t){if(t===void 0){t=S.JOIN}return $(this,void 0,Promise,(function(){var n,r,i,o,a,o;return Z(this,(function(u){switch(u.label){case 0:R.k.info("join meet by entity: ",(0,s.sensitive)(e,["email"]));n=R.k.performance();r=e.entityId;i=this._getMeetEntity(r);if(!i)return[3,2];o=this._getSuitableMeetingController(r);if(!o){throw this._getInvalidControllerError()}return[4,o.joinMeetByEntity(i)];case 1:u.sent();return[3,4];case 2:if(!e.meetId){R.k.report("Join meet with meetId is undefined");throw this._getInvalidControllerError()}a=this._getMeetingServiceType();o=this._getAdaptorController(a);if(!o){throw this._getInvalidControllerError()}return[4,o.joinMeetByEntityId(e,a,t)];case 3:u.sent();u.label=4;case 4:n.end({key:E.JOIN_MEETING,level:s.LOG_CONTROL_LEVEL.HIGH});return[2,r]}}))}))};MeetingController.prototype._getMeetingTitleById=function(e){var t;return $(this,void 0,void 0,(function(){var n;return Z(this,(function(r){switch(r.label){case 0:return[4,this.meetModule.hasMeetingPermission()];case 1:if(!r.sent())return[2,""];r.label=2;case 2:r.trys.push([2,4,,5]);return[4,m.P.getBridgeByShortId(e)];case 3:return[2,(t=r.sent().name)!==null&&t!==void 0?t:""];case 4:n=r.sent();return[2,""];case 5:return[2]}}))}))};MeetingController.prototype._recordJoinMeetHistoryById=function(e,t){return $(this,void 0,void 0,(function(){var n;return Z(this,(function(r){switch(r.label){case 0:return[4,this._getMeetingTitleById(e)];case 1:n=r.sent();return[4,this.meetModule.upsertRecentMeetItem({id:e,password:t,displayName:n!==null&&n!==void 0?n:""})];case 2:r.sent();return[2]}}))}))};MeetingController.prototype._recordJoinMeetHistoryByUrl=function(e){return $(this,void 0,void 0,(function(){var t,n;return Z(this,(function(r){switch(r.label){case 0:return[4,(0,u.getModuleAsync)(G.oF)];case 1:return[4,r.sent().parse(e)];case 2:t=r.sent().meetingCode;return[4,this._getMeetingTitleById(t)];case 3:n=r.sent();return[4,this.meetModule.upsertRecentMeetItem({id:t,url:e,displayName:n})];case 4:r.sent();return[2]}}))}))};MeetingController.prototype.joinMeetById=function(e,t){if(t===void 0){t=S.JOIN}var n,r;return $(this,void 0,Promise,(function(){var i,o,a,u,c,l,f;return Z(this,(function(d){switch(d.label){case 0:i=this._getMeetingServiceType();o=this._getAdaptorController(i);if(!o)return[3,2];a=R.k.performance();u={meetId:e.meetId};c=(n=this.switchOverModule)===null||n===void 0?void 0:n.getRCVSwitchOverMeetInfoByMeetId(e.meetId);l={uname:e.userName,pw:(r=e.password)!==null&&r!==void 0?r:c===null||c===void 0?void 0:c.password,audioMute:c===null||c===void 0?void 0:c.audioMute,videoMute:e.turnOffCamera!==undefined?e.turnOffCamera:c===null||c===void 0?void 0:c.videoMute,useComputerAudio:e.joinAudio!==undefined?e.joinAudio:(c===null||c===void 0?void 0:c.deviceAudioJoined)?(c===null||c===void 0?void 0:c.deviceAudioJoined)===F.RCV_AUDIO_STATUS.INTERNET_AUDIO:undefined};return[4,o.joinMeetById(u,i,l,t)];case 1:f=d.sent();this._recordJoinMeetHistoryById(e.meetId,e.password);if(e.userName){this.meetModule.updateJoinName(e.userName)}a.end({key:E.JOIN_MEETING,level:s.LOG_CONTROL_LEVEL.HIGH});return[2,f];case 2:throw this._getInvalidControllerError()}}))}))};MeetingController.prototype.joinMeetByUrl=function(e,t){if(t===void 0){t=S.JOIN}return $(this,void 0,Promise,(function(){var n,r,i,o,a,c,l,f,d;return Z(this,(function(p){switch(p.label){case 0:n=this._getMeetingServiceType();r=this._getAdaptorController(n);if(!r)return[3,5];i=R.k.performance();o=(0,u.getModule)(G.oF).parse(e.joinUrl);a=o.meetingCode;c={joinUrl:e.joinUrl,joinAsGuest:e.joinAsGuest,meetId:a,password:o.meetingPassword};l={useComputerAudio:e.joinAudio,videoMute:e.turnOffCamera};if(!e.userName)return[3,1];l.uname=e.userName;return[3,3];case 1:return[4,this.meetModule.getCurrentPersonName()];case 2:f=p.sent();if(f){l.uname=f.firstName+" "+f.lastName}p.label=3;case 3:return[4,r.joinMeetByUrl(c,n,l,t)];case 4:d=p.sent();this._recordJoinMeetHistoryByUrl(e.joinUrl);if(e.userName){this.meetModule.updateJoinName(e.userName)}i.end({key:E.JOIN_MEETING,level:s.LOG_CONTROL_LEVEL.HIGH});return[2,d];case 5:throw this._getInvalidControllerError()}}))}))};MeetingController.prototype.getShortIdByBridgeId=function(e){return $(this,void 0,void 0,(function(){var t,n;return Z(this,(function(r){switch(r.label){case 0:r.trys.push([0,2,,3]);return[4,m.P.getBridgeByBridgeId(e)];case 1:t=r.sent();return[2,t&&t.pins&&t.pins.web];case 2:n=r.sent();R.k.report("Get shortId by Bridge Id failed.");throw n;case 3:return[2]}}))}))};MeetingController.prototype._getInvalidControllerError=function(){R.k.report("Can NOT get suitable meet controller");return new f.R(d.n.INVALID_CONTROLLER,"Can NOT get suitable meet controller")};MeetingController.prototype._getMeetingServiceType=function(){if(this.meetModule.isEmbedded()){return a.h8.EMBEDDED}return a.h8.DEEP_LINK};MeetingController.prototype.rejectMeeting=function(e){var t;return $(this,void 0,void 0,(function(){var n,r,o,s;return Z(this,(function(c){switch(c.label){case 0:n=this._getMeetEntity(e);if(!n)return[3,11];r=this._getSuitableMeetingController(e);c.label=1;case 1:c.trys.push([1,4,,5]);if(!r)return[3,3];return[4,r.rejectMeeting(+e,(t=n===null||n===void 0?void 0:n.group_ids)===null||t===void 0?void 0:t[0])];case 2:c.sent();c.label=3;case 3:return[3,5];case 4:o=c.sent();R.k.report("Reject meet error",o);return[3,5];case 5:if(!((n===null||n===void 0?void 0:n.type_id)===b.uT))return[3,10];c.label=6;case 6:c.trys.push([6,9,,10]);if(!(r&&r.ackMeeting))return[3,8];return[4,r.ackMeeting(+e)];case 7:c.sent();c.label=8;case 8:return[3,10];case 9:s=c.sent();R.k.report("Ack meet error",s);return[3,10];case 10:n.user_action=a.xf.REJECT;u.notificationCenter.emitEntityUpdate(i.QT.RCV,[n]);c.label=11;case 11:return[2]}}))}))};MeetingController.prototype.ignoreMeeting=function(e){return $(this,void 0,void 0,(function(){var t;return Z(this,(function(n){R.k.info("Ignore meeting for entityId = ",e);t=this._getMeetEntity(e);if(t){t.ignore=true;u.notificationCenter.emitEntityUpdate(i.QT.RCV,[t])}return[2]}))}))};MeetingController.prototype.deleteWindowFromMap=function(e){var t=-l().toInteger(e);this._windowGroupMap.delete(t)};MeetingController.prototype.addAdaptorController=function(e,t){this._adaptors.set(e,t)};MeetingController.prototype._getAdaptorController=function(e){R.k.info("controller type = ",e);return this._adaptors.get(e)};MeetingController.prototype._getMeetEntity=function(e){var t=this._entityCacheController.getSynchronously(e);return t?l().cloneDeep(t):null};MeetingController.prototype._getSuitableMeetingController=function(e){var t=a.h8.DEEP_LINK;if(e){var n=this._getMeetEntity(e);if(n){t=n.service_type}}else{t=this._getMeetingServiceType()}return this._getAdaptorController(t)};MeetingController.prototype.handleIncomingData=function(e){return $(this,void 0,void 0,(function(){var t,n;return Z(this,(function(r){switch(r.label){case 0:if(![w,b.uT].includes(e.type_id)){return[2,undefined]}return[4,this.meetModule.getUserId()];case 1:t=r.sent();R.k.info("Handle RCV incoming data, glipId:",t);n=this.dataHandler.handleIncomingData(e,t);R.k.info("Handle RCV incoming data from server: ",(0,p.KP)(n));n&&u.notificationCenter.emitEntityUpdate(i.QT.RCV,[n]);return[2,n]}}))}))};MeetingController.prototype.getRCVMeetSettingUrl=function(){return $(this,void 0,Promise,(function(){var e;return Z(this,(function(t){switch(t.label){case 0:e=this._getSuitableMeetingController();if(!e)return[3,2];return[4,e.getRCVMeetSettingUrl()];case 1:return[2,t.sent()];case 2:throw this._getInvalidControllerError()}}))}))};MeetingController.prototype.getMeetingDetails=function(e){return $(this,void 0,Promise,(function(){var t,n;return Z(this,(function(r){switch(r.label){case 0:return[4,m.P.getBridgeByShortId(e)];case 1:t=r.sent();n=Q.W.convertV2Response2V1Response(t);n.e2ee=t.security.e2ee;return[2,n]}}))}))};MeetingController.prototype.editMeetingDetails=function(e,t){return $(this,void 0,Promise,(function(){var n,r;return Z(this,(function(i){switch(i.label){case 0:return[4,m.P.updateBridge(e,t)];case 1:n=i.sent();r=Q.W.convertV2Response2V1Response(n);r.e2ee=n.security.e2ee;return[2,r]}}))}))};return MeetingController}();var te=n(510200);var ne=undefined&&undefined.__awaiter||function(e,t,n,r){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,i){function fulfilled(e){try{step(r.next(e))}catch(e){i(e)}}function rejected(e){try{step(r["throw"](e))}catch(e){i(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((r=r.apply(e,t||[])).next())}))};var re=undefined&&undefined.__generator||function(e,t){var n={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},r,i,o,a;return a={next:verb(0),throw:verb(1),return:verb(2)},typeof Symbol==="function"&&(a[Symbol.iterator]=function(){return this}),a;function verb(e){return function(t){return step([e,t])}}function step(a){if(r)throw new TypeError("Generator is already executing.");while(n)try{if(r=1,i&&(o=a[0]&2?i["return"]:a[0]?i["throw"]||((o=i["return"])&&o.call(i),0):i.next)&&!(o=o.call(i,a[1])).done)return o;if(i=0,o)a=[a[0]&2,o.value];switch(a[0]){case 0:case 1:o=a;break;case 4:n.label++;return{value:a[1],done:false};case 5:n.label++;i=a[1];a=[0];continue;case 7:a=n.ops.pop();n.trys.pop();continue;default:if(!(o=n.trys,o=o.length>0&&o[o.length-1])&&(a[0]===6||a[0]===2)){n=0;continue}if(a[0]===3&&(!o||a[1]>o[0]&&a[1]<o[3])){n.label=a[1];break}if(a[0]===6&&n.label<o[1]){n.label=o[1];o=a;break}if(o&&n.label<o[2]){n.label=o[2];n.ops.push(a);break}if(o[2])n.ops.pop();n.trys.pop();continue}a=t.call(e,n)}catch(e){a=[6,e];i=0}finally{r=o=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:true}}};var ie=function(){function RCVConfigFetchController(e){var t=this;this.meetingService=e;this.requestRCVDelegateUserList=function(){return ne(t,void 0,void 0,(function(){var e;return re(this,(function(t){switch(t.label){case 0:return[4,m.P.getRCVDelegateUserList()];case 1:e=t.sent();return[4,this.meetingUserConfig.setRCVDelegateUserList(e)];case 2:t.sent();return[2,e]}}))}))};this.requestRCVDefaultBridges=function(){return ne(t,void 0,Promise,(function(){var e;return re(this,(function(t){switch(t.label){case 0:return[4,m.P.getDefaultBridges()];case 1:e=t.sent();return[4,this.meetingUserConfig.setRCVDefaultBridge(e)];case 2:t.sent();return[2]}}))}))};this.requestRCVPreference=function(){return ne(t,void 0,void 0,(function(){return re(this,(function(e){return[2,h.gv.getInstance().getRCVPreferences(false)]}))}))};this.requestDelegatorBridges=function(e){return ne(t,void 0,Promise,(function(){var t,n;return re(this,(function(r){switch(r.label){case 0:return[4,m.P.getDefaultBridges(e)];case 1:t=r.sent();if(t){n=Q.W.convertV2Response2V1Response(t);n.pmiLink=this._generateLink(n.shortId,n.meetingPasswordMasked);n.pmnLink=this._generateLink(n.personalRoomName,n.meetingPasswordMasked);return[2,n]}return[2,undefined]}}))}))}}Object.defineProperty(RCVConfigFetchController.prototype,"meetingUserConfig",{get:function(){return this.meetingService.DBConfig},enumerable:true,configurable:true});RCVConfigFetchController.prototype.scheduleRCVDelegateUserList=function(){this._scheduleJob(M.FETCH_RCV_DELEGATE_USER_LIST,this.requestRCVDelegateUserList)};RCVConfigFetchController.prototype.scheduleRCVDefaultBridge=function(){this._scheduleJob(M.FETCH_RCV_DEFAULT_BRIDGES,this.requestRCVDefaultBridges)};RCVConfigFetchController.prototype.scheduleRCVPreference=function(){h.gv.getInstance().startSync({preference:true,dialInNumber:true})};RCVConfigFetchController.prototype._scheduleJob=function(e,t){var n=this;u.jobScheduler.scheduleDailyPeriodicJob(e,(function(r){return ne(n,void 0,void 0,(function(){var n;return re(this,(function(i){switch(i.label){case 0:i.trys.push([0,2,,3]);return[4,t()];case 1:i.sent();r(true);return[3,3];case 2:n=i.sent();R.k.report("Meet config refresh error in daily JOB, "+e+", "+n);r(false);return[3,3];case 3:return[2]}}))}))}),true,u.INITIAL_OPTION.BASE_ON_LAST_TIME)};RCVConfigFetchController.prototype._generateLink=function(e,t){if(e){return u.apiConfiguration.getConfig().meetingsConfig.rcv.baseUrl+"/join/"+e+(t?"?pw="+t:"")}return undefined};return RCVConfigFetchController}();var oe=n(711719);var ae=n(960782);var ue=n(38942);var se=n(782117);var ce=undefined&&undefined.__awaiter||function(e,t,n,r){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,i){function fulfilled(e){try{step(r.next(e))}catch(e){i(e)}}function rejected(e){try{step(r["throw"](e))}catch(e){i(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((r=r.apply(e,t||[])).next())}))};var le=undefined&&undefined.__generator||function(e,t){var n={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},r,i,o,a;return a={next:verb(0),throw:verb(1),return:verb(2)},typeof Symbol==="function"&&(a[Symbol.iterator]=function(){return this}),a;function verb(e){return function(t){return step([e,t])}}function step(a){if(r)throw new TypeError("Generator is already executing.");while(n)try{if(r=1,i&&(o=a[0]&2?i["return"]:a[0]?i["throw"]||((o=i["return"])&&o.call(i),0):i.next)&&!(o=o.call(i,a[1])).done)return o;if(i=0,o)a=[a[0]&2,o.value];switch(a[0]){case 0:case 1:o=a;break;case 4:n.label++;return{value:a[1],done:false};case 5:n.label++;i=a[1];a=[0];continue;case 7:a=n.ops.pop();n.trys.pop();continue;default:if(!(o=n.trys,o=o.length>0&&o[o.length-1])&&(a[0]===6||a[0]===2)){n=0;continue}if(a[0]===3&&(!o||a[1]>o[0]&&a[1]<o[3])){n.label=a[1];break}if(a[0]===6&&n.label<o[1]){n.label=o[1];o=a;break}if(o&&n.label<o[2]){n.label=o[2];n.ops.push(a);break}if(o[2])n.ops.pop();n.trys.pop();continue}a=t.call(e,n)}catch(e){a=[6,e];i=0}finally{r=o=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:true}}};var fe=undefined&&undefined.__read||function(e,t){var n=typeof Symbol==="function"&&e[Symbol.iterator];if(!n)return e;var r=n.call(e),i,o=[],a;try{while((t===void 0||t-- >0)&&!(i=r.next()).done)o.push(i.value)}catch(e){a={error:e}}finally{try{if(i&&!i.done&&(n=r["return"]))n.call(r)}finally{if(a)throw a.error}}return o};var de=undefined&&undefined.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(fe(arguments[t]));return e};var pe="/rcv/create-call/waiting-page";var he="/rcv/join-call/waiting-page";var ve="[RCV]";var ge=function(){function RCVBaseController(e){this.meetingService=e}Object.defineProperty(RCVBaseController.prototype,"meetingConfig",{get:function(){return this.meetingService.DBConfig},enumerable:true,configurable:true});Object.defineProperty(RCVBaseController.prototype,"meetModule",{get:function(){return this.meetingService.meetModule},enumerable:true,configurable:true});RCVBaseController.prototype.getDelegateUserList=function(){return ce(this,void 0,void 0,(function(){var e;return le(this,(function(t){switch(t.label){case 0:return[4,this.meetingConfig.getRCVDelegateUserList()];case 1:e=t.sent();return[2,this._handleList(e)]}}))}))};RCVBaseController.prototype.requestDelegateUserList=function(){return ce(this,void 0,void 0,(function(){var e,t;return le(this,(function(n){switch(n.label){case 0:return[4,this.meetingConfigFetchController.requestRCVDelegateUserList()];case 1:e=n.sent();t=this._handleList(e);return[2,t]}}))}))};RCVBaseController.prototype._handleList=function(e){if(e&&e.length){return de(e)}return[]};RCVBaseController.prototype.createScheduleMeeting=function(e){return ce(this,void 0,void 0,(function(){var t,n;return le(this,(function(r){switch(r.label){case 0:if(!e.usePersonalMeetingId)return[3,2];return[4,this._updateBridge(e)];case 1:t=r.sent();return[3,4];case 2:return[4,this._createBridge(e)];case 3:t=r.sent();r.label=4;case 4:n={hostName:e.hostName,meetingId:t.pins.web,meetingName:e.topic,meetingUrl:t.discovery.web,participantCode:t.pins.pstn.participant,password:t.security.password.plainText,maskedPassword:t.security.password.joinQuery,dialInPassword:t.security.password.pstn,isE2eeEnabled:t.security.e2ee};return[2,n]}}))}))};RCVBaseController.prototype._createBridge=function(e){var t={name:e.personalRoomTitle===undefined?e.topic:e.personalRoomTitle,type:a._b.SCHEDULED,security:{password:e.password,passwordProtected:!!e.password,noGuests:e.usersCanJoin!==a.wN.Off,sameAccount:e.usersCanJoin===a.wN.OnlyCoworkersJoin,e2ee:e.e2ee},preferences:{join:{audioMuted:e.muteAudio,videoMuted:e.startParticipantsVideo,waitingRoomRequired:Q.W.convertOldWaitingRoomMode2New(e.waitingRoomMode)},joinBeforeHost:e.allowJoinBeforeHost,screenSharing:!e.screenSharingHostOnly}};R.k.tags(ve).info("create bridge request param",t);return m.P.createBridge(t,e.extensionId)};RCVBaseController.prototype._updateBridge=function(e){var t={name:e.personalRoomTitle===undefined?e.topic:e.personalRoomTitle,security:{password:e.password,passwordProtected:!!e.password,noGuests:e.usersCanJoin!==a.wN.Off,sameAccount:e.usersCanJoin===a.wN.OnlyCoworkersJoin,e2ee:e.e2ee},preferences:{join:{audioMuted:e.muteAudio,videoMuted:e.startParticipantsVideo,waitingRoomRequired:Q.W.convertOldWaitingRoomMode2New(e.waitingRoomMode)},joinBeforeHost:e.allowJoinBeforeHost,screenSharing:!e.screenSharingHostOnly}};R.k.tags(ve).info("update bridge request param",t);return m.P.updateBridge(e.bridgeId,t)};RCVBaseController.prototype.rejectMeeting=function(e,t){return ce(this,void 0,void 0,(function(){var n,r,i;return le(this,(function(o){switch(o.label){case 0:R.k.tags(ve).info("reject meet with",e);n=(0,u.getModule)(ae.COMMON_KEY_ACTION_MODULE).getKeyActionService().get(ae.ACTION_KEY.REJECT_RCV_MEETING);i=n===null||n===void 0?void 0:n.getAction;if(!i)return[3,2];return[4,n.getAction()];case 1:i=o.sent();o.label=2;case 2:r=i;return[4,r(e,t)];case 3:o.sent();return[2]}}))}))};RCVBaseController.prototype.answerMeeting=function(){return ce(this,void 0,Promise,(function(){return le(this,(function(e){R.k.tags(ve).info("Answer RCV meet ");return[2]}))}))};RCVBaseController.prototype.ackMeeting=function(e){return ce(this,void 0,Promise,(function(){var t,n,r;return le(this,(function(i){switch(i.label){case 0:R.k.tags(ve).info("ACK RCV meet ");t=(0,u.getModule)(ae.COMMON_KEY_ACTION_MODULE).getKeyActionService().get(ae.ACTION_KEY.ACK_RCM_VIDEO_CALL);r=t===null||t===void 0?void 0:t.getAction;if(!r)return[3,2];return[4,t.getAction()];case 1:r=i.sent();i.label=2;case 2:n=r;return[4,n(String(e))];case 3:i.sent();return[2]}}))}))};RCVBaseController.prototype.startMeeting=function(e){var t=e.groupIds,n=e.service_type,r=e.windowId;return ce(this,void 0,Promise,(function(){var e,o,c,l,v,g;return le(this,(function(_){switch(_.label){case 0:R.k.tags(ve).info("Start RCV meet, groupIds = "+t);e=t[0];return[4,this._getBaseUrlAndToken()];case 1:o=_.sent(),c=o.baseUrl,l=o.glipToken;if(!(e&&c&&l))return[3,3];v=p.MO.getTime();g={id:v,meeting_id:(-r).toString(),provider:a.$q.RCV,service_type:n,meeting_state:a.zp.NOT_STARTED,group_ids:t,start_url:c+"/api/group/"+e+pe+"?tk="+l};return[4,this.canStartE2EEMeeting()];case 2:if(_.sent()){g.start_url=s.UrlUtils.queryString.stringifyUrl({url:g.start_url,query:{e2ee:"true",type:a.Bp.CALL.toString(),waitingRoomMode:h.VQ.NOT_COWORKER.toString(),isOnlyAuthUserJoin:"true"}});g.e2ee=true;g.type=a.Bp.CALL;g.waitingRoomMode=h.VQ.NOT_COWORKER;g.isOnlyAuthUserJoin=true}u.notificationCenter.emitEntityUpdate(i.QT.RCV,[g]);return[2,v];case 3:throw new f.R(d.n.INVALID_TOKEN,"invalid glip token")}}))}))};RCVBaseController.prototype.startMeetingShareScreen=function(e){var t=e.groupIds,n=e.service_type,r=e.windowId;return ce(this,void 0,Promise,(function(){var e,o,s,c,l;return le(this,(function(f){switch(f.label){case 0:R.k.tags(ve).info("Start RCV meet Share Screen, groupIds = "+t);e=t[0];o=(0,oe.v4)();return[4,this._getJoinLinkByGroupId(e,o)];case 1:s=f.sent();c=p.MO.getTime();l={id:c,meeting_id:(-r).toString(),provider:a.$q.RCV,service_type:n,meeting_state:a.zp.NOT_STARTED,start_url:s};u.notificationCenter.emitEntityUpdate(i.QT.RCV,[l]);return[2,c]}}))}))};RCVBaseController.prototype.startInstantMeeting=function(e){return ce(this,void 0,Promise,(function(){var t,n,r,i,o,u;return le(this,(function(c){switch(c.label){case 0:R.k.tags(ve).info("Start RCV instant Meet");t=e.serviceType;return[4,this.canStartE2EEMeeting()];case 1:n=c.sent();r={type:a._b.SCHEDULED};if(!(e.usePMI&&!n))return[3,3];R.k.tags(ve).info("Start RCV instant Meet with PMI");return[4,this.joinMeetById({meetId:e.PMI},t,{instantMeeting:true})];case 2:return[2,c.sent()];case 3:if(n){r={type:a._b.SCHEDULED,security:{e2ee:true,noGuests:true},preferences:{join:{waitingRoomRequired:a.eJ.OtherAccount}}}}return[4,m.P.createBridge(r)];case 4:i=c.sent();o=s.UrlUtils.queryString.stringifyUrl({url:i.discovery.web,query:{instantMeeting:"true"}});u=i.discovery;return[4,this._addParamToUrl(o)];case 5:u.web=c.sent();return[2,this._notifyMeetingEntity(t,i)]}}))}))};RCVBaseController.prototype.canStartE2EEMeeting=function(){return ce(this,void 0,Promise,(function(){var e,t,n,r,i;return le(this,(function(o){switch(o.label){case 0:return[4,(0,u.getModule)(ue.FEATURE_FLAG_MODULE).getFeatureFlag(ue.G.D_USE_RCV_E2EE_START,true)];case 1:e=o.sent();if(!e){return[2,false]}R.k.tags(ve).info("e2eeForStartFromLD",e);t=u.accountManager.getCurrent().context.entitlement.get(K.H3.RCExtensionFeaturesId.MeetingsEncryption);if(!t){return[2,false]}R.k.tags(ve).info("e2eeForStartFromAW",t);return[4,h.gv.getInstance().getRCVPreferences()];case 2:n=o.sent();r=n.find((function(e){return e.id===v.m.E2EE}));if(r&&!r.value&&r.readOnly){return[2,false]}R.k.tags(ve).info("e2eeForSchedulePreference",r);i=n.find((function(e){return e.id===v.m.E2EE_INSTANT}));R.k.tags(ve).info("e2eeForStartPreference",i);return[2,!!(i&&i.value)]}}))}))};RCVBaseController.prototype.joinMeetById=function(e,t,n,r){if(r===void 0){r=S.JOIN}return ce(this,void 0,Promise,(function(){var i;return le(this,(function(o){switch(o.label){case 0:R.k.tags(ve).info("Join RCV meet with MeetId = ",e.meetId);i="/"+r+"/"+e.meetId;e.joinUrl=this._handleMeetingUrl(i);return[4,this.joinMeetByUrl(e,t,n)];case 1:return[2,o.sent()]}}))}))};RCVBaseController.prototype.joinMeetByEntity=function(e){var t;return ce(this,void 0,void 0,(function(){var n,r;return le(this,(function(o){switch(o.label){case 0:n=l().get(e,"details.join_url","");r=e;return[4,this._jointMeetUrl(n,e.id,(t=e===null||e===void 0?void 0:e.group_ids)===null||t===void 0?void 0:t[0])];case 1:r.start_url=o.sent();e.join_url=e.start_url;e.user_action=a.xf.JOIN;R.k.info("Join meet by entity: ",(0,p.KP)(e));u.notificationCenter.emitEntityUpdate(i.QT.RCV,[e]);return[2]}}))}))};RCVBaseController.prototype.joinMeetByEntityId=function(e,t,n){if(n===void 0){n=S.JOIN}return ce(this,void 0,void 0,(function(){var r,o;return le(this,(function(c){switch(c.label){case 0:r=e.joinUrl?e.joinUrl:"";if(n===S.SHARE){r=r.replace("/join/","/share/")}return[4,this._jointMeetUrl(r,e.entityId)];case 1:r=c.sent();o={id:e.entityId,meeting_id:e.meetId,provider:a.$q.RCV,service_type:t,meeting_state:a.zp.LIVE,start_url:r,join_url:r,user_action:a.xf.JOIN};R.k.tags(ve).info("Join Meet by entity: ",(0,s.sensitive)(o,["email"]));u.notificationCenter.emitEntityUpdate(i.QT.RCV,[o]);return[2]}}))}))};RCVBaseController.prototype.joinMeetByUrl=function(e,t,n,r){if(r===void 0){r=S.JOIN}return ce(this,void 0,Promise,(function(){var i,o,a;return le(this,(function(u){switch(u.label){case 0:R.k.tags(ve).info("Join RCV meet with URL");i=e.joinUrl;if(r===S.SHARE){i=i.replace("/join/","/share/")}o={pins:{web:e.meetId},security:{password:{plainText:e.password||n.pw}},discovery:{web:i}};a=o.discovery;return[4,this._addParamToUrl(i,n,e.joinAsGuest)];case 1:a.web=u.sent();return[2,this._notifyMeetingEntity(t,o)]}}))}))};RCVBaseController.prototype.getRCVMeetSettingUrl=function(){return ce(this,void 0,Promise,(function(){var e,t,n,r;return le(this,(function(i){switch(i.label){case 0:return[4,(0,q.gT)()];case 1:e=i.sent();if(!e)return[3,3];t=e.userConfig.getExtensionId();n=u.apiConfiguration.getConfig().meetingsConfig.rcv.baseUrl;return[4,this._getRCVAuthCode()];case 2:r=i.sent();return[2,n+"/settings-external?code="+r+"&id="+t];case 3:return[2,Promise.resolve("")]}}))}))};Object.defineProperty(RCVBaseController.prototype,"meetingConfigFetchController",{get:function(){if(!this._rcvConfigFetchController){this._rcvConfigFetchController=new ie(this.meetingService)}return this._rcvConfigFetchController},enumerable:true,configurable:true});RCVBaseController.prototype._handleMeetingUrl=function(e){var t=e;var n=u.apiConfiguration.getConfig().meetingsConfig.rcv.baseUrl;if(n){t=""+n+e}return t};RCVBaseController.prototype._getJoinUrlForFreeUser=function(e,t){return ce(this,void 0,void 0,(function(){var n,r,i,o;return le(this,(function(a){switch(a.label){case 0:return[4,this._getBaseUrlAndToken()];case 1:n=a.sent(),r=n.baseUrl,i=n.glipToken;o=t?r+"/api/group/"+t+he+"?tk="+i+"&meeting_item_id="+e:r+"/api"+he+"?tk="+i+"&meeting_item_id="+e;if(!t){R.k.warn("join meet for free user without groupId",e)}R.k.info("Free user join RCV meet with URL =",(0,s.sensitiveAllQuery)(o));return[2,o]}}))}))};RCVBaseController.prototype._jointMeetUrl=function(e,t,n){return ce(this,void 0,void 0,(function(){return le(this,(function(r){switch(r.label){case 0:return[4,this._isRCAccount()];case 1:if(!r.sent())return[3,3];return[4,this._addParamToUrl(e)];case 2:return[2,r.sent()];case 3:return[4,this._getJoinUrlForFreeUser(t,n)];case 4:return[2,r.sent()]}}))}))};RCVBaseController.prototype._notifyMeetingEntity=function(e,t){var n=p.MO.getTime();var r={id:n,meeting_id:t.pins.web,provider:a.$q.RCV,service_type:e,meeting_state:a.zp.NOT_STARTED,join_url:t.discovery.web,start_url:t.discovery.web,password:t.security.password.plainText};u.notificationCenter.emitEntityUpdate(i.QT.RCV,[r]);return n};RCVBaseController.prototype._addParamToUrl=function(e,t,n){if(n===void 0){n=false}return ce(this,void 0,void 0,(function(){var r,i,o,a;return le(this,(function(u){switch(u.label){case 0:r=s.UrlUtils.queryString.parseUrl(e).query;if(r.autoClose===undefined){r.autoClose="true"}r.joinFromWeb="true";if(t){Object.keys(t).forEach((function(e){if(t[e]!==undefined){r[e]=t[e].toString()}}))}return[4,this._isRCAccount()];case 1:if(!u.sent())return[3,3];i=this._getExtensionId();if(i){r.rc_extension_id=i.toString()}R.k.info("joinAsGuest: "+n+", url: "+(0,s.sensitiveAllQuery)(e));if(!!n)return[3,3];return[4,this._getCode()];case 2:o=u.sent();if(o){r.code=o}u.label=3;case 3:a=s.UrlUtils.queryString.stringifyUrl({url:e,query:r});return[2,a]}}))}))};RCVBaseController.prototype._getCode=function(){return ce(this,void 0,void 0,(function(){var e,t;return le(this,(function(n){switch(n.label){case 0:n.trys.push([0,2,,3]);return[4,this._getRCVAuthCode()];case 1:e=n.sent();if(e){return[2,e]}return[3,3];case 2:t=n.sent();R.k.report("authorizeRCV to get RCV authCode error",t);return[3,3];case 3:return[2,undefined]}}))}))};RCVBaseController.prototype._isRCAccount=function(){var e;return ce(this,void 0,void 0,(function(){return le(this,(function(t){return[2,((e=(0,u.getCurrentAccount)())===null||e===void 0?void 0:e.accountType())===se.Q5.RC]}))}))};RCVBaseController.prototype._getExtensionId=function(){var e=(0,q.gT)();if(e&&e.userConfig){return e.userConfig.getExtensionId()}return undefined};RCVBaseController.prototype._getJoinLinkByGroupId=function(e,t){return ce(this,void 0,Promise,(function(){var n,r,i,o,c,l;return le(this,(function(f){switch(f.label){case 0:n=(0,u.getModule)(ae.COMMON_KEY_ACTION_MODULE).getKeyActionService().get(ae.ACTION_KEY.CREATE_RCV_MEETING);i=n===null||n===void 0?void 0:n.getAction;if(!i)return[3,2];return[4,n.getAction()];case 1:i=f.sent();f.label=2;case 2:r=i;return[4,this.canStartE2EEMeeting()];case 3:o=f.sent();return[4,r({group_id:e,unique:t,type:o?a.Bp.CALL:undefined,e2ee:o?true:undefined,waitingRoomMode:o?h.VQ.NOT_COWORKER:undefined,isOnlyAuthUserJoin:o?true:undefined})];case 4:c=f.sent();l=c.joinLink.replace("/join/","/share/");l=s.UrlUtils.queryString.stringifyUrl({url:l,query:{audioMute:"false"}});l=s.UrlUtils.queryString.stringifyUrl({url:l,query:{useComputerAudio:"true"}});return[2,l]}}))}))};RCVBaseController.prototype._getBaseUrlAndToken=function(){return ce(this,void 0,void 0,(function(){var e,t,n,r,i;return le(this,(function(o){switch(o.label){case 0:e=(0,u.getModule)(ae.COMMON_KEY_ACTION_MODULE).getKeyActionService().get(ae.ACTION_KEY.GET_GLIP_ACCOUNT_USER_CONFIG);n=e===null||e===void 0?void 0:e.getAction;if(!n)return[3,2];return[4,e.getAction()];case 1:n=o.sent();o.label=2;case 2:t=n;r=t.getToken();i=u.apiConfiguration.getConfig().glip.server;return[2,{baseUrl:i,glipToken:r}]}}))}))};RCVBaseController.prototype._getRCVAuthCode=function(){return ce(this,void 0,void 0,(function(){var e,t,n,r,i;return le(this,(function(o){switch(o.label){case 0:e=5*60;t=(0,u.getModule)(ae.COMMON_KEY_ACTION_MODULE).getKeyActionService().get(ae.ACTION_KEY.GET_RCV_VIDEO_CLIENT_ID);r=t===null||t===void 0?void 0:t.getAction;if(!r)return[3,2];return[4,t.getAction()];case 1:r=o.sent();o.label=2;case 2:n=r;if(!n)return[3,4];return[4,q.Vi.generateRCCode(n,e)];case 3:i=o.sent();if(i&&i.code){return[2,i.code]}o.label=4;case 4:return[2,""]}}))}))};return RCVBaseController}();var _e=undefined&&undefined.__extends||function(){var extendStatics=function(e,t){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)if(t.hasOwnProperty(n))e[n]=t[n]};return extendStatics(e,t)};return function(e,t){extendStatics(e,t);function __(){this.constructor=e}e.prototype=t===null?Object.create(t):(__.prototype=t.prototype,new __)}}();var Ce=function(e){_e(RCVEmbeddedController,e);function RCVEmbeddedController(){return e!==null&&e.apply(this,arguments)||this}return RCVEmbeddedController}(ge);var ye=n(49064);var Ee=n(812490);var Re=n(696206);var me=n(260666);var Ie=undefined&&undefined.__extends||function(){var extendStatics=function(e,t){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)if(t.hasOwnProperty(n))e[n]=t[n]};return extendStatics(e,t)};return function(e,t){extendStatics(e,t);function __(){this.constructor=e}e.prototype=t===null?Object.create(t):(__.prototype=t.prototype,new __)}}();var be=undefined&&undefined.__awaiter||function(e,t,n,r){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,i){function fulfilled(e){try{step(r.next(e))}catch(e){i(e)}}function rejected(e){try{step(r["throw"](e))}catch(e){i(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((r=r.apply(e,t||[])).next())}))};var Me=undefined&&undefined.__generator||function(e,t){var n={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},r,i,o,a;return a={next:verb(0),throw:verb(1),return:verb(2)},typeof Symbol==="function"&&(a[Symbol.iterator]=function(){return this}),a;function verb(e){return function(t){return step([e,t])}}function step(a){if(r)throw new TypeError("Generator is already executing.");while(n)try{if(r=1,i&&(o=a[0]&2?i["return"]:a[0]?i["throw"]||((o=i["return"])&&o.call(i),0):i.next)&&!(o=o.call(i,a[1])).done)return o;if(i=0,o)a=[a[0]&2,o.value];switch(a[0]){case 0:case 1:o=a;break;case 4:n.label++;return{value:a[1],done:false};case 5:n.label++;i=a[1];a=[0];continue;case 7:a=n.ops.pop();n.trys.pop();continue;default:if(!(o=n.trys,o=o.length>0&&o[o.length-1])&&(a[0]===6||a[0]===2)){n=0;continue}if(a[0]===3&&(!o||a[1]>o[0]&&a[1]<o[3])){n.label=a[1];break}if(a[0]===6&&n.label<o[1]){n.label=o[1];o=a;break}if(o&&n.label<o[2]){n.label=o[2];n.ops.push(a);break}if(o[2])n.ops.pop();n.trys.pop();continue}a=t.call(e,n)}catch(e){a=[6,e];i=0}finally{r=o=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:true}}};var Se="MEETING";var we=function(e){Ie(RCVService,e);function RCVService(t){var n;var i=e.call(this,{isSupportedCache:true,entityName:Se})||this;i._daoManager=t;i.handleUpdate=function(){return be(i,void 0,void 0,(function(){var e;return Me(this,(function(t){switch(t.label){case 0:return[4,this.meetModule.hasMeetingPermission()];case 1:if(!t.sent())return[2];return[4,this.meetModule.getVideoServiceSource()];case 2:e=t.sent();if((e===null||e===void 0?void 0:e.includes(Ee.ZE.RINGCENTRAL_VIDEO_EMBEDDED))||(e===null||e===void 0?void 0:e.includes(Ee.ZE.RINGCENTRAL_VIDEO))){this.meetingConfigFetchController.scheduleRCVDelegateUserList();this.meetingConfigFetchController.scheduleRCVDefaultBridge();this.meetingConfigFetchController.scheduleRCVPreference()}return[2]}}))}))};i.handleSDKLogin=function(e){e.success&&i.settingManager.load()};i.handleGlipLogin=function(e){if(e.success){var t=(0,r.getModule)(ae.COMMON_KEY_ACTION_MODULE).getKeyActionService().get(ae.ACTION_KEY.OBSERVE_SOCKET_ITEM);(t===null||t===void 0?void 0:t.getAction)&&t.getAction().then((function(e){e((function(e){i.handleIncomingData(e)}))}))}};i.handleRCLogin=function(e){if(e.success){(0,r.getModule)(Re.oF).observeSettingChange(me.H.Video_Service,i.handleUpdate)}};i.handleIncomingData=function(e){return be(i,void 0,void 0,(function(){var t,n;var r=this;return Me(this,(function(i){switch(i.label){case 0:if(e.length===0){return[2]}t=e.map((function(e){return(0,u.transform)(e)}));n=[];return[4,Promise.all(t.map((function(e){return be(r,void 0,void 0,(function(){var t;return Me(this,(function(r){switch(r.label){case 0:return[4,this.meetingController.handleIncomingData(e)];case 1:t=r.sent();t&&n.push(t);return[2]}}))}))})))];case 1:i.sent();n.length&&this.getEntityNotificationController().onReceivedNotification(n);return[2]}}))}))};var o=(0,r.getModule)(ae.COMMON_KEY_ACTION_MODULE).getKeyActionService().get(ae.ACTION_KEY.OBSERVE_GLIP_LOGIN);(o===null||o===void 0?void 0:o.getAction)&&o.getAction().then((function(e){e((function(e){i.handleGlipLogin(e)}))}));(0,q.hA)((function(e){i.handleRCLogin(e)}));(n=(0,u.getCurrentAccount)())===null||n===void 0?void 0:n.onLoginResult((function(e){i.handleSDKLogin(e)}));return i}RCVService.prototype.onStarted=function(){e.prototype.onStarted.call(this)};RCVService.prototype.onStopped=function(){this.settingManager.unload();delete this._settingManager;e.prototype.onStopped.call(this)};Object.defineProperty(RCVService.prototype,"DBConfig",{get:function(){if(!this._DBConfig){this._DBConfig=new y(this._daoManager.getDBConfigService())}return this._DBConfig},enumerable:true,configurable:true});Object.defineProperty(RCVService.prototype,"meetModule",{get:function(){if(!this._meetModule){this._meetModule=(0,r.getModule)(Ee.oF)}return this._meetModule},enumerable:true,configurable:true});RCVService.prototype.requestRCVPMISetting=function(){return this.requestRCVDefaultBridges()};RCVService.prototype.scheduleMeeting=function(e,t,n,r){if(t===void 0){t=true}return this.meetingController.scheduleMeeting(e,t,n,r)};RCVService.prototype.scheduleMeetingWithMeetingInfo=function(e){return this.meetingController.scheduleMeetingWithMeetingInfo(e)};RCVService.prototype.startMeeting=function(e){return this.meetingController.startMeeting(e)};RCVService.prototype.startMeetingShareScreen=function(e){return this.meetingController.startMeetingShareScreen(e)};RCVService.prototype.canStartE2EEMeeting=function(){return this.meetingController.canStartE2EEMeeting()};RCVService.prototype.answerMeeting=function(e){return this.meetingController.answerMeeting(e)};RCVService.prototype.endMeeting=function(e){return be(this,void 0,Promise,(function(){return Me(this,(function(t){this.meetingController.deleteWindowFromMap(e);return[2]}))}))};RCVService.prototype.joinMeet=function(e){return this.meetingController.joinMeet(e)};RCVService.prototype.joinMeetingWithScreenShare=function(e){return this.meetingController.joinMeetingWithScreenShare(e)};RCVService.prototype.rejectMeeting=function(e){return this.meetingController.rejectMeeting(e)};RCVService.prototype.ignoreMeeting=function(e){return this.meetingController.ignoreMeeting(e)};RCVService.prototype.requestRCVDefaultBridges=function(){return be(this,void 0,void 0,(function(){return Me(this,(function(e){switch(e.label){case 0:return[4,this.meetingConfigFetchController.requestRCVDefaultBridges()];case 1:return[2,e.sent()]}}))}))};RCVService.prototype.requestRCVPreference=function(){return be(this,void 0,void 0,(function(){return Me(this,(function(e){switch(e.label){case 0:return[4,this.meetingConfigFetchController.requestRCVPreference()];case 1:return[2,e.sent()]}}))}))};RCVService.prototype.getDelegateUserList=function(){return this.meetingController.getDelegateUserList()};RCVService.prototype.requestDelegateUserList=function(){return this.meetingController.requestDelegateUserList()};RCVService.prototype.requestDelegatorBridges=function(e){return this.meetingConfigFetchController.requestDelegatorBridges(e)};RCVService.prototype.getShortIdByBridgeId=function(e){return this.meetingController.getShortIdByBridgeId(e)};RCVService.prototype.getRCVMeetSettingUrl=function(){return be(this,void 0,Promise,(function(){return Me(this,(function(e){switch(e.label){case 0:return[4,this.meetingController.getRCVMeetSettingUrl()];case 1:return[2,e.sent()]}}))}))};RCVService.prototype.getMeetingDetails=function(e){return this.meetingController.getMeetingDetails(e)};RCVService.prototype.editMeetingDetails=function(e,t){return this.meetingController.editMeetingDetails(e,t)};Object.defineProperty(RCVService.prototype,"meetingConfigFetchController",{get:function(){if(!this._meetingConfigFetchController){this._meetingConfigFetchController=new ie(this)}return this._meetingConfigFetchController},enumerable:true,configurable:true});Object.defineProperty(RCVService.prototype,"meetingController",{get:function(){if(!this._meetingController){this._meetingController=new ee(this,this.getEntityCacheController());this._meetingController.addAdaptorController(a.h8.EMBEDDED,new Ce(this));this._meetingController.addAdaptorController(a.h8.DEEP_LINK,new Ce(this))}return this._meetingController},enumerable:true,configurable:true});Object.defineProperty(RCVService.prototype,"settingManager",{get:function(){if(!this._settingManager){this._settingManager=new ye.H(this)}return this._settingManager},enumerable:true,configurable:true});return RCVService}(te.L);var Oe=n(424843);var Ve=n(782821);var gen=function(e,t,n){if(e===void 0){e="id"}if(t===void 0){t=[]}return{unique:e,indices:t,onUpgrade:n}};var Ae={name:"RCV",version:1,schema:{1:{userConfigs:gen("key")}}};var Pe=undefined&&undefined.__extends||function(){var extendStatics=function(e,t){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)if(t.hasOwnProperty(n))e[n]=t[n]};return extendStatics(e,t)};return function(e,t){extendStatics(e,t);function __(){this.constructor=e}e.prototype=t===null?Object.create(t):(__.prototype=t.prototype,new __)}}();var Ne=undefined&&undefined.__awaiter||function(e,t,n,r){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,i){function fulfilled(e){try{step(r.next(e))}catch(e){i(e)}}function rejected(e){try{step(r["throw"](e))}catch(e){i(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((r=r.apply(e,t||[])).next())}))};var Te=undefined&&undefined.__generator||function(e,t){var n={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},r,i,o,a;return a={next:verb(0),throw:verb(1),return:verb(2)},typeof Symbol==="function"&&(a[Symbol.iterator]=function(){return this}),a;function verb(e){return function(t){return step([e,t])}}function step(a){if(r)throw new TypeError("Generator is already executing.");while(n)try{if(r=1,i&&(o=a[0]&2?i["return"]:a[0]?i["throw"]||((o=i["return"])&&o.call(i),0):i.next)&&!(o=o.call(i,a[1])).done)return o;if(i=0,o)a=[a[0]&2,o.value];switch(a[0]){case 0:case 1:o=a;break;case 4:n.label++;return{value:a[1],done:false};case 5:n.label++;i=a[1];a=[0];continue;case 7:a=n.ops.pop();n.trys.pop();continue;default:if(!(o=n.trys,o=o.length>0&&o[o.length-1])&&(a[0]===6||a[0]===2)){n=0;continue}if(a[0]===3&&(!o||a[1]>o[0]&&a[1]<o[3])){n.label=a[1];break}if(a[0]===6&&n.label<o[1]){n.label=o[1];o=a;break}if(o&&n.label<o[2]){n.label=o[2];n.ops.push(a);break}if(o[2])n.ops.pop();n.trys.pop();continue}a=t.call(e,n)}catch(e){a=[6,e];i=0}finally{r=o=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:true}}};var Le=function(e){Pe(E2eePermissionKeyAction,e);function E2eePermissionKeyAction(t){if(t===void 0){t=u.ActionWeight.NORMAL}return e.call(this,t)||this}Object.defineProperty(E2eePermissionKeyAction.prototype,"rcvModule",{get:function(){if(!this._rcvModule){this._rcvModule=(0,u.getModule)(i.oF)}return this._rcvModule},enumerable:true,configurable:true});E2eePermissionKeyAction.prototype.getAction=function(){var e=this;return Promise.resolve({canStartE2EEMeeting:function(){return Ne(e,void 0,void 0,(function(){return Te(this,(function(e){switch(e.label){case 0:return[4,this.rcvModule.canStartE2EEMeeting()];case 1:return[2,e.sent()]}}))}))}})};return E2eePermissionKeyAction}(u.AbstractKeyAction);var De=undefined&&undefined.__extends||function(){var extendStatics=function(e,t){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)if(t.hasOwnProperty(n))e[n]=t[n]};return extendStatics(e,t)};return function(e,t){extendStatics(e,t);function __(){this.constructor=e}e.prototype=t===null?Object.create(t):(__.prototype=t.prototype,new __)}}();var Ue=function(e){De(E2eeParamsKeyAction,e);function E2eeParamsKeyAction(t){if(t===void 0){t=u.ActionWeight.NORMAL}return e.call(this,t)||this}E2eeParamsKeyAction.prototype.getAction=function(){return Promise.resolve({e2ee:true,waitingRoomMode:h.VQ.NOT_COWORKER,isOnlyAuthUserJoin:true})};return E2eeParamsKeyAction}(u.AbstractKeyAction);var Be=undefined&&undefined.__extends||function(){var extendStatics=function(e,t){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)if(t.hasOwnProperty(n))e[n]=t[n]};return extendStatics(e,t)};return function(e,t){extendStatics(e,t);function __(){this.constructor=e}e.prototype=t===null?Object.create(t):(__.prototype=t.prototype,new __)}}();var ke=undefined&&undefined.__awaiter||function(e,t,n,r){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,i){function fulfilled(e){try{step(r.next(e))}catch(e){i(e)}}function rejected(e){try{step(r["throw"](e))}catch(e){i(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((r=r.apply(e,t||[])).next())}))};var je=undefined&&undefined.__generator||function(e,t){var n={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},r,i,o,a;return a={next:verb(0),throw:verb(1),return:verb(2)},typeof Symbol==="function"&&(a[Symbol.iterator]=function(){return this}),a;function verb(e){return function(t){return step([e,t])}}function step(a){if(r)throw new TypeError("Generator is already executing.");while(n)try{if(r=1,i&&(o=a[0]&2?i["return"]:a[0]?i["throw"]||((o=i["return"])&&o.call(i),0):i.next)&&!(o=o.call(i,a[1])).done)return o;if(i=0,o)a=[a[0]&2,o.value];switch(a[0]){case 0:case 1:o=a;break;case 4:n.label++;return{value:a[1],done:false};case 5:n.label++;i=a[1];a=[0];continue;case 7:a=n.ops.pop();n.trys.pop();continue;default:if(!(o=n.trys,o=o.length>0&&o[o.length-1])&&(a[0]===6||a[0]===2)){n=0;continue}if(a[0]===3&&(!o||a[1]>o[0]&&a[1]<o[3])){n.label=a[1];break}if(a[0]===6&&n.label<o[1]){n.label=o[1];o=a;break}if(o&&n.label<o[2]){n.label=o[2];n.ops.push(a);break}if(o[2])n.ops.pop();n.trys.pop();continue}a=t.call(e,n)}catch(e){a=[6,e];i=0}finally{r=o=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:true}}};var He="GetDialInNumberKeyAction";var Ge=function(e){Be(GetDialInNumberKeyAction,e);function GetDialInNumberKeyAction(t){if(t===void 0){t=u.ActionWeight.NORMAL}return e.call(this,t)||this}Object.defineProperty(GetDialInNumberKeyAction.prototype,"rcInfoModule",{get:function(){return(0,u.getModule)(Y.oF)},enumerable:true,configurable:true});GetDialInNumberKeyAction.prototype.getAction=function(){var e,t,n,r;return ke(this,void 0,void 0,(function(){var i,o,a;return je(this,(function(u){switch(u.label){case 0:return[4,(e=this.rcInfoModule)===null||e===void 0?void 0:e.getRCExtensionInfo()];case 1:i=(r=(n=(t=u.sent())===null||t===void 0?void 0:t.regionalSettings)===null||n===void 0?void 0:n.homeCountry)===null||r===void 0?void 0:r.isoCode;R.k.tags(He).info("iso code from rc extension info",i);return[4,h.gv.getInstance().getDialInNumbers()];case 2:o=u.sent().phoneNumbers;a=o.find((function(e){var t;return((t=e.country)===null||t===void 0?void 0:t.isoCode)===i}));R.k.tags(He).info("first got matched dial in number",a);return[2,a?a.phoneNumber:""]}}))}))};return GetDialInNumberKeyAction}(u.AbstractKeyAction);var Fe=undefined&&undefined.__extends||function(){var extendStatics=function(e,t){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)if(t.hasOwnProperty(n))e[n]=t[n]};return extendStatics(e,t)};return function(e,t){extendStatics(e,t);function __(){this.constructor=e}e.prototype=t===null?Object.create(t):(__.prototype=t.prototype,new __)}}();var xe=undefined&&undefined.__awaiter||function(e,t,n,r){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,i){function fulfilled(e){try{step(r.next(e))}catch(e){i(e)}}function rejected(e){try{step(r["throw"](e))}catch(e){i(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((r=r.apply(e,t||[])).next())}))};var Je=undefined&&undefined.__generator||function(e,t){var n={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},r,i,o,a;return a={next:verb(0),throw:verb(1),return:verb(2)},typeof Symbol==="function"&&(a[Symbol.iterator]=function(){return this}),a;function verb(e){return function(t){return step([e,t])}}function step(a){if(r)throw new TypeError("Generator is already executing.");while(n)try{if(r=1,i&&(o=a[0]&2?i["return"]:a[0]?i["throw"]||((o=i["return"])&&o.call(i),0):i.next)&&!(o=o.call(i,a[1])).done)return o;if(i=0,o)a=[a[0]&2,o.value];switch(a[0]){case 0:case 1:o=a;break;case 4:n.label++;return{value:a[1],done:false};case 5:n.label++;i=a[1];a=[0];continue;case 7:a=n.ops.pop();n.trys.pop();continue;default:if(!(o=n.trys,o=o.length>0&&o[o.length-1])&&(a[0]===6||a[0]===2)){n=0;continue}if(a[0]===3&&(!o||a[1]>o[0]&&a[1]<o[3])){n.label=a[1];break}if(a[0]===6&&n.label<o[1]){n.label=o[1];o=a;break}if(o&&n.label<o[2]){n.label=o[2];n.ops.push(a);break}if(o[2])n.ops.pop();n.trys.pop();continue}a=t.call(e,n)}catch(e){a=[6,e];i=0}finally{r=o=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:true}}};var Ke=function(e){Fe(RCVModule,e);function RCVModule(t){var n=e.call(this,t)||this;n._getHealthyStatus=function(){return xe(n,void 0,void 0,(function(){var e,t,n,r,i,o;return Je(this,(function(a){switch(a.label){case 0:if(!this.isLoaded())return[3,3];return[4,this.rcvService.DBConfig.getRCVDefaultBridge()];case 1:e=a.sent();return[4,this.rcvService.DBConfig.getBridgeId()];case 2:t=a.sent();n=this._rcvMeetCounter.getStartMeetCount();r=this._rcvMeetCounter.getStartMeetFailCount();i=this._rcvMeetCounter.getJoinMeetCount();o=this._rcvMeetCounter.getJoinMeetFailCount();return[2,{HasDefaultBridge:!!e,bridgeId:t,startMeetCount:n,startMeetFailCount:r,joinMeetCount:i,joinMeetFailCount:o}];case 3:return[2,{}]}}))}))};return n}RCVModule.prototype.onLoad=function(){return xe(this,void 0,Promise,(function(){var e=this;return Je(this,(function(t){this._rcvMeetCounter=new Ve.e;this.rcvService.onStarted();this.getHealthController().registerItemMap({RCVInfo:function(){return xe(e,void 0,void 0,(function(){return Je(this,(function(e){switch(e.label){case 0:return[4,this._getHealthyStatus()];case 1:return[2,e.sent()]}}))}))}});this._setupNetworkClient();this._initCommonKeyAction();return[2]}))}))};RCVModule.prototype.onUnload=function(){this.rcvService.onStopped()};RCVModule.prototype.moduleName=function(){return i.oF};RCVModule.prototype.onDBRecoverRequire=function(){R.k.warn("DB integrity check failed. RCV PMI data will be restored on demand.")};RCVModule.prototype.startMeeting=function(e){return xe(this,void 0,Promise,(function(){var t,n;return Je(this,(function(r){switch(r.label){case 0:r.trys.push([0,2,,3]);return[4,this.rcvService.startMeeting(e)];case 1:t=r.sent();this._rcvMeetCounter.increaseStartMeetCount();return[2,t];case 2:n=r.sent();this._rcvMeetCounter.increaseStartMeetFailCount();throw n;case 3:return[2]}}))}))};RCVModule.prototype.startMeetingShareScreen=function(e){return this.rcvService.startMeetingShareScreen(e)};RCVModule.prototype.canStartE2EEMeeting=function(){return this.rcvService.canStartE2EEMeeting()};RCVModule.prototype.joinMeetingWithScreenShare=function(e){return xe(this,void 0,Promise,(function(){return Je(this,(function(t){switch(t.label){case 0:return[4,this.rcvService.joinMeetingWithScreenShare(e)];case 1:return[2,t.sent()]}}))}))};RCVModule.prototype.joinMeet=function(e){return xe(this,void 0,Promise,(function(){var t,n;return Je(this,(function(r){switch(r.label){case 0:r.trys.push([0,2,,3]);return[4,this.rcvService.joinMeet(e)];case 1:t=r.sent();this._rcvMeetCounter.increaseJoinMeetCount();return[2,t];case 2:n=r.sent();this._rcvMeetCounter.increaseJoinMeetFailCount();throw n;case 3:return[2]}}))}))};RCVModule.prototype.scheduleMeeting=function(e,t,n,r){if(t===void 0){t=true}return this.rcvService.scheduleMeeting(e,t,n,r)};RCVModule.prototype.scheduleMeetingWithMeetingInfo=function(e){return this.rcvService.scheduleMeetingWithMeetingInfo(e)};RCVModule.prototype.answerMeeting=function(e){return this.rcvService.answerMeeting(e)};RCVModule.prototype.rejectMeeting=function(e){return this.rcvService.rejectMeeting(e)};RCVModule.prototype.ignoreMeeting=function(e){return this.rcvService.ignoreMeeting(e)};RCVModule.prototype.endMeeting=function(e){return this.rcvService.endMeeting(e)};RCVModule.prototype.requestRCVPMISetting=function(){return this.rcvService.requestRCVPMISetting()};RCVModule.prototype.requestRCVPreference=function(){return this.rcvService.requestRCVPreference()};RCVModule.prototype.getDelegateUserList=function(){return this.rcvService.getDelegateUserList()};RCVModule.prototype.requestDelegateUserList=function(){return this.rcvService.requestDelegateUserList()};RCVModule.prototype.requestDelegatorBridges=function(e){return this.rcvService.requestDelegatorBridges(e)};RCVModule.prototype.addEntityNotificationObserver=function(e){return this.rcvService.addEntityNotificationObserver(e)};RCVModule.prototype.removeEntityNotificationObserver=function(e){return this.rcvService.removeEntityNotificationObserver(e)};RCVModule.prototype.getById=function(e){return this.rcvService.getById(e)};RCVModule.prototype.getRCVMeetSettingUrl=function(){return this.rcvService.getRCVMeetSettingUrl()};RCVModule.prototype.getRCVBridgeId=function(){return this.rcvService.DBConfig.getBridgeId()};RCVModule.prototype.getShortIdByBridgeId=function(e){return this.rcvService.getShortIdByBridgeId(e)};RCVModule.prototype.getMeetingDetails=function(e){return this.rcvService.getMeetingDetails(e)};RCVModule.prototype.editMeetingDetails=function(e,t){return this.rcvService.editMeetingDetails(e,t)};Object.defineProperty(RCVModule.prototype,"rcvService",{get:function(){if(!this._rcvService){this._rcvService=new we(this.daoManager)}return this._rcvService},enumerable:true,configurable:true});RCVModule.prototype._setupNetworkClient=function(){var e=(0,q.gT)();if(!e){return}var t=e.getNetworkHandlerConfig(q.vm.RCV);if(t){var n={server:""+Oe.apiConfiguration.getConfig()["rcv"].server};var r=new Oe.ResponseParser;r.register(new Oe.CommonResponseParser);m.P.networkClient=e.buildNetworkClient(n,t,r);h.gv.setNetworkClient(m.P.networkClient)}};RCVModule.prototype._initCommonKeyAction=function(){var e=(0,r.getModule)(ae.COMMON_KEY_ACTION_MODULE).getKeyActionService();e.register(ae.ACTION_KEY.E2EE_PERMISSION,new Le);e.register(ae.ACTION_KEY.E2EE_PARAMS,new Ue);e.register(ae.ACTION_KEY.GET_DIAL_IN_NUMBER,new Ge)};RCVModule.prototype.getSchema=function(){return Ae};return RCVModule}(r.AbstractModule)},212616:(e,t,n)=>{"use strict";n.d(t,{P:()=>l});var r=n(862926);var i="v1";var o="v2";var a={API_BRIDGES:"/rcvideo/"+i+"/bridges",API_DELEGATE:"/rcvideo/"+i+"/accounts/~/extensions/~/delegators",API_BRIDGES_V2:"/rcvideo/"+o+"/bridges",RENDER_DOCUMENT:"/restapi/v1.0/uns/render-document",CREATE_BRIDGE_API:"/rcvideo/"+o+"/account/~/extension/~/bridges"};var u=n(268908);var s=undefined&&undefined.__awaiter||function(e,t,n,r){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,i){function fulfilled(e){try{step(r.next(e))}catch(e){i(e)}}function rejected(e){try{step(r["throw"](e))}catch(e){i(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((r=r.apply(e,t||[])).next())}))};var c=undefined&&undefined.__generator||function(e,t){var n={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},r,i,o,a;return a={next:verb(0),throw:verb(1),return:verb(2)},typeof Symbol==="function"&&(a[Symbol.iterator]=function(){return this}),a;function verb(e){return function(t){return step([e,t])}}function step(a){if(r)throw new TypeError("Generator is already executing.");while(n)try{if(r=1,i&&(o=a[0]&2?i["return"]:a[0]?i["throw"]||((o=i["return"])&&o.call(i),0):i.next)&&!(o=o.call(i,a[1])).done)return o;if(i=0,o)a=[a[0]&2,o.value];switch(a[0]){case 0:case 1:o=a;break;case 4:n.label++;return{value:a[1],done:false};case 5:n.label++;i=a[1];a=[0];continue;case 7:a=n.ops.pop();n.trys.pop();continue;default:if(!(o=n.trys,o=o.length>0&&o[o.length-1])&&(a[0]===6||a[0]===2)){n=0;continue}if(a[0]===3&&(!o||a[1]>o[0]&&a[1]<o[3])){n.label=a[1];break}if(a[0]===6&&n.label<o[1]){n.label=o[1];o=a;break}if(o&&n.label<o[2]){n.label=o[2];n.ops.push(a);break}if(o[2])n.ops.pop();n.trys.pop();continue}a=t.call(e,n)}catch(e){a=[6,e];i=0}finally{r=o=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:true}}};var l=function(){function RCVApi(){}RCVApi.createBridge=function(e,t){var n=a.CREATE_BRIDGE_API;if(t){n=n.replace("extension/~","extension/"+t)}var i={data:e,method:r.NETWORK_METHOD.POST,path:r.RequestPath.buildRequestPath(n),authFree:false,HAPriority:r.HA_PRIORITY.HIGH};return RCVApi.networkClient.http(i)};RCVApi.getInvitationByUNS=function(e){return s(this,void 0,Promise,(function(){var t,n;return c(this,(function(i){switch(i.label){case 0:t={data:e,authFree:false,method:r.NETWORK_METHOD.POST,HAPriority:r.HA_PRIORITY.HIGH,path:r.RequestPath.buildRequestPath(""+a.RENDER_DOCUMENT)};return[4,RCVApi.networkClient.http(t)];case 1:n=i.sent();return[2,u.W.parseInvitationResponse(n)]}}))}))};RCVApi.getDefaultBridges=function(e){var t=a.CREATE_BRIDGE_API+"/default";if(e){t=t.replace("extension/~","extension/"+e)}var n={authFree:false,method:r.NETWORK_METHOD.GET,HAPriority:r.HA_PRIORITY.HIGH,path:r.RequestPath.buildRequestPath(t)};return RCVApi.networkClient.http(n)};RCVApi.updateBridge=function(e,t){var n={requuid:Date.now().toString()};var i={data:t,params:n,authFree:false,method:r.NETWORK_METHOD.PATCH,HAPriority:r.HA_PRIORITY.HIGH,path:r.RequestPath.buildRequestPath(a.API_BRIDGES_V2+"/"+r.FORMAT_MARK,e)};return RCVApi.networkClient.http(i)};RCVApi.updateBridgeWebPin=function(e,t){var n={data:t,authFree:false,method:r.NETWORK_METHOD.PATCH,HAPriority:r.HA_PRIORITY.HIGH,path:r.RequestPath.buildRequestPath(a.API_BRIDGES_V2+"/"+r.FORMAT_MARK+"/pin/web",e)};return RCVApi.networkClient.http(n)};RCVApi.getBridgeByBridgeId=function(e){var t={authFree:false,method:r.NETWORK_METHOD.GET,HAPriority:r.HA_PRIORITY.HIGH,path:r.RequestPath.buildRequestPath(a.API_BRIDGES_V2+"/"+r.FORMAT_MARK,e)};return RCVApi.networkClient.http(t)};RCVApi.getRCVDelegateUserList=function(){var e={authFree:false,method:r.NETWORK_METHOD.GET,HAPriority:r.HA_PRIORITY.HIGH,path:r.RequestPath.buildRequestPath(""+a.API_DELEGATE)};return RCVApi.networkClient.http(e)};RCVApi.getRoomAliases=function(e){var t={authFree:false,method:r.NETWORK_METHOD.GET,HAPriority:r.HA_PRIORITY.HIGH,path:r.RequestPath.buildRequestPath(a.API_BRIDGES_V2+"/"+r.FORMAT_MARK+"/pin/aliases",e)};return RCVApi.networkClient.http(t)};RCVApi.addRoomAliases=function(e,t){var n={data:{aliases:t},authFree:false,method:r.NETWORK_METHOD.PATCH,HAPriority:r.HA_PRIORITY.HIGH,path:r.RequestPath.buildRequestPath(a.API_BRIDGES_V2+"/"+r.FORMAT_MARK+"/pin/aliases",e)};return RCVApi.networkClient.http(n)};RCVApi.deleteRoomAliases=function(e,t,n){var i={authFree:false,method:r.NETWORK_METHOD.DELETE,HAPriority:r.HA_PRIORITY.HIGH,retryCount:n,path:r.RequestPath.buildRequestPath(a.API_BRIDGES_V2+"/"+r.FORMAT_MARK+"/pin/aliases?aliases="+r.FORMAT_MARK,e,t.join(","))};return RCVApi.networkClient.http(i)};RCVApi.getBridgeByShortId=function(e){var t={authFree:false,method:r.NETWORK_METHOD.GET,HAPriority:r.HA_PRIORITY.HIGH,path:r.RequestPath.buildRequestPath(a.API_BRIDGES_V2+"/pin/web/"+r.FORMAT_MARK,e)};return RCVApi.networkClient.http(t)};return RCVApi}()},17406:(e,t,n)=>{"use strict";n.d(t,{o:()=>i,m:()=>r.Xv});var r=n(902114);var i={RCV_DELEGATE_USER_LIST:"RCV_DELEGATE_USER_LIST",RCV_DEFAULT_BRIDGE:"RCV_DEFAULT_BRIDGE"}},661117:(e,t,n)=>{"use strict";n.d(t,{oF:()=>i,FY:()=>o,QT:()=>a});var r=n(295454);var i=r.Lb.RCV;var o={MEET_SWITCH:"MEET_SWITCH",HAS_ACTIVE_RCV:"HAS_ACTIVE_RCV"};var a={RCV:"ENTITY.MEETING"};var u="RingCentral Video meeting"},253962:(e,t,n)=>{"use strict";n.d(t,{wN:()=>r.wN,_b:()=>r._b,of:()=>r.of,mz:()=>r.mz,$q:()=>r.$q,h8:()=>r.h8,zp:()=>r.zp,Bp:()=>r.Bp,xf:()=>r.xf,VQ:()=>r.VQ,eJ:()=>r.eJ});var r=n(551451)},551451:(e,t,n)=>{"use strict";n.d(t,{$q:()=>r.$q,h8:()=>r.h8,Bp:()=>o,_b:()=>a,zp:()=>r.zp,xf:()=>r.xf,VQ:()=>c,eJ:()=>l,mz:()=>p,wN:()=>s,of:()=>d});var r=n(954083);var i=n(902114);var o;(function(e){e[e["INSTANT"]=0]="INSTANT";e[e["SCHEDULED"]=0]="SCHEDULED";e[e["CALL"]=1]="CALL"})(o||(o={}));var a;(function(e){e["INSTANT"]="Instant";e["SCHEDULED"]="Scheduled";e["PMI"]="PMI"})(a||(a={}));var u;(function(e){e["Both"]="both";e["Telephony"]="Phone";e["Voip"]="ComputerAudio"})(u||(u={}));var s;(function(e){e["Off"]="Off";e["OnlyAuthUserJoin"]="OnlyAuthUserJoin";e["OnlyCoworkersJoin"]="OnlyCoworkersJoin"})(s||(s={}));var c;(function(e){e[e["OFF"]=0]="OFF";e[e["ALL"]=1]="ALL";e[e["ONLY_GUESTS"]=2]="ONLY_GUESTS";e[e["NOT_COWORKER"]=3]="NOT_COWORKER"})(c||(c={}));var l;(function(e){e["Nobody"]="Nobody";e["Everybody"]="Everybody";e["GuestsOnly"]="GuestsOnly";e["OtherAccount"]="OtherAccount"})(l||(l={}));var f;(function(e){e["On"]="On";e["Off"]="Off";e["ExitOnly"]="ExitOnly";e["EnterOnly"]="EnterOnly"})(f||(f={}));var d;(function(e){e["HOST"]="host";e["ALL"]="all"})(d||(d={}));var p;(function(e){e["ANYONE_SIGNED_INTO_RC"]="anyone_signed_into_rc";e["ONLY_CO_WORKERS"]="only_co_workers"})(p||(p={}))},529696:(e,t,n)=>{"use strict";n.d(t,{k:()=>u});var r=n(862926);var i=n.n(r);var o=n(204285);var a="[MEET][CORE][RCV]";var u=r.ModuleLogger.getLogger(a,(function(){var e=[];for(var t=0;t<arguments.length;t++){e[t]=arguments[t]}return e}),o.VIDEO_EVENT_DATA_FEATURE_KEY)},855588:()=>{},49064:(e,t,n)=>{"use strict";n.d(t,{H:()=>J});var r=n(696206);var i=n(890512);var o=n(812490);var a=n(260666);var u=n(707938);var s=n(667489);var c=n(960782);var l=n(782117);var f=undefined&&undefined.__extends||function(){var extendStatics=function(e,t){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)if(t.hasOwnProperty(n))e[n]=t[n]};return extendStatics(e,t)};return function(e,t){extendStatics(e,t);function __(){this.constructor=e}e.prototype=t===null?Object.create(t):(__.prototype=t.prototype,new __)}}();var d=undefined&&undefined.__awaiter||function(e,t,n,r){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,i){function fulfilled(e){try{step(r.next(e))}catch(e){i(e)}}function rejected(e){try{step(r["throw"](e))}catch(e){i(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((r=r.apply(e,t||[])).next())}))};var p=undefined&&undefined.__generator||function(e,t){var n={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},r,i,o,a;return a={next:verb(0),throw:verb(1),return:verb(2)},typeof Symbol==="function"&&(a[Symbol.iterator]=function(){return this}),a;function verb(e){return function(t){return step([e,t])}}function step(a){if(r)throw new TypeError("Generator is already executing.");while(n)try{if(r=1,i&&(o=a[0]&2?i["return"]:a[0]?i["throw"]||((o=i["return"])&&o.call(i),0):i.next)&&!(o=o.call(i,a[1])).done)return o;if(i=0,o)a=[a[0]&2,o.value];switch(a[0]){case 0:case 1:o=a;break;case 4:n.label++;return{value:a[1],done:false};case 5:n.label++;i=a[1];a=[0];continue;case 7:a=n.ops.pop();n.trys.pop();continue;default:if(!(o=n.trys,o=o.length>0&&o[o.length-1])&&(a[0]===6||a[0]===2)){n=0;continue}if(a[0]===3&&(!o||a[1]>o[0]&&a[1]<o[3])){n.label=a[1];break}if(a[0]===6&&n.label<o[1]){n.label=o[1];o=a;break}if(o&&n.label<o[2]){n.label=o[2];n.ops.push(a);break}if(o[2])n.ops.pop();n.trys.pop();continue}a=t.call(e,n)}catch(e){a=[6,e];i=0}finally{r=o=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:true}}};var h=function(e){f(MeetSettingItemProvider,e);function MeetSettingItemProvider(t){var n=e.call(this,{id:i.o.RCV_MEET_SETTING,value:{type:r.Pe.CONSTANT},source:{type:r.Pe.CONSTANT}})||this;n._meetingService=t;return n}MeetSettingItemProvider.prototype.buildStateProvider=function(){var e=this;return this.buildBaseItemValueProvider({getter:function(){return e._getState()}})};MeetSettingItemProvider.prototype.onLoad=function(){var e=this;this.onSettingUpdate(a.H.Video_Service,(function(){e.getStateProvider().notifyChange()}))};MeetSettingItemProvider.prototype._getVideoService=function(){return d(this,void 0,void 0,(function(){return p(this,(function(e){switch(e.label){case 0:return[4,this._meetingService.meetModule.getVideoService()];case 1:return[2,e.sent()]}}))}))};MeetSettingItemProvider.prototype._getState=function(){var e,t;return d(this,void 0,void 0,(function(){var n,i,a,u;return p(this,(function(f){switch(f.label){case 0:n=((e=(0,s.getCurrentAccount)())===null||e===void 0?void 0:e.accountType())===l.Q5.RC;i=(0,s.getModule)(c.COMMON_KEY_ACTION_MODULE).getKeyActionService().get(c.ACTION_KEY.VIDEO_CONFERENCING);return[4,i===null||i===void 0?void 0:i.getAction()];case 1:return[4,(t=f.sent())===null||t===void 0?void 0:t.get()];case 2:a=f.sent();u=n;if(!u)return[3,4];return[4,this._getVideoService()];case 3:u=f.sent()===o.ZE.RINGCENTRAL_VIDEO_EMBEDDED;f.label=4;case 4:if(u&&a){return[2,r.ESettingItemState.ENABLE]}return[2,r.ESettingItemState.INVISIBLE]}}))}))};return MeetSettingItemProvider}(u.t);var v=n(253962);var g=n(529696);var _=n(212616);var C=n(17406);var y=n(714266);var E=n(862926);var R=n(829649);var m=n(268908);var I=n(902114);var b=undefined&&undefined.__awaiter||function(e,t,n,r){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,i){function fulfilled(e){try{step(r.next(e))}catch(e){i(e)}}function rejected(e){try{step(r["throw"](e))}catch(e){i(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((r=r.apply(e,t||[])).next())}))};var M=undefined&&undefined.__generator||function(e,t){var n={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},r,i,o,a;return a={next:verb(0),throw:verb(1),return:verb(2)},typeof Symbol==="function"&&(a[Symbol.iterator]=function(){return this}),a;function verb(e){return function(t){return step([e,t])}}function step(a){if(r)throw new TypeError("Generator is already executing.");while(n)try{if(r=1,i&&(o=a[0]&2?i["return"]:a[0]?i["throw"]||((o=i["return"])&&o.call(i),0):i.next)&&!(o=o.call(i,a[1])).done)return o;if(i=0,o)a=[a[0]&2,o.value];switch(a[0]){case 0:case 1:o=a;break;case 4:n.label++;return{value:a[1],done:false};case 5:n.label++;i=a[1];a=[0];continue;case 7:a=n.ops.pop();n.trys.pop();continue;default:if(!(o=n.trys,o=o.length>0&&o[o.length-1])&&(a[0]===6||a[0]===2)){n=0;continue}if(a[0]===3&&(!o||a[1]>o[0]&&a[1]<o[3])){n.label=a[1];break}if(a[0]===6&&n.label<o[1]){n.label=o[1];o=a;break}if(o&&n.label<o[2]){n.label=o[2];n.ops.push(a);break}if(o[2])n.ops.pop();n.trys.pop();continue}a=t.call(e,n)}catch(e){a=[6,e];i=0}finally{r=o=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:true}}};var S=3;var w=function(){function RoomAliasRequestController(){}RoomAliasRequestController.setRoomAliasName=function(e,t){return b(this,void 0,Promise,(function(){var n,r,i,o,a;return M(this,(function(u){switch(u.label){case 0:if(!(t===""))return[3,4];return[4,_.P.getRoomAliases(e)];case 1:n=u.sent();if(!(n.aliases&&n.aliases.length>0))return[3,3];return[4,_.P.deleteRoomAliases(e,n.aliases,S)];case 2:u.sent();u.label=3;case 3:return[2];case 4:u.trys.push([4,8,,9]);r=t.toLowerCase();return[4,_.P.addRoomAliases(e,[r])];case 5:i=u.sent();if(!i.aliases)return[3,7];o=i.aliases.filter((function(e){return e!==r}));return[4,_.P.deleteRoomAliases(e,o,S)];case 6:u.sent();u.label=7;case 7:return[3,9];case 8:a=u.sent();g.k.warn("add room aliases failed, code:",a.code);if(a.code===E.ERROR_CODES_NETWORK.PAYMENT_REQUIRED){throw new y.RT(y.nf.INVALID_PERSONAL_ROOM_NAME,"invalid personal room name")}if(a.code===E.ERROR_CODES_NETWORK.CONFLICT){throw new y.RT(y.nf.DUPLICATE_PERSONAL_ROOM_NAME,"personal room name had been used")}throw a;case 9:return[2]}}))}))};return RoomAliasRequestController}();var O=n(38942);var V=n(470033);var A=undefined&&undefined.__extends||function(){var extendStatics=function(e,t){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)if(t.hasOwnProperty(n))e[n]=t[n]};return extendStatics(e,t)};return function(e,t){extendStatics(e,t);function __(){this.constructor=e}e.prototype=t===null?Object.create(t):(__.prototype=t.prototype,new __)}}();var P=undefined&&undefined.__awaiter||function(e,t,n,r){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,i){function fulfilled(e){try{step(r.next(e))}catch(e){i(e)}}function rejected(e){try{step(r["throw"](e))}catch(e){i(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((r=r.apply(e,t||[])).next())}))};var N=undefined&&undefined.__generator||function(e,t){var n={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},r,i,o,a;return a={next:verb(0),throw:verb(1),return:verb(2)},typeof Symbol==="function"&&(a[Symbol.iterator]=function(){return this}),a;function verb(e){return function(t){return step([e,t])}}function step(a){if(r)throw new TypeError("Generator is already executing.");while(n)try{if(r=1,i&&(o=a[0]&2?i["return"]:a[0]?i["throw"]||((o=i["return"])&&o.call(i),0):i.next)&&!(o=o.call(i,a[1])).done)return o;if(i=0,o)a=[a[0]&2,o.value];switch(a[0]){case 0:case 1:o=a;break;case 4:n.label++;return{value:a[1],done:false};case 5:n.label++;i=a[1];a=[0];continue;case 7:a=n.ops.pop();n.trys.pop();continue;default:if(!(o=n.trys,o=o.length>0&&o[o.length-1])&&(a[0]===6||a[0]===2)){n=0;continue}if(a[0]===3&&(!o||a[1]>o[0]&&a[1]<o[3])){n.label=a[1];break}if(a[0]===6&&n.label<o[1]){n.label=o[1];o=a;break}if(o&&n.label<o[2]){n.label=o[2];n.ops.push(a);break}if(o[2])n.ops.pop();n.trys.pop();continue}a=t.call(e,n)}catch(e){a=[6,e];i=0}finally{r=o=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:true}}};var T=function(e){A(PMISettingItemProvider,e);function PMISettingItemProvider(t){var n=e.call(this,{id:i.o.RCV_PMI,source:{type:r.Pe.CONSTANT}})||this;n._meetingService=t;n.handleUpdate=function(){n.getValueProvider().notifyChange();n.getStateProvider().notifyChange()};return n}PMISettingItemProvider.prototype.buildValueProvider=function(){var e=this;return this.buildBaseItemValueProvider({getter:function(){return e._getValue()},setter:function(t){return e.updateValue(t)}})};PMISettingItemProvider.prototype.buildStateProvider=function(){var e=this;return this.buildBaseItemValueProvider({getter:function(){return e._getState()}})};Object.defineProperty(PMISettingItemProvider.prototype,"meetingUserConfig",{get:function(){return this._meetingService.DBConfig},enumerable:true,configurable:true});PMISettingItemProvider.prototype.onLoad=function(){var e;this.onSettingUpdate(a.H.Video_Service,this.handleUpdate);this.on(this._getRCVConfigKey(),this.handleUpdate);this.onSettingUpdate(i.o.RCV_PREFERENCES,this.handleUpdate);this.onEntitlement(V.H3.RCExtensionFeaturesId.MeetingsEncryption,this.handleUpdate);(e=this.featureFlagModule)===null||e===void 0?void 0:e.observe(O.G.D_USE_RCV_E2EE_SCHEDULE,this.handleUpdate)};PMISettingItemProvider.prototype.updateValue=function(e){var t,n,r;return P(this,void 0,void 0,(function(){var i,o,a,u,s,c,l,f,d;return N(this,(function(p){switch(p.label){case 0:e.setting.personalRoomName=(t=e.setting.personalRoomName)===null||t===void 0?void 0:t.toLocaleLowerCase();if(!(!this._cacheValue||!this._cacheValue.setting||!this._compareValue(this._cacheValue.setting,e.setting)))return[3,10];return[4,this.meetingUserConfig.getBridgeId()];case 1:i=p.sent();p.label=2;case 2:p.trys.push([2,9,,10]);o={security:{password:e.setting.meetingPassword,passwordProtected:!!e.setting.meetingPassword,noGuests:e.setting.usersCanJoin!==v.wN.Off,sameAccount:e.setting.usersCanJoin===v.wN.OnlyCoworkersJoin},preferences:{join:{audioMuted:e.setting.muteAudio,videoMuted:e.setting.muteVideo,waitingRoomRequired:m.W.convertOldWaitingRoomMode2New(e.setting.waitingRoomMode)},joinBeforeHost:e.setting.allowJoinBeforeHost,screenSharing:e.setting.allowScreenSharing}};if(!(e.setting.shortId&&((n=this._cacheValue)===null||n===void 0?void 0:n.setting.shortId)!==e.setting.shortId))return[3,4];a={pin:e.setting.shortId};return[4,_.P.updateBridgeWebPin(i,a)];case 3:p.sent();p.label=4;case 4:if(!(e.setting.personalRoomName!==undefined&&((r=this._cacheValue)===null||r===void 0?void 0:r.setting.personalRoomName)!==e.setting.personalRoomName))return[3,6];return[4,w.setRoomAliasName(i,e.setting.personalRoomName)];case 5:p.sent();p.label=6;case 6:return[4,_.P.updateBridge(i,o)];case 7:u=p.sent();return[4,this.meetingUserConfig.setRCVDefaultBridge(u)];case 8:p.sent();s=m.W.convertV2Response2V1Response(u);c=this._generatePmiLinkAndPmnLink(e.setting.shortId,e.setting.personalRoomName,s.meetingPasswordMasked),l=c.pmiLinkValue,f=c.pmnLinkValue;e.pmiLink=l;e.pmnLink=f;return[3,10];case 9:d=p.sent();g.k.report("updateValue RCV PMI failed",d);if(d.code===E.ERROR_CODES_NETWORK.NOT_ACCEPTABLE){throw new y.RT(y.nf.INVALID_PERSONAL_MEET_ID,"Personal meeting ID is already exists.")}if(d.code===E.ERROR_CODES_NETWORK.CONFLICT){throw new y.RT(y.nf.INVALID_PERSONAL_MEET_ID,"Personal meeting ID is already exists.")}throw d;case 10:if(!(!this._cacheValue||e.use_pmi_instant!==this._cacheValue.use_pmi_instant))return[3,12];return[4,this._updateRCVPreference(e.use_pmi_instant)];case 11:p.sent();p.label=12;case 12:this._cacheValue=e;this.getValueProvider().notifyChange();return[2]}}))}))};PMISettingItemProvider.prototype._updateRCVPreference=function(e){return P(this,void 0,void 0,(function(){var t;return N(this,(function(n){switch(n.label){case 0:n.trys.push([0,2,,3]);return[4,I.gv.getInstance().updateRCVPreference(I.Xv.USE_PMI_INSTANT,e)];case 1:n.sent();return[3,3];case 2:t=n.sent();g.k.report("update RCV PMI instant failed",t);return[3,3];case 3:return[2]}}))}))};PMISettingItemProvider.prototype._getRCVConfigKey=function(){var e=this._meetingService.DBConfig;return e.getNotificationKey(C.o.RCV_DEFAULT_BRIDGE)};PMISettingItemProvider.prototype._getVideoService=function(){return P(this,void 0,void 0,(function(){return N(this,(function(e){switch(e.label){case 0:return[4,this._meetingService.meetModule.getVideoService()];case 1:return[2,e.sent()]}}))}))};PMISettingItemProvider.prototype._getState=function(){return P(this,void 0,void 0,(function(){var e,t,n,i;return N(this,(function(a){switch(a.label){case 0:if((0,s.getCurrentAccount)().accountType()!==l.Q5.RC){return[2,r.ESettingItemState.INVISIBLE]}e=(0,s.getCurrentAccount)().context.entitlement.get(V.H3.RCExtensionFeaturesId.Meetings);if(!e){return[2,r.ESettingItemState.INVISIBLE]}return[4,this._getVideoService()];case 1:if(a.sent()!==o.ZE.RINGCENTRAL_VIDEO_EMBEDDED){return[2,r.ESettingItemState.INVISIBLE]}return[4,(0,s.getModule)(O.FEATURE_FLAG_MODULE).getFeatureFlag(O.G.D_USE_RCV_E2EE_SCHEDULE,true)];case 2:t=a.sent();if(!t){return[2,r.ESettingItemState.ENABLE]}g.k.info("e2eeLD in RCV PMISettingProvider",t);n=(0,s.getCurrentAccount)().context.entitlement.get(V.H3.RCExtensionFeaturesId.MeetingsEncryption);if(!n){return[2,r.ESettingItemState.ENABLE]}g.k.info("e2eeAWFlag in RCV PMISettingProvider",n);return[4,I.gv.getInstance().getRCVPreferences()];case 3:i=a.sent().find((function(e){return e.id===C.m.E2EE}));g.k.info("e2eePreferences in RCV PMISettingProvider",i);if(i&&!!i.value&&i.readOnly){return[2,r.ESettingItemState.INVISIBLE]}return[2,r.ESettingItemState.ENABLE]}}))}))};PMISettingItemProvider.prototype._compareValue=function(e,t){if(e.allowJoinBeforeHost===t.allowJoinBeforeHost&&e.muteVideo===t.muteVideo&&e.muteAudio===t.muteAudio&&e.isMeetingSecret===t.isMeetingSecret&&e.shortId===t.shortId&&e.allowScreenSharing===t.allowScreenSharing&&e.usersCanJoin===t.usersCanJoin&&e.waitingRoomMode===t.waitingRoomMode&&(e.meetingPassword===t.meetingPassword||e.meetingPassword===undefined&&t.meetingPassword==="")&&e.personalRoomName===t.personalRoomName){return true}return false};PMISettingItemProvider.prototype._getValue=function(){return P(this,void 0,void 0,(function(){var e,t,n,i,o,a;return N(this,(function(u){switch(u.label){case 0:return[4,this._getState()];case 1:if(u.sent()!==r.ESettingItemState.ENABLE){return[2,Promise.resolve(undefined)]}return[4,this.meetingUserConfig.getRCVDefaultBridge()];case 2:e=u.sent();if(!e){return[2,Promise.resolve(undefined)]}if(!e.pins){t=e}else{t=m.W.convertV2Response2V1Response(e)}return[4,this.meetingUserConfig.isRCVInstantMeet()];case 3:n=u.sent();i=this._generatePmiLinkAndPmnLink(t.shortId,t.personalRoomName,t.meetingPasswordMasked),o=i.pmiLinkValue,a=i.pmnLinkValue;this._cacheValue={setting:t,use_pmi_instant:n,pmiLink:o,pmnLink:a};return[2,this._cacheValue]}}))}))};PMISettingItemProvider.prototype._generatePmiLinkAndPmnLink=function(e,t,n){var r=this._generatePersonalMeetingLink(e,n);var i=this._generatePersonalMeetingLink(t,n);return{pmiLinkValue:r,pmnLinkValue:i}};PMISettingItemProvider.prototype._generatePersonalMeetingLink=function(e,t){if(e){var n=R.S.getConfig().meetingsConfig.rcv.baseUrl+"/join/"+e;t&&(n+="?pw="+t);return n}return""};Object.defineProperty(PMISettingItemProvider.prototype,"featureFlagModule",{get:function(){return(0,s.getModule)(O.FEATURE_FLAG_MODULE)},enumerable:true,configurable:true});return PMISettingItemProvider}(u.t);var L=undefined&&undefined.__extends||function(){var extendStatics=function(e,t){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)if(t.hasOwnProperty(n))e[n]=t[n]};return extendStatics(e,t)};return function(e,t){extendStatics(e,t);function __(){this.constructor=e}e.prototype=t===null?Object.create(t):(__.prototype=t.prototype,new __)}}();var D=undefined&&undefined.__awaiter||function(e,t,n,r){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,i){function fulfilled(e){try{step(r.next(e))}catch(e){i(e)}}function rejected(e){try{step(r["throw"](e))}catch(e){i(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((r=r.apply(e,t||[])).next())}))};var U=undefined&&undefined.__generator||function(e,t){var n={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},r,i,o,a;return a={next:verb(0),throw:verb(1),return:verb(2)},typeof Symbol==="function"&&(a[Symbol.iterator]=function(){return this}),a;function verb(e){return function(t){return step([e,t])}}function step(a){if(r)throw new TypeError("Generator is already executing.");while(n)try{if(r=1,i&&(o=a[0]&2?i["return"]:a[0]?i["throw"]||((o=i["return"])&&o.call(i),0):i.next)&&!(o=o.call(i,a[1])).done)return o;if(i=0,o)a=[a[0]&2,o.value];switch(a[0]){case 0:case 1:o=a;break;case 4:n.label++;return{value:a[1],done:false};case 5:n.label++;i=a[1];a=[0];continue;case 7:a=n.ops.pop();n.trys.pop();continue;default:if(!(o=n.trys,o=o.length>0&&o[o.length-1])&&(a[0]===6||a[0]===2)){n=0;continue}if(a[0]===3&&(!o||a[1]>o[0]&&a[1]<o[3])){n.label=a[1];break}if(a[0]===6&&n.label<o[1]){n.label=o[1];o=a;break}if(o&&n.label<o[2]){n.label=o[2];n.ops.push(a);break}if(o[2])n.ops.pop();n.trys.pop();continue}a=t.call(e,n)}catch(e){a=[6,e];i=0}finally{r=o=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:true}}};var B;(function(e){e[e["guests"]=v.VQ.ONLY_GUESTS]="guests";e[e["all"]=v.VQ.ALL]="all";e[e["notcoworker"]=v.VQ.NOT_COWORKER]="notcoworker"})(B||(B={}));var k=function(e){L(RCVPreferencesProvider,e);function RCVPreferencesProvider(){return e.call(this,{id:i.o.RCV_PREFERENCES,source:{type:r.Pe.CONSTANT}})||this}RCVPreferencesProvider.prototype.buildValueProvider=function(){var e=this;return this.buildBaseItemValueProvider({getter:function(){return e._getValue()}})};RCVPreferencesProvider.prototype.onLoad=function(){var e=this;var handleUpdate=function(){e.getValueProvider().notifyChange()};this._preferenceDisposer=I.gv.getInstance().subscribeRCVPreferenceChange(handleUpdate)};RCVPreferencesProvider.prototype.onUnload=function(){if(this._preferenceDisposer){this._preferenceDisposer();this._preferenceDisposer=undefined}};RCVPreferencesProvider.prototype._getValue=function(){return D(this,void 0,void 0,(function(){var e,t,n,r,i,o;return U(this,(function(a){switch(a.label){case 0:e={readOnly:false,value:""};t={readOnly:false,value:""};n=false;r=false;i={usePMIScheduled:{readOnly:false,value:false},passwordScheduled:{readOnly:false,value:true},passwordInstant:{readOnly:false,value:true},guestJoin:{readOnly:false,value:false},joinBeforeHost:{readOnly:false,value:false},screenSharing:{readOnly:false,value:true},screenSharingHostOnly:{readOnly:false,value:false},usersCanJoin:{readOnly:false,value:v.wN.Off},usePMIInstant:{readOnly:false,value:false},waitingRoomMode:{readOnly:false,value:v.VQ.OFF},e2ee:{readOnly:false,value:false},e2ee_instant:{readOnly:false,value:false}};return[4,I.gv.getInstance().getRCVPreferences()];case 1:o=a.sent();if(o){o.forEach((function(o){switch(o.id){case C.m.GUEST_JOIN:i.guestJoin.value=o.value;i.guestJoin.readOnly=o.readOnly;i.usersCanJoin.readOnly=o.readOnly;break;case C.m.JOIN_AUTHENTICATED_FROM_ACCOUNT_ONLY:e.value=o.value;e.readOnly=o.readOnly;break;case C.m.SCREEN_SHARING:i.screenSharing.value=o.value;i.screenSharing.readOnly=o.readOnly;break;case C.m.JOIN_BEFORE_HOST:i.joinBeforeHost.value=o.value;i.joinBeforeHost.readOnly=o.readOnly;break;case C.m.PASSWORD_INSTANT:i.passwordInstant.value=o.value;i.passwordInstant.readOnly=o.readOnly;break;case C.m.SCREEN_SHARING_HOST_ONLY:t.value=o.value;t.readOnly=o.readOnly;break;case C.m.PASSWORD_SCHEDULED:i.passwordScheduled.value=o.value;i.passwordScheduled.readOnly=o.readOnly;break;case C.m.USE_PMI_INSTANT:i.usePMIInstant.value=o.value;i.usePMIInstant.readOnly=o.readOnly;break;case C.m.USE_PMI_SCHEDULED:i.usePMIScheduled.value=o.value;i.usePMIScheduled.readOnly=o.readOnly;break;case C.m.WAITING_ROOM:n=o.value;i.waitingRoomMode.readOnly=o.readOnly;break;case C.m.WAITING_ROOM_GUESTS_ONLY:if(n){i.waitingRoomMode.value=B[o.value]||v.VQ.OFF}break;case C.m.E2EE:i.e2ee.value=o.value;i.e2ee.readOnly=o.readOnly;if(!i.e2ee.value&&i.e2ee.readOnly){i.e2ee_instant.value=false;r=true}break;case C.m.E2EE_INSTANT:if(!r){i.e2ee_instant.value=o.value;i.e2ee_instant.readOnly=o.readOnly}break;default:break}}));if(t.value===v.of.HOST){i.screenSharingHostOnly.value=true}i.screenSharingHostOnly.readOnly=t.readOnly;if(i.guestJoin.value){switch(e.value){case v.mz.ANYONE_SIGNED_INTO_RC:i.usersCanJoin.value=v.wN.OnlyAuthUserJoin;i.usersCanJoin.readOnly=e.readOnly;break;default:i.usersCanJoin.value=v.wN.OnlyCoworkersJoin;i.usersCanJoin.readOnly=e.readOnly}}}return[2,i]}}))}))};return RCVPreferencesProvider}(u.t);var j=undefined&&undefined.__extends||function(){var extendStatics=function(e,t){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)if(t.hasOwnProperty(n))e[n]=t[n]};return extendStatics(e,t)};return function(e,t){extendStatics(e,t);function __(){this.constructor=e}e.prototype=t===null?Object.create(t):(__.prototype=t.prototype,new __)}}();var H=undefined&&undefined.__awaiter||function(e,t,n,r){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,i){function fulfilled(e){try{step(r.next(e))}catch(e){i(e)}}function rejected(e){try{step(r["throw"](e))}catch(e){i(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((r=r.apply(e,t||[])).next())}))};var G=undefined&&undefined.__generator||function(e,t){var n={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},r,i,o,a;return a={next:verb(0),throw:verb(1),return:verb(2)},typeof Symbol==="function"&&(a[Symbol.iterator]=function(){return this}),a;function verb(e){return function(t){return step([e,t])}}function step(a){if(r)throw new TypeError("Generator is already executing.");while(n)try{if(r=1,i&&(o=a[0]&2?i["return"]:a[0]?i["throw"]||((o=i["return"])&&o.call(i),0):i.next)&&!(o=o.call(i,a[1])).done)return o;if(i=0,o)a=[a[0]&2,o.value];switch(a[0]){case 0:case 1:o=a;break;case 4:n.label++;return{value:a[1],done:false};case 5:n.label++;i=a[1];a=[0];continue;case 7:a=n.ops.pop();n.trys.pop();continue;default:if(!(o=n.trys,o=o.length>0&&o[o.length-1])&&(a[0]===6||a[0]===2)){n=0;continue}if(a[0]===3&&(!o||a[1]>o[0]&&a[1]<o[3])){n.label=a[1];break}if(a[0]===6&&n.label<o[1]){n.label=o[1];o=a;break}if(o&&n.label<o[2]){n.label=o[2];n.ops.push(a);break}if(o[2])n.ops.pop();n.trys.pop();continue}a=t.call(e,n)}catch(e){a=[6,e];i=0}finally{r=o=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:true}}};var F=function(e){j(RCVAllowIncomingCallsProvider,e);function RCVAllowIncomingCallsProvider(t){var n=e.call(this,{id:i.o.RCV_ALLOW_INCOMING_CALLS,value:{type:r.Pe.STORAGE,defaultValue:true}})||this;n._meetingService=t;return n}RCVAllowIncomingCallsProvider.prototype.buildStateProvider=function(){var e=this;return this.buildBaseItemValueProvider({getter:function(){return e._getState()}})};RCVAllowIncomingCallsProvider.prototype.onLoad=function(){var e=this;this.onSettingUpdate(a.H.Video_Service,(function(){e.getStateProvider().notifyChange()}))};RCVAllowIncomingCallsProvider.prototype._isRcAccount=function(){var e;return((e=(0,s.getCurrentAccount)())===null||e===void 0?void 0:e.accountType())===l.Q5.RC};RCVAllowIncomingCallsProvider.prototype._isMeetPermissionEnabled=function(){var e;return H(this,void 0,void 0,(function(){var t;return G(this,(function(n){switch(n.label){case 0:return[4,(e=(0,s.getModule)(c.COMMON_KEY_ACTION_MODULE).getKeyActionService().get(c.ACTION_KEY.VIDEO_CONFERENCING))===null||e===void 0?void 0:e.getAction()];case 1:t=n.sent();return[4,t===null||t===void 0?void 0:t.get()];case 2:return[2,n.sent()]}}))}))};RCVAllowIncomingCallsProvider.prototype._isRCV=function(){return H(this,void 0,void 0,(function(){var e;return G(this,(function(t){switch(t.label){case 0:return[4,this._meetingService.meetModule.getVideoService()];case 1:e=t.sent();return[2,e&&[o.ZE.RINGCENTRAL_VIDEO,o.ZE.RINGCENTRAL_VIDEO_EMBEDDED,o.ZE.RINGCENTRAL_VIDEO_HERCULES].includes(e)]}}))}))};RCVAllowIncomingCallsProvider.prototype._getState=function(){return H(this,void 0,void 0,(function(){var e;return G(this,(function(t){switch(t.label){case 0:return[4,Promise.all([this._isRcAccount(),this._isMeetPermissionEnabled(),this._isRCV()])];case 1:e=t.sent();if(e.every(Boolean)){return[2,r.ESettingItemState.ENABLE]}return[2,r.ESettingItemState.INVISIBLE]}}))}))};return RCVAllowIncomingCallsProvider}(u.t);var x=undefined&&undefined.__extends||function(){var extendStatics=function(e,t){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)if(t.hasOwnProperty(n))e[n]=t[n]};return extendStatics(e,t)};return function(e,t){extendStatics(e,t);function __(){this.constructor=e}e.prototype=t===null?Object.create(t):(__.prototype=t.prototype,new __)}}();var J=function(e){x(RCVSettingManager,e);function RCVSettingManager(t){var n=e.call(this)||this;n._rcvService=t;return n}RCVSettingManager.prototype.getProviderMap=function(){var e;return e={},e[i.o.RCV_MEET_SETTING]=new h(this._rcvService),e[i.o.RCV_PMI]=new T(this._rcvService),e[i.o.RCV_PREFERENCES]=new k,e[i.o.RCV_ALLOW_INCOMING_CALLS]=new F(this._rcvService),e};return RCVSettingManager}(r.AbstractModuleSettingProviderManager)},890512:(e,t,n)=>{"use strict";n.d(t,{o:()=>r});var r;(function(e){e["RCV_PMI"]="RCV_PMI";e["RCV_MEET_SETTING"]="RCV_MEET_SETTING";e["RCV_PREFERENCES"]="RCV_PREFERENCES";e["RCV_ALLOW_INCOMING_CALLS"]="RCV_ALLOW_INCOMING_CALLS"})(r||(r={}))},782821:(e,t,n)=>{"use strict";n.d(t,{e:()=>o});var r=n(231820);var i=undefined&&undefined.__extends||function(){var extendStatics=function(e,t){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)if(t.hasOwnProperty(n))e[n]=t[n]};return extendStatics(e,t)};return function(e,t){extendStatics(e,t);function __(){this.constructor=e}e.prototype=t===null?Object.create(t):(__.prototype=t.prototype,new __)}}();var o=function(e){i(RCVMeetCounter,e);function RCVMeetCounter(){return e.call(this)||this}return RCVMeetCounter}(r.zD)},268908:(e,t,n)=>{"use strict";n.d(t,{W:()=>a});var r=n(253962);var i="\r\n";var o='name="body"';var a=function(){function RCVUtils(){}RCVUtils.parseInvitationResponse=function(e){var t=e.trim().split(i);var n=t[0];var r=t.findIndex((function(e){return e.endsWith(o)}));var a=r+t.slice(r).findIndex((function(e){return e.startsWith(n)}));if(r>0&&a>r){return t.slice(r+2,a).join(i)}return""};RCVUtils.convertV2Response2V1Response=function(e){var t,n,i,o,a,u;var s=new Map;s.set(r.eJ.Nobody,r.VQ.OFF);s.set(r.eJ.Everybody,r.VQ.ALL);s.set(r.eJ.GuestsOnly,r.VQ.ONLY_GUESTS);s.set(r.eJ.OtherAccount,r.VQ.NOT_COWORKER);s.set(undefined,r.VQ.OFF);var c={id:e.id,participantCode:(t=e.pins.pstn)===null||t===void 0?void 0:t.participant,hostCode:(n=e.pins.pstn)===null||n===void 0?void 0:n.host,allowJoinBeforeHost:e.preferences.joinBeforeHost,muteAudio:e.preferences.join.audioMuted,muteVideo:e.preferences.join.videoMuted,shortId:e.pins.web,joinUri:e.discovery.web,isMeetingSecret:e.security.passwordProtected,meetingPassword:(i=e.security.password)===null||i===void 0?void 0:i.plainText,accountId:(o=e.host)===null||o===void 0?void 0:o.accountId,extensionId:(a=e.host)===null||a===void 0?void 0:a.extensionId,allowScreenSharing:e.preferences.screenSharing,isOnlyAuthUserJoin:e.security.noGuests,isOnlyCoworkersJoin:e.security.sameAccount,usersCanJoin:r.wN.Off,name:e.name,meetingPasswordMasked:(u=e.security.password)===null||u===void 0?void 0:u.joinQuery,waitingRoomMode:s.get(e.preferences.join.waitingRoomRequired),type:e.type};if(e.security.noGuests){c.usersCanJoin=r.wN.OnlyAuthUserJoin}if(e.security.sameAccount){c.usersCanJoin=r.wN.OnlyCoworkersJoin}if(e.pins.aliases&&e.pins.aliases.length>0){c.personalRoomName=e.pins.aliases[e.pins.aliases.length-1]}return c};RCVUtils.convertOldWaitingRoomMode2New=function(e){var t=new Map;t.set(r.VQ.OFF,r.eJ.Nobody);t.set(r.VQ.ALL,r.eJ.Everybody);t.set(r.VQ.ONLY_GUESTS,r.eJ.GuestsOnly);t.set(r.VQ.NOT_COWORKER,r.eJ.OtherAccount);t.set(undefined,r.eJ.Nobody);return t.get(e)};return RCVUtils}()}}]);